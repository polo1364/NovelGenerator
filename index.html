<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Â∞èË™™ & Êº´Áï´Â∑•Âùä | AI Ââµ‰ΩúÂπ≥Âè∞</title>
    
    <!-- PWA ÊîØÊè¥ -->
    <meta name="description" content="AI Â∞èË™™ & Êº´Áï´Â∑•Âùä - ‰∏ÄÈçµÁîüÊàêÂ∞èË™™‰∏¶ËΩâÊèõÊàêÊº´Áï´ÁöÑÂâµ‰ΩúÂ∑•ÂÖ∑">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AIÂâµ‰ΩúÂ∑•Âùä">
    
    <!-- Èõ¢Á∑öÂ≠óÈ´îÂÇôÊè¥ -->
    <style>
      /* Èõ¢Á∑öÊôÇ‰ΩøÁî®Á≥ªÁµ±Â≠óÈ´î */
      @font-face {
        font-family: 'Offline Serif';
        src: local('Noto Serif TC'), local('Noto Serif CJK TC'), local('Source Han Serif TC'), 
             local('PingFang TC'), local('Microsoft JhengHei'), local('ÂæÆËªüÊ≠£ÈªëÈ´î'),
             local('Heiti TC'), local('Apple LiGothic'), local('SimHei');
        font-weight: 400 700;
        font-display: swap;
      }
    </style>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;600;700&family=LXGW+WenKai+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary: #1a1a2e;
        --primary-light: #16213e;
        --accent: #e94560;
        --accent-hover: #ff6b6b;
        --gold: #f4a261;
        --gold-light: #f8c291;
        --text: #2d3436;
        --text-light: #636e72;
        --bg: #fefefe;
        --card-bg: #ffffff;
        --section-bg: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
        --input-bg: #fff;
        --border: #e0e0e0;
        --shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        --shadow-hover: 0 15px 50px rgba(0, 0, 0, 0.12);
        --font-size-base: 16px;
        --font-size-output: 1.15rem;
      }

      /* Ê∑±Ëâ≤Ê®°Âºè */
      [data-theme="dark"] {
        --primary: #e0e0e0;
        --primary-light: #b0b0b0;
        --accent: #ff6b8a;
        --accent-hover: #ff8fa8;
        --gold: #ffb347;
        --gold-light: #ffc978;
        --text: #e8e8e8;
        --text-light: #a0a0a0;
        --bg: #0d1117;
        --card-bg: #161b22;
        --section-bg: linear-gradient(135deg, #1c2128 0%, #21262d 100%);
        --input-bg: #21262d;
        --border: #30363d;
        --shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        --shadow-hover: 0 15px 50px rgba(0, 0, 0, 0.5);
      }

      [data-theme="dark"] body {
        background: var(--bg);
        background-image: 
          radial-gradient(circle at 20% 80%, rgba(255, 107, 138, 0.05) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(255, 179, 71, 0.05) 0%, transparent 50%),
          linear-gradient(180deg, #0d1117 0%, #161b22 100%);
      }

      [data-theme="dark"] body::before {
        background: linear-gradient(90deg, var(--accent), var(--gold), var(--accent));
      }

      [data-theme="dark"] h1 {
        background: linear-gradient(135deg, #e0e0e0 0%, var(--accent) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      [data-theme="dark"] .output {
        background: linear-gradient(180deg, var(--card-bg) 0%, #1c2128 100%);
      }

      [data-theme="dark"] select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23a0a0a0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      }

      [data-theme="dark"] .status.loading {
        background: linear-gradient(90deg, #21262d, #30363d, #21262d);
        background-size: 200% 100%;
      }

      [data-theme="dark"] .status.success {
        background: #1f3d2a;
        color: #7ee787;
      }

      [data-theme="dark"] .status.error {
        background: #3d1f1f;
        color: #ff7b72;
      }

      [data-theme="dark"] .status.warning {
        background: #3d3520;
        color: #d29922;
      }

      [data-theme="dark"] .modal {
        background: var(--card-bg);
        color: var(--text);
      }

      [data-theme="dark"] .modal-content {
        background: var(--card-bg);
      }

      [data-theme="dark"] .special-element-item {
        background: rgba(30, 35, 42, 0.8);
      }

      [data-theme="dark"] .character-row {
        background: rgba(30, 35, 42, 0.7);
      }

      [data-theme="dark"] .speech-panel {
        background: linear-gradient(135deg, #1c2128 0%, var(--card-bg) 100%);
      }

      [data-theme="dark"] .chapter-nav-list button {
        background: #21262d;
      }

      [data-theme="dark"] .btn-icon {
        background: var(--card-bg);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: 'LXGW WenKai TC', 'Noto Serif TC', 'Offline Serif', 'PingFang TC', 'Microsoft JhengHei', 'ÂæÆËªüÊ≠£ÈªëÈ´î', sans-serif;
        background: var(--bg);
        background-image: 
          radial-gradient(circle at 20% 80%, rgba(233, 69, 96, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(244, 162, 97, 0.03) 0%, transparent 50%),
          linear-gradient(180deg, #fefefe 0%, #f8f9fa 100%);
        color: var(--text);
        min-height: 100vh;
        padding: 40px 20px 80px;
      }

      /* È†ÇÈÉ®Ë£ùÈ£æÊ¢ù */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--accent), var(--gold), var(--accent));
        z-index: 1000;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding-left: 20px;
        padding-right: 20px;
      }

      /* È†≠ÈÉ®ÂçÄÂüü */
      header {
        text-align: center;
        margin-bottom: 50px;
        position: relative;
      }

      header::after {
        content: '‚ú¶';
        display: block;
        font-size: 1.5rem;
        color: var(--gold);
        margin-top: 20px;
        animation: twinkle 2s ease-in-out infinite;
      }

      @keyframes twinkle {
        0%, 100% { opacity: 0.5; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.2); }
      }

      h1 {
        font-family: 'Noto Serif TC', serif;
        font-size: 3rem;
        font-weight: 700;
        margin: 0;
        background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: 0.1em;
      }

      .subtitle {
        margin-top: 16px;
        color: var(--text-light);
        font-size: 1.1rem;
        line-height: 1.8;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      /* ‰∏ªÂç°Áâá */
      .card {
        background: var(--card-bg);
        border-radius: 20px;
        box-shadow: var(--shadow);
        padding: 40px;
        margin-bottom: 30px;
        border: 1px solid rgba(0, 0, 0, 0.03);
        transition: box-shadow 0.3s ease;
      }

      .card:hover {
        box-shadow: var(--shadow-hover);
      }

      /* ÂçÄÂ°äÊ®£Âºè */
      .section {
        background: var(--section-bg);
        border-radius: 16px;
        padding: 28px;
        margin-bottom: 24px;
        border: 1px solid var(--border);
        position: relative;
        overflow: hidden;
      }

      .section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: linear-gradient(180deg, var(--accent), var(--gold));
        border-radius: 4px 0 0 4px;
      }

      .section-title {
        font-family: 'Noto Serif TC', serif;
        font-weight: 600;
        font-size: 1.3rem;
        color: var(--primary);
        margin: 0 0 20px 0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-title::before {
        content: attr(data-icon);
        font-size: 1.2rem;
      }

      /* Ëº∏ÂÖ•ÁµÑ‰ª∂ */
      .input-group {
        margin-bottom: 20px;
      }

      .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--primary);
        font-size: 0.95rem;
      }

      .label-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .label-row label {
        font-weight: 500;
        color: var(--primary);
        margin-bottom: 0;
      }

      input[type="text"],
      input[type="number"],
      input[type="password"],
      select,
      textarea {
        width: 100%;
        padding: 14px 18px;
        border: 2px solid var(--border);
        border-radius: 12px;
        background: var(--input-bg);
        font-family: inherit;
        font-size: 1rem;
        color: var(--text);
        transition: all 0.3s ease;
      }

      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 4px rgba(233, 69, 96, 0.1);
      }

      textarea {
        min-height: 100px;
        resize: vertical;
        line-height: 1.6;
      }

      select {
        cursor: pointer;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23636e72' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        background-size: 18px;
        padding-right: 45px;
      }

      /* API ÈáëÈë∞ÂÆπÂô® */
      .api-key-container {
        display: flex;
        gap: 10px;
      }

      .api-key-container input {
        flex: 1;
      }

      /* ÊåâÈàïÊ®£Âºè */
      button {
        font-family: inherit;
        font-size: 0.95rem;
        font-weight: 500;
        padding: 12px 24px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      button::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.4s, height 0.4s;
      }

      button:active::after {
        width: 300px;
        height: 300px;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b6b 100%);
        color: #fff;
        box-shadow: 0 4px 15px rgba(233, 69, 96, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(233, 69, 96, 0.4);
      }

      .btn-secondary {
        background: var(--primary);
        color: #fff;
      }

      .btn-secondary:hover {
        background: var(--primary-light);
        transform: translateY(-2px);
      }

      .btn-outline {
        background: transparent;
        color: var(--text);
        border: 2px solid var(--border);
      }

      .btn-outline:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      .btn-gold {
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
        color: var(--primary);
        box-shadow: 0 4px 15px rgba(244, 162, 97, 0.3);
      }

      .btn-gold:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(244, 162, 97, 0.4);
      }

      .btn-small {
        padding: 8px 16px;
        font-size: 0.85rem;
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      /* ‰∏ªÊåâÈàïÂçÄ */
      .buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 10px;
      }

      /* ‰∏ãËºâ‰∏ãÊãâÈÅ∏ÂñÆ */
      .download-dropdown {
        position: relative;
        display: inline-block;
      }
      
      .download-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        margin-top: 6px;
        background: white;
        border: 1px solid var(--border);
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        z-index: 100;
        min-width: 200px;
        overflow: hidden;
        animation: dropdownFade 0.2s ease;
      }
      
      @keyframes dropdownFade {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      .download-dropdown.open .download-menu {
        display: block;
      }
      
      .download-menu button {
        display: block;
        width: 100%;
        padding: 14px 18px;
        background: none;
        border: none;
        text-align: left;
        font-size: 0.95rem;
        color: var(--text);
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: inherit;
      }
      
      .download-menu button:hover {
        background: linear-gradient(135deg, rgba(233, 69, 96, 0.08), rgba(244, 162, 97, 0.08));
        color: var(--accent);
      }
      
      .download-menu button:first-child {
        border-bottom: 1px solid var(--border);
      }
      
      .download-menu button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* ‰∫∫Áâ©Ë®≠ÂÆöÂçÄ */
      .character-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 14px;
        align-items: center;
        padding: 16px;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 12px;
        border: 1px solid var(--border);
        transition: all 0.3s ease;
      }

      .character-row:hover {
        border-color: var(--accent);
        box-shadow: 0 4px 12px rgba(233, 69, 96, 0.08);
      }

      .char-index {
        font-weight: 600;
        color: var(--accent);
        font-size: 0.9rem;
        width: 55px;
        flex-shrink: 0;
      }

      .character-row input,
      .character-row select {
        padding: 10px 12px;
        font-size: 0.9rem;
      }

      .character-row .char-gender {
        width: 75px;
        flex-shrink: 0;
      }
      
      .character-row .char-age {
        width: 70px;
        flex-shrink: 0;
      }
      
      .character-row .char-name {
        width: 90px;
        flex-shrink: 0;
      }
      
      .character-row .char-personality,
      .character-row .char-goal,
      .character-row .char-weakness,
      .character-row .char-secret,
      .character-row .char-relation {
        flex: 1;
        min-width: 110px;
      }

      .character-row button {
        padding: 10px 14px;
        white-space: nowrap;
        flex-shrink: 0;
      }
      
      .char-remove-btn {
        color: #999;
        border-color: #ddd;
      }
      
      .char-remove-btn:hover {
        color: #e94560;
        border-color: #e94560;
        background: rgba(233, 69, 96, 0.1);
      }

      /* Â∏∂ datalist ÁöÑËº∏ÂÖ•Ê°ÜÊ®£Âºè */
      .character-row input[list] {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23999' d='M6 8L2 4h8z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 8px center;
        padding-right: 28px;
        cursor: pointer;
      }
      
      .character-row input[list]:focus {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23e94560' d='M6 8L2 4h8z'/%3E%3C/svg%3E");
      }
      
      .character-row input[list]::placeholder {
        color: #aaa;
      }

      /* ÈüøÊáâÂºè - ‰∫∫Áâ©Ë®≠ÂÆö */
      @media (max-width: 1200px) {
        .character-row .char-personality,
        .character-row .char-goal,
        .character-row .char-weakness,
        .character-row .char-secret,
        .character-row .char-relation {
          min-width: 100px;
        }
      }

      @media (max-width: 900px) {
        .character-row {
          padding: 14px;
        }
        .char-index {
          width: 100%;
          padding-bottom: 8px;
          margin-bottom: 4px;
          border-bottom: 1px dashed var(--border);
        }
        .character-row .char-personality,
        .character-row .char-goal,
        .character-row .char-weakness,
        .character-row .char-secret,
        .character-row .char-relation {
          min-width: calc(33% - 10px);
          flex: 1 1 calc(33% - 10px);
        }
      }

      @media (max-width: 600px) {
        .character-row {
          padding: 12px;
          gap: 8px;
        }
        .character-row .char-gender {
          width: 70px;
        }
        .character-row .char-age {
          width: 65px;
        }
        .character-row .char-name {
          flex: 1;
          min-width: 80px;
        }
        .character-row .char-personality,
        .character-row .char-goal,
        .character-row .char-weakness,
        .character-row .char-secret,
        .character-row .char-relation {
          min-width: calc(50% - 5px);
          flex: 1 1 calc(50% - 5px);
        }
      }

      @media (max-width: 450px) {
        .character-row .char-personality,
        .character-row .char-goal,
        .character-row .char-weakness,
        .character-row .char-secret,
        .character-row .char-relation {
          min-width: 100%;
          flex: 1 1 100%;
        }
        .character-row button {
          flex: 1;
        }
      }

      /* ÁãÄÊÖãË®äÊÅØ */
      .status {
        margin-top: 16px;
        padding: 14px 20px;
        border-radius: 10px;
        font-size: 0.95rem;
        display: none;
        align-items: center;
        gap: 10px;
      }

      .status.show {
        display: flex;
      }

      .status.loading {
        background: linear-gradient(90deg, #f8f9fa, #e9ecef, #f8f9fa);
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
        color: var(--text);
      }

      .status.success {
        background: #d4edda;
        color: #155724;
      }

      .status.error {
        background: #f8d7da;
        color: #721c24;
      }

      .status.warning {
        background: #fff3cd;
        color: #856404;
      }

      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }

      .status-icon {
        font-size: 1.2rem;
      }

      /* Ëá™Âãï‰øùÂ≠òÊåáÁ§∫Âô® */
      .auto-save-indicator {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background: var(--card-bg);
        padding: 8px 16px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        color: var(--text-light);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
        z-index: 1000;
        pointer-events: none;
      }

      .auto-save-indicator.show {
        opacity: 1;
        transform: translateY(0);
      }

      .auto-save-indicator .save-icon {
        animation: pulse 1s ease-in-out;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
      }

      /* ÁîüÊàêÊ≠∑Âè≤Èù¢Êùø */
      .history-panel {
        position: fixed;
        top: 0;
        right: -400px;
        width: 380px;
        max-width: 90vw;
        height: 100vh;
        background: var(--card-bg);
        box-shadow: -5px 0 30px rgba(0,0,0,0.2);
        z-index: 2000;
        transition: right 0.3s ease;
        display: flex;
        flex-direction: column;
      }

      .history-panel.open {
        right: 0;
      }

      .history-header {
        padding: 20px;
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b8a 100%);
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .history-header h3 {
        margin: 0;
        font-size: 1.1rem;
      }

      .history-close {
        background: rgba(255,255,255,0.2);
        border: none;
        color: white;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s;
      }

      .history-close:hover {
        background: rgba(255,255,255,0.3);
      }

      .history-list {
        flex: 1;
        overflow-y: auto;
        padding: 15px;
      }

      .history-item {
        background: var(--section-bg);
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 12px;
        cursor: pointer;
        transition: all 0.2s;
        border: 2px solid transparent;
      }

      .history-item:hover {
        border-color: var(--accent);
        transform: translateX(-5px);
      }

      .history-item-title {
        font-weight: 600;
        color: var(--text);
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .history-item-meta {
        font-size: 0.8rem;
        color: var(--text-light);
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .history-item-preview {
        font-size: 0.85rem;
        color: var(--text-light);
        margin-top: 8px;
        line-height: 1.5;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .history-empty {
        text-align: center;
        padding: 40px 20px;
        color: var(--text-light);
      }

      .history-empty-icon {
        font-size: 3rem;
        margin-bottom: 10px;
        opacity: 0.5;
      }

      /* Ê≠∑Âè≤ÊåâÈàï */
      .history-toggle-btn {
        position: fixed;
        top: 50%;
        right: 0;
        transform: translateY(-50%);
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b8a 100%);
        color: white;
        border: none;
        padding: 15px 8px;
        border-radius: 12px 0 0 12px;
        cursor: pointer;
        font-size: 1.2rem;
        box-shadow: -3px 0 15px rgba(0,0,0,0.2);
        z-index: 1500;
        transition: all 0.3s;
        writing-mode: vertical-rl;
        text-orientation: mixed;
      }

      .history-toggle-btn:hover {
        padding-right: 15px;
      }

      .history-toggle-btn .badge {
        background: white;
        color: var(--accent);
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 0.7rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-top: 5px;
      }

      /* È¶ñÊ¨°‰ΩøÁî®ÂºïÂ∞é */
      .onboarding-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.8);
        z-index: 3000;
        display: none;
        align-items: center;
        justify-content: center;
      }

      .onboarding-overlay.show {
        display: flex;
      }

      .onboarding-card {
        background: var(--card-bg);
        border-radius: 20px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        text-align: center;
        animation: slideUp 0.5s ease;
      }

      @keyframes slideUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .onboarding-icon {
        font-size: 4rem;
        margin-bottom: 15px;
      }

      .onboarding-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text);
        margin-bottom: 10px;
      }

      .onboarding-desc {
        color: var(--text-light);
        line-height: 1.7;
        margin-bottom: 25px;
      }

      .onboarding-steps {
        text-align: left;
        background: var(--section-bg);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
      }

      .onboarding-step {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 15px;
      }

      .onboarding-step:last-child {
        margin-bottom: 0;
      }

      .onboarding-step-num {
        background: var(--accent);
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: 600;
        flex-shrink: 0;
      }

      .onboarding-step-text {
        color: var(--text);
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .onboarding-btns {
        display: flex;
        gap: 12px;
        justify-content: center;
      }

      .onboarding-btn {
        padding: 12px 30px;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      .onboarding-btn.primary {
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b8a 100%);
        color: white;
        border: none;
      }

      .onboarding-btn.secondary {
        background: transparent;
        color: var(--text-light);
        border: 2px solid var(--border);
      }

      .onboarding-btn:hover {
        transform: translateY(-2px);
      }

      /* Ëº∏ÂÖ•È©óË≠âÊ®£Âºè */
      .input-error {
        border-color: #e74c3c !important;
        animation: shake 0.3s ease;
      }

      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }

      .validation-hint {
        font-size: 0.8rem;
        color: #e74c3c;
        margin-top: 5px;
        display: none;
      }

      .validation-hint.show {
        display: block;
      }

      /* ÂøÖÂ°´Ê®ôË®ò */
      .required-mark {
        color: var(--accent);
        margin-left: 3px;
      }

      /* Áµ±Ë®àÊ¶ÇË¶ΩÂç°Áâá */
      .stats-card {
        background: linear-gradient(135deg, var(--card-bg) 0%, var(--section-bg) 100%);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid var(--border);
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
      }

      .stat-item {
        text-align: center;
        padding: 15px 10px;
        background: var(--card-bg);
        border-radius: 12px;
        transition: transform 0.2s;
      }

      .stat-item:hover {
        transform: translateY(-3px);
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--accent);
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.8rem;
        color: var(--text-light);
      }

      @media (max-width: 768px) {
        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }
        
        .history-panel {
          width: 100%;
          max-width: 100%;
        }
        
        .history-toggle-btn {
          bottom: 80px;
          top: auto;
          right: 20px;
          transform: none;
          border-radius: 50%;
          padding: 15px;
          writing-mode: horizontal-tb;
        }
      }

      /* Ëº∏Âá∫ÂçÄ */
      .output {
        margin-top: 30px;
        padding: 40px;
        border: 2px solid var(--border);
        border-radius: 16px;
        background: linear-gradient(180deg, #fff 0%, #fafafa 100%);
        font-family: 'Noto Serif TC', serif;
        font-size: 1.15rem;
        line-height: 2;
        white-space: pre-wrap;
        color: var(--text);
        min-height: 200px;
        position: relative;
      }

      .output:empty::before {
        content: 'ÁîüÊàêÁöÑÊïÖ‰∫ãÂ∞áÊúÉÂú®ÈÄôË£°È°ØÁ§∫...';
        color: #adb5bd;
        font-style: italic;
      }

      .output-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .output-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--primary);
      }

      /* ======================= */
      /* Êõ∏Á±§ÂäüËÉΩ - Â§ßÂπÖÂÑ™Âåñ */
      /* ======================= */
      .bookmark-card {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        color: #fff;
        border-radius: 20px;
        padding: 30px;
        box-shadow: var(--shadow);
      }

      .bookmark-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        flex-wrap: wrap;
        gap: 16px;
      }

      .bookmark-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 1.5rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .bookmark-title::before {
        content: 'üìö';
        font-size: 1.4rem;
      }

      .bookmark-count {
        background: rgba(255, 255, 255, 0.2);
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 400;
      }

      .bookmark-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .bookmark-actions button {
        background: rgba(255, 255, 255, 0.15);
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .bookmark-actions button:hover {
        background: rgba(255, 255, 255, 0.25);
      }

      /* Êõ∏Á±§ÊêúÂ∞ãËàáÊéíÂ∫è */
      .bookmark-toolbar {
        display: flex;
        gap: 12px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .bookmark-search {
        flex: 1;
        min-width: 200px;
        position: relative;
      }

      .bookmark-search input {
        padding-left: 45px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
      }

      .bookmark-search input::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }

      .bookmark-search input:focus {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.4);
        box-shadow: none;
      }

      .bookmark-search::before {
        content: 'üîç';
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1rem;
        z-index: 1;
      }

      .bookmark-sort {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        min-width: 140px;
      }

      .bookmark-sort option {
        background: var(--primary);
        color: #fff;
      }

      /* Êõ∏Á±§ÂàóË°® */
      .bookmark-list {
        list-style: none;
        padding: 0;
        margin: 0;
        max-height: 400px;
        overflow-y: auto;
      }

      .bookmark-list::-webkit-scrollbar {
        width: 6px;
      }

      .bookmark-list::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
      }

      .bookmark-list::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
      }

      .bookmark-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px 20px;
        background: rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        margin-bottom: 10px;
        transition: all 0.3s ease;
        border: 1px solid transparent;
      }

      .bookmark-item:hover {
        background: rgba(255, 255, 255, 0.12);
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateX(4px);
      }

      .bookmark-item-icon {
        font-size: 1.5rem;
        flex-shrink: 0;
      }

      .bookmark-item-content {
        flex: 1;
        min-width: 0;
      }

      .bookmark-item-title {
        font-weight: 500;
        font-size: 1rem;
        margin-bottom: 6px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .bookmark-item-meta {
        display: flex;
        gap: 16px;
        font-size: 0.8rem;
        opacity: 0.7;
      }

      .bookmark-item-actions {
        display: flex;
        gap: 8px;
        flex-shrink: 0;
      }

      .bookmark-item-actions button {
        padding: 8px 12px;
        font-size: 0.8rem;
        background: rgba(255, 255, 255, 0.1);
        border: none;
      }

      .bookmark-item-actions button:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .bookmark-item-actions .btn-load {
        background: var(--gold);
        color: var(--primary);
      }

      .bookmark-item-actions .btn-load:hover {
        background: var(--gold-light);
      }

      .bookmark-empty {
        text-align: center;
        padding: 40px;
        opacity: 0.7;
      }

      .bookmark-empty-icon {
        font-size: 3rem;
        margin-bottom: 16px;
      }

      /* Êõ∏Á±§Á∑®ËºØÂΩàÁ™ó */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        padding: 20px;
      }

      .modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background: #fff;
        border-radius: 20px;
        padding: 32px;
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
        transform: translateY(20px);
        transition: transform 0.3s ease;
        color: var(--text);
      }

      .modal-overlay.show .modal {
        transform: translateY(0);
      }

      .modal-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 1.5rem;
        font-weight: 600;
        margin: 0 0 24px 0;
        color: var(--primary);
      }

      .modal-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 24px;
      }

      /* Á´†ÁØÄÂ∞éËà™ - Êô∫ËÉΩÊµÆÂãïÂºè */
      .chapter-nav-container {
        position: fixed;
        top: 80px;
        right: 20px;
        z-index: 999;
        display: none;
      }

      .chapter-nav-container.show {
        display: block;
      }

      .chapter-nav-toggle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b6b 100%);
        color: #fff;
        border: none;
        box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .chapter-nav-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(233, 69, 96, 0.5);
      }

      .chapter-nav-toggle .badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--primary);
        color: #fff;
        font-size: 0.7rem;
        padding: 2px 6px;
        border-radius: 10px;
        font-weight: 600;
      }

      .chapter-nav-panel {
        position: absolute;
        top: 0;
        right: 60px;
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 16px;
        min-width: 250px;
        max-width: 350px;
        max-height: 70vh;
        overflow-y: auto;
        opacity: 0;
        visibility: hidden;
        transform: translateX(20px);
        transition: all 0.3s ease;
      }

      .chapter-nav-panel.open {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
      }

      .chapter-nav-panel::-webkit-scrollbar {
        width: 4px;
      }

      .chapter-nav-panel::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 2px;
      }

      .chapter-nav-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }

      .chapter-nav-title {
        font-weight: 600;
        color: var(--primary);
        font-size: 0.95rem;
      }

      .chapter-nav-close {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        padding: 4px;
        font-size: 1.2rem;
        line-height: 1;
      }

      .chapter-nav-list {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .chapter-nav-list button {
        padding: 10px 14px;
        font-size: 0.85rem;
        background: #f8f9fa;
        color: var(--text);
        border: 1px solid var(--border);
        border-radius: 8px;
        text-align: left;
        transition: all 0.2s ease;
      }

      .chapter-nav-list button:hover {
        background: var(--accent);
        color: #fff;
        border-color: var(--accent);
        transform: translateX(4px);
      }

      .chapter-nav-list button.active {
        background: var(--primary);
        color: #fff;
        border-color: var(--primary);
      }

      .chapter-nav-list button .chapter-num {
        display: inline-block;
        background: rgba(0,0,0,0.1);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        margin-right: 8px;
      }

      .chapter-nav-list button.active .chapter-num {
        background: rgba(255,255,255,0.2);
      }

      /* Èñ±ËÆÄÈÄ≤Â∫¶ÊåáÁ§∫Âô® */
      .reading-progress {
        position: fixed;
        top: 4px;
        left: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--accent), var(--gold));
        z-index: 1001;
        transition: width 0.1s ease;
      }

      /* ==================== ÊµÆÂãïÂ∑•ÂÖ∑Âàó ==================== */
      .floating-toolbar {
        position: fixed;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        z-index: 999;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .toolbar-btn {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        transition: all 0.3s ease;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      }

      .toolbar-btn:hover {
        transform: scale(1.08);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
      }

      .toolbar-btn:active {
        transform: scale(0.95);
      }

      .toolbar-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        transform: none !important;
      }

      .toolbar-btn:disabled:hover {
        transform: none !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      }

      /* Â∑•ÂÖ∑ÂàóÊåâÈàïÈ°èËâ≤ */
      .toolbar-btn.btn-api {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .toolbar-btn.btn-random {
        background: linear-gradient(135deg, var(--gold) 0%, #f39c12 100%);
        color: white;
      }

      .toolbar-btn.btn-generate {
        background: linear-gradient(135deg, var(--accent) 0%, #c0392b 100%);
        color: white;
      }

      .toolbar-btn.btn-continue {
        background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
        color: white;
      }

      .toolbar-btn.btn-download {
        background: linear-gradient(135deg, #0984e3 0%, #6c5ce7 100%);
        color: white;
      }

      .toolbar-btn.btn-comic {
        background: linear-gradient(135deg, #e17055 0%, #fdcb6e 100%);
        color: white;
      }

      .toolbar-btn.btn-speak {
        background: linear-gradient(135deg, #a29bfe 0%, #fd79a8 100%);
        color: white;
      }

      /* Ê≠£Âú®‰ΩúÊ•≠‰∏≠ÁöÑÊåâÈàïÂãïÁï´ */
      .toolbar-btn.active-task {
        animation: pulse-glow 1.5s ease-in-out infinite;
      }

      @keyframes pulse-glow {
        0%, 100% {
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        50% {
          box-shadow: 0 4px 25px rgba(255, 255, 255, 0.5), 0 0 20px currentColor;
        }
      }

      /* Â∑•ÂÖ∑ÂàóÊèêÁ§∫Ê®ôÁ±§ */
      .toolbar-btn .toolbar-tooltip {
        position: absolute;
        left: 62px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--primary);
        color: white;
        padding: 8px 14px;
        border-radius: 8px;
        font-size: 0.85rem;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: all 0.2s ease;
        pointer-events: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .toolbar-btn .toolbar-tooltip::before {
        content: '';
        position: absolute;
        left: -6px;
        top: 50%;
        transform: translateY(-50%);
        border-width: 6px;
        border-style: solid;
        border-color: transparent var(--primary) transparent transparent;
      }

      .toolbar-btn:hover .toolbar-tooltip {
        opacity: 1;
        visibility: visible;
        left: 65px;
      }

      /* API Èù¢Êùø */
      .api-panel {
        position: fixed;
        left: 85px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 20px;
        width: 320px;
        max-height: 80vh;
        overflow-y: auto;
        opacity: 0;
        visibility: hidden;
        z-index: 998;
        transition: all 0.3s ease;
      }

      .api-panel.open {
        opacity: 1;
        visibility: visible;
        left: 90px;
      }

      .api-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }

      .api-panel-title {
        font-weight: 600;
        color: #667eea;
        font-size: 1rem;
      }

      .api-panel-close {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        padding: 4px;
        font-size: 1.2rem;
        line-height: 1;
      }

      .api-panel-close:hover {
        color: var(--accent);
      }

      .api-panel .input-group {
        margin-bottom: 16px;
      }

      .api-panel .input-group:last-child {
        margin-bottom: 0;
      }

      .api-panel label {
        display: block;
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--text);
        margin-bottom: 6px;
      }

      .api-panel input,
      .api-panel select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.9rem;
        transition: border-color 0.2s;
      }

      .api-panel input:focus,
      .api-panel select:focus {
        border-color: #667eea;
        outline: none;
      }

      .api-key-row {
        display: flex;
        gap: 8px;
      }

      .api-key-row input {
        flex: 1;
      }

      .api-key-row button {
        padding: 10px 14px;
        border: 1px solid var(--border);
        border-radius: 8px;
        background: #f8f9fa;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.2s;
      }

      .api-key-row button:hover {
        background: var(--border);
      }

      /* ‰∏ãËºâÈÅ∏ÂñÆÔºàÂ∑•ÂÖ∑ÂàóÁâàÊú¨Ôºâ */
      .toolbar-download-menu {
        position: absolute;
        left: 62px;
        top: 0;
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        padding: 8px;
        min-width: 180px;
        opacity: 0;
        visibility: hidden;
        transform: translateX(-10px);
        transition: all 0.2s ease;
        z-index: 1000;
      }

      .toolbar-download-menu.open {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
      }

      .toolbar-download-menu button {
        display: block;
        width: 100%;
        padding: 10px 14px;
        border: none;
        background: transparent;
        text-align: left;
        cursor: pointer;
        border-radius: 8px;
        font-size: 0.9rem;
        transition: all 0.2s;
      }

      .toolbar-download-menu button:hover {
        background: rgba(233, 69, 96, 0.1);
        color: var(--accent);
      }

      .toolbar-download-menu button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* ÂàÜÈöîÁ∑ö */
      .toolbar-divider {
        width: 32px;
        height: 2px;
        background: var(--border);
        margin: 2px auto;
        border-radius: 1px;
      }

      /* Âπ≥ÊùøÂíåÂ∞èËû¢ÂπïË™øÊï¥ */
      @media (max-width: 1100px) {
        .floating-toolbar {
          left: 10px;
        }

        .toolbar-btn {
          width: 44px;
          height: 44px;
          font-size: 1.1rem;
        }

        .api-panel {
          left: 65px;
          width: 300px;
        }

        .api-panel.open {
          left: 70px;
        }
      }

      /* ÊâãÊ©üÁâàË™øÊï¥ */
      @media (max-width: 768px) {
        .floating-toolbar {
          left: 8px;
          gap: 5px;
        }

        .toolbar-btn {
          width: 40px;
          height: 40px;
          border-radius: 10px;
          font-size: 1rem;
        }

        .toolbar-btn .toolbar-tooltip {
          display: none;
        }

        .toolbar-divider {
          width: 28px;
          margin: 2px auto;
        }

        .api-panel {
          left: 10px;
          right: 10px;
          width: auto;
          top: auto;
          bottom: 20px;
          transform: none;
          max-height: 60vh;
        }

        .api-panel.open {
          left: 10px;
        }

        .toolbar-download-menu {
          left: 50px;
        }
      }

      /* Ë∂ÖÂ∞èËû¢ÂπïÔºàÊâãÊ©üÁõ¥ÂêëÔºâ */
      @media (max-width: 480px) {
        .floating-toolbar {
          left: 5px;
          gap: 4px;
        }

        .toolbar-btn {
          width: 36px;
          height: 36px;
          border-radius: 8px;
          font-size: 0.9rem;
        }

        .toolbar-divider {
          width: 24px;
        }

        .toolbar-download-menu {
          left: 45px;
          min-width: 150px;
        }

        .toolbar-download-menu button {
          padding: 8px 12px;
          font-size: 0.85rem;
        }
      }

      /* ÊµÆÂãïÊõ∏Á±§Â∞éËà™ */
      .bookmark-nav-container {
        position: fixed;
        top: 140px;
        right: 20px;
        z-index: 998;
      }

      .bookmark-nav-toggle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--gold) 0%, #f4a261 100%);
        color: #fff;
        border: none;
        box-shadow: 0 4px 15px rgba(244, 162, 97, 0.4);
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        position: relative;
      }

      .bookmark-nav-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(244, 162, 97, 0.5);
      }

      .bookmark-nav-toggle .badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--accent);
        color: #fff;
        font-size: 0.7rem;
        padding: 2px 6px;
        border-radius: 10px;
        font-weight: 600;
      }

      .bookmark-nav-panel {
        position: absolute;
        top: 0;
        right: 60px;
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 16px;
        width: 320px;
        max-height: 70vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        opacity: 0;
        visibility: hidden;
        transform: translateX(20px);
        transition: all 0.3s ease;
      }

      .bookmark-nav-panel.open {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
      }

      .bookmark-nav-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }

      .bookmark-nav-title {
        font-weight: 600;
        color: var(--gold);
        font-size: 0.95rem;
      }

      .bookmark-nav-close {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        padding: 4px;
        font-size: 1.2rem;
        line-height: 1;
      }

      .bookmark-nav-close:hover {
        color: var(--accent);
      }

      .bookmark-nav-toolbar {
        display: flex;
        gap: 8px;
        margin-bottom: 10px;
      }

      .bookmark-nav-search {
        flex: 1;
        padding: 8px 12px;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.85rem;
      }

      .bookmark-nav-search:focus {
        border-color: var(--gold);
        outline: none;
      }

      .bookmark-nav-actions {
        display: flex;
        gap: 4px;
      }

      .btn-icon {
        width: 34px;
        height: 34px;
        padding: 0;
        border: 1px solid var(--border);
        border-radius: 8px;
        background: white;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .btn-icon:hover {
        border-color: var(--gold);
        background: rgba(244, 162, 97, 0.1);
      }

      .bookmark-nav-sort {
        margin-bottom: 10px;
      }

      .bookmark-sort-select {
        width: 100%;
        padding: 6px 10px;
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: 0.85rem;
        background: white;
      }

      .bookmark-nav-list {
        flex: 1;
        overflow-y: auto;
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 8px;
        max-height: calc(70vh - 200px);
      }

      .bookmark-nav-list::-webkit-scrollbar {
        width: 4px;
      }

      .bookmark-nav-list::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 2px;
      }

      .bookmark-nav-list li {
        background: #f8f9fa;
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .bookmark-nav-list li:hover {
        border-color: var(--gold);
        background: rgba(244, 162, 97, 0.05);
        transform: translateX(4px);
      }

      .bookmark-nav-list .bookmark-item-title {
        font-weight: 600;
        font-size: 0.9rem;
        color: var(--text);
        margin-bottom: 4px;
        display: -webkit-box;
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .bookmark-nav-list .bookmark-item-meta {
        font-size: 0.75rem;
        color: var(--text-light);
        display: flex;
        gap: 8px;
        margin-bottom: 6px;
      }

      .bookmark-nav-list .bookmark-item-preview {
        font-size: 0.8rem;
        color: var(--text-light);
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        line-height: 1.4;
      }

      .bookmark-nav-list .bookmark-item-actions {
        display: flex;
        gap: 6px;
        margin-top: 8px;
        padding-top: 8px;
        border-top: 1px dashed var(--border);
      }

      .bookmark-nav-list .bookmark-item-actions button {
        flex: 1;
        padding: 4px 8px;
        font-size: 0.75rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        background: white;
        cursor: pointer;
        transition: all 0.2s;
      }

      .bookmark-nav-list .bookmark-item-actions button:hover {
        border-color: var(--gold);
        background: rgba(244, 162, 97, 0.1);
      }

      .bookmark-nav-list .bookmark-item-actions button.delete-btn:hover {
        border-color: var(--accent);
        background: rgba(233, 69, 96, 0.1);
        color: var(--accent);
      }

      .bookmark-nav-empty {
        text-align: center;
        padding: 30px 20px;
        color: var(--text-light);
      }

      .bookmark-nav-empty span {
        font-size: 3rem;
        display: block;
        margin-bottom: 10px;
      }

      .bookmark-nav-empty p {
        margin: 4px 0;
      }

      .bookmark-nav-empty .hint {
        font-size: 0.8rem;
        opacity: 0.7;
      }

      @media (max-width: 768px) {
        .bookmark-nav-container {
          top: auto;
          bottom: 80px;
          right: 16px;
        }

        .bookmark-nav-panel {
          right: 0;
          top: auto;
          bottom: 60px;
          width: calc(100vw - 32px);
          max-width: 350px;
        }
      }

      @media (max-width: 768px) {
        .chapter-nav-container {
          top: auto;
          bottom: 20px;
          right: 16px;
        }

        .chapter-nav-panel {
          right: 0;
          top: auto;
          bottom: 60px;
          max-width: calc(100vw - 32px);
        }
      }

      /* ÂãïÁï´ */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card, .bookmark-card {
        animation: fadeInUp 0.6s ease-out;
      }

      .card:nth-child(2) { animation-delay: 0.1s; }
      .bookmark-card { animation-delay: 0.2s; }

      /* ÈüøÊáâÂºè */
      @media (max-width: 768px) {
        body {
          padding: 20px 16px 60px;
        }

        h1 {
          font-size: 2rem;
        }

        .card {
          padding: 24px;
        }

        .section {
          padding: 20px;
        }

        .output {
          padding: 24px;
          font-size: 1.05rem;
        }

        .bookmark-card {
          padding: 20px;
        }

        .buttons {
          flex-direction: column;
        }

        .buttons button {
          width: 100%;
        }
      }

      /* ÊúóËÆÄÊéßÂà∂Èù¢ÊùøÊ®£Âºè */
      .speech-panel {
        background: linear-gradient(135deg, #fff9f0 0%, #fff 100%);
        border: 2px solid var(--accent);
        border-radius: 16px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 8px 32px rgba(233, 69, 96, 0.15);
      }

      .speech-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }

      .speech-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--accent);
      }

      .speech-close {
        background: none;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        color: #999;
        padding: 4px 8px;
        border-radius: 4px;
        transition: all 0.2s;
      }

      .speech-close:hover {
        background: rgba(233, 69, 96, 0.1);
        color: var(--accent);
      }

      /* ÊÆµËêΩÁØÑÂúçÈÅ∏ÊìáÂô® */
      .range-selector {
        display: flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
      }

      .segment-input {
        width: 60px !important;
        min-width: 60px !important;
        flex: none !important;
        text-align: center;
        padding: 6px 8px !important;
        font-size: 0.9rem;
      }

      .range-selector span {
        color: var(--text-light);
        font-size: 0.9rem;
      }

      .range-selector .btn-small {
        padding: 6px 10px;
        font-size: 0.8rem;
        margin-left: 8px;
      }

      .segment-info {
        font-size: 0.85rem;
        color: var(--text-light);
        margin-top: 6px;
        margin-bottom: 10px;
      }

      .speech-extra-buttons {
        margin-top: 14px;
        padding-top: 14px;
        border-top: 1px dashed var(--border);
      }

      .btn-full {
        width: 100%;
        justify-content: center;
      }
      
      /* Ë™ûÈÄü/Èü≥Ë™øÂæÆË™øÊåâÈàï */
      .speed-control {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
      }
      
      .speed-control input[type="range"] {
        flex: 1;
      }
      
      .speed-btn {
        width: 32px;
        height: 32px;
        padding: 0;
        border: 1px solid var(--border);
        border-radius: 6px;
        background: white;
        cursor: pointer;
        font-size: 1.1rem;
        font-weight: bold;
        color: var(--text);
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .speed-btn:hover {
        border-color: var(--accent);
        color: var(--accent);
        background: rgba(233, 69, 96, 0.05);
      }
      
      .speed-value {
        min-width: 45px;
        text-align: right;
        font-weight: 600;
        color: var(--accent);
      }
      
      /* ÊÆµËêΩË∑≥ËΩâÊåâÈàï */
      .speech-nav-buttons {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin-top: 12px;
        padding: 10px;
        background: rgba(233, 69, 96, 0.03);
        border-radius: 10px;
      }
      
      .speech-nav-buttons button {
        padding: 8px 14px;
        font-size: 0.9rem;
      }
      
      .segment-display {
        font-size: 1rem;
        font-weight: 600;
        color: var(--accent);
        min-width: 70px;
        text-align: center;
      }
      
      /* ÈÄ≤Â∫¶Ê¢ùÂèØÈªûÊìä */
      .speech-progress-bar {
        cursor: pointer;
        position: relative;
      }
      
      .speech-progress-bar:hover {
        opacity: 0.9;
      }
      
      .speech-progress-bar:hover::after {
        content: 'ÈªûÊìäË∑≥ËΩâ';
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.75rem;
        color: var(--text-light);
        background: white;
        padding: 2px 8px;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      
      /* ÈÅ∏È†ÖÂçÄ */
      .speech-options {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        margin-top: 14px;
        padding: 12px;
        background: rgba(0, 0, 0, 0.02);
        border-radius: 8px;
      }
      
      .checkbox-label {
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        color: var(--text);
      }
      
      .checkbox-label input[type="checkbox"] {
        width: 16px;
        height: 16px;
        accent-color: var(--accent);
      }
      
      /* È´ò‰∫ÆÁõÆÂâçÊúóËÆÄÁöÑÊÆµËêΩ */
      .speaking-segment {
        background: linear-gradient(90deg, rgba(233, 69, 96, 0.12) 0%, rgba(233, 69, 96, 0.05) 100%);
        border-left: 4px solid var(--accent);
        padding: 12px 16px;
        margin: 8px -16px;
        border-radius: 0 8px 8px 0;
        position: relative;
        animation: pulse-highlight 2s ease-in-out infinite;
      }
      
      @keyframes pulse-highlight {
        0%, 100% { background: linear-gradient(90deg, rgba(233, 69, 96, 0.12) 0%, rgba(233, 69, 96, 0.05) 100%); }
        50% { background: linear-gradient(90deg, rgba(233, 69, 96, 0.18) 0%, rgba(233, 69, 96, 0.08) 100%); }
      }
      
      .speaking-segment::before {
        content: 'üîä';
        position: absolute;
        left: -30px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1rem;
      }
      
      /* Ëº∏Âá∫ÂçÄÂüüÈúÄË¶Å relative ÂÆö‰Ωç */
      .output {
        position: relative;
      }

      @media (max-width: 500px) {
        .range-selector {
          font-size: 0.85rem;
        }
        .segment-input {
          width: 50px !important;
          min-width: 50px !important;
        }
      }

      /* ÁâπÊÆäÂÖÉÁ¥†Â∑•ÂÖ∑Âàó */
      .special-elements-toolbar {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
        flex-wrap: wrap;
      }
      
      .element-search {
        flex: 1;
        min-width: 150px;
        max-width: 250px;
        padding: 8px 12px;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 0.9rem;
      }
      
      .element-search:focus {
        border-color: var(--accent);
        outline: none;
      }
      
      .selected-count {
        font-size: 0.85rem;
        color: var(--accent);
        font-weight: 600;
        padding: 4px 10px;
        background: rgba(233, 69, 96, 0.1);
        border-radius: 12px;
      }
      
      /* ÂàÜÈ°ûÊ®ôÁ±§ */
      .element-category-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 14px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }
      
      .category-tab {
        padding: 6px 14px;
        border: 2px solid var(--border);
        border-radius: 20px;
        background: white;
        cursor: pointer;
        font-size: 0.85rem;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 4px;
      }
      
      .category-tab:hover {
        border-color: var(--accent);
        background: rgba(233, 69, 96, 0.05);
      }
      
      .category-tab.active {
        border-color: var(--accent);
        background: var(--accent);
        color: white;
      }
      
      .category-tab .tab-count {
        font-size: 0.75rem;
        background: rgba(0,0,0,0.1);
        padding: 1px 6px;
        border-radius: 10px;
      }
      
      .category-tab.active .tab-count {
        background: rgba(255,255,255,0.3);
      }
      
      /* ÁâπÊÆäÂÖÉÁ¥†Â§öÈÅ∏Ê†ºÂ≠ê */
      .special-elements-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        gap: 10px;
        margin-top: 8px;
        max-height: 320px;
        overflow-y: auto;
        padding: 4px;
      }

      .special-element-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.8);
        border: 2px solid var(--border);
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.2s ease;
        user-select: none;
      }

      .special-element-item:hover {
        border-color: var(--accent);
        background: rgba(233, 69, 96, 0.05);
      }

      .special-element-item.selected {
        border-color: var(--accent);
        background: linear-gradient(135deg, rgba(233, 69, 96, 0.1), rgba(244, 162, 97, 0.1));
        box-shadow: 0 2px 8px rgba(233, 69, 96, 0.15);
      }

      .special-element-item input[type="checkbox"] {
        display: none;
      }

      .special-element-item .checkbox-custom {
        width: 18px;
        height: 18px;
        border: 2px solid var(--border);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        flex-shrink: 0;
      }

      .special-element-item.selected .checkbox-custom {
        background: var(--accent);
        border-color: var(--accent);
      }

      .special-element-item.selected .checkbox-custom::after {
        content: '‚úì';
        color: white;
        font-size: 12px;
        font-weight: bold;
      }

      .special-element-item .element-label {
        font-size: 0.9rem;
        color: var(--text);
      }

      .special-element-item .element-icon {
        font-size: 1.1rem;
      }

      @media (max-width: 600px) {
        .special-elements-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      .speech-controls {
        display: flex;
        flex-direction: column;
        gap: 14px;
      }

      .speech-row {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .speech-row label {
        min-width: 80px;
        font-weight: 500;
        color: var(--text);
      }

      .speech-row select,
      .speech-row input[type="range"] {
        flex: 1;
      }

      .speech-row input[type="range"] {
        -webkit-appearance: none;
        height: 6px;
        background: linear-gradient(to right, var(--accent), var(--gold));
        border-radius: 3px;
        cursor: pointer;
      }

      .speech-row input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        background: var(--accent);
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(233, 69, 96, 0.3);
      }

      .speech-row span {
        min-width: 45px;
        text-align: right;
        font-size: 0.9rem;
        color: #666;
      }

      .speech-buttons {
        display: flex;
        gap: 12px;
        margin-top: 8px;
      }

      .speech-buttons button {
        flex: 1;
      }

      .speech-progress {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px dashed var(--border);
      }

      .speech-progress-bar {
        height: 8px;
        background: #eee;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 8px;
      }

      .speech-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--accent), var(--gold));
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 4px;
      }

      #speechProgressText {
        font-size: 0.85rem;
        color: #666;
      }

      /* ==================== Ê®°ÊÖãË¶ñÁ™óÈÄöÁî®Ê®£Âºè ==================== */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        padding: 20px;
      }

      .modal-overlay.open {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background: var(--card-bg);
        border-radius: 20px;
        box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
        width: 100%;
        max-width: 800px;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transform: scale(0.9) translateY(20px);
        transition: all 0.3s ease;
      }

      .modal-overlay.open .modal-content {
        transform: scale(1) translateY(0);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 24px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .modal-header.comic-header {
        background: linear-gradient(135deg, #e17055 0%, #fdcb6e 100%);
      }

      .modal-header.speech-header {
        background: linear-gradient(135deg, #a29bfe 0%, #fd79a8 100%);
      }

      .modal-title {
        font-size: 1.2rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .modal-close {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
      }

      .modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      /* AI Êº´Áï´Èù¢ÊùøÔºàÊ®°ÊÖãË¶ñÁ™óÁâàÊú¨Ôºâ */
      .image-panel {
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
        overflow: hidden;
      }

      .image-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .image-panel-title {
        font-weight: 600;
        font-size: 1.1rem;
      }

      .image-panel-close {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.2s;
      }

      .image-panel-close:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .image-panel-content {
        padding: 20px;
      }

      .image-settings {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 20px;
      }

      .image-row {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .image-row label {
        font-size: 0.9rem;
        font-weight: 500;
        color: #555;
      }

      .image-row select,
      .image-row textarea {
        padding: 10px 14px;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.95rem;
        transition: border-color 0.2s;
      }

      .image-row select:focus,
      .image-row textarea:focus {
        border-color: #667eea;
        outline: none;
      }

      .image-row textarea {
        resize: vertical;
        min-height: 80px;
      }

      .image-result {
        margin-top: 20px;
        text-align: center;
      }

      .image-loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        padding: 40px;
        color: #666;
      }

      .image-loading .spinner {
        width: 40px;
        height: 40px;
        border: 3px solid #eee;
        border-top-color: #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      .image-loading small {
        color: #999;
        font-size: 0.85rem;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .image-actions {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-top: 16px;
        flex-wrap: wrap;
      }

      /* Êº´Áï´ÈÄ≤Â∫¶Ê¢ù */
      .comic-progress-bar {
        margin: 15px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .comic-progress-bar .progress-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 0.9rem;
        color: #555;
      }

      .comic-progress-bar .progress-track {
        height: 8px;
        background: #e0e0e0;
        border-radius: 4px;
        overflow: hidden;
      }

      .comic-progress-bar .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea, #764ba2);
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .comic-complete-msg {
        margin-top: 15px;
        padding: 12px 20px;
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        color: #155724;
        border-radius: 8px;
        text-align: center;
        font-weight: 500;
      }

      /* Êº´Áï´ÂÆπÂô® */
      .comic-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        max-width: 100%;
      }

      .comic-page {
        background: white;
        border: 3px solid #333;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      }

      .comic-page-header {
        background: #333;
        color: white;
        padding: 8px 16px;
        font-weight: bold;
        font-size: 0.9rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .comic-page-download-btn {
        background: rgba(255,255,255,0.15);
        border: 1px solid rgba(255,255,255,0.3);
        color: white;
        padding: 4px 12px;
        border-radius: 4px;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .comic-page-download-btn:hover {
        background: rgba(255,255,255,0.25);
        border-color: rgba(255,255,255,0.5);
      }

      .comic-page-download-btn:active {
        transform: scale(0.95);
      }

      .comic-grid {
        display: grid;
        gap: 3px;
        background: #333;
        padding: 3px;
      }

      .comic-grid.panels-4 {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(2, 1fr);
      }

      .comic-grid.panels-6 {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, 1fr);
      }

      .comic-grid.panels-9 {
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(3, 1fr);
      }

      .comic-panel {
        background: white;
        position: relative;
        aspect-ratio: 1;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .comic-panel-image {
        flex: 1;
        background-size: cover;
        background-position: center;
        background-color: #f5f5f5;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        font-size: 2rem;
      }

      .comic-panel-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .comic-panel-text {
        background: white;
        padding: 8px 10px;
        font-size: 0.85rem;
        line-height: 1.4;
        border-top: 2px solid #333;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .comic-panel-text.dialogue {
        background: #fff9e6;
        font-style: normal;
      }

      .comic-panel-text.narration {
        background: #f0f0f0;
        font-style: italic;
        color: #555;
      }

      .comic-bubble {
        position: absolute;
        background: white;
        border: 2px solid #333;
        border-radius: 20px;
        padding: 8px 12px;
        font-size: 0.8rem;
        max-width: 80%;
        box-shadow: 2px 2px 0 #333;
      }

      .comic-bubble::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 20px;
        border-width: 10px 10px 0;
        border-style: solid;
        border-color: #333 transparent transparent;
      }

      .btn-text {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        font-size: 0.85rem;
      }

      .btn-text:hover {
        color: var(--accent);
      }

      /* ÊúóËÆÄ‰∏≠ÁöÑÊñáÂ≠óÈ´ò‰∫Æ */
      .speaking-highlight {
        background: linear-gradient(120deg, rgba(255, 215, 0, 0.3) 0%, rgba(233, 69, 96, 0.2) 100%);
        border-radius: 4px;
        padding: 2px 4px;
        transition: background 0.3s;
      }

      @media (max-width: 600px) {
        .speech-row {
          flex-wrap: wrap;
        }
        
        .speech-row label {
          min-width: 100%;
          margin-bottom: 4px;
        }
        
        .speech-buttons {
          flex-direction: column;
        }
      }

      /* Èõ¢Á∑öÁãÄÊÖãÊèêÁ§∫ */
      .offline-banner {
        position: fixed;
        top: 4px;
        left: 0;
        right: 0;
        background: linear-gradient(135deg, #f39c12, #e74c3c);
        color: white;
        text-align: center;
        padding: 8px 16px;
        font-size: 0.9rem;
        z-index: 9999;
        display: none;
        animation: slideDown 0.3s ease;
      }

      .offline-banner.show {
        display: block;
      }

      .offline-banner.online {
        background: linear-gradient(135deg, #27ae60, #2ecc71);
      }

      @keyframes slideDown {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Èõ¢Á∑öÊ®°Âºè‰∏ãÁ¶ÅÁî®ÁîüÊàêÊåâÈàïÁöÑÊ®£Âºè */
      .offline-disabled {
        opacity: 0.5;
        cursor: not-allowed;
        position: relative;
      }

      .offline-disabled::after {
        content: 'üì¥ ÈúÄË¶ÅÁ∂≤Ë∑Ø';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 0.75rem;
        white-space: nowrap;
      }

      /* ==================== Ë®≠ÂÆöÈù¢Êùø ==================== */
      .settings-panel {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 998;
      }

      .settings-toggle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #fff;
        border: none;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        cursor: pointer;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .settings-toggle:hover {
        transform: scale(1.1) rotate(30deg);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
      }

      .settings-dropdown {
        position: absolute;
        bottom: 60px;
        right: 0;
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 20px;
        width: 280px;
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px);
        transition: all 0.3s ease;
      }

      .settings-dropdown.open {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .settings-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }

      .settings-title {
        font-weight: 600;
        color: var(--primary);
        font-size: 1rem;
      }

      .settings-close {
        background: none;
        border: none;
        color: var(--text-light);
        cursor: pointer;
        padding: 4px;
        font-size: 1.2rem;
        line-height: 1;
      }

      .settings-item {
        margin-bottom: 16px;
      }

      .settings-item:last-child {
        margin-bottom: 0;
      }

      .settings-item label {
        display: block;
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--text);
        margin-bottom: 8px;
      }

      .settings-row {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .theme-toggle {
        display: flex;
        background: var(--input-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        overflow: hidden;
      }

      .theme-toggle button {
        flex: 1;
        padding: 10px 16px;
        border: none;
        background: transparent;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s;
        color: var(--text);
      }

      .theme-toggle button.active {
        background: var(--accent);
        color: white;
      }

      .theme-toggle button:hover:not(.active) {
        background: rgba(233, 69, 96, 0.1);
      }

      .font-size-control {
        display: flex;
        align-items: center;
        gap: 10px;
        width: 100%;
      }

      .font-size-control input[type="range"] {
        flex: 1;
        -webkit-appearance: none;
        height: 6px;
        background: linear-gradient(to right, var(--accent), var(--gold));
        border-radius: 3px;
        cursor: pointer;
      }

      .font-size-control input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        background: var(--accent);
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(233, 69, 96, 0.3);
      }

      .font-size-value {
        min-width: 50px;
        text-align: right;
        font-weight: 600;
        color: var(--accent);
      }

      /* Â≠óÊï∏Áµ±Ë®àÈ°ØÁ§∫ */
      .word-count-display {
        display: flex;
        gap: 16px;
        padding: 12px 16px;
        background: var(--section-bg);
        border-radius: 10px;
        margin-top: 12px;
        font-size: 0.9rem;
      }

      .word-count-item {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .word-count-item .label {
        color: var(--text-light);
      }

      .word-count-item .value {
        font-weight: 600;
        color: var(--accent);
      }

      /* È†êË®≠Ê®°ÊùøÈÅ∏ÊìáÂô® */
      .template-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-top: 8px;
      }

      .template-select {
        width: 100%;
        padding: 10px 12px;
        border: 2px solid var(--border);
        border-radius: 10px;
        background: var(--input-bg);
        color: var(--text);
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        padding-right: 32px;
      }

      .template-select:hover {
        border-color: var(--accent);
      }

      .template-select:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.15);
      }

      .template-select optgroup {
        font-weight: 600;
        color: var(--accent);
        padding: 8px 0;
      }

      .template-select option {
        padding: 8px 12px;
        color: var(--text);
        background: var(--card-bg);
      }

      .apply-template-btn {
        width: 100%;
        margin-top: 10px;
        padding: 12px 16px;
        border: none;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--accent) 0%, #ff6b8a 100%);
        color: white;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 4px 15px rgba(233, 69, 96, 0.3);
      }

      .apply-template-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(233, 69, 96, 0.4);
      }

      .apply-template-btn:active {
        transform: translateY(0);
      }

      .apply-template-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      /* Âø´Êç∑ÈçµÊèêÁ§∫ */
      .shortcuts-hint {
        font-size: 0.8rem;
        color: var(--text-light);
        padding: 10px;
        background: var(--section-bg);
        border-radius: 8px;
        margin-top: 12px;
      }

      .shortcuts-hint kbd {
        display: inline-block;
        padding: 2px 6px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 4px;
        font-family: monospace;
        font-size: 0.75rem;
        margin: 0 2px;
      }

      /* ÈÄ≤Â∫¶‰º∞ÁÆóÈ°ØÁ§∫ */
      .generation-progress {
        margin-top: 16px;
        padding: 16px;
        background: var(--section-bg);
        border-radius: 12px;
        display: none;
      }

      .generation-progress.show {
        display: block;
      }

      .progress-stats {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 0.9rem;
      }

      .progress-bar-container {
        height: 8px;
        background: var(--border);
        border-radius: 4px;
        overflow: hidden;
      }

      .progress-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--accent), var(--gold));
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .progress-details {
        display: flex;
        justify-content: space-between;
        margin-top: 8px;
        font-size: 0.8rem;
        color: var(--text-light);
      }

      /* Â§ßÁ∂±È†êË¶ΩÊ®°ÊÖãË¶ñÁ™ó */
      .outline-preview {
        padding: 20px;
        background: var(--section-bg);
        border-radius: 12px;
        margin: 16px 0;
        max-height: 400px;
        overflow-y: auto;
      }

      .outline-chapter {
        padding: 12px;
        margin-bottom: 8px;
        background: var(--card-bg);
        border-radius: 8px;
        border-left: 4px solid var(--accent);
      }

      .outline-chapter-title {
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 6px;
      }

      .outline-chapter-summary {
        font-size: 0.9rem;
        color: var(--text-light);
        line-height: 1.5;
      }

      @media (max-width: 768px) {
        .settings-panel {
          bottom: 80px;
          right: 16px;
        }

        .settings-dropdown {
          right: 0;
          width: calc(100vw - 32px);
          max-width: 300px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Èõ¢Á∑öÁãÄÊÖãÊèêÁ§∫ -->
    <div id="offlineBanner" class="offline-banner">
      üì¥ ÁõÆÂâçÁÇ∫Èõ¢Á∑öÊ®°Âºè - ÊúóËÆÄ„ÄÅÈñ±ËÆÄ„ÄÅÂåØÂá∫„ÄÅÂåØÂÖ•ÂäüËÉΩ‰ªçÂèØ‰ΩøÁî®
    </div>

    <!-- ==================== ÊµÆÂãïÂ∑•ÂÖ∑Âàó ==================== -->
    <div class="floating-toolbar">
      <!-- API Ë®≠ÂÆö -->
      <button id="apiPanelToggle" class="toolbar-btn btn-api" title="API Ë®≠ÂÆö">
        üîë
        <span class="toolbar-tooltip">API Ë®≠ÂÆö</span>
      </button>

      <div class="toolbar-divider"></div>

      <!-- Èö®Ê©üÂ°´ÂÖÖ -->
      <button id="randomBtn" class="toolbar-btn btn-random" title="Èö®Ê©üÂ°´ÂÖÖ">
        üé≤
        <span class="toolbar-tooltip">Èö®Ê©üÂ°´ÂÖÖ</span>
      </button>

      <!-- ÈñãÂßãÁîüÊàê -->
      <button id="generateBtn" class="toolbar-btn btn-generate" title="ÈñãÂßãÁîüÊàê">
        ‚ú®
        <span class="toolbar-tooltip">ÈñãÂßãÁîüÊàê</span>
      </button>

      <!-- ÁπºÁ∫åÁîüÊàê -->
      <button id="continueBtn" class="toolbar-btn btn-continue" title="ÁπºÁ∫åÁîüÊàê" disabled>
        ‚û§
        <span class="toolbar-tooltip">ÁπºÁ∫åÁîüÊàê</span>
      </button>

      <div class="toolbar-divider"></div>

      <!-- ‰∏ãËºâÂ∞èË™™ -->
      <div style="position: relative;">
        <button id="downloadBtn" class="toolbar-btn btn-download" title="‰∏ãËºâÂ∞èË™™" disabled>
          ‚¨áÔ∏è
          <span class="toolbar-tooltip">‰∏ãËºâÂ∞èË™™</span>
        </button>
        <div id="toolbarDownloadMenu" class="toolbar-download-menu">
          <button type="button" data-format="txt">üìÑ TXT Á¥îÊñáÂ≠óÊ™î</button>
          <button type="button" data-format="html">üì± HTML ÊâãÊ©üÈñ±ËÆÄÁâà</button>
        </div>
      </div>

      <!-- AI Êº´Áï´ -->
      <button id="generateImageBtn" class="toolbar-btn btn-comic" title="AI Êº´Áï´" disabled>
        üìö
        <span class="toolbar-tooltip">AI Êº´Áï´</span>
      </button>

      <!-- ÊúóËÆÄÊñáÁ´† -->
      <button id="speakBtn" class="toolbar-btn btn-speak" title="ÊúóËÆÄÊñáÁ´†" disabled>
        üîä
        <span class="toolbar-tooltip">ÊúóËÆÄÊñáÁ´†</span>
      </button>

      <div class="toolbar-divider"></div>

      <!-- Â§ßÁ∂±È†êË¶Ω -->
      <button id="outlineBtn" class="toolbar-btn" style="background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%); color: white;" title="È†êË¶ΩÂ§ßÁ∂±">
        üìã
        <span class="toolbar-tooltip">È†êË¶ΩÂ§ßÁ∂±</span>
      </button>
    </div>

    <!-- API Ë®≠ÂÆöÈù¢Êùø -->
    <div id="apiPanel" class="api-panel">
      <div class="api-panel-header">
        <span class="api-panel-title">üîë API Ë®≠ÂÆö</span>
        <button id="apiPanelClose" class="api-panel-close">‚úï</button>
      </div>
      <div class="input-group">
        <label for="apiKey">Gemini API ÈáëÈë∞</label>
        <div class="api-key-row">
          <input
            type="password"
            id="apiKey"
            placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ API ÈáëÈë∞"
            autocomplete="off"
          />
          <button type="button" id="toggleApiKeyVisibility">È°ØÁ§∫</button>
        </div>
      </div>
      <div class="input-group">
        <label for="model">ÈÅ∏ÊìáÊ®°Âûã</label>
        <select id="model">
          <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
          <option value="gemini-pro">Gemini Pro</option>
        </select>
      </div>
    </div>

    <div class="container">
      <header>
        <h1>üé® AI Â∞èË™™ & Êº´Áï´Â∑•Âùä</h1>
        <p class="subtitle">
          ÁµêÂêà AI ÁöÑÁÑ°ÈôêÂâµÊÑèÔºåÊâìÈÄ†Â∞àÂ±¨Êñº‰Ω†ÁöÑÈï∑ÁØáÊïÖ‰∫ãËàáÊº´Áï´<br>
          Ë®≠ÂÆö‰∏ªÈ°å„ÄÅ‰∫∫Áâ©„ÄÅËÉåÊôØÔºå‰∏ÄÈçµÁîüÊàêÁ≤æÂΩ©Â∞èË™™ÔºåÈÇÑËÉΩËΩâÊèõÊàêÊº´Áï´ÔºÅ<br>
          <small style="opacity: 0.7;">üí° ÊîØÊè¥Èõ¢Á∑öÈñ±ËÆÄ„ÄÅÊúóËÆÄ„ÄÅÊõ∏Á±§ÁÆ°ÁêÜ„ÄÅÊº´Áï´ÁîüÊàê„ÄÅÂåØÂá∫ÂåØÂÖ•</small>
        </p>
      </header>

      <div class="card">
        <!-- ÊïÖ‰∫ãÂÖÉÁ¥† -->
        <div class="section">
          <h2 class="section-title" data-icon="üìñ">ÊïÖ‰∫ãÂÖÉÁ¥†</h2>
          <div class="input-group">
            <label for="theme">‰∏ªÈ°å</label>
            <select id="theme">
              <option value="">Ë´ãÈÅ∏Êìá‰∏ªÈ°å</option>
            </select>
          </div>
          <div class="input-group">
            <label for="setting">ËÉåÊôØË®≠ÂÆö</label>
            <select id="setting">
              <option value="">Ë´ãÈÅ∏ÊìáËÉåÊôØ</option>
            </select>
          </div>
          <div class="input-group">
            <div class="label-row">
              <label>‰∏ªË¶Å‰∫∫Áâ©Ë®≠ÂÆö</label>
              <div style="display: flex; gap: 8px;">
                <button id="randomAllCharactersBtn" type="button" class="btn-outline btn-small">üé≤ Èö®Ê©ü‰∫∫Áâ©</button>
                <button id="addCharacterBtn" type="button" class="btn-outline btn-small">+ Êñ∞Â¢û‰∫∫Áâ©</button>
              </div>
            </div>
            <div id="charactersContainer"></div>
          </div>
          <div class="input-group">
            <label for="style">ÊïÖ‰∫ãÈ¢®Ê†º</label>
            <select id="style">
              <option value="">Ë´ãÈÅ∏ÊìáÈ¢®Ê†º</option>
            </select>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="chapters">Á´†ÁØÄÊï∏</label>
              <input type="number" id="chapters" placeholder="Â¶ÇÔºö10" min="1" max="50" step="1" />
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="length">È†êË®àÁ∏ΩÂ≠óÊï∏</label>
              <input type="number" id="length" placeholder="Â¶ÇÔºö50000" min="1000" max="200000" step="1000" />
            </div>
          </div>
        </div>

        <!-- ÈÄ≤ÈöéË®≠ÂÆö -->
        <div class="section">
          <h2 class="section-title" data-icon="üéõÔ∏è">ÈÄ≤ÈöéË®≠ÂÆö</h2>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="narrative">Êïò‰∫ãË¶ñËßí</label>
              <select id="narrative">
                <option value="">Ë´ãÈÅ∏ÊìáË¶ñËßí</option>
              </select>
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="era">ÊôÇ‰ª£Ë®≠ÂÆö</label>
              <select id="era">
                <option value="">Ë´ãÈÅ∏ÊìáÊôÇ‰ª£</option>
              </select>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="pacing">ÊïÖ‰∫ãÁØÄÂ•è</label>
              <select id="pacing">
                <option value="">Ë´ãÈÅ∏ÊìáÁØÄÂ•è</option>
              </select>
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="rating">ÂÖßÂÆπÂàÜÁ¥ö</label>
              <select id="rating">
                <option value="">Ë´ãÈÅ∏ÊìáÂàÜÁ¥ö</option>
              </select>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="worldComplexity">‰∏ñÁïåËßÄË§áÈõúÂ∫¶</label>
              <select id="worldComplexity">
                <option value="">Ë´ãÈÅ∏ÊìáË§áÈõúÂ∫¶</option>
              </select>
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="emotionalTone">ÊÉÖÊÑüÂü∫Ë™ø</label>
              <select id="emotionalTone">
                <option value="">Ë´ãÈÅ∏ÊìáÂü∫Ë™ø</option>
              </select>
            </div>
          </div>
          <div class="input-group" style="margin-top: 16px;">
            <label for="ending">ÁµêÂ±ÄÂÇæÂêë</label>
            <select id="ending">
              <option value="">Ë´ãÈÅ∏ÊìáÁµêÂ±Ä</option>
            </select>
          </div>
          
          <!-- ÁâπÊÆäÂÖÉÁ¥†Â§öÈÅ∏ -->
          <div class="input-group" style="margin-top: 16px;">
            <label>ÁâπÊÆäÂÖÉÁ¥†ÔºàÂèØÂ§öÈÅ∏Ôºâ</label>
            <div class="special-elements-toolbar">
              <input type="text" id="elementSearch" placeholder="üîç ÊêúÂ∞ãÂÖÉÁ¥†..." class="element-search" />
              <button type="button" id="clearElementsBtn" class="btn-small btn-outline">Ê∏ÖÈô§ÈÅ∏Êìá</button>
              <span id="selectedCount" class="selected-count">Â∑≤ÈÅ∏ 0 È†Ö</span>
            </div>
            <div id="elementCategoryTabs" class="element-category-tabs"></div>
            <div id="specialElementsContainer" class="special-elements-grid"></div>
          </div>
        </div>

        <!-- ÂÖ∂‰ªñË™™Êòé -->
        <div class="section">
          <h2 class="section-title" data-icon="‚úèÔ∏è">ÂÖ∂‰ªñË™™Êòé</h2>
          <div class="input-group" style="margin-bottom: 0;">
            <label for="notes">Ë£úÂÖÖË™™ÊòéÔºàÈÅ∏Â°´Ôºâ</label>
            <textarea id="notes" placeholder="Â¶ÇÊúâÈ°çÂ§ñÊÉÖÁØÄÊàñÈ¢®Ê†ºË¶ÅÊ±ÇÔºåÂèØÂú®Ê≠§Ë£úÂÖÖ„ÄÇ‰æãÂ¶ÇÔºöÂ∏åÊúõ‰∏ªËßíÊúâÂèçËΩâÁöÑÁµêÂ±Ä„ÄÅÂä†ÂÖ•ÊôÇÈñìÊóÖË°åÂÖÉÁ¥†Á≠â„ÄÇ"></textarea>
          </div>
        </div>

        </div>

        <!-- ÁãÄÊÖãË®äÊÅØ -->
        <div id="status" class="status">
          <span class="status-icon"></span>
          <span class="status-text"></span>
        </div>

        <!-- Ëá™Âãï‰øùÂ≠òÊåáÁ§∫Âô® -->
        <div id="autoSaveIndicator" class="auto-save-indicator">
          <span class="save-icon">üíæ</span>
          <span class="save-text">Â∑≤Ëá™Âãï‰øùÂ≠ò</span>
        </div>

        <!-- ÁîüÊàêÈÄ≤Â∫¶ -->
        <div id="generationProgress" class="generation-progress">
          <div class="progress-stats">
            <span id="progressChapter">Ê∫ñÂÇô‰∏≠...</span>
            <span id="progressPercent">0%</span>
          </div>
          <div class="progress-bar-container">
            <div id="progressBarFill" class="progress-bar-fill" style="width: 0%"></div>
          </div>
          <div class="progress-details">
            <span id="progressWords">Â∑≤ÁîüÊàê 0 Â≠ó</span>
            <span id="progressTime">È†ê‰º∞Ââ©È§ò --:--</span>
          </div>
        </div>

        <!-- Ëº∏Âá∫ÂçÄ -->
        <div class="output-header" style="margin-top: 30px;">
          <span class="output-title">üìú ÁîüÊàêÁµêÊûú</span>
          <div id="wordCountDisplay" class="word-count-display" style="display: none;">
            <div class="word-count-item">
              <span class="label">Á∏ΩÂ≠óÊï∏</span>
              <span id="totalWordCount" class="value">0</span>
            </div>
            <div class="word-count-item">
              <span class="label">Á´†ÁØÄÊï∏</span>
              <span id="totalChapterCount" class="value">0</span>
            </div>
            <div class="word-count-item">
              <span class="label">ÊÆµËêΩÊï∏</span>
              <span id="totalParagraphCount" class="value">0</span>
            </div>
          </div>
        </div>
        <div id="result" class="output"></div>
      </div>

    <!-- ==================== ÊúóËÆÄÊ®°ÊÖãË¶ñÁ™ó ==================== -->
    <div id="speechModal" class="modal-overlay">
      <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header speech-header">
          <span class="modal-title">üéôÔ∏è ÊúóËÆÄÊéßÂà∂</span>
          <button id="closeSpeechModal" class="modal-close">‚úï</button>
        </div>
        <div class="modal-body">
          <div class="speech-controls">
            <div class="speech-row">
              <label>Ë™ûÈü≥Ôºö</label>
              <select id="voiceSelect"></select>
            </div>
            <div class="speech-row">
              <label>Ë™ûÈÄüÔºö</label>
              <div class="speed-control">
                <button class="speed-btn" data-speed="-0.25">‚àí</button>
                <input type="range" id="speechRate" min="0.25" max="3" step="0.05" value="1" />
                <button class="speed-btn" data-speed="+0.25">+</button>
                <span id="rateValue" class="speed-value">1.0x</span>
              </div>
            </div>
            <div class="speech-row">
              <label>Èü≥Ë™øÔºö</label>
              <div class="speed-control">
                <button class="speed-btn" data-pitch="-0.1">‚àí</button>
                <input type="range" id="speechPitch" min="0.5" max="2" step="0.05" value="1" />
                <button class="speed-btn" data-pitch="+0.1">+</button>
                <span id="pitchValue" class="speed-value">1.0</span>
              </div>
            </div>
            <div class="speech-row">
              <label>ÊÉÖÁ∑íÊ®°ÂºèÔºö</label>
              <select id="emotionMode">
                <option value="auto">üé≠ Ëá™ÂãïÂÅµÊ∏¨</option>
                <option value="narration">üìñ Âπ≥Á©©ÊïòËø∞</option>
                <option value="dramatic">üé¨ Êà≤ÂäáÂºµÂäõ</option>
                <option value="gentle">üå∏ Ê∫´ÊüîÁ¥∞ËÜ©</option>
                <option value="excited">‚ö° ÊøÄÊòÇÁÜ±Ë°Ä</option>
                <option value="sad">üíß ÊÇ≤ÂÇ∑‰ΩéÊ≤â</option>
                <option value="mysterious">üåô Á•ûÁßòÊá∏Áñë</option>
              </select>
            </div>
            <div class="speech-row">
              <label>ÊúóËÆÄÁØÑÂúçÔºö</label>
              <div class="range-selector">
                <span>ÂæûÁ¨¨</span>
                <input type="number" id="startSegment" min="1" value="1" class="segment-input" />
                <span>ÊÆµ Âà∞Á¨¨</span>
                <input type="number" id="endSegment" min="1" value="1" class="segment-input" />
                <span>ÊÆµ</span>
                <button id="readAllBtn" class="btn-small btn-outline" title="ÊúóËÆÄÂÖ®ÈÉ®">ÂÖ®ÈÉ®</button>
              </div>
            </div>
            <div id="segmentInfo" class="segment-info">ÂÖ± 0 ÊÆµ</div>
            
            <!-- ‰∏ªÊéßÂà∂ÊåâÈàï -->
            <div class="speech-buttons">
              <button id="playPauseBtn" class="btn-primary">‚ñ∂Ô∏è ÈñãÂßãÊúóËÆÄ</button>
              <button id="stopSpeechBtn" class="btn-outline">‚èπÔ∏è ÂÅúÊ≠¢</button>
              <button id="resetSpeechBtn" class="btn-outline" title="Ê∏ÖÈô§ÈÄ≤Â∫¶ÔºåÂæûÈ†≠ÈñãÂßã">üîÑ ÈáçÁΩÆ</button>
            </div>
            
            <!-- ÊÆµËêΩË∑≥ËΩâÊéßÂà∂ -->
            <div class="speech-nav-buttons">
              <button id="prevSegmentBtn" class="btn-outline" disabled title="‰∏ä‰∏ÄÊÆµ">‚èÆÔ∏è ‰∏ä‰∏ÄÊÆµ</button>
              <span id="currentSegmentDisplay" class="segment-display">- / -</span>
              <button id="nextSegmentBtn" class="btn-outline" disabled title="‰∏ã‰∏ÄÊÆµ">‰∏ã‰∏ÄÊÆµ ‚è≠Ô∏è</button>
            </div>
            
            <!-- ÈÄ≤Â∫¶Ê¢ùÔºàÂèØÈªûÊìäË∑≥ËΩâÔºâ -->
            <div class="speech-progress">
              <div class="speech-progress-bar" id="speechProgressBar" title="ÈªûÊìäË∑≥ËΩâÂà∞ÊåáÂÆö‰ΩçÁΩÆ">
                <div id="speechProgressFill" class="speech-progress-fill"></div>
              </div>
              <span id="speechProgressText">Ê∫ñÂÇôÂ∞±Á∑í</span>
            </div>
            
            <!-- ÈÅ∏È†Ö -->
            <div class="speech-options">
              <label class="checkbox-label">
                <input type="checkbox" id="autoScrollCheck" checked />
                <span>Ëá™ÂãïÊç≤ÂãïÂà∞ÁõÆÂâçÊÆµËêΩ</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="highlightCheck" checked />
                <span>È´ò‰∫ÆÈ°ØÁ§∫ÁõÆÂâçÊÆµËêΩ</span>
              </label>
            </div>
            
            <div class="speech-extra-buttons">
              <button id="copyAllBtn" class="btn-outline btn-full">üìã Ë§áË£ΩÂÖ®ÊñáÔºàÂèØË≤ºÂà∞ÂÖ∂‰ªñ App ÊúóËÆÄÔºâ</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== AI Êº´Áï´Ê®°ÊÖãË¶ñÁ™ó ==================== -->
    <div id="comicModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header comic-header">
          <span class="modal-title">üìö AI Êº´Áï´ÁîüÊàê</span>
          <button id="closeComicModal" class="modal-close">‚úï</button>
        </div>
        <div class="modal-body">
          <div class="image-settings">
            <div class="image-row">
              <label>Êº´Áï´È¢®Ê†ºÔºö</label>
              <select id="imageStyle">
                <option value="manga">üáØüáµ Êó•ÂºèÊº´Áï´ÔºàÈªëÁôΩÔºâ</option>
                <option value="manhwa">üá∞üá∑ ÈüìÂºèÊº´Áï´ÔºàÂΩ©Ëâ≤Ôºâ</option>
                <option value="manhua">üá®üá≥ ‰∏≠ÂºèÊº´Áï´</option>
                <option value="comic">üá∫üá∏ ÁæéÂºèÊº´Áï´</option>
                <option value="webtoon">üì± Ê¢ùÊº´È¢®Ê†º</option>
              </select>
            </div>
            <div class="image-row">
              <label>ÈÅ∏ÊìáÁ´†ÁØÄÔºö</label>
              <select id="comicChapterSelect"></select>
            </div>
            <div class="image-row">
              <label>ÊØèÈ†ÅÊ†ºÊï∏Ôºö</label>
              <select id="panelsPerPage">
                <option value="4">4 Ê†ºÔºà2x2Ôºâ</option>
                <option value="6" selected>6 Ê†ºÔºà2x3Ôºâ</option>
                <option value="9">9 Ê†ºÔºà3x3Ôºâ</option>
              </select>
            </div>
          </div>
          
          <button id="generateImageNowBtn" class="btn-primary btn-full">üé¨ ÈñãÂßãÁîüÊàêÊº´Áï´</button>
          
          <div id="imageResult" class="image-result" style="display: none;">
            <div id="imageLoading" class="image-loading">
              <div class="spinner"></div>
              <span>AI Ê≠£Âú®Áπ™Ë£ΩÊº´Áï´‰∏≠...</span>
              <small id="comicProgress">ÂàÜÊûêÂäáÊÉÖ...</small>
            </div>
            
            <!-- ÈÄ≤Â∫¶È°ØÁ§∫ -->
            <div id="comicProgressBar" class="comic-progress-bar" style="display: none;">
              <div class="progress-info">
                <span id="comicPageInfo">Á¨¨ 1 È†Å</span>
                <span id="comicContentProgress">0%</span>
              </div>
              <div class="progress-track">
                <div id="comicProgressFill" class="progress-fill" style="width: 0%"></div>
              </div>
            </div>
            
            <div id="comicContainer" class="comic-container" style="display: none;"></div>
            
            <div id="imageActions" class="image-actions" style="display: none;">
              <button id="continueComicBtn" class="btn-primary" style="display: none;">‚û§ ÁπºÁ∫åÁîüÊàê‰∏ã‰∏ÄÈ†Å</button>
              <button id="downloadImageBtn" class="btn-outline">‚¨áÔ∏è ‰∏ãËºâÂÖ®ÈÉ®</button>
              <button id="regenerateImageBtn" class="btn-outline">üîÑ ÈáçÊñ∞ÈñãÂßã</button>
              <button id="clearComicBtn" class="btn-outline" style="color: #e74c3c;">üóëÔ∏è Ê∏ÖÈô§Êº´Áï´</button>
            </div>
            
            <!-- ÂÆåÊàêÊèêÁ§∫ -->
            <div id="comicCompleteMsg" class="comic-complete-msg" style="display: none;">
              ‚úÖ Êú¨Á´†ÁØÄÊº´Áï´Â∑≤ÂÖ®ÈÉ®ÁîüÊàêÂÆåÊàêÔºÅ
            </div>
          </div>
        </div>
      </div>
    </div>

      <!-- ÊµÆÂãïÁ´†ÁØÄÂ∞éËà™ -->
      <div id="chapterNavContainer" class="chapter-nav-container">
        <button id="chapterNavToggle" class="chapter-nav-toggle" title="Á´†ÁØÄÂ∞éËà™">
          üìë
          <span id="chapterBadge" class="badge">0</span>
        </button>
        <div id="chapterNavPanel" class="chapter-nav-panel">
          <div class="chapter-nav-header">
            <span class="chapter-nav-title">üìñ Á´†ÁØÄÁõÆÈåÑ</span>
            <button id="chapterNavClose" class="chapter-nav-close">‚úï</button>
          </div>
          <div id="chapterNavList" class="chapter-nav-list"></div>
        </div>
      </div>

      <!-- ÊµÆÂãïÊõ∏Á±§Â∞éËà™ -->
      <div id="bookmarkNavContainer" class="bookmark-nav-container">
        <button id="bookmarkNavToggle" class="bookmark-nav-toggle" title="ÊàëÁöÑÊõ∏Á±§">
          üîñ
          <span id="bookmarkBadge" class="badge">0</span>
        </button>
        <div id="bookmarkNavPanel" class="bookmark-nav-panel">
          <div class="bookmark-nav-header">
            <span class="bookmark-nav-title">üîñ ÊàëÁöÑÊõ∏Á±§</span>
            <button id="bookmarkNavClose" class="bookmark-nav-close">‚úï</button>
          </div>
          
          <!-- Êõ∏Á±§Â∑•ÂÖ∑Âàó -->
          <div class="bookmark-nav-toolbar">
            <input type="text" id="bookmarkSearch" placeholder="üîç ÊêúÂ∞ã..." class="bookmark-nav-search" />
            <div class="bookmark-nav-actions">
              <button id="addBookmarkBtn" type="button" class="btn-icon" title="ÂÑ≤Â≠òÁõÆÂâçÊïÖ‰∫ã">üíæ</button>
              <button id="exportBookmarksBtn" type="button" class="btn-icon" title="ÂåØÂá∫ÂÖ®ÈÉ®">üì§</button>
              <button id="importBookmarksBtn" type="button" class="btn-icon" title="ÂåØÂÖ•">üì•</button>
            </div>
          </div>
          
          <!-- ÊéíÂ∫èÈÅ∏È†Ö -->
          <div class="bookmark-nav-sort">
            <select id="bookmarkSort" class="bookmark-sort-select">
              <option value="newest">ÊúÄÊñ∞ÂÑ™ÂÖà</option>
              <option value="oldest">ÊúÄËàäÂÑ™ÂÖà</option>
              <option value="name">ÂêçÁ®±ÊéíÂ∫è</option>
              <option value="length">Èï∑Â∫¶ÊéíÂ∫è</option>
            </select>
          </div>
          
          <!-- Êõ∏Á±§ÂàóË°® -->
          <ul id="bookmarkList" class="bookmark-nav-list"></ul>
          
          <!-- Á©∫ÁãÄÊÖã -->
          <div id="bookmarkEmpty" class="bookmark-nav-empty">
            <span>üìö</span>
            <p>Â∞öÁÑ°Êõ∏Á±§</p>
            <p class="hint">ÈªûÊìä üíæ ÂÑ≤Â≠òÁõÆÂâçÊïÖ‰∫ã</p>
          </div>
        </div>
      </div>

      <!-- Èñ±ËÆÄÈÄ≤Â∫¶Ê¢ù -->
      <div id="readingProgress" class="reading-progress" style="width: 0%;"></div>

      <!-- Ë®≠ÂÆöÈù¢Êùø -->
      <div class="settings-panel">
        <button id="settingsToggle" class="settings-toggle" title="Ë®≠ÂÆö">
          ‚öôÔ∏è
        </button>
        <div id="settingsDropdown" class="settings-dropdown">
          <div class="settings-header">
            <span class="settings-title">‚öôÔ∏è È°ØÁ§∫Ë®≠ÂÆö</span>
            <button id="settingsClose" class="settings-close">‚úï</button>
          </div>
          
          <!-- ‰∏ªÈ°åÂàáÊèõ -->
          <div class="settings-item">
            <label>üé® ‰∏ªÈ°åÊ®°Âºè</label>
            <div class="theme-toggle">
              <button id="lightThemeBtn" class="active" data-theme="light">‚òÄÔ∏è Ê∑∫Ëâ≤</button>
              <button id="darkThemeBtn" data-theme="dark">üåô Ê∑±Ëâ≤</button>
            </div>
          </div>
          
          <!-- Â≠óÈ´îÂ§ßÂ∞è -->
          <div class="settings-item">
            <label>üìù Èñ±ËÆÄÂ≠óÈ´îÂ§ßÂ∞è</label>
            <div class="font-size-control">
              <span style="font-size: 0.8rem;">A</span>
              <input type="range" id="fontSizeSlider" min="14" max="24" value="18" step="1" />
              <span style="font-size: 1.2rem;">A</span>
              <span id="fontSizeValue" class="font-size-value">18px</span>
            </div>
          </div>
          
          <!-- Âø´ÈÄüÊ®°Êùø -->
          <div class="settings-item">
            <label>üìö Âø´ÈÄüÊ®°Êùø</label>
            <select id="quickTemplateSelect" class="template-select">
              <option value="">‚îÄ‚îÄ Ë´ãÈÅ∏ÊìáÊ®°Êùø ‚îÄ‚îÄ</option>
              <optgroup label="üêâ ÁéÑÂπª‰ªô‰ø†">
                <option value="fantasy">‚öîÔ∏è ÁéÑÂπª‰øÆ‰ªô - ÂçáÁ¥öÊâìÊÄ™ÈÄÜË•≤</option>
                <option value="cultivation">‚òØÔ∏è ÂÇ≥Áµ±‰ªô‰ø† - ‰øÆÈÅìÂïèÂøÉ</option>
                <option value="martial">ü•ã Ê≠¶‰ø†Ê±üÊπñ - Âø´ÊÑèÊÅ©‰ªá</option>
                <option value="xuanhuan-harem">üëë ÁéÑÂπªÂæåÂÆÆ - ÁæéÂ•≥Â¶ÇÈõ≤</option>
                <option value="system-novel">üìä Á≥ªÁµ±ÊµÅ - ÈáëÊâãÊåáÈñãÊéõ</option>
                <option value="reincarnation">üîÑ ÈáçÁîüÂæ©‰ªá - ÈÄÜÂ§©ÊîπÂëΩ</option>
              </optgroup>
              <optgroup label="üíï Ë®ÄÊÉÖÊµ™Êº´">
                <option value="romance">üíó Áèæ‰ª£Ë®ÄÊÉÖ - ÈÉΩÂ∏ÇÁîúËúú</option>
                <option value="ceo-romance">üëî Èú∏Á∏ΩËôêÊÑõ - Á∏ΩË£ÅÂØµÂ¶ª</option>
                <option value="campus-romance">üè´ Ê†°ÂúíÁ¥îÊÑõ - ÈùíÊò•ÊàÄÊõ≤</option>
                <option value="historical-romance">üèØ Âè§‰ª£ÂÆÆÂª∑ - ÂÆÆÈ¨•ÊÉÖÊ∑±</option>
                <option value="transmig-romance">üìñ Á©øÊõ∏Â•≥‰∏ª - ÊîπÂØ´ÂëΩÈÅã</option>
                <option value="rebirth-romance">üåÖ ÈáçÁîüÂæ©Áîú - ÁèçÊÉúÊâÄÊÑõ</option>
                <option value="contract-marriage">üíç Â•ëÁ¥ÑÂ©öÂßª - ÂÅáÊà≤ÁúüÂÅö</option>
                <option value="enemies-lovers">‚öîÔ∏èüíï Ê≠°ÂñúÂÜ§ÂÆ∂ - ÂêµËëóÊÑõ‰∏ä</option>
              </optgroup>
              <optgroup label="üîç Êá∏ÁñëÈ©öÊÇö">
                <option value="mystery">üîé Êá∏ÁñëÊé®ÁêÜ - ÊäΩÁµ≤ÂâùÁπ≠</option>
                <option value="detective">üïµÔ∏è ÂÅµÊé¢Á†¥Ê°à - ÈÇèËºØÊé®ÁêÜ</option>
                <option value="thriller">üò± È©öÊÇöÊÅêÊÄñ - Ê≠•Ê≠•È©öÂøÉ</option>
                <option value="psychological">üß† ÂøÉÁêÜÈ©öÊÇö - Á¥∞ÊÄùÊ•µÊÅê</option>
                <option value="crime">üî´ ÁäØÁΩ™Êá∏Áñë - ÈªëÊöóÊ∑±Ê∑µ</option>
                <option value="supernatural-mystery">üëª ÈùàÁï∞Êá∏Áñë - È¨ºÂΩ±ÈáçÈáç</option>
              </optgroup>
              <optgroup label="üöÄ ÁßëÂπªÊú™‰æÜ">
                <option value="scifi">üåå Â§™Á©∫Ê≠åÂäá - ÊòüÈöõÂÜíÈö™</option>
                <option value="cyberpunk">üåÉ Ë≥ΩÂçöÈæêÂÖã - ÈúìËôπÊöóÂΩ±</option>
                <option value="apocalypse">‚ò¢Ô∏è Êú´Êó•Âª¢Âúü - ÁîüÂ≠òÊéôÊâé</option>
                <option value="ai-story">ü§ñ ‰∫∫Â∑•Êô∫ËÉΩ - Ê©üÊ¢∞Ë¶∫ÈÜí</option>
                <option value="virtual-reality">ü•Ω ËôõÊì¨ÁèæÂØ¶ - ÈÅäÊà≤‰∫∫Áîü</option>
                <option value="time-travel">‚è≥ ÊôÇÈñìÊóÖË°å - ÊîπËÆäÊ≠∑Âè≤</option>
              </optgroup>
              <optgroup label="üè∞ Ë•øÊñπÂ•áÂπª">
                <option value="western-fantasy">‚öîÔ∏è ÂäçËàáÈ≠îÊ≥ï - ÂãáËÄÖÂÜíÈö™</option>
                <option value="dark-fantasy">üñ§ ÈªëÊöóÂ•áÂπª - ÊÆòÈÖ∑‰∏ñÁïå</option>
                <option value="dragon-knight">üê≤ ÈæçÈ®éÂ£´ - È¶¥ÈæçÂÇ≥Â•á</option>
                <option value="magic-academy">üè´ È≠îÊ≥ïÂ≠∏Èô¢ - ÊàêÈï∑ËõªËÆä</option>
                <option value="vampire">üßõ Âê∏Ë°ÄÈ¨º - ÈªëÂ§úÂÇ≥Ë™™</option>
                <option value="werewolf">üê∫ Áãº‰∫∫ÂÇ≥Ë™™ - ÈáéÊÄßÂëºÂñö</option>
              </optgroup>
              <optgroup label="üéÆ ÈÅäÊà≤Á´∂ÊäÄ">
                <option value="game-world">üéÆ ÈÅäÊà≤‰∏ñÁïå - Á©øË∂äÈÅäÊà≤</option>
                <option value="esports">üèÜ ÈõªÁ´∂ÁÜ±Ë°Ä - Â∑îÂ≥∞Â∞çÊ±∫</option>
                <option value="infinite-flow">‚ôæÔ∏è ÁÑ°ÈôêÊµÅ - ÂâØÊú¨Ê±ÇÁîü</option>
                <option value="death-game">‚ò†Ô∏è Ê≠ª‰∫°ÈÅäÊà≤ - ÁîüÂ≠òÂçöÂºà</option>
                <option value="card-master">üÉè Âç°ÁâåÂ§ßÂ∏´ - Ê±∫È¨•ÁéãËÄÖ</option>
              </optgroup>
              <optgroup label="üé≠ Ê≠∑Âè≤ÂÇ≥Â•á">
                <option value="historical">üìú Êû∂Á©∫Ê≠∑Âè≤ - Ê¨äË¨ÄÂ§©‰∏ã</option>
                <option value="three-kingdoms">‚öîÔ∏è ‰∏âÂúãÈ¢®Èõ≤ - Áæ§ÈõÑÈÄêÈπø</option>
                <option value="tang-dynasty">üå∏ Â§ßÂîêÁõõ‰∏ñ - ÁπÅËèØÈï∑ÂÆâ</option>
                <option value="ming-dynasty">üèÆ ÊòéÊúùÈå¶Ë°£ - Âª†Ë°õÈ¢®Èõ≤</option>
                <option value="warring-states">üó°Ô∏è Êà∞ÂúãÁ≠ñÂ£´ - Á∏±Ê©´Êç≠Èóî</option>
                <option value="republic-era">üé© Ê∞ëÂúãÈ¢®Èõ≤ - ‰∫Ç‰∏ñ‰Ω≥‰∫∫</option>
              </optgroup>
              <optgroup label="üåü ÁâπÊÆäÈ°åÊùê">
                <option value="slice-of-life">‚òï Êó•Â∏∏Ê≤ªÁôí - Ê≠≤ÊúàÈùúÂ•Ω</option>
                <option value="farming">üåæ Á®ÆÁî∞Á∂ìÁáü - ÊÇ†ÈñíÁîüÊ¥ª</option>
                <option value="cooking">üçú ÁæéÈ£üÊ±üÊπñ - ËàåÂ∞ñÈ¢®Èõ≤</option>
                <option value="showbiz">üé¨ Â®õÊ®ÇÂúà - ÊòüÂÖâÈñÉËÄÄ</option>
                <option value="sports">‚öΩ ÁÜ±Ë°ÄÈÅãÂãï - ÈùíÊò•ÊèÆÊ±ó</option>
                <option value="military">üéñÔ∏è ËªçÊóÖÊ¶ÆÂÖâ - ÈêµË°ÄËªçÈ≠Ç</option>
                <option value="medical">üë®‚Äç‚öïÔ∏è ÈÜ´ÁôÇÊá∏Â£∫ - ‰ªÅÂøÉ‰ªÅË°ì</option>
                <option value="legal">‚öñÔ∏è Ê≥ïÂæãÊ≠£Áæ© - Â∫≠ÂØ©È¢®Èõ≤</option>
              </optgroup>
              <optgroup label="üòà ÂèçÊ¥æË¶ñËßí">
                <option value="villain-mc">üòà ÂèçÊ¥æ‰∏ªËßí - ÊàëÂç≥ÊòØÊÉ°</option>
                <option value="demon-lord">üëπ È≠îÁéãÂ¥õËµ∑ - Áµ±Âæ°ÈªëÊöó</option>
                <option value="villain-redemption">üïäÔ∏è ÂèçÊ¥æÊïëË¥ñ - Ê¥óÁôΩ‰πãË∑Ø</option>
                <option value="misunderstood">üé≠ Ë¢´Ë™§Ëß£ÁöÑÊÉ°‰∫∫ - ÁúüÁõ∏ÂèçËΩâ</option>
              </optgroup>
            </select>
            <button id="applyTemplateBtn" class="apply-template-btn">
              ‚ú® Â•óÁî®Ê®°Êùø
            </button>
          </div>
          
          <!-- Âø´Êç∑ÈçµÊèêÁ§∫ -->
          <div class="shortcuts-hint">
            <strong>Âø´Êç∑ÈçµÔºö</strong><br>
            <kbd>Ctrl</kbd>+<kbd>G</kbd> ÈñãÂßãÁîüÊàê<br>
            <kbd>Ctrl</kbd>+<kbd>R</kbd> Èö®Ê©üÂ°´ÂÖÖ<br>
            <kbd>Ctrl</kbd>+<kbd>S</kbd> ÂÑ≤Â≠òÊõ∏Á±§<br>
            <kbd>Ctrl</kbd>+<kbd>D</kbd> ÂàáÊèõÊ∑±Ëâ≤Ê®°Âºè<br>
            <kbd>Esc</kbd> ÈóúÈñâÂΩàÁ™ó
          </div>
        </div>
      </div>

    </div>

    <!-- Â§ßÁ∂±È†êË¶ΩÊ®°ÊÖãË¶ñÁ™ó -->
    <div id="outlineModal" class="modal-overlay">
      <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header" style="background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);">
          <span class="modal-title">üìã ÊïÖ‰∫ãÂ§ßÁ∂±È†êË¶Ω</span>
          <button id="closeOutlineModal" class="modal-close">‚úï</button>
        </div>
        <div class="modal-body">
          <p style="color: var(--text-light); margin-bottom: 16px; font-size: 0.9rem;">
            üí° ÂÖàÈ†êË¶ΩÊïÖ‰∫ãÂ§ßÁ∂±ÔºåÁ¢∫Ë™çÊñπÂêëÊ≠£Á¢∫ÂæåÂÜçÁîüÊàêÂÆåÊï¥ÂÖßÂÆπÔºåÁØÄÁúÅÊôÇÈñìËàá API È°çÂ∫¶
          </p>
          
          <div id="outlineLoading" class="image-loading" style="display: none;">
            <div class="spinner"></div>
            <span>Ê≠£Âú®ÁîüÊàêÊïÖ‰∫ãÂ§ßÁ∂±...</span>
          </div>
          
          <div id="outlineContent" class="outline-preview" style="display: none;"></div>
          
          <div id="outlineActions" style="display: flex; gap: 12px; margin-top: 16px;">
            <button id="generateOutlineBtn" class="btn-primary" style="flex: 1;">
              ‚ú® ÁîüÊàêÂ§ßÁ∂±
            </button>
            <button id="generateFromOutlineBtn" class="btn-gold" style="flex: 1; display: none;">
              üìñ Âü∫ÊñºÊ≠§Â§ßÁ∂±ÁîüÊàêÂ∞èË™™
            </button>
            <button id="regenerateOutlineBtn" class="btn-outline" style="display: none;">
              üîÑ ÈáçÊñ∞ÁîüÊàê
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Á∑®ËºØÊõ∏Á±§ÂΩàÁ™ó -->
    <div id="editModal" class="modal-overlay">
      <div class="modal">
        <h3 class="modal-title">Á∑®ËºØÊõ∏Á±§</h3>
        <div class="input-group">
          <label for="editBookmarkTitle">Êõ∏Á±§Ê®ôÈ°å</label>
          <input type="text" id="editBookmarkTitle" placeholder="Ëº∏ÂÖ•Êõ∏Á±§Ê®ôÈ°å" />
        </div>
        <div class="input-group">
          <label for="editBookmarkTags">Ê®ôÁ±§ÔºàÁî®ÈÄóËôüÂàÜÈöîÔºâ</label>
          <input type="text" id="editBookmarkTags" placeholder="Â¶ÇÔºöÂ•áÂπª, ÂÜíÈö™, ‰∏ªËßíÂÖâÁí∞" />
        </div>
        <div class="input-group" style="margin-bottom: 0;">
          <label for="editBookmarkNotes">ÂÇôË®ª</label>
          <textarea id="editBookmarkNotes" placeholder="Ê∑ªÂä†ÂÇôË®ª..."></textarea>
        </div>
        <div class="modal-actions">
          <button type="button" id="cancelEditBtn" class="btn-outline">ÂèñÊ∂à</button>
          <button type="button" id="saveEditBtn" class="btn-primary">ÂÑ≤Â≠ò</button>
        </div>
      </div>
    </div>

    <!-- Èö±ËóèÁöÑÊ™îÊ°àËº∏ÂÖ• -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;" />

    <!-- ÁîüÊàêÊ≠∑Âè≤Èù¢Êùø -->
    <button id="historyToggle" class="history-toggle-btn" title="ÁîüÊàêÊ≠∑Âè≤">
      üìú<span id="historyBadge" class="badge" style="display: none;">0</span>
    </button>
    
    <div id="historyPanel" class="history-panel">
      <div class="history-header">
        <h3>üìú ÁîüÊàêÊ≠∑Âè≤</h3>
        <button id="historyClose" class="history-close">‚úï</button>
      </div>
      <div id="historyList" class="history-list">
        <div class="history-empty">
          <div class="history-empty-icon">üì≠</div>
          <p>Â∞öÁÑ°ÁîüÊàêË®òÈåÑ</p>
          <p style="font-size: 0.85rem;">ÁîüÊàêÊïÖ‰∫ãÂæåÊúÉËá™Âãï‰øùÂ≠òÂà∞ÈÄôË£°</p>
        </div>
      </div>
    </div>

    <!-- È¶ñÊ¨°‰ΩøÁî®ÂºïÂ∞é -->
    <div id="onboardingOverlay" class="onboarding-overlay">
      <div class="onboarding-card">
        <div class="onboarding-icon">‚ú®</div>
        <div class="onboarding-title">Ê≠°Ëøé‰ΩøÁî® AI Â∞èË™™Â∑•ÂùäÔºÅ</div>
        <div class="onboarding-desc">
          Âè™ÈúÄÂπæÂÄãÊ≠•È©üÔºåÂç≥ÂèØÁî® AI Ââµ‰ΩúÁ≤æÂΩ©ÁöÑÈï∑ÁØáÂ∞èË™™„ÄÇ
        </div>
        <div class="onboarding-steps">
          <div class="onboarding-step">
            <div class="onboarding-step-num">1</div>
            <div class="onboarding-step-text">Ëº∏ÂÖ• Gemini API KeyÔºàÈªûÊìäÂè≥‰∏äËßí üîë ÊåâÈàïÔºâ</div>
          </div>
          <div class="onboarding-step">
            <div class="onboarding-step-num">2</div>
            <div class="onboarding-step-text">Ë®≠ÂÆöÊïÖ‰∫ã‰∏ªÈ°å„ÄÅËÉåÊôØÂíå‰∫∫Áâ©ÔºåÊàñ‰ΩøÁî®„ÄåÂø´ÈÄüÊ®°Êùø„Äç‰∏ÄÈçµÂ°´ÂÖ•</div>
          </div>
          <div class="onboarding-step">
            <div class="onboarding-step-num">3</div>
            <div class="onboarding-step-text">ÈªûÊìä„Äå‚ú® ÈñãÂßãÁîüÊàê„ÄçÔºåAI Â∞áÁÇ∫‰Ω†Êí∞ÂØ´Èï∑ÁØáÊïÖ‰∫ã</div>
          </div>
          <div class="onboarding-step">
            <div class="onboarding-step-num">4</div>
            <div class="onboarding-step-text">‰ΩøÁî®„Äåüìñ ÁπºÁ∫åÁîüÊàê„ÄçËÆìÊïÖ‰∫ãÂª∂Á∫åÔºåÁõ¥Âà∞ÂÆåÁµê</div>
          </div>
        </div>
        <div class="onboarding-btns">
          <button id="onboardingSkip" class="onboarding-btn secondary">‰∏ãÊ¨°ÂÜçË™™</button>
          <button id="onboardingStart" class="onboarding-btn primary">ÈñãÂßãÂâµ‰Ωú ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- ‰∫∫Áâ©Ë®≠ÂÆö‰∏ãÊãâÈÅ∏ÂñÆÁöÑ datalistÔºàÂãïÊÖãÁîüÊàêÔºâ -->
    <datalist id="personality-list"></datalist>
    <datalist id="goal-list"></datalist>
    <datalist id="weakness-list"></datalist>
    <datalist id="secret-list"></datalist>
    <datalist id="relation-list"></datalist>

    <script>
      // ==================== Èõ¢Á∑öÊ®°ÂºèÊ™¢Ê∏¨ ====================
      const offlineBanner = document.getElementById('offlineBanner');
      let isOnline = navigator.onLine;

      function updateOnlineStatus() {
        isOnline = navigator.onLine;
        
        if (!isOnline) {
          offlineBanner.textContent = 'üì¥ ÁõÆÂâçÁÇ∫Èõ¢Á∑öÊ®°Âºè - ÊúóËÆÄ„ÄÅÈñ±ËÆÄ„ÄÅÂåØÂá∫„ÄÅÂåØÂÖ•ÂäüËÉΩ‰ªçÂèØ‰ΩøÁî®';
          offlineBanner.classList.remove('online');
          offlineBanner.classList.add('show');
          
          // Á¶ÅÁî®ÈúÄË¶ÅÁ∂≤Ë∑ØÁöÑÊåâÈàï
          if (generateBtn) {
            generateBtn.disabled = true;
            generateBtn.title = 'Èõ¢Á∑öÊ®°Âºè‰∏ãÁÑ°Ê≥ïÁîüÊàêÊïÖ‰∫ã';
          }
          if (continueBtn) {
            continueBtn.disabled = true;
            continueBtn.title = 'Èõ¢Á∑öÊ®°Âºè‰∏ãÁÑ°Ê≥ïÁπºÁ∫åÁîüÊàê';
          }
        } else {
          offlineBanner.textContent = '‚úÖ Â∑≤ÊÅ¢Âæ©Á∂≤Ë∑ØÈÄ£Á∑ö';
          offlineBanner.classList.add('online');
          offlineBanner.classList.add('show');
          
          // ÊÅ¢Âæ©ÊåâÈàï
          if (generateBtn) {
            generateBtn.disabled = false;
            generateBtn.title = '';
          }
          if (continueBtn && latestStory) {
            continueBtn.disabled = false;
            continueBtn.title = '';
          }
          
          // 3ÁßíÂæåÈö±ËóèÊèêÁ§∫
          setTimeout(() => {
            offlineBanner.classList.remove('show');
          }, 3000);
        }
      }

      // Áõ£ËÅΩÁ∂≤Ë∑ØÁãÄÊÖãËÆäÂåñ
      window.addEventListener('online', updateOnlineStatus);
      window.addEventListener('offline', updateOnlineStatus);

      // ÂàùÂßãÊ™¢Êü•
      if (!navigator.onLine) {
        setTimeout(updateOnlineStatus, 500);
      }

      // ==================== ÂÖÉÁ¥†ÂèñÂæó ====================
      const apiKeyInput = document.getElementById('apiKey');
      const modelSelect = document.getElementById('model');
      const themeSelect = document.getElementById('theme');
      const settingSelect = document.getElementById('setting');
      const styleSelect = document.getElementById('style');
      const chaptersInput = document.getElementById('chapters');
      const lengthInput = document.getElementById('length');
      const notesInput = document.getElementById('notes');
      const randomBtn = document.getElementById('randomBtn');
      const generateBtn = document.getElementById('generateBtn');
      const downloadBtn = document.getElementById('downloadBtn');
      const continueBtn = document.getElementById('continueBtn');
      const generateImageBtn = document.getElementById('generateImageBtn');
      const statusDiv = document.getElementById('status');
      const resultDiv = document.getElementById('result');
      const toggleApiKeyVisibility = document.getElementById('toggleApiKeyVisibility');
      const charactersContainer = document.getElementById('charactersContainer');
      const randomAllCharactersBtn = document.getElementById('randomAllCharactersBtn');
      const addCharacterBtn = document.getElementById('addCharacterBtn');

      // ÊµÆÂãïÂ∑•ÂÖ∑ÂàóÂÖÉÁ¥†
      const apiPanelToggle = document.getElementById('apiPanelToggle');
      const apiPanel = document.getElementById('apiPanel');
      const apiPanelClose = document.getElementById('apiPanelClose');
      const toolbarDownloadMenu = document.getElementById('toolbarDownloadMenu');

      // ==================== ÊµÆÂãïÂ∑•ÂÖ∑Âàó‰∫ã‰ª∂ ====================
      // API Èù¢ÊùøÈñãÈóú
      apiPanelToggle.addEventListener('click', () => {
        apiPanel.classList.toggle('open');
        // ÈóúÈñâ‰∏ãËºâÈÅ∏ÂñÆ
        toolbarDownloadMenu.classList.remove('open');
      });

      apiPanelClose.addEventListener('click', () => {
        apiPanel.classList.remove('open');
      });

      // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâ API Èù¢Êùø
      document.addEventListener('click', (e) => {
        if (!apiPanel.contains(e.target) && !apiPanelToggle.contains(e.target)) {
          apiPanel.classList.remove('open');
        }
        if (!toolbarDownloadMenu.contains(e.target) && !downloadBtn.contains(e.target)) {
          toolbarDownloadMenu.classList.remove('open');
        }
      });

      // ‰∏ãËºâÈÅ∏ÂñÆÈñãÈóú
      downloadBtn.addEventListener('click', () => {
        if (downloadBtn.disabled) return;
        toolbarDownloadMenu.classList.toggle('open');
        // ÈóúÈñâ API Èù¢Êùø
        apiPanel.classList.remove('open');
      });

      // ‰∏ãËºâÈÅ∏ÂñÆÊåâÈàï‰∫ã‰ª∂
      toolbarDownloadMenu.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', () => {
          const format = btn.dataset.format;
          if (format === 'txt') {
            downloadAsTxt();
          } else if (format === 'html') {
            downloadAsHtml();
          }
          toolbarDownloadMenu.classList.remove('open');
        });
      });

      // ESC ÈçµÈóúÈñâÊ®°ÊÖãË¶ñÁ™ó
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          // ÈóúÈñâ API Èù¢Êùø
          apiPanel.classList.remove('open');
          // ÈóúÈñâ‰∏ãËºâÈÅ∏ÂñÆ
          toolbarDownloadMenu.classList.remove('open');
          // ÈóúÈñâÊúóËÆÄÊ®°ÊÖãË¶ñÁ™ó
          const speechModal = document.getElementById('speechModal');
          if (speechModal && speechModal.classList.contains('open')) {
            speechModal.classList.remove('open');
          }
          // ÈóúÈñâÊº´Áï´Ê®°ÊÖãË¶ñÁ™ó
          const comicModal = document.getElementById('comicModal');
          if (comicModal && comicModal.classList.contains('open')) {
            comicModal.classList.remove('open');
          }
        }
      });

      // ÈÄ≤ÈöéË®≠ÂÆöÂÖÉÁ¥†
      const narrativeSelect = document.getElementById('narrative');
      const eraSelect = document.getElementById('era');
      const pacingSelect = document.getElementById('pacing');
      const ratingSelect = document.getElementById('rating');
      const worldComplexitySelect = document.getElementById('worldComplexity');
      const emotionalToneSelect = document.getElementById('emotionalTone');
      const endingSelect = document.getElementById('ending');
      const specialElementsContainer = document.getElementById('specialElementsContainer');

      // ÊµÆÂãïÁ´†ÁØÄÂ∞éËà™ÂÖÉÁ¥†
      const chapterNavContainer = document.getElementById('chapterNavContainer');
      const chapterNavToggle = document.getElementById('chapterNavToggle');
      const chapterNavPanel = document.getElementById('chapterNavPanel');
      const chapterNavClose = document.getElementById('chapterNavClose');
      const chapterNavList = document.getElementById('chapterNavList');
      const chapterBadge = document.getElementById('chapterBadge');
      const readingProgress = document.getElementById('readingProgress');

      // Êõ∏Á±§ÂÖÉÁ¥†
      const addBookmarkBtn = document.getElementById('addBookmarkBtn');
      const exportBookmarksBtn = document.getElementById('exportBookmarksBtn');
      const importBookmarksBtn = document.getElementById('importBookmarksBtn');
      const importFileInput = document.getElementById('importFileInput');
      const bookmarkSearch = document.getElementById('bookmarkSearch');
      const bookmarkSort = document.getElementById('bookmarkSort');
      const bookmarkList = document.getElementById('bookmarkList');

      // ÊúóËÆÄÊ®°ÊÖãË¶ñÁ™óÂÖÉÁ¥†
      const speakBtn = document.getElementById('speakBtn');
      const speechModal = document.getElementById('speechModal');
      const closeSpeechModal = document.getElementById('closeSpeechModal');
      const voiceSelect = document.getElementById('voiceSelect');
      const speechRate = document.getElementById('speechRate');
      const speechPitch = document.getElementById('speechPitch');
      const rateValue = document.getElementById('rateValue');
      const pitchValue = document.getElementById('pitchValue');
      const emotionMode = document.getElementById('emotionMode');
      const playPauseBtn = document.getElementById('playPauseBtn');
      const stopSpeechBtn = document.getElementById('stopSpeechBtn');
      const resetSpeechBtn = document.getElementById('resetSpeechBtn');
      const speechProgressFill = document.getElementById('speechProgressFill');
      const speechProgressText = document.getElementById('speechProgressText');

      // Êº´Áï´Ê®°ÊÖãË¶ñÁ™óÂÖÉÁ¥†
      const comicModal = document.getElementById('comicModal');
      const closeComicModal = document.getElementById('closeComicModal');

      // Á∑®ËºØÂΩàÁ™óÂÖÉÁ¥†
      const editModal = document.getElementById('editModal');
      const editBookmarkTitle = document.getElementById('editBookmarkTitle');
      const editBookmarkTags = document.getElementById('editBookmarkTags');
      const editBookmarkNotes = document.getElementById('editBookmarkNotes');
      const cancelEditBtn = document.getElementById('cancelEditBtn');
      const saveEditBtn = document.getElementById('saveEditBtn');

      let latestStory = '';
      let editingBookmarkId = null;
      let chapterMatches = [];
      let isPanelOpen = false;

      // ==================== ÁãÄÊÖãÈ°ØÁ§∫ ====================
      function showStatus(type, message) {
        const icons = {
          loading: '‚è≥',
          success: '‚úÖ',
          error: '‚ùå',
          warning: '‚ö†Ô∏è'
        };
        statusDiv.className = `status show ${type}`;
        statusDiv.querySelector('.status-icon').textContent = icons[type] || '';
        statusDiv.querySelector('.status-text').textContent = message;
      }

      function hideStatus() {
        statusDiv.className = 'status';
      }

      // ==================== API ÈáëÈë∞ ====================
      const storedKey = localStorage.getItem('geminiApiKey');
      if (storedKey) apiKeyInput.value = storedKey;

      apiKeyInput.addEventListener('change', () => {
        const val = apiKeyInput.value.trim();
        if (val) {
          try {
            localStorage.setItem('geminiApiKey', val);
          } catch (e) {
            showStatus('error', 'API ÈáëÈë∞ÂÑ≤Â≠òÂ§±Êïó');
          }
        }
      });

      toggleApiKeyVisibility.addEventListener('click', () => {
        const isPassword = apiKeyInput.type === 'password';
        apiKeyInput.type = isPassword ? 'text' : 'password';
        toggleApiKeyVisibility.textContent = isPassword ? 'Èö±Ëóè' : 'È°ØÁ§∫';
      });

      // ==================== ËºâÂÖ•Â∑≤ÂÑ≤Â≠òÁöÑÊïÖ‰∫ã ====================
      const savedStory = localStorage.getItem('savedStory');
      if (savedStory) {
        latestStory = savedStory;
        resultDiv.textContent = savedStory;
        // Áõ¥Êé•Áî® getElementById Á¢∫‰øùÁç≤ÂèñÊ≠£Á¢∫ÁöÑÂÖÉÁ¥†
        document.getElementById('downloadBtn').disabled = false;
        document.getElementById('continueBtn').disabled = false;
        document.getElementById('speakBtn').disabled = false;
        document.getElementById('generateImageBtn').disabled = false;
        parseAndShowChapters(savedStory);
        console.log('Â∑≤ËºâÂÖ•ÂÑ≤Â≠òÁöÑÊïÖ‰∫ãÔºåÊåâÈàïÂ∑≤ÂïüÁî®');
      }

      // ==================== Èö®Ê©üË≥áÊñôÂ∫´ ====================
      const themes = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ•áÂπªÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âè≤Ë©©Â•áÂπª','È´òÁ≠âÂ•áÂπª','ÈªëÊöóÂ•áÂπª','ÈÉΩÂ∏ÇÂ•áÂπª','ËºïÂ•áÂπª','Á´•Ë©±ÊîπÁ∑®','Á•ûË©±ÂÇ≥Ë™™',
        'Á≤æÈùàËàáÁüÆ‰∫∫','ÈæçËàáÈ≠îÊ≥ï','È≠îÊ≥ï‰∏ñÁïå','ÂãáËÄÖËàáÈ≠îÁéã','È≠îÁéãËΩâÁîü','È®éÂ£´ÂÇ≥Ë™™',
        'Á•ûÁç∏Â•ëÁ¥Ñ','È≠îÊ≥ïÂ∞ëÂ•≥','Â•áÂπªÂÜíÈö™','Â∞ãÈæç‰πãÊóÖ','È≠îÊ≥ïÂ∏´‰πãË∑Ø','ÁéãÂúãËààË°∞',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰ªô‰ø†Ê≠¶‰ø†È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰ªô‰ø†‰øÆÁúü','ÁéÑÂπª‰øÆÁúü','Âè§Ë£ùÊ≠¶‰ø†','Áèæ‰ª£‰øÆ‰ªô','Ê¥™ËçíÊµÅ','Á•ûË©±‰øÆÁúü',
        'Ê±üÊπñ‰ø†ÂÆ¢','ÈñÄÊ¥æÁà≠È¨•','ÂäçËàáÊÉÖ‰ªá','È£õÂçáÊàê‰ªô','ÈÅìÊ≥ïËá™ÁÑ∂','Ê≠¶ÊûóËá≥Â∞ä',
        'Â¶ñÈ≠îÈ¨ºÊÄ™','Èô∞ÈôΩÂ∏´','ÊçâÂ¶ñË®ò','‰øÆÈ≠îÂ§ßÈÅì','ÈÄÜÂ§©ÊîπÂëΩ','Ê∞£ÈÅã‰πãÂ≠ê',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁßëÂπªÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á°¨ÁßëÂπª','ËªüÁßëÂπª','Â§™Á©∫Ê≠åÂäá','Ë≥ΩÂçöÈæêÂÖã','Ëí∏Ê±ΩÈæêÂÖã','Êü¥Ê≤πÈæêÂÖã',
        'ÂæåÂïüÁ§∫ÈåÑ','‰∫∫Â∑•Êô∫ÊÖß','ÊôÇÈñìÊóÖË°å','Â§ñÊòüÊñáÊòé','Âü∫Âõ†ÊîπÈÄ†','ËôõÊì¨ÂØ¶Â¢É',
        'Ê©üÁî≤Êà∞Áà≠','ÊòüÈöõÊà∞Áà≠','ÊÆñÊ∞ëÊòüÁêÉ','ÂÖãÈöÜ‰∫∫','ÊÑèË≠ò‰∏äÂÇ≥','ÈáèÂ≠ê‰∏ñÁïå',
        'ËøëÊú™‰æÜÈÉΩÂ∏Ç','ÂèçÁÉèÊâòÈÇ¶','ÁîüÂåñÂç±Ê©ü','Á¥çÁ±≥ÁßëÊäÄ','Â§™Á©∫Êé¢Á¥¢','Á¨¨‰∏ÄÊ¨°Êé•Ëß∏',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÑõÊÉÖÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êµ™Êº´ÊÑõÊÉÖ','ÁîúËúúÂØµÊÑõ','ËôêÊàÄÊÉÖÊ∑±','Á¶ÅÂøå‰πãÊàÄ','Á†¥Èè°ÈáçÂúì','ÂÖàÂ©öÂæåÊÑõ',
        'ÈùíÊ¢ÖÁ´πÈ¶¨','‰∏ÄË¶ãÈçæÊÉÖ','Êó•‰πÖÁîüÊÉÖ','ÊöóÊàÄÊàêÁúü','Ê≠°ÂñúÂÜ§ÂÆ∂','Ëæ¶ÂÖ¨ÂÆ§ÊàÄÊÉÖ',
        'Ë±™ÈñÄÊÅ©ÊÄ®','ÁÅ∞ÂßëÂ®ò','Èú∏ÈÅìÁ∏ΩË£Å','Ë∑®Ë∂äÊôÇÁ©∫ÁöÑÊÑõ','Áï∞Êóè‰πãÊàÄ','‰∫∫Â¶ñ‰πãÊàÄ',
        'Â©öÂæåÁîüÊ¥ª','ÁîúËúúÊó•Â∏∏','ÈõôÂêëÊöóÊàÄ','Â•ëÁ¥ÑÊàÄÊÑõ','ÈáçÁîüËøΩÊÑõ','Â®õÊ®ÇÂúàÊàÄÊÑõ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊá∏ÁñëÊé®ÁêÜÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êú¨Ê†ºÊé®ÁêÜ','Á§æÊúÉÊ¥æÊé®ÁêÜ','ÂØÜÂÆ§ÊÆ∫‰∫∫','ÈÄ£Áí∞ÊÆ∫Êâã','Ê≥ïÂ∫≠ÊîªÈò≤','Ë≠¶Âå™Â∞çÊ±∫',
        'ÈñìË´úË´úÊà∞','ÁäØÁΩ™ÂøÉÁêÜ','ÂÜ∑Ê°àÈáçÂïü','Âæ©‰ªáË®àÁï´','ÂÆåÁæéÁäØÁΩ™','Êá∏ÁñëÊé®ÁêÜ',
        'ÂøÉÁêÜÊá∏Áñë','ÂèçËΩâÂäáÊÉÖ','Â∞ãÊâæÁúüÂÖá','Á•ûÊé¢Á†¥Ê°à','ÊöóÈªëÂÅµÊé¢','ÁÑ°ÁΩ™Êé®ÂÆö',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÅêÊÄñÈ©öÊÇöÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂøÉÁêÜÊÅêÊÄñ','ÈùàÁï∞È¨ºÊÄ™','ÂÖãËòáÈ≠ØÁ•ûË©±','ÈÉΩÂ∏ÇÊÄ™Ë´á','Ë©õÂííÂÇ≥Ë™™','È¨ºÂ±ãÊé¢Èö™',
        'Âñ™Â±çÂç±Ê©ü','ÈÇ™ÊïôÂÑÄÂºè','ÊÅêÊÄñÈ©öÊÇö','Ê∞ë‰øóÊÅêÊÄñ','Ê†°ÂúíÊÄ™Ë´á','ÈÜ´Èô¢È©öÈ≠Ç',
        'ÊÄ™Áâ©Áçµ‰∫∫','Ê∑±Êµ∑ÊÅêÊáº','Â§™Á©∫È©öÈ≠Ç','Êú´Êó•Ê±ÇÁîü','Áï∞ÂΩ¢ÂÖ•‰æµ','ÂØÑÁîüÁç∏',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊ≠∑Âè≤È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê≠∑Âè≤ÂÇ≥Â•á','ÂÆÆÂª∑È¨•Áà≠','ÂæåÂÆÆÁà≠ÂØµ','Êà∞ÂúãÈ¢®Èõ≤','‰∏âÂúãÊºîÁæ©','Ê•öÊº¢Áà≠Èú∏',
        'Ê∞ëÂúãÈ¢®ËèØ','Âè§‰ª£ÂïÜÊà∞','Â∏ùÁéãÂ∞áÁõ∏','‰∫Ç‰∏ñËã±ÈõÑ','Ê≠∑Âè≤Á©øË∂ä','Êû∂Á©∫Ê≠∑Âè≤',
        'ÊäóÊà∞È¢®Èõ≤','Ë´úÊà∞È¢®Èõ≤','ÁßëËàâ‰πãË∑Ø','Áõõ‰∏ñÁπÅËèØ','ÁéãÊúùË¶ÜÊªÖ','ÈñãÂúãÂ§ßÊ•≠',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁèæ‰ª£ÈÉΩÂ∏ÇÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Áèæ‰ª£ÈÉΩÂ∏Ç','ËÅ∑Â†¥È¢®Èõ≤','Â®õÊ®ÇÂúà','È´îËÇ≤Á´∂ÊäÄ','ÈõªÁ´∂ÁÜ±Ë°Ä','ÂâµÊ•≠Â•ÆÈ¨•',
        'Ê†°ÂúíÈùíÊò•','ÂÆ∂Â∫≠ÂÄ´ÁêÜ','Á§æÊúÉÂØ´ÂØ¶','Á∂≤Á¥ÖÁîüÊ¥ª','Áõ¥Êí≠‰∫∫Áîü','ÈÉΩÂ∏ÇÁï∞ËÉΩ',
        'ÈáçÁîüÈÉΩÂ∏Ç','ÂïÜÊà∞È¢®Èõ≤','ÈÜ´ÁôÇËÅ∑‰∫∫','Ê≥ïÂæãÊ≠£Áæ©','ÊïôÂ∏´‰∫∫Áîü','Ë®òËÄÖËøΩËπ§',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËªç‰∫ãÊà∞Áà≠È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ëªç‰∫ãÊà∞Áà≠','Êà∞Áà≠Âè≤Ë©©','ÁâπÁ®ÆÂÖµ','ÂÇ≠ÂÖµÁîüÊ∂Ø','ËªçÊóÖÁîüÊ¥ª','Êµ∑ËªçËâ¶Èöä',
        'Á©∫Êà∞Ëã±ÈõÑ','ÁãôÊìäÊâã','Ë´úÂ†±‰∫∫Âì°','Êà∞Âú∞ÈÜ´Ë≠∑','Êà∞Áà≠ËàáÂíåÂπ≥','Êú™‰æÜÊà∞Áà≠',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÜíÈö™Êé¢Á¥¢È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êµ∑Ê¥ãÂÜíÈö™','Ë•øÈÉ®ÊãìËçí','ÂåóÊ≠êÁ∂≠‰∫¨','Êé¢Èö™Â∞ãÂØ∂','ËçíÈáéÊ±ÇÁîü','ÁôªÂ±±Êé¢Èö™',
        'Âè¢ÊûóÊé¢Èö™','Ê≤ôÊº†‰πãÊóÖ','Ê•µÂú∞ÂÜíÈö™','Âú∞ÂøÉÊé¢Á¥¢','Á©∫Â≥∂ÂÜíÈö™','Áï∞‰∏ñÁïåÊé¢Èö™',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁîüÊ¥ªËÅ∑Ê•≠È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁæéÈ£üÊñôÁêÜ','ÁîúÈªûÁÉòÁÑô','Èü≥Ê®ÇÂ§¢ÊÉ≥','Áπ™Áï´‰∫∫Áîü','ËàûËπàÈùíÊò•','ÊîùÂΩ±ÊïÖ‰∫ã',
        'ÂØµÁâ©ÊÉÖÁ∑£','ÂúíËóùÁîüÊ¥ª','ÊâãÂ∑•Ëóù‰∫∫','Êõ∏Â∫óÊó•Â∏∏','ÂíñÂï°Âª≥Áâ©Ë™û','Ëä±Â∫óÊïÖ‰∫ã',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁâπÊÆäÈ°åÊùêÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êú´‰∏ñÂª¢Âúü','Áï∞ËÉΩË¶∫ÈÜí','Á≥ªÁµ±ÊµÅ','ÁÑ°ÈôêÊµÅ','ÂâØÊú¨ÈÅäÊà≤','Áõ¥Êí≠Ê±ÇÁîü',
        'Ë¶èÂâáÊÄ™Ë´á','Ë©≠Áï∞ÈÅäÊà≤','ÈùàÊ∞£Âæ©Áî¶','Ë´∏Â§©Ëê¨Áïå','Âø´Á©øÁ≥ªÁµ±','Á∂úÊº´Âêå‰∫∫',
        'Áï∞‰∏ñÁïåËΩâÁîü','ÈáçÁîüÂæ©‰ªá','ÈáçÁîüÁ∂ìÂïÜ','ÈáçÁîüÂ®õÊ®ÇÂúà','Á©∫ÈñìÁ®ÆÁî∞','Èö®Ë∫´ËÄÅÁà∫Áà∫'
      ];
      
      const settingsData = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ•áÂπª‰∏ñÁïå„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËôõÊßãÁöÑ‰∏≠‰∏ñÁ¥ÄÁéãÂúã','Á≤æÈùàÊóèÁöÑÊ£ÆÊûóÂúãÂ∫¶','ÁüÆ‰∫∫ÁöÑÂú∞Â∫ïÂüéÂ∏Ç','ÈæçÊóèÁõ§ÊìöÁöÑÁÅ´Â±±Â≥∂',
        'È≠îÊ≥ïÂ∏´ÁöÑÊµÆÁ©∫Â°î','Ë¢´Ë©õÂííÁöÑÈªëÊöóÊ£ÆÊûó','Á•ûËÅñÁöÑÂÖâÊòéÁ•ûÊÆø','‰∫°ÈùàÊ©´Ë°åÁöÑËçíÂéü',
        'Êµ∑Â¶ñÂá∫Ê≤íÁöÑÁ•ûÁßòÊµ∑Âüü','Èö±ËóèÂú®Ëø∑Èúß‰∏≠ÁöÑ‰ªôÂ¢É','È≠îÊ≥ïÂÖ¨ÊúÉÁ∏ΩÈÉ®','ÂÜíÈö™ËÄÖÂçîÊúÉ',
        'È≠îÁç∏Ê©´Ë°åÁöÑÂç±Èö™Âú∞Â∏∂','Âè§ËÄÅÁöÑÈ≠îÊ≥ïÈÅ∫Ë∑°','Â∞ÅÂç∞ÈÇ™Á•ûÁöÑËÅñÂú∞','ÈæçÈ®éÂ£´ÁöÑË®ìÁ∑¥Â†¥',
        'Á≤æÈùàÂ•≥ÁéãÁöÑÂÆÆÊÆø','Áç∏‰∫∫ÈÉ®ËêΩÁöÑÁáüÂú∞','ÂçäÁç∏‰∫∫ÁöÑÈÇäÂ¢ÉË¶ÅÂ°û','È≠îÊ≥ïÁµêÁïå‰øùË≠∑ÁöÑÂ≠∏Èô¢',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰ªô‰ø†‰øÆÁúü‰∏ñÁïå„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰øÆ‰ªôÈñÄÊ¥æÁöÑÈùàÂ±±','Ê¥ûÂ§©Á¶èÂú∞','È≠îÊïôÁ∏ΩÂ£á','Â¶ñÊóèÈ†òÂú∞','ÈùàÁç∏Ê£ÆÊûó',
        '‰ªô‰∫∫Ê¥ûÂ∫ú','ÁÖâ‰∏πÈñ£','ËóèÁ∂ìÈñ£','ÂäçÂÜ¢','Èõ∑Âä´Ê∏°Âä´‰πãÂú∞',
        'Âá°‰∫∫‰øÆ‰ªôÁïå','‰∏äÂè§Êà∞Â†¥ÈÅ∫Ë∑°','ÁßòÂ¢ÉÂÖ•Âè£','‰ªôÈ≠îÊà∞Â†¥','Ëº™Ëø¥‰πãÂú∞',
        'Â§©Â∫≠ÂáåÈúÑÊÆø','Âú∞Â∫úÈñªÁæÖÊÆø','ÈæçÂÆÆ','Ëì¨Ëêä‰ªôÂ≥∂','Â¥ëÂ¥ô‰ªôÂ¢É',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂè§‰ª£‰∏≠Âúã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁöáÂÆÆÁ¥´Á¶ÅÂüé','ÁéãÂ∫úÊ∑±ÂÆÖ','Ê±üÂçóÊ∞¥ÈÑâ','ÈÇäÂ°ûÈóúÈöò','Áµ≤Ë∑ØÂè§ÈÅì',
        'ÂîêÊúùÈï∑ÂÆâÂüé','ÂÆã‰ª£ÁπÅËèØÊ±¥‰∫¨','ÊòéÊúùÊ±üÂçó','Ê∏ÖÊúù‰∫¨Âüé','Êà∞ÂúãÊôÇ‰ª£ÁöÑÂüéÊ±†',
        '‰∏âÂúãÊôÇÊúüÁöÑÊà∞Â†¥','ÁßëËàâËÄÉÂ†¥','ÈùíÊ®ìÊ•öÈ§®','ÂÆ¢Ê£ßËå∂Ê®ì','Èè¢Â±ÄÁ∏ΩÈÉ®',
        'Ê≠¶ÊûóÁõü‰∏ªÁöÑËéäÂúí','Èö±‰∏ñÊùëËêΩ','Â∞ëÊûóÂØ∫','Ê≠¶Áï∂Â±±','Â≥®ÁúâÈáëÈ†Ç',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂè§‰ª£ÂÖ∂‰ªñ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âè§ÁæÖÈ¶¨Á´∂ÊäÄÂ†¥','ÂüÉÂèäÊ≥ïËÄÅÁéãÂÆÆ','Â∏åËáòÁ•ûÊÆø','Á∂≠‰∫¨Êµ∑ÁõúËàπ','Êó•Êú¨Êà∞ÂúãÂüéÂ†°',
        '‰∏≠‰∏ñÁ¥ÄÊ≠êÊ¥≤ÂüéÂ†°','È®éÂ£´ÂúòË¶ÅÂ°û','ÈòøÊãâ‰ºØÂÆÆÊÆø','Áë™ÈõÖÁ•ûÂªü','Âç∞Âä†Â∏ùÂúã',
        'Ê≥¢ÊñØÂ∏ùÂúã','ÊãúÂç†Â∫≠ÁöáÂÆÆ','ËíôÂè§Â§ßËçâÂéü','Â•ßÊñØÊõºÂ∏ùÂúã','‰∏≠‰∏ñÁ¥Ä‰øÆÈÅìÈô¢',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËøëÁèæ‰ª£Ê≠∑Âè≤„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê∞ëÂúãÊôÇÊúüÁöÑ‰∏äÊµ∑ÁÅò','ÂçÅÈáåÊ¥ãÂ†¥','ÁßüÁïåÂçÄ','ÊäóÊà∞ÊôÇÊúüÁöÑÈáçÊÖ∂','Âª∂ÂÆâÁ™ØÊ¥û',
        'Á∂≠Â§öÂà©‰∫ûÊôÇ‰ª£ÁöÑÂÄ´Êï¶','Â∑•Ê•≠Èù©ÂëΩÁöÑÂ∑•Âª†','ÁæéÂúãË•øÈÉ®ËçíÈáé','Ê∑òÈáëÁÜ±ÊôÇ‰ª£',
        '‰∫åÊà∞ÊôÇÊúüÁöÑÊ≠êÊ¥≤Êà∞Â†¥','ÂÜ∑Êà∞ÊôÇÊúüÁöÑÊüèÊûó','ÂÖ≠‰∏ÉÂçÅÂπ¥‰ª£ÁöÑÈ¶ôÊ∏Ø','ÂÖ´‰πùÂçÅÂπ¥‰ª£ÁöÑÂè∞ÁÅ£',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁèæ‰ª£ÈÉΩÂ∏Ç„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁπÅËèØÁöÑÁèæ‰ª£Â§ßÈÉΩÊúÉ','ÂúãÈöõÈáëËûç‰∏≠ÂøÉ','È†ÇÁ¥öË∑®Âúã‰ºÅÊ•≠Á∏ΩÈÉ®','ÂâµÊ•≠Â≠µÂåñÂô®',
        'ÊôÇÂ∞öÈõúË™åÁ§æ','ÈõªË¶ñÂè∞ÊºîÊí≠Âª≥','ÈõªÂΩ±ÊãçÊîùÁèæÂ†¥','Â®õÊ®ÇÂÖ¨Âè∏Á∑¥ÁøíÂÆ§',
        'È´òÁ¥öÁßÅ‰∫∫ÊúÉÊâÄ','Âú∞‰∏ãÊã≥Â†¥','ÈÖíÂêßÂ§úÂ∫ó','È´òÊ™îÈ§êÂª≥','Á±≥ÂÖ∂ÊûóÂªöÊàø',
        'ÁßÅÁ´ãË≤¥ÊóèÂ≠∏Ê†°','ÊôÆÈÄöÈ´ò‰∏≠Ê†°Âúí','Â§ßÂ≠∏Âüé','Á†îÁ©∂ÊâÄÂØ¶È©óÂÆ§','ÈÜ´Â≠∏Èô¢ÈôÑÂ±¨ÈÜ´Èô¢',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÅ∑Ê•≠Â†¥ÊâÄ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂøôÁ¢åÁöÑ‰∏âÁî≤ÈÜ´Èô¢','ÂæãÂ∏´‰∫ãÂãôÊâÄ','Ë≠¶ÂØüÂ±ÄÂàëÂÅµÈöä','Ê≥ïÈô¢ÂØ©Âà§Â∫≠','Ê™¢ÂØüÈô¢',
        'Ê∂àÈò≤Â±Ä','Ëªç‰∫ãÂü∫Âú∞','ÁâπÁ®ÆÈÉ®ÈöäË®ìÁ∑¥Ááü','ÊÉÖÂ†±Ê©üÊßãÁ∏ΩÈÉ®','Áõ£ÁçÑ',
        'Á≤æÁ•ûÁóÖÈô¢','ÂøÉÁêÜË®∫ÊâÄ','ÊÆØÂÑÄÈ§®','ËÄÉÂè§ÁèæÂ†¥','ÂçöÁâ©È§®',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁßëÂπª‰∏ñÁïå„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËøëÊú™‰æÜÁöÑÈ´òÁßëÊäÄÂüéÂ∏Ç','Ë≥ΩÂçöÈæêÂÖãÁöÑÈúìËôπÈÉΩÂ∏Ç','‰∫∫Â∑•Êô∫ÊÖßÁµ±Ê≤ªÁöÑÂüéÂ∏Ç',
        'ÈÅôÈÅ†ÁöÑÂ§™Á©∫ÊÆñÊ∞ëÂú∞','ÂÆáÂÆôÊà∞Ëâ¶ÂÖßÈÉ®','Â§™Á©∫Á´ô','ÁÅ´ÊòüÊÆñÊ∞ëÂü∫Âú∞','ÊúàÁêÉÂü∫Âú∞',
        'Êµ∑Â∫ïÈÉΩÂ∏Ç','ËôõÊì¨ÂØ¶Â¢É‰∏ñÁïå','ÈáèÂ≠êÈõªËÖ¶Ê†∏ÂøÉ','Âü∫Âõ†ÊîπÈÄ†ÂØ¶È©óÂÆ§',
        'ÂèçÁÉèÊâòÈÇ¶ÁöÑÁõ£ÊéßÂüéÂ∏Ç','Âª¢ÂúüÊú´‰∏ñ','Âñ™Â±çËÇÜËôêÁöÑÂüéÂ∏Ç','Â§ñÊòü‰∫∫È£õËàπÂÖßÈÉ®',
        'Áí∞ÂΩ¢‰∏ñÁïå','Êà¥Ê£ÆÁêÉ','ÊòüÈöõË≤øÊòìÁ´ô','ÈäÄÊ≤≥ËÅØÈÇ¶Ë≠∞ÊúÉ','ÂÖãÈöÜ‰∫∫ÂüπËÇ≤‰∏≠ÂøÉ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁï∞‰∏ñÁïå/Áï∞Á©∫Èñì„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âπ≥Ë°åÂÆáÂÆô','Áï∞Ê¨°ÂÖÉÁ©∫Èñì','Â§¢Â¢É‰∏ñÁïå','ÈùàÁïåËàáÂÜ•Â∫ú','Â§©ÁïåËàá‰ªôÂ¢É',
        'Âú∞ÁçÑÊ∑±Ê∑µ','ÊôÇÈñìË£ÇÁ∏´‰πã‰∏≠','ÈáèÂ≠êÁñäÂä†ÁöÑ‰∏ñÁïå','ÈÅäÊà≤ÂâØÊú¨Á©∫Èñì','Ë´∏Á•ûÁöÑÈ†òÂüü',
        'ÊÑèË≠òÁ©∫Èñì','ËôõÊï∏Á©∫Èñì','Ê∑∑Ê≤å‰πãÊµ∑','Ââµ‰∏ñ‰πãÂàù','‰∏ñÁïåÁõ°È†≠',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËá™ÁÑ∂Áí∞Â¢É„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ëàá‰∏ñÈöîÁµïÁöÑÂ≠§Â≥∂','Ê∞∏Â§úÁöÑÊ•µÂú∞','Ê≤ôÊº†‰∏≠ÁöÑÁ∂†Ê¥≤','ÊºÇÊµÆÂú®Á©∫‰∏≠ÁöÑÂ≥∂Â∂º',
        'Âú∞‰∏ãÊ∑±ËôïÁöÑÊ¥ûÁ©¥','Ê¥ªÁÅ´Â±±Âè£','ÂÜ∞Â∞ÅÁöÑÂè§Âüé','Ë¢´ÈÅ∫ÂøòÁöÑÂè§ÊñáÊòéÈÅ∫Ë∑°',
        'ÁÜ±Â∏∂Èõ®ÊûóÊ∑±Ëôï','Á•ûÁßòÁöÑÁôæÊÖïÈÅî','È¶¨Èáå‰∫ûÁ¥çÊµ∑Ê∫ù','ÂñúÈ¶¨ÊãâÈõÖ‰πãÂ∑î',
        '‰∫ûÈ¶¨ÈÅúÂè¢Êûó','ÊííÂìàÊãâÊ≤ôÊº†','ÂçóÊ•µÂÜ∞Âéü','ÂåóÊ•µÂáçÂúü','Â§ßÂ†°Á§Å',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊó•Â∏∏Ê∫´È¶®Â†¥ÊâÄ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê∫´È¶®ÁöÑÂíñÂï°Âª≥','ËÄÅËàäÁöÑÊõ∏Â∫ó','Á•ûÁßòÁöÑÂè§Ëë£Â∫ó','ÁÜ±È¨ßÁöÑÈÅäÊ®ÇÂúí',
        'ÂÆâÈùúÁöÑÂúñÊõ∏È§®','Ê∫´ÊöñÁöÑÈ∫µÂåÖÂ∫ó','ÊñáËóùÁöÑËä±Â∫ó','Ê≤ªÁôíÁöÑÂØµÁâ©Â∫ó',
        'Âæ©Âè§ÁöÑÂî±ÁâáË°å','Êâã‰ΩúÂ∑•‰ΩúÂÆ§','Á§æÂçÄÊ¥ªÂãï‰∏≠ÂøÉ','Â±ãÈ†ÇÂ§©Âè∞',
        'Êµ∑ÈÇäÂ∞èÊú®Â±ã','Â±±ÈñìÊ∞ëÂÆø','ÈÑâÊùëËæ≤Â†¥','Ëë°ËêÑÈÖíËéäÂúí','Ê∫´Ê≥âÊóÖÈ§®',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁâπÊÆäÂª∫ÁØâ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'È≠îÊ≥ïÂ≠∏Èô¢','Ëí∏Ê±ΩÈæêÂÖãÂüéÂ∏Ç','Á©∫‰∏≠Ëä±Âúí','Êµ∑Â∫ïÂÆÆÊÆø','Ê®πÂ±ãÊùëËêΩ',
        'ÁßªÂãïÂüéÂ†°','Ê©üÊ¢∞Â∑®Áç∏ÂÖßÈÉ®','Ë´æ‰∫ûÊñπËàü','ÈÄöÂ§©Â°î','Âú∞‰∏ãÂüéÂ∏Ç',
        'Âª¢Ê£ÑÁöÑ‰∏ªÈ°åÊ®ÇÂúí','È¨ßÈ¨ºÁöÑËÄÅÂÆÖ','Âª¢Ê£ÑÁöÑÁ≤æÁ•ûÁóÖÈô¢','Âú∞‰∏ãÂØ¶È©óÂÆ§','Á•ïÂØÜÂü∫Âú∞'
      ];
      
      const stylesArr = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÊÑüÂü∫Ë™ø„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê∫´È¶®Ê≤ªÁôí','ÁîúËúúÊµ™Êº´','ËºïÈ¨ÜÂπΩÈªò','ÈùíÊò•Ê¥ªÂäõ','ÁÜ±Ë°ÄÁáÉÊÉÖ',
        'ÊÑü‰∫∫ÂÇ¨Ê∑ö','ËôêÂøÉÁ≥æÁµê','ÊÇ≤ÂÇ∑ÂìÄÂ©â','Ê≤âÈáçÂ£ìÊäë','ÈªëÊöóÁµïÊúõ',
        'Ê∫´ÊüîÁ¥∞ËÜ©','Ê∏ÖÊñ∞Ê∑°ÈõÖ','Ë©©ÊÑèÂîØÁæé','ÂãµÂøóÂêë‰∏ä','Ê≠£ËÉΩÈáè',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊ∞õÂúçÈ¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á•ûÁßòË©≠Áï∞','Êá∏ÁñëÁ∑äÂºµ','È©öÊÇöÊÅêÊÄñ','Èô∞Ê£ÆË©≠Ë≠é','ËçíË™ïÈõ¢Â•á',
        'Âè≤Ë©©Â£ØÈóò','Â§ßÊ∞£Á£ÖÁ§¥','ÊÅ¢ÂºòÂ£ØÈ∫ó','ËéäÂö¥ËÇÖÁ©Ü','ËíºÊ∂ºÊÇ≤Â£Ø',
        'Êòé‰∫ÆÊ≠°Âø´','‰øèÁöÆÂèØÊÑõ','Â§¢ÂπªËø∑Èõ¢','Á©∫ÈùàÁ∏πÁ∑≤','Á¶™ÊÑèÊÇ†ÈÅ†',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊïò‰∫ãÈ¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á¥∞ËÜ©ÊèèÂØ´','ÁôΩÊèèÊâãÊ≥ï','ÊÑèË≠òÊµÅ','ËíôÂ§™Â•á','Á¢éÁâáÂåñÊïò‰∫ã',
        'Â§öÁ∑ö‰∏¶ÈÄ≤','ÈõôÁ∑ö‰∫§Áπî','Áí∞ÂΩ¢Êïò‰∫ã','ÂÄíÊïòÊèíÊïò','ÈùûÁ∑öÊÄßÊïò‰∫ã',
        'Á¨¨‰∏Ä‰∫∫Á®±','Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•','ÂÖ®Áü•Ë¶ñËßí','Â§öË¶ñËßíÂàáÊèõ','Êõ∏‰ø°È´î',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁØÄÂ•èÈ¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âø´ÁØÄÂ•èÁàΩÊñá','Á∑äÊπäÂà∫ÊøÄ','È´òÊΩÆËø≠Ëµ∑','‰∏ÄÊ∞£ÂëµÊàê',
        'ÊÖ¢ÁÜ±Èã™Èô≥','Â®ìÂ®ìÈÅì‰æÜ','Âæ™Â∫èÊº∏ÈÄ≤','Á¥∞Ê∞¥Èï∑ÊµÅ',
        'ÂºµÂºõÊúâÂ∫¶','Ë∑åÂÆïËµ∑‰ºè','Âπ≥Èã™Áõ¥Êïò','ÁïôÁôΩÊÉ≥ÂÉè',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊñáÂ≠∏È¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âè§ÂÖ∏ÂÑ™ÈõÖ','ËèØÈ∫óÁπÅË§á','Á∞°Á¥ÑÁïôÁôΩ','Á≤óÁç∑Ë±™Êîæ',
        'ÁèæÂØ¶‰∏ªÁæ©','È≠îÂπªÁèæÂØ¶','Ë∂ÖÁèæÂØ¶‰∏ªÁæ©','Ë±°Âæµ‰∏ªÁæ©',
        'ÈªëËâ≤ÂπΩÈªò','ËæõËæ£Ë´∑Âà∫','ÊâπÂà§ÁèæÂØ¶','Âì≤ÁêÜÊÄùËæ®',
        'ÊäíÊÉÖÊï£Êñá','Ë©©ÂåñË™ûË®Ä','Âè£Ë™ûÂåñ','ÊñáÁôΩÂ§æÈõú',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈ°ûÂûãÈ¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËºïÂ∞èË™™È¢®','Á∂≤ÊñáÁàΩÊñá','Á¥îÊñáÂ≠∏','Âö¥ËÇÖÊñáÂ≠∏',
        'ÊñáËóùÊ∏ÖÊñ∞','ÈÉΩÂ∏ÇËºïÁÜü','ËÅ∑Â†¥Á≤æËã±','Ê†°ÂúíÁ¥îÊÑõ',
        'Âè§Ë®ÄÂÖ∏ÈõÖ','ÁèæË®ÄÈÉΩÂ∏Ç','ÁîúÂØµÊ∫∫ÊÑõ','BEÁæéÂ≠∏',
        'Á°¨Ê†∏ÂØ´ÂØ¶','ËªüÁ≥ØÊ≤ªÁôí','‰∏≠‰∫åÁÜ±Ë°Ä','ËÖπÈªëÊêûÁ¨ë',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁâπÊÆäÈ¢®Ê†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êñ∞Ê≠¶‰ø†','ÂÇ≥Áµ±Ê≠¶‰ø†','‰ªô‰ø†È£ÑÈÄ∏','ÁéÑÂπªÁÜ±Ë°Ä',
        'Á°¨ÁßëÂπª','ËªüÁßëÂπª','Ë≥ΩÂçöÈæêÂÖã','Ëí∏Ê±ΩÈæêÂÖã',
        'Âì•ÁâπÈ¢®','ÊöóÈªëÁ≥ª','ÂÖãËòáÈ≠Ø','Ê∞ë‰øóÈ¢®',
        'Êó•Á≥ªËºïÂ∞èË™™','ÈüìÂºèÁîúÂäá','ÁæéÂäáÁØÄÂ•è','Ëã±ÂäáË≥™ÊÑü',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÁ∑íÂ∞éÂêë„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁàΩÈªûÂØÜÈõÜ','ÊâìËáâÁàΩÊñá','ÈÄÜË•≤ÁøªÁõ§','Ë£ùÈÄºÊâìËáâ',
        'Á¥∞ËÜ©ÊÉÖÊÑü','ÊÖ¢ÁÜ±ÊöóÊàÄ','ÊÉÖÊÑüÁ≥æËëõ','‰∫∫ÊÄßÊé¢Ë®é',
        'ËÖ¶Ê¥ûÂ§ßÈñã','ÁÑ°ÂéòÈ†≠','È¨ºÁïúÊêûÁ¨ë','Ê∫´È¶®Êó•Â∏∏'
      ];
      const chapterOpts = [5, 8, 10, 12, 15];
      const lengthOpts = [30000, 50000, 70000, 90000];

      const nameOptions = ['ËâæÁê≥','Ê¥õÊÅ©','Âá±‰∫û','Á±≥Áàæ','Â∏≠ÊÅ©','ËñáÊãâ','Á•àÂÆâ','ÊùúÊûó','Â∏åÁàæÁ∂≠','ËêäÈõÖ','‰ºäÂá°','Ê≥ïËò≠','Ê†ºËò≠','Ê¢ÖËäô','ÂÆâÂ®ú','Èõ∑Ê†º','Á¥¢Ëè≤','ËâæÁï•Áâπ','‰∫ûÊ≠∑ÂÖã','Ëé´Â¶ÆÂç°','Ë∑ØË•ø','‰ºäËäô','Âä†ÁôæÂàó','‰∫ûÁï∂','Áë™ÈõÖ','ËâæÂæ∑','Ëñ©Êãâ','Êù∞Áôª','Áê™Êãâ','Âæ∑ÁëûÂÖã','Âá±ÁëüÁê≥','È¶¨‰∏Å','ÁæÖÁµ≤','Â•ßÂà©Á∂≠','ÊòÜÊ±Ä','ÂìàËéâ','‰ºØÁ¥çÂæ∑','Êµ∑ÂÄ´','‰∏πÂ∞ºÁàæ','Èõ∑ÂàáÁàæ','Â±±ÂßÜ','ËâæËñá','Ë´æ‰∫û','ËâæÁ±≥Ëéâ','Â∏ÉËêäÊÅ©','ËâæËúúËéâ‰∫û','ÈÅîÁ±≥ÂÆâ','Èú≤Ë•ø‰∫û','Á±≥Ëò≠ÈÅî','‰∫ûÊ≠∑Â±±Â§ß','Ê≥¢Áê≥Â®ú','‰∫®Âà©','ËòáËè≤‰∫û','Ë≤ªÂçóÂ§ö','ÂÖãËêäÂÖí','ÂüÉÂæ∑Âä†','Ê≠êÊñá','Ëéâ‰∫û','Êü•ÁàæÊñØ','ÂìàÂ®ú','Êù∞ÂÖã','Áë™ËíÇÁàæÈÅî','ÊâòÂ∞º','Â®úÂ°îËéâ','ÈÅîÁëûÊñØ','ÂÖãÈáåÊñØ','ËâæÁë™','ÁæÖ‰ºØÁâπ','Âá±Áâπ','Ê†ºËïæÁµ≤','Ëé´ÈáåÊñØ','ÊôÆÊãâÂ§ö','ÂãûÊãâ','Á∂≠ÂÖãÂ§ö','Âá±Ëéâ','Ëè≤Âà©ÊôÆ','ÁëûÁßã','Âè≤ËíÇÂ§´','ÁæÖ‰ºä','ÂìàÂæ∑Ê£Æ','Â¶ÆÂèØ','ÂÖãÈ∫óÁµ≤Ê±Ä','ËêäÊòÇ','Ê¢ÖÊ†π','ÊùúËò≠','È¶¨ÈõÖ','Ëò≠ÊñØÊ¥õÁâπ','Âç°ÁæÖÁàæ','‰ºäÈ∫óËééÁôΩ','‰ºäËñ©Ë≤ùÊãâ','ËÄÉÁâπÂ∞º','Ëî£Áê¥','ÂîêÂ®ú','Â°ûÂæ∑ÈáåÂÖã','Â∏ÉËò≠Â¶Æ','Èõ∑Ëíô','Âá±Ëñ©Áê≥','ÈòøËêäÂÖãÊñØ','Âä†Â∏ÉÈáåÂüÉÊãâ','Ë•øËíô'];
      
      // Áî∑ÊÄßÂêçÂ≠ó
      const maleNames = ['Ê¥õÊÅ©','Á±≥Áàæ','Â∏≠ÊÅ©','Á•àÂÆâ','ÊùúÊûó','‰ºäÂá°','Ê≥ïËò≠','Ê†ºËò≠','Èõ∑Ê†º','ËâæÁï•Áâπ','‰∫ûÊ≠∑ÂÖã','Âä†ÁôæÂàó','‰∫ûÁï∂','ËâæÂæ∑','Êù∞Áôª','Âæ∑ÁëûÂÖã','È¶¨‰∏Å','Â•ßÂà©Á∂≠','ÊòÜÊ±Ä','‰ºØÁ¥çÂæ∑','‰∏πÂ∞ºÁàæ','Â±±ÂßÜ','Ë´æ‰∫û','Â∏ÉËêäÊÅ©','ÈÅîÁ±≥ÂÆâ','‰∫ûÊ≠∑Â±±Â§ß','‰∫®Âà©','Ë≤ªÂçóÂ§ö','ÂüÉÂæ∑Âä†','Ê≠êÊñá','Êü•ÁàæÊñØ','Êù∞ÂÖã','ÊâòÂ∞º','ÈÅîÁëûÊñØ','ÂÖãÈáåÊñØ','ÁæÖ‰ºØÁâπ','Ëé´ÈáåÊñØ','ÊôÆÊãâÂ§ö','Á∂≠ÂÖãÂ§ö','Ëè≤Âà©ÊôÆ','Âè≤ËíÇÂ§´','ÁæÖ‰ºä','ÂìàÂæ∑Ê£Æ','ËêäÊòÇ','ÊùúËò≠','Ëò≠ÊñØÊ¥õÁâπ','Â°ûÂæ∑ÈáåÂÖã','Èõ∑Ëíô','ÈòøËêäÂÖãÊñØ','Ë•øËíô','Â®ÅÂªâ','Ë©πÂßÜÊñØ','È∫•ÂÖã','Â§ßË°õ','Á¥ÑÁëüÂ§´','ÁêÜÊü•','ÊπØÁë™ÊñØ','ÂÆâÂæ∑È≠Ø','‰πîÊ≤ª','ËâæÂÄ´','Âá±Êñá','‰πîÁ¥çÊ£Æ','‰πîËàí‰∫û','ËêäÊÅ©','Â∞ºÂè§ÊãâÊñØ','Ë¥æÊñØÊ±Ä','Â∏ÉÂÖ∞Áôª','Ê≥∞Âãí','‰∫ö‰º¶','Êù∞ÁëûÁ±≥','ËÇñÊÅ©','Âæ∑ÈáåÂÖã','È©¨‰øÆ','‰øùÁΩó','Âç°Â∞î','ÊñáÊ£ÆÁâπ'];
      
      // Â•≥ÊÄßÂêçÂ≠ó
      const femaleNames = ['ËâæÁê≥','Âá±‰∫û','ËñáÊãâ','Â∏åÁàæÁ∂≠','ËêäÈõÖ','Ê¢ÖËäô','ÂÆâÂ®ú','Á¥¢Ëè≤','Ëé´Â¶ÆÂç°','Ë∑ØË•ø','‰ºäËäô','Áë™ÈõÖ','Ëñ©Êãâ','Áê™Êãâ','Âá±ÁëüÁê≥','ÁæÖÁµ≤','ÂìàËéâ','Êµ∑ÂÄ´','Èõ∑ÂàáÁàæ','ËâæËñá','ËâæÁ±≥Ëéâ','ËâæËúúËéâ‰∫û','Èú≤Ë•ø‰∫û','Á±≥Ëò≠ÈÅî','Ê≥¢Áê≥Â®ú','ËòáËè≤‰∫û','ÂÖãËêäÂÖí','Ëéâ‰∫û','ÂìàÂ®ú','Áë™ËíÇÁàæÈÅî','Â®úÂ°îËéâ','ËâæÁë™','Âá±Áâπ','Ê†ºËïæÁµ≤','ÂãûÊãâ','Âá±Ëéâ','ÁëûÁßã','Â¶ÆÂèØ','ÂÖãÈ∫óÁµ≤Ê±Ä','Ê¢ÖÊ†π','È¶¨ÈõÖ','Âç°ÁæÖÁàæ','‰ºäÈ∫óËééÁôΩ','‰ºäËñ©Ë≤ùÊãâ','ËÄÉÁâπÂ∞º','Ëî£Áê¥','ÂîêÂ®ú','Â∏ÉËò≠Â¶Æ','Âá±Ëñ©Áê≥','Âä†Â∏ÉÈáåÂüÉÊãâ','ËâæËéâÁµ≤','Á∂≠Â§öÂà©‰∫û','Â•ßËéâÁ∂≠‰∫û','Â§èÊ¥õÁâπ','ÈòøÊõºÈÅî','ÊΩîË•øÂç°','ÁèçÂ¶Æ‰Ωõ','ËúúÈõ™ÂÖí','Â¶ÆÂ®ú','ÂÖãËòø‰ºä','ËééÊõºÁèä','ÈªõÂÆâÂ®ú','Âá±ËíÇ','ËâæËéâÊ£Æ','Â∏ÉÈ∫óÂß¨Áâπ','Ëé´Â¶ÆÂÖã','ÂÆâÁê™Êãâ','Âè≤ÈªõË•ø','Âù¶ÈõÖ','ËòøÊãâ','ÊΩò‰πÉÊãâ'];
      // ========== ÂÄãÊÄßÈÅ∏È†ÖÔºàÂàÜÈ°ûÊï¥ÁêÜÔºâ==========
      const personalityOptions = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊ∫´ÊöñÊ≠£ÂêëÂûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂñÑËâØÂñÆÁ¥î','Ê∫´ÊüîÈ´îË≤º','Ê®ÇËßÄÈñãÊúó','ÁÜ±ÊÉÖÂèãÂñÑ','ÁúüË™†Âù¶Áéá','Ê®ÇÊñºÂä©‰∫∫',
        'ÂñÑËß£‰∫∫ÊÑè','Á¥∞ÂøÉÈ´îË≤º','Èö®ÂíåÂåÖÂÆπ','Ë¶™ÂàáÂíåËóπ','ÈôΩÂÖâÁá¶Áàõ','ÊöñÂøÉÊ≤ªÁôí',
        'Á¥îÁúüÁÑ°ÈÇ™','Ëµ§Â≠ê‰πãÂøÉ','Â§©ÁúüÁàõÊº´','ÂøÉÂú∞ÂñÑËâØ','Ëàá‰∫∫ÁÇ∫ÂñÑ','Âè§ÈÅìÁÜ±ËÖ∏',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ†ÖÂº∑ÂãáÊï¢Âûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂãáÊï¢ÁÑ°Áïè','Â†ÖÊØÖ‰∏çÂ±à','Ê≠£Áæ©ÊÑüÂº∑','‰ø†ËÇùÁæ©ËÜΩ','Ë¶ãÁæ©ÂãáÁÇ∫','ÂâõÊ≠£‰∏çÈòø',
        'Ë≤¨‰ªªÊÑüÂº∑','ÊÑèÂøóÂ†ÖÂÆö','ÁôæÊäò‰∏çÊíì','Ë∂äÊå´Ë∂äÂãá','Ëá®Âç±‰∏çÊáº','Ë¶ñÊ≠ªÂ¶ÇÊ≠∏',
        'ÈêµÈ™®ÈåöÈåö','ÂØßÊäò‰∏çÂΩé','Â§ßÁæ©ÂáúÁÑ∂','Êç®ÁîüÂèñÁæ©','Áæ©ÁÑ°ÂèçÈ°ß','‰∏ÄÂæÄÁÑ°Ââç',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÅ∞ÊòéÁêÜÊÄßÂûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê©üÊô∫ÈùàÊ¥ª','ÂøÉÊÄùÁ∏ùÂØÜ','Ê≤âÁ©©ÂèØÈù†','ÂÜ∑ÈùúÁêÜÊô∫','Ê∑±Ë¨ÄÈÅ†ÊÖÆ','Ë∂≥Êô∫Â§öË¨Ä',
        'ËÅ∞ÊòéÁµïÈ†Ç','ÈÅéÁõÆ‰∏çÂøò','Â≠∏Ë≠òÊ∑µÂçö','ÂçöÂ≠∏Â§öÊâç','Ëß∏È°ûÊóÅÈÄö','Ë¶ãÂæÆÁü•Ëëó',
        'ÊòéÂØüÁßãÊØ´','Ê¥ûÂØü‰∫∫ÂøÉ','ÈÅãÁ±åÂ∏∑ÂπÑ','Ë¨ÄÂÆöÂæåÂãï','Á≤æÊòéÂππÁ∑¥','ËÄÅË¨ÄÊ∑±ÁÆó',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈ†òË¢ñÈ≠ÖÂäõÂûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'È†òÂ∞éÈ≠ÖÂäõ','ÁéãËÄÖÈ¢®ÁØÑ','Èú∏Ê∞£ÂÅ¥Êºè','Ê∞£Â†¥Âº∑Â§ß','Â®ÅÂö¥ËéäÈáç','‰∏çÊÄíËá™Â®Å',
        'ÈõÑÊâçÂ§ßÁï•','È´òÁûªÈÅ†Áüö','ËÉ∏Êá∑Â§©‰∏ã','Â§ßÂ±ÄÁÇ∫Èáç','Áü•‰∫∫ÂñÑ‰ªª','Á¶ÆË≥¢‰∏ãÂ£´',
        '‰∏ÄË®Ä‰πùÈºé','Ë®ÄÂá∫ÂøÖË°å','ÊÆ∫‰ºêÊûúÊñ∑','Èõ∑Âé≤È¢®Ë°å','Áç®Êñ∑Â∞àË°å','‰πæÁ∂±Áç®Êñ∑',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËóùË°ìÊµ™Êº´Âûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂØåÊúâÂâµÊÑè','Êµ™Êº´Â§öÊÉÖ','ÊÑüÊÄßÁ¥∞ËÜ©','Ë©©ÊÉÖÁï´ÊÑè','È¢®Ëä±Èõ™Êúà','Â§öÊÑÅÂñÑÊÑü',
        'ÊñáËóùÊ∞£Ë≥™','Êõ∏Âç∑Ê∞£','ÊâçËèØÊ©´Ê∫¢','ËóùË°ìÂ§©ÂàÜ','ÂìÅÂë≥Áç®Áâπ','ËøΩÊ±ÇÁæéÊÑü',
        'Â§©È¶¨Ë°åÁ©∫','Áï∞ÊÉ≥Â§©Èñã','‰∏çÊãò‰∏ÄÊ†º','ÁâπÁ´ãÁç®Ë°å','ÁéáÊÄßËÄåÁÇ∫','Èö®ÂøÉÊâÄÊ¨≤',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ§ñÂÜ∑ÂÖßÁÜ±Âûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â§ñÂÜ∑ÂÖßÁÜ±','Èù¢ÂÜ∑ÂøÉÁÜ±','Âè£Â´åÈ´îÊ≠£','ÂàÄÂ≠êÂò¥Ë±ÜËÖêÂøÉ','È´òÂÜ∑‰ΩÜÈóúÂøÉ‰∫∫',
        '‰∏çÂñÑË°®ÈÅî‰ΩÜË°åÂãïÊ¥æ','Âò¥Á°¨ÂøÉËªü','Ë°®Èù¢ÁÑ°ÊÉÖÂØ¶ÂâáÊ∑±ÊÉÖ','ÂÜ∑Èù¢ÁÜ±ÂøÉËÖ∏',
        'ÊÇ∂È®∑','Áúã‰ººÁñèÈõ¢ÂØ¶ÂâáÂú®ÊÑè','ÈªòÈªòÂÆàË≠∑Âûã','‰∏çË™™‰ΩÜÈÉΩË®òÂú®ÂøÉË£°',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÇ≤Â¨åÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂÇ≤Â¨å','Âà•Êâ≠ÂΩÜÊâ≠','Âò¥‰∏äË™™‰∏çË¶ÅË∫´È´îÂæàË™†ÂØ¶','Ê≠ªË¶ÅÈù¢Â≠ê','ÊÑõÈÄûÂº∑',
        '‰∏çÂù¶Áéá','Ê¨≤ÊìíÊïÖÁ∏±','ÊïÖ‰ΩúÂÜ∑Ê∑°','ÂÅáË£ù‰∏çÂú®‰πé','Âè£ÊòØÂøÉÈùû',
        'ÂêÉÈÜã‰∏çÊâøË™ç','ÂÅ∑ÂÅ∑ÈóúÊ≥®','Âò¥‰∏äÂ´åÊ£ÑÂØ¶ÈöõÂØµÊ∫∫','Ë°®Èù¢È´òÂÇ≤ÂÖßÂøÉÊúüÂæÖ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁóÖÂ¨åÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁóÖÂ¨å','‰ΩîÊúâÊ¨≤Ê•µÂº∑','Áç®‰ΩîÊ¨≤ÁàÜÊ£ö','ÊéßÂà∂Ê¨≤Âº∑','ÂÅèÂü∑','ÁòãÊâπ',
        'ÈªëÂåñÈ†êÂÇô','ÊÑõÂà∞Ê•µÁ´Ø','‰∏çË®±‰Ω†ÁúãÂà•‰∫∫','ÁÇ∫ÊÑõÁòãÁãÇ','Âü∑ÂøµÊ∑±Èáç',
        'ÂÅèÊøÄ','Ê•µÁ´Ø','ÊÑõÊÅ®ÂàÜÊòé','‰∏ÄÂøµÂ§©Â†Ç‰∏ÄÂøµÂú∞ÁçÑ','‰Ω†ÊòØÊàëÁöÑ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ§©ÁÑ∂ÂëÜÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â§©ÁÑ∂ÂëÜ','Ëø∑Á≥ä','ÊÖ¢ÂçäÊãç','ÂæåÁü•ÂæåË¶∫','ÈÅ≤Èàç','Â§©ÁÑ∂Èªë',
        'ÁÑ°ÊÑèË≠òÊí©‰∫∫','‰∏çË´≥‰∏ñ‰∫ã','ÂñÆÁ¥îÂà∞ÂÇª','ÂÇªÁôΩÁîú','ÂëÜËêå','Ê≤ªÁôíÁ≥ªÁ¨®Ëõã',
        'Ê≤íÊúâÂøÉÊ©ü','Áõ¥ÁêÉÈÅ∏Êâã','‰∏çÊáÇÊõñÊòß','Ë™çÁúüÂà∞ÂèØÊÑõ','ÁÑ°Ëá™Ë¶∫È≠ÖÂäõ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÖπÈªëÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËÖπÈªë','Á¨ëË£°ËóèÂàÄ','Á∂øË£°ËóèÈáù','ÂøÉÊ©üÊ∑±Ê≤â','ÂüéÂ∫úÊ•µÊ∑±','ËÄÅÁãêÁã∏',
        'Ë°®Èù¢ÁÑ°ÂÆ≥ÂÖßÂøÉËÖπÈªë','ÂÅáË£ùÂñÆÁ¥î','ÊâÆË±¨ÂêÉËÄÅËôé','Èö±ËóèÂØ¶Âäõ','Ê∑±Ëóè‰∏çÈú≤',
        'ÁúãÁ©ø‰∏ÄÂàá‰ΩÜ‰∏çË™™','ÈªòÈªò‰ΩàÂ±Ä','‰∏ÄÂàáÁõ°Âú®ÊéåÊè°','‰ª•ÈÄÄÁÇ∫ÈÄ≤','Êöó‰∏≠ÊìçÊéß',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊØíËàåÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊØíËàå','Âò¥ÊØíÂøÉÂñÑ','ÊêçÂèã','ÂêêÊßΩÂΩπ','Âò¥Ë≥§','Ë™™Ë©±‰∏çÈÅéËÖ¶',
        '‰∏ÄÈáùË¶ãË°Ä','Êà≥‰∫∫ÁóõËôï','Áõ¥Ë®Ä‰∏çË´±','ÊúâË©±Áõ¥Ë™™','‰∏çÁïôÊÉÖÈù¢',
        'Ë´∑Âà∫ÊåñËã¶','Ë©±‰∏≠Â∏∂Âà∫','ÂÜ∑Âò≤ÁÜ±Ë´∑','Èô∞ÈôΩÊÄ™Ê∞£','Ë™™Ë©±Â∏∂ÂàÄ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∏≠‰∫åÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏≠‰∫åÁóÖ','Ëá™ÊàëÊÑüË¶∫ËâØÂ•Ω','ÂπªÊÉ≥Áóá','Êà≤Á≤æ','ÊÑõÊºî','Ëá™ÊàëÈô∂ÈÜâ',
        'ÁæûÊÅ•playÊÑõÂ•ΩËÄÖ','ÂèñÂ•áÊÄ™ÁöÑÂêçÂ≠ó','ÂñúÊ≠°Ë£ùX','ÊÑõÁî®Èõ£ÊáÇË©ûÂΩô',
        'Â∞ÅÂç∞‰πãÂäõ','Âè≥ÊâãÁöÑÈªëÊöó','ËÉåË≤†Ë©õÂíí','Ë¢´ÈÅ∏‰∏≠ÁöÑ‰∫∫','Ë¶∫ÈÜíÁöÑÂäõÈáè',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ§æÊÅêÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á§æÊÅê','ÊÄïÁîü','ÂÖßÂêë','‰∏çÂñÑË®ÄËæ≠','ÂÆâÈùú','ÂñúÊ≠°Áç®Ëôï','ÂÆ≥Áæû',
        '‰∫∫Áæ§ÊÅêÊáº','‰∏çÊï¢Áúã‰∫∫ÁúºÁùõ','Á∑äÂºµÁµêÂ∑¥','Ë∫≤Âú®ËßíËêΩ','Â≠òÂú®ÊÑüËñÑ',
        '‰∏ÄÂÄã‰∫∫ÊâçËá™Âú®','Á§æ‰∫§ÈõªÈáè‰Ωé','ÈúÄË¶ÅÁç®ËôïÂÖÖÈõª','ÁÜü‰∫∫Èù¢ÂâçÂèçÂ∑ÆÂ§ß',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêË©±ÁôÜÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ë©±ÁôÜ','ÂòÆÂè®','Á¢éÁ¢éÂøµ','ÂÅú‰∏ç‰∏ã‰æÜ','Á§æÁâõ','Ëá™‰æÜÁÜü','‰∫∫‰æÜÁòã',
        'ÊÑõË™™Ë©±','Ë°®ÈÅîÊ¨≤Âº∑','ÂàÜ‰∫´Ê¨≤ÊªøÊªø','ÂñúÊ≠°ÂÖ´Âç¶','Ê∂àÊÅØÈùàÈÄö',
        '‰ªÄÈ∫ºÈÉΩË¶ÅË™™','Ëóè‰∏ç‰ΩèË©±','Âò¥Â∑¥Èñí‰∏ç‰Ωè','Ê≤í‰∫∫ËÅäÂ§©ÊúÉÊÇ∂Ê≠ª',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÜ∑ÈÖ∑ÁÑ°ÊÉÖÂûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂÜ∑ÈÖ∑ÁÑ°ÊÉÖ','ÈêµÁü≥ÂøÉËÖ∏','ÂÖ≠Ë¶™‰∏çË™ç','ÂøÉÁã†ÊâãËæ£','ÁúºË£°Êèâ‰∏çÂæóÊ≤ô',
        'ÂÜ∑Ë°Ä','ÁÑ°ÊÉÖ','‰∏çË¨õÊÉÖÈù¢','ÂÖ¨‰∫ãÂÖ¨Ëæ¶','Â∞ç‰∫ã‰∏çÂ∞ç‰∫∫',
        '‰∏çÊúÉÂøÉËªü','‰∏ãÊâãÁµï‰∏çÁïôÊÉÖ','Êñ¨ËçâÈô§Ê†π','Èô§ÊÉ°ÂãôÁõ°','ÁúºÁ•ûÂÜ∑Êº†',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈô∞ÊöóÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Èô∞È¨±','ÊÇ≤ËßÄÂé≠‰∏ñ','ÁúãÈÄè‰∏ÄÂàá','Â§±ÂéªÂ∏åÊúõ','Ë°åÂ±çËµ∞ËÇâ','Â≠§ÂÉª',
        'Ëá™Èñâ','‰∏ç‰ø°‰ªª‰ªª‰Ωï‰∫∫','ÊääÊâÄÊúâ‰∫∫Êé®Èñã','Ëá™ÊàëÂ∞ÅÈñâ','ÂøÉÂ¶ÇÊ≠ªÁÅ∞',
        'Ê¥ªËëóÊ≤íÊÑèÊÄù','ÁÑ°ÊâÄË¨Ç','ÈÉΩ‰∏ÄÊ®£','ÁøíÊÖ£Â≠§Áç®','Ëàá‰∏ñÈöîÁµï',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁòãÁãÇÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁòãÊâπÁæé‰∫∫','ÁòãÁô≤','‰∏çÊåâÁâåÁêÜÂá∫Áâå','Ë°åÁÇ∫Èõ£‰ª•È†êÊ∏¨','Â§©ÊâçËàáÁòãÂ≠ê‰∏ÄÁ∑öÈñì',
        'Êà∞È¨•ÁãÇ‰∫∫','ÂóúÊÆ∫','Ë°ÄËÖ•','Êö¥ÂäõÂÇæÂêë','Á†¥Â£ûÊ¨≤Âº∑','ÊÆ∫‰∫∫Â¶ÇÈ∫ª',
        'ÁòãÁãÇÁßëÂ≠∏ÂÆ∂','ÂØ¶È©óÁãÇ‰∫∫','ÁÇ∫Á†îÁ©∂‰∏çÊìáÊâãÊÆµ','Ëµ∞ÁÅ´ÂÖ•È≠î','ÂÖ•È≠î',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈ´òÂ∂∫‰πãËä±Âûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ê∏ÖÂÜ∑Á¶ÅÊÖæ','‰ªôÊ∞£È£ÑÈ£Ñ','ÈÅ∫‰∏ñÁç®Á´ã','‰∏çÈ£ü‰∫∫ÈñìÁÖôÁÅ´','Ë∂ÖÂá°ËÑ´‰øó',
        'Ê∑°Êº†ÁñèÈõ¢','Êãí‰∫∫ÂçÉÈáå','È´òÈ´òÂú®‰∏ä','‰∏çÂèØË§ªÁé©','ÂèØÊúõ‰∏çÂèØÂèä',
        'ÁÑ°Ê¨≤ÁÑ°Ê±Ç','ÁúãÊ∑°‰∏ÄÂàá','Ëàá‰∏ñÁÑ°Áà≠','Èõ≤Ê∑°È¢®Ëºï','ÂøÉÂ¶ÇÊ≠¢Ê∞¥',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈ≠ÖÊÉëÂûã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â¶ñÂ™ö','È≠ÖÊÉëÁúæÁîü','È¢®ÊÉÖËê¨Á®Æ','ÁãêÁã∏Á≤æ','Êí©‰∫∫','Âãæ‰∫∫',
        'Â™öÈ™®Â§©Êàê','Â§©ÁîüÂ∞§Áâ©','Ëê¨‰∫∫Ëø∑','Ë†±ÊÉë‰∫∫ÂøÉ','‰ª§‰∫∫Ê≤âÊ∑™',
        'ÈÇ™È≠ÖÁãÇÁã∑','ÈÇ™Ê∞£','ÁóûÊ∞£','Â£ûÂ£ûÁöÑ','Âç±Èö™ÁöÑÈ≠ÖÂäõ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂãïÁâ©Á≥ªÊÄßÊ†º„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁãºÁãóÂûã','Â•∂ÁãóÂûã','Â§ßÂûãÁä¨ÊÄßÊ†º','Â∞èÁãºÁãó','Âø†Áä¨','ÊííÂ¨åÁ≤æ',
        'Ë≤ìÁ≥ªÊÄßÊ†º','È´òÂÜ∑Ë≤ì','Èªè‰∫∫Ë≤ì','ÂÇ≤Â¨åË≤ì','Â•ΩÂ•áË≤ì',
        'ÁãêÁã∏ÊÄßÊ†º','Â∞èÁãêÁã∏','Áã°Áåæ','Ê©üÈùà','Áã°Èª†',
        'ÂÖîÁ≥ª','ËªüËêå','ËÜΩÂ∞è','ÊÑõÊííÂ¨å','ÈúÄË¶Å‰øùË≠∑',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂèçÂ∑ÆËêåÁ≥ªÂàó„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂèçÂ∑ÆËêå','Âπ≥ÊôÇÈ´òÂÜ∑ÁßÅ‰∏ãÂπºÁ®ö','Â§ñË°®Âá∂Áã†ÂÖßÂøÉÊüîËªü','ÁúãËµ∑‰æÜÂº±ÂØ¶ÂâáË∂ÖÂº∑',
        'Âö¥ËÇÖ‰ΩÜÊÑõÁé©','ÂÜ∑Ê∑°‰ΩÜÂêÉÈÜã','Âº∑Â§ß‰ΩÜÊÄïËü≤','È´òÊâã‰ΩÜË∑ØÁó¥',
        'Èú∏Á∏Ω‰ΩÜ‰∏ãÂªöÁãÇÈ≠î','Â•≥Áéã‰ΩÜÁßÅ‰∏ãËªüËêå','ÂèçÊ¥æ‰ΩÜË≠∑Áü≠','È≠îÁéã‰ΩÜÊÄïËÄÅÂ©Ü'
      ];

      // ========== ÁõÆÊ®ôÈÅ∏È†ÖÔºàÂ§ßÂπÖÊì¥ÂÖÖÔºâ==========
      const goalOptions = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂæ©‰ªáÈõ™ÊÅ®È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁÇ∫ÂÆ∂‰∫∫Â†±‰ªá','ÁÇ∫Â∏´ÈñÄÂæ©‰ªá','ÁÇ∫ÊïÖÈÑâÂæ©‰ªá','ÁÇ∫ÊÑõ‰∫∫Âæ©‰ªá','ÁÇ∫ÊëØÂèãÂ†±‰ªá',
        'ÁÇ∫Ââç‰∏ñÂæ©‰ªá','Êé®ÁøªÊö¥Êîø','Ê∏ÖÁÆóËàäÂ∏≥','Ê¥óÂà∑ÂÜ§Â±à','Ë®éÂõûÂÖ¨ÈÅì',
        'ÊÆ∫Ê≠ª‰ªá‰∫∫','ÊØÄÊªÖÊïµÂ∞çÂã¢Âäõ','ËÆìËÉåÂèõËÄÖ‰ªòÂá∫‰ª£ÂÉπ','ÂêëÊï¥ÂÄã‰∏ñÁïåÂæ©‰ªá',
        'ËøΩÊÆ∫ÈÄÉ‰∫°ÁöÑÂÖáÊâã','Ë°ÄÂÇµË°ÄÂÑü','‰ª•ÁâôÈÇÑÁâô','‰∏ÄÂÄãÈÉΩ‰∏çÊîæÈÅé',
        'ËÆì‰ªñÂÄëË∑™ËëóÊ±ÇÈ•í','ÊØÄÊéâ‰ªñÂÄëÁèçË¶ñÁöÑ‰∏ÄÂàá','Â•™ÂõûË¢´Êê∂Ëµ∞ÁöÑ‰∏ÄÂàá',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ∞ãÊâæÊé¢Á¥¢È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â∞ãÊâæÂ§±Ëπ§ÁöÑË¶™‰∫∫','Â∞ãÊâæÁúüÊ≠£ÁöÑË∫´‰∏ñ','Â∞ãÊâæË¶™ÁîüÁà∂ÊØç','Â∞ãÊâæÂ§±Êï£ÁöÑÂ≠øÁîü',
        'Â∞ãÊâæÂÇ≥Ë™™‰∏≠ÁöÑÂØ∂Ëóè','Â∞ãÊâæÈï∑Áîü‰∏çËÄÅÁöÑÁßòÂØÜ','Â∞ãÊâæÊ≤ªÁóÖÁöÑÈùàËó•','Â∞ãÊâæËß£Ëó•',
        'Â∞ãÊâæÂ§±ËêΩÁöÑÊñáÊòé','Â∞ãÊâæÈÄöÂæÄÁï∞‰∏ñÁïåÁöÑÈñÄ','Â∞ãÊâæÂâç‰∏ñÁöÑË®òÊÜ∂','Â∞ãÊâæËΩâ‰∏ñÁöÑÊÑõ‰∫∫',
        'Â∞ãÊâæÁ•ûÂô®Á¢éÁâá','Â∞ãÊâæÈ†êË®Ä‰∏≠ÁöÑÊïë‰∏ñ‰∏ª','Â∞ãÊâæÈÅ∫Â§±ÁöÑÂÇ≥Êâø','Â∞ãÊâæ‰∏äÂè§ÁßòÂÖ∏',
        'Êé¢Á¥¢Êú™Áü•Â§ßÈô∏','Êé¢Á¥¢Ê∑±Êµ∑ÈÅ∫Ë∑°','Êé¢Á¥¢ÊòüÈöõ','Êé¢Á¥¢Â§¢Â¢É‰∏ñÁïå','Êé¢Á¥¢ÊôÇÈñìÁ∏´Èöô',
        'Ëß£ÈñãÂè§ËÄÅË¨éÈ°å','Á†¥Ëß£‰∏äÂè§È†êË®Ä','ËøΩÂ∞ãÁúüÁõ∏','Êè≠ÈñãÊ≠∑Âè≤ÁúüÁõ∏','ÊâæÂá∫ÂπïÂæåÈªëÊâã',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊãØÊïëÂÆàË≠∑È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊãØÊïë‰∏ñÁïå','ÊãØÊïë‰∫∫È°û','ÊãØÊïëË¢´Âõ∞ÁöÑÊÑõ‰∫∫','ÊãØÊïëÁÄïËá®ÊªÖÁµïÁöÑÁ®ÆÊóè',
        'ÊãØÊïëË¢´Ë©õÂííÁöÑÊóè‰∫∫','ÊãØÊïëÂ§±ËêΩÁöÑÈùàÈ≠Ç','ÊãØÊïëÂ¢ÆËêΩÁöÑÁ•û','ÊãØÊïëÈªëÂåñÁöÑÊÑõ‰∫∫',
        '‰øùË≠∑ÊïÖÈÑâ','‰øùË≠∑ÊúÄÂæåÁöÑÂ∏åÊúõ','ÂÆàË≠∑ÈáçË¶Å‰πã‰∫∫','ÂÆàË≠∑ÂÆ∂ÊóèË°ÄËÑà',
        'ÂÆàË≠∑‰∏ñÁïåÂíåÂπ≥','ÂÆàË≠∑ÊúÄÂæåÁöÑÊ∑®Âúü','ÂÆàË≠∑ÂÇ≥Êâø','ÊàêÁÇ∫ÂÆàË≠∑ËÄÖ',
        'ÈòªÊ≠¢Êú´Êó•','ÈòªÊ≠¢ÁòüÁñ´ËîìÂª∂','ÈòªÊ≠¢Êà∞Áà≠','ÈòªÊ≠¢ÈªëÊöóÂÑÄÂºè',
        'ÈòªÊ≠¢ÊôÇÁ©∫Â¥©Â°å','ÈòªÊ≠¢‰∫∫Â∑•Êô∫ËÉΩÊö¥Ëµ∞','ÈòªÊ≠¢È≠îÁéãÂæ©Ê¥ª','ÈòªÊ≠¢Á•ûÁöÑÊØÄÊªÖË®àÂäÉ',
        'Ê≤ªÁôíË¢´Ë©õÂííÁöÑ‰∫∫','Ëß£Èô§Â∞ÅÂç∞','ÊâìÁ†¥ÁµêÁïå','Ê∂àÊªÖÈÇ™ÊÉ°ÁµÑÁπî','Ê∑®ÂåñÊ±°Êüì‰πãÂú∞',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÆäÂº∑ÊàêÈï∑È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊàêÁÇ∫ÊúÄÂº∑ËÄÖ','ÊàêÁÇ∫‰∏Ä‰ª£ÂÆóÂ∏´','ÊàêÁÇ∫Â§©‰∏ãÁ¨¨‰∏Ä','ÁôªÈ†ÇÊ≠¶ÈÅìÂ∑îÂ≥∞',
        'Á™ÅÁ†¥‰øÆÁÇ∫Áì∂È†∏','Ê∏°ÈÅéÂ§©Âä´','È£õÂçáÊàê‰ªô','Ë≠âÈÅìÊàêÁ•û','Ë∂ÖËÑ´Ëº™Ëø¥',
        'Áç≤ÂæóÁ•ûÁöÑË™çÂèØ','Ë∂ÖË∂äÂâç‰∫∫','Ë∂ÖË∂äËá™Â∑±ÁöÑÊ•µÈôê','ÊâìÁ†¥ÂëΩÈÅãÊû∑Èéñ',
        'Ë≠âÊòéËá™Â∑±ÁöÑÂÉπÂÄº','ËÆìÁúã‰∏çËµ∑ÊàëÁöÑ‰∫∫ÂæåÊÇî','ÈÄÜÂ§©ÊîπÂëΩ','ÂæûÂª¢ÊùêÂà∞Â§©Êâç',
        'ÊâìÊïóÂÆøÊïµ','Êà∞ÂãùÂøÉÈ≠î','ÂÖãÊúçÈÅéÂéªÁöÑÂâµÂÇ∑','Êì∫ËÑ´ÂëΩÈÅãÊùüÁ∏õ',
        'ÊâìÁ†¥ÈöéÁ¥öÈôêÂà∂','Êé®Áøª‰∏çÂÖ¨ÁöÑÂà∂Â∫¶','ËÆì‰∏ñÁïåË™çÂèØ','ÂêçÈúáÂ§©‰∏ã',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂª∫Ë®≠Áµ±Ê≤ªÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âª∫Á´ãÁêÜÊÉ≥ÂúãÂ∫¶','Áµ±‰∏ÄÂ§©‰∏ã','Á®±Èú∏‰∏ÄÊñπ','Âª∫Á´ã‰∏çÊúΩÂ∏ùÂúã',
        'ÈáçÂª∫ÂÆ∂Âúí','Âæ©ËààÂÆ∂Êóè','ÂÖâÂæ©ÈñÄÊ¥æ','ÈáçÊåØÂÆóÈñÄÊ¶ÆÂÖâ',
        'Âª∫Á´ãÂïÜÊ•≠Â∏ùÂúã','ÊàêÁÇ∫È¶ñÂØå','Â£üÊñ∑Â∏ÇÂ†¥','Âª∫Á´ãË∑®ÂúãÈõÜÂúò',
        'ÂâµÂª∫ÈñÄÊ¥æ','ÈñãÂÆóÁ´ãÊ¥æ','ÂüπÈ§äÊé•Áè≠‰∫∫','ÂÇ≥ÊâøË°£ÁºΩ',
        'ÊîπËÆä‰∏ñÁïåÁß©Â∫è','Êé®Ë°åÊñ∞ÁöÑÂà∂Â∫¶','Èù©Êñ∞Ëàä‰∏ñÁïå','ÈñãÂâµÊñ∞Á¥ÄÂÖÉ',
        'Âª∫ÈÄ†ÈÄöÂ§©Â°î','ÈñãÈó¢Êñ∞‰∏ñÁïå','ÊÆñÊ∞ëÂ§ñÊòü','Âª∫Á´ãAIÁÉèÊâòÈÇ¶',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÊÑüËøΩÊ±ÇÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊâæÂà∞ÁúüÊÑõ','ËøΩÂà∞ÂøÉ‰∏ä‰∫∫','ËÆì‰ªñ/Â•πÊÑõ‰∏äÊàë','ÈáçÊñ∞Ë¥èÂõûÊÑõ‰∫∫',
        'ËàáÂ§±Êï£ÁöÑÊÑõ‰∫∫ÈáçÈÄ¢','Ë∑®Ë∂äÈòªÁ§ôÂú®‰∏ÄËµ∑','Ë≠âÊòéÊÑõÊÉÖ','Âü∑Â≠ê‰πãÊâãÁôΩÈ†≠ÂÅïËÄÅ',
        'Ê≤ªÁôí‰ªñ/Â•πÁöÑÂÇ∑Áóõ','ÊãØÊïëÈªëÂåñÁöÑÊÑõ‰∫∫','ÂñöÈÜíÂ§±ÊÜ∂ÁöÑÊÑõ‰∫∫','Á≠âÂæÖËΩâ‰∏ñÈáçÈÄ¢',
        'Â†±Á≠îÊÅ©ÊÉÖ','Â±•Ë°åÊâøË´æ','ÂÆåÊàêÁ¥ÑÂÆö','ÂØ¶ÁèæÂÖ±ÂêåÁöÑÂ§¢ÊÉ≥',
        'ÁÖßÈ°ßÂÆ∂‰∫∫','È§äËÇ≤Â≠êÂ•≥','ËÆìÂÆ∂‰∫∫ÈÅé‰∏äÂ•ΩÊó•Â≠ê','‰øùË≠∑ÊÉ≥‰øùË≠∑ÁöÑ‰∫∫',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËá™ÊàëÂØ¶ÁèæÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËøΩÊ±ÇËá™Áî±','ÊéôËÑ´ÊùüÁ∏õ','ÂÅöËá™Â∑±ÊÉ≥ÂÅöÁöÑ‰∫ã','Ê¥ªÂá∫Ëá™Â∑±',
        'Â∞ãÊ±ÇÂÖßÂøÉÂπ≥Èùú','Êîæ‰∏ãÂü∑Âøµ','ËàáÈÅéÂéªÂíåËß£','ÊâæÂà∞ÂøÉÈùàÊ≠∏ÂÆø',
        'Ë¥ñÁΩ™','ÂΩåË£úÈÅéÈåØ','ÂÆåÊàêËá®ÁµÇÈÅ∫È°ò','‰∫ÜÂçªÊú™Á´ü‰πã‰∫ã',
        'È´îÈ©ó‰∫∫ÈñìÁôæÊÖã','ÂòóÈÅç‰∏ñÈñìÁæéÈ£ü','ÈÅäÊ≠∑ÂõõÊñπ','ÁúãÈÅçÂ§©‰∏ãÁæéÊôØ',
        'ÊâæÂà∞‰∫∫ÁîüÊÑèÁæ©','ÊÇüÈÅì','ÂèÉÈÄèÁîüÊ≠ª','ÊòéÁôΩÊ¥ªËëóÁöÑÊÑèÁæ©',
        'Áïô‰∏ãÂÇ≥‰∏ñ‰πã‰Ωú','ÈùíÂè≤ÁïôÂêç','ËÆìÂæå‰∫∫Ë®ò‰Ωè','‰∏çÊûâÊ≠§Áîü',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÅ∑Ê•≠ÊàêÂ∞±È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊàêÁÇ∫ÈõªÁ´∂ÂÜ†Ëªç','ÊàêÁÇ∫È†ÇÊµÅÂÅ∂ÂÉè','Âá∫ÈÅìC‰Ωç','ÊãøÂΩ±Â∏ùÂΩ±Âêé',
        'ÂâµÊ•≠ÊàêÂäü','ÂÖ¨Âè∏‰∏äÂ∏Ç','Ë≤°ÂãôËá™Áî±','ÂØ¶ÁèæÈöéÂ±§Ë∫çÂçá',
        'ÊàêÁÇ∫ÂêçÈÜ´','ÊîªÂÖãÁµïÁóá','ÈÜ´Â≠∏Á™ÅÁ†¥','Êá∏Â£∫Êøü‰∏ñ',
        'ÊàêÁÇ∫Â§ßÂæãÂ∏´','‰º∏ÂºµÊ≠£Áæ©','ÁÇ∫Âº±ËÄÖÁôºËÅ≤','ÊîπËÆä‰∏çÂÖ¨',
        'ÂØ¶ÁèæÁßëÂ≠∏Á™ÅÁ†¥','Áç≤ÂæóË´æË≤ùÁàæÁçé','ÊîπËÆä‰∫∫È°ûÂëΩÈÅã','Êé®ÂãïÊñáÊòéÈÄ≤Ê≠•',
        'ÊàêÁÇ∫ÂêçÂªö','Á±≥ÂÖ∂Êûó‰∏âÊòü','ÂÇ≥ÊâøÁæéÈ£üÊñáÂåñ','ÈñãÈÅçÂÖ®ÁêÉÁöÑÂ∫ó',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁßëÂπªÁâπÊÆäÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁßªÊ∞ëÁÅ´Êòü','ÊòüÈöõÊé¢Á¥¢','Á¨¨‰∏ÄÂÄãË∏èË∂≥Â§ñÊòü','Êé•Ëß∏Â§ñÊòüÊñáÊòé',
        'ÈÄ≤ÂÖ•ËôõÊì¨‰∏ñÁïå','ÊàêÁÇ∫È†ÇÁ¥öÁé©ÂÆ∂','ÊéåÊéßËôõÊì¨Â∏ùÂúã','ÈÄÉÈõ¢ËôõÊì¨ÂõöÁ±†',
        'Á†¥Ëß£Á≥ªÁµ±ÊºèÊ¥û','ÊàêÁÇ∫ÈªëÂÆ¢‰πãÁéã','ÊéßÂà∂ÂÖ®ÁêÉÁ∂≤Áµ°','Êè≠Èú≤Èô∞Ë¨Ä',
        'Áç≤ÂæóË∂ÖËÉΩÂäõ','Ë¶∫ÈÜíÁï∞ËÉΩ','ÊéßÂà∂Ëá™Â∑±ÁöÑËÉΩÂäõ','ÊàêÁÇ∫Áï∞ËÉΩÁéãËÄÖ',
        'ÂÆåÊàêÂü∫Âõ†ÈÄ≤Âåñ','Ë∂ÖË∂ä‰∫∫È°ûÊ•µÈôê','‰∏äÂÇ≥ÊÑèË≠òÊ∞∏Áîü','ÊàêÁÇ∫Êñ∞‰∫∫È°û',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰øÆ‰ªôÁéÑÂπªÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Èï∑Áîü‰∏çÊ≠ª','ÁôΩÊó•È£õÂçá','‰ΩçÂàó‰ªôÁè≠','ÊàêÁÇ∫Â§ßÁæÖÈáë‰ªô',
        'ÊàêÁÇ∫È≠îÁéã','Áµ±‰∏ÄÈ≠îÁïå','È≠îÈÅìËá≥Â∞ä','‰ª•È≠îÂÖ•ÈÅì',
        'ÈÄÜÂ§©ÊàêÁ•û','ÂºíÁ•û','Âèñ‰ª£Â§©ÈÅì','ÈáçÂ°ë‰∏âÁïå',
        'Êî∂ÊúçÁ•ûÁç∏','ÈõÜÈΩäÊ≥ïÂØ∂','ÁÖâË£ΩÁ•û‰∏π','ÈëÑÈÄ†Á•ûÂÖµ',
        'ÈñãÂâµÂäüÊ≥ï','Ëá™Êàê‰∏ÄËÑà','ÊÇüÂá∫Â§ßÈÅì','ÂâµÈÄ†‰∏ñÁïå',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ∂≤ÊñáÁâπÊÆäÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Áç≤ÂæóÁ≥ªÁµ±Ë™çÂèØ','Á∂ÅÂÆöÊúÄÂº∑Á≥ªÁµ±','ÂçáÁ¥öÁ≥ªÁµ±','ÊàêÁÇ∫Á≥ªÁµ±‰πã‰∏ª',
        'ÂÆåÊàê‰∏ªÁ•û‰ªªÂãô','ÈÄÉÈõ¢ÁÑ°ÈôêÊµÅ‰∏ñÁïå','ÊàêÁÇ∫‰∏ªÁ•û','ÊâìÁ†¥‰∏ñÁïåÂ£ÅÂ£ò',
        'ÊîªÁï•ÊâÄÊúâËßíËâ≤','ÂÖ®Âì°Â•ΩÊÑüÂ∫¶MAX','Êî∂ÊúçÊâÄÊúâ‰∫∫','ÂæåÂÆÆÊªøÂì°',
        'ÊîπÂØ´ÂäáÊú¨','ËÆìÂèçÊ¥æÊ¥óÁôΩ','ÊãØÊïëÊ≥®ÂÆöÊ≠ª‰∫°ÁöÑ‰∫∫','ÊîπËÆäÊó¢ÂÆöÁµêÂ±Ä',
        'ÊàêÁÇ∫Á©øÊõ∏Â§ß‰Ω¨','ÊéåÊéßÂäáÊÉÖËµ∞Âêë','ËÆìÊâÄÊúâ‰∫∫ÊåâÊàëÁöÑÂäáÊú¨Ëµ∞','HEÁµêÂ±Ä'
      ];

      // ========== Âº±ÈªûÈÅ∏È†ÖÔºàÂ§ßÂπÖÊì¥ÂÖÖÔºâ==========
      const weaknessOptions = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêË∫´È´îÁ¥†Ë≥™Âº±Èªû„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'È´îÂäõÊ•µÂ∑Æ','Ë∫´È´îËôõÂº±','ÂÖàÂ§©‰∏çË∂≥','È´îÂº±Â§öÁóÖ','ÂÖçÁñ´Âäõ‰Ωé‰∏ã',
        'ÂÆπÊòìÁîüÁóÖ','ÊÖ¢ÊÄßÁóÖÁ∫èË∫´','‰ΩéË°ÄÁ≥ñ','Ë≤ßË°Ä','ÂøÉËáü‰∏çÂ•Ω',
        'ËÇ∫Ê¥ªÈáèÂ∞è','ËÄêÂäõÂ∑Æ','ÂèçÊáâÈÅ≤Èàç','ÂçîË™øÊÄßÂ∑Æ','ÊüîÈüåÊÄßÂ∑Æ',
        'ËÇåËÇâËêéÁ∏Æ','È™®Ë≥™ÁñèÈ¨Ü','ÈóúÁØÄÂïèÈ°å','ËÑäÊ§éÂïèÈ°å','ÂÅèÈ†≠Áóõ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÑüÂÆòÁº∫Èô∑„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ë¶ñÂäõ‰∏ç‰Ω≥','ËøëË¶ñ','ÈÅ†Ë¶ñ','Ëâ≤Áõ≤','Â§úÁõ≤Áóá','Âº±Ë¶ñ',
        'ËÅΩÂäõÂèóÊêç','ËÄ≥È≥¥','Âë≥Ë¶∫ÈÅ≤Èàç','ÂóÖË¶∫Âñ™Â§±','Ëß∏Ë¶∫ÈÅéÊïè',
        'Âπ≥Ë°°ÊÑüÂ∑Æ','ÊöàÁú©Áóá','Áú©Êöà','ÊÑüÂÆòÈÅéËºâ','ÊÑüÂÆòÈÅ≤Èàç',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁù°Áú†ÂïèÈ°å„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â§±Áú†Áóá','ÂóúÁù°Áóá','Ê∑∫Áú†ÊòìÈÜí','Âô©Â§¢ÈÄ£ÈÄ£','Â§¢ÈÅäÁóá',
        'Áù°Áú†ÂëºÂê∏‰∏≠Ê≠¢','ÊôùÂ§úÈ°õÂÄí','ÁÑ°Ê≥ïÂÖ•Áù°','Áù°Áú†ÊÅêÊáº','Áù°Â§™Â∞ëÊúÉÊö¥Ë∫Å',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈÅéÊïèËàáÁ¶ÅÂøå„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÈÅéÊïèÈ´îË≥™','Ëä±Á≤âÈÅéÊïè','È£üÁâ©ÈÅéÊïè','Ëó•Áâ©ÈÅéÊïè','ÈáëÂ±¨ÈÅéÊïè',
        'Â∞çÈôΩÂÖâÈÅéÊïè','Â∞çÊüêÁ®ÆÂÖÉÁ¥†ÈÅéÊïè','‰∏çËÉΩÂêÉÁâπÂÆöÈ£üÁâ©','Êé•Ëß∏ÁâπÂÆöÁâ©Ë≥™ÊúÉËôõÂº±',
        'ËÅûÂà∞ÁâπÂÆöÊ∞£Âë≥ÊúÉ‰∏çÈÅ©','Â∞çÈÖíÁ≤æÈÅéÊïè','‰π≥Á≥ñ‰∏çËÄê','È∫©Ë≥™ÈÅéÊïè',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËàäÂÇ∑ËàáÊÆòÁñæ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ë∫´È´îÊúâËàäÂÇ∑','Êà∞Áà≠ÂæåÈÅ∫Áóá','ÂÖßÂÇ∑Êú™Áôí','Á∂ìËÑàÂèóÊêç','‰∏πÁî∞Á†¥Á¢é',
        'ÊÆòÁñæ','Ë°åÂãï‰∏ç‰æø','ÂñÆÁúºÂ§±Êòé','Êñ∑ËáÇ','Êñ∑ËÖø','ÂïûÂ∑¥','ËÅæÂ≠ê',
        'ÊØíÁ¥†Á¥ØÁ©ç','‰∏≠ÊØíÊú™Ëß£','Ë©õÂííÁ∫èË∫´','Ê•≠ÂäõÂèçÂô¨','Â§©ÈÅìÊá≤ÁΩ∞',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ£ΩÂëΩËàá‰ª£ÂÉπ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â£ΩÂëΩÂ∞áÁõ°','ÊôÇÊó•ÁÑ°Â§ö','Ë¢´ÊäΩÂèñ‰∫ÜÂ£ΩÂëΩ','ÊØè‰ΩøÁî®ËÉΩÂäõÊ∏õÂ£Ω',
        'ÊØèÊó•ÈúÄÊúçËó•Á∫åÂëΩ','Èù†‰∏πËó•Á∂≠ÊåÅ','ÈúÄË¶ÅÁâπÊÆäË°ÄÊ∂≤','ÈúÄË¶ÅÂê∏Êî∂ÁîüÂëΩÂäõ',
        '‰ΩøÁî®ËÉΩÂäõÊúÉÊäòÂ£Ω','Ë∂ÖÈÅéÊ•µÈôêÊúÉÊ≠ª','ÂäõÈáèÊúÉÂèçÂô¨','ÈÄèÊîØÁîüÂëΩ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂäõÈáèÂ§±Êéß„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂäõÈáèÊúÉÊö¥Ëµ∞','ÁÑ°Ê≥ïÂÆåÂÖ®ÊéßÂà∂ËÉΩÂäõ','ÊÉÖÁ∑íÊøÄÂãïÊôÇÂ§±Êéß','ÊªøÊúàÊúÉÂ§±Êéß',
        'Ë∫´È´îË¢´Â∞ÅÂç∞','ÂäõÈáèË¢´Â£ìÂà∂','Âè™ËÉΩÁôºÊèÆ‰∏ÄÊàêÂØ¶Âäõ','ÊØèÊ¨°Ëß£Â∞Å‰ª£ÂÉπÂ∑®Â§ß',
        'ËÉΩÂäõÊúâÂâØ‰ΩúÁî®','‰ΩøÁî®ÂæåÊúÉËôõÂº±','ÂÜ∑ÂçªÊôÇÈñìÈï∑','‰ΩøÁî®Ê¨°Êï∏ÊúâÈôê',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÅêÊáºÁóá„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊÅêÈ´ò','ÊáºÈ´òÁóá','ÊÅêÊ∞¥','ÊÅêÈªë','ÊÅêÁÅ´','ÊÅêÈõ∑',
        'ÂπΩÈñâÊÅêÊáº','Âª£Â†¥ÊÅêÊáº','Á§æ‰∫§ÊÅêÊáº','ÂØÜÈõÜÊÅêÊáº','Ê∑±Êµ∑ÊÅêÊáº',
        'ÊÄïËõá','ÊÄïËü≤','ÊÄïËúòËõõ','ÊÄïËÄÅÈº†','ÊÄïÈ¨º','ÊÄïÂ±çÈ´î',
        'ÊÄïË°Ä','ÊÄïÈÜ´Èô¢','ÊÄïÊâìÈáù','ÊÄïÊâãË°ì','ÊÄïÁâôÈÜ´',
        'ÊÄïÊ≠ª‰∫°','ÊÄïÁñæÁóÖ','ÊÄïË°∞ËÄÅ','ÊÄïÂ§±Âéª','ÊÄïË¢´ÊããÊ£Ñ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂøÉÁêÜÂâµÂÇ∑„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂâµÂÇ∑ÂæåÈÅ∫Áóá','PTSD','Á´•Âπ¥Èô∞ÂΩ±','ÂéüÁîüÂÆ∂Â∫≠ÂâµÂÇ∑','Ë¢´Èú∏ÂáåÁöÑÈô∞ÂΩ±',
        'Êà∞Áà≠ÂâµÂÇ∑','ÁõÆÁùπÊÖòÂäáÁöÑÈô∞ÂΩ±','Ë¢´ËÉåÂèõÁöÑÂÇ∑Áóõ','Â§±ÂéªËá≥Ë¶™ÁöÑÁóõ',
        'Âô©Â§¢Á∫èË∫´','ÈñÉÂõû','ËÅΩÂà∞ÁâπÂÆöËÅ≤Èü≥ÊúÉÂ¥©ÊΩ∞','ÁúãÂà∞ÁâπÂÆöÂ†¥ÊôØÊúÉÂ§±Êéß',
        'Ëß∏ÁôºÈªûÊïèÊÑü','ÁÑ°Ê≥ïÈù¢Â∞çÈÅéÂéª','ÈÅ∏ÊìáÊÄßÂ§±ÊÜ∂','Ëá™Êàë‰øùË≠∑ÊÄßÈÅ∫Âøò',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÄßÊ†ºÁº∫Èô∑„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÈÅéÊñºÂñÑËâØ','ÈÅéÊñºÂøÉËªü','ÈÅéÊñº‰ø°‰ªª‰ªñ‰∫∫','ÁÑ°Ê≥ïÊãíÁµïË´ãÊ±Ç','ËÄÅÂ•Ω‰∫∫',
        'ÂÑ™ÊüîÂØ°Êñ∑','Áå∂Ë±´‰∏çÊ±∫','Ë°ùÂãïÊòìÊÄí','‰∏âÂàÜÈêòÁÜ±Â∫¶','ËôéÈ†≠ËõáÂ∞æ',
        'ÊãñÂª∂Áóá','ÂÆåÁæé‰∏ªÁæ©','Âº∑Ëø´Áóá','ÊΩîÁôñ','ÊéßÂà∂Ê¨≤ÈÅéÂº∑',
        'Â´âÂ¶íÂøÉÈáç','Â†±Âæ©ÂøÉÂº∑','Ë®ò‰ªá','ÁùöÁú•ÂøÖÂ†±','Â∞èÂøÉÁúº',
        'Â§™Âú®ÊÑè‰ªñ‰∫∫ÁúãÊ≥ï','ÁéªÁíÉÂøÉ','ÊïèÊÑüËÑÜÂº±','ÂÆπÊòìÂèóÂÇ∑','ÈëΩÁâõËßíÂ∞ñ',
        'ÈÅéÂ∫¶Ëá™Ë≤¨','Ëá™ÊàëÊá∑Áñë','Ëá™Âçë','Ëá™Ë≤†','Ê≠ªË¶ÅÈù¢Â≠ê',
        'Âõ∫Âü∑Â∑±Ë¶ã','‰∏ÄÊ†πÁ≠ã','‰∏çÊúÉËÆäÈÄö','ËÅΩ‰∏çÈÄ≤Âã∏','ÊíûÂçóÁâÜ‰∏çÂõûÈ†≠',
        'ÊÉÖÁ∑íÂåñ','ÊòìÊÄí','ÊÑõÂì≠','ÊÑõÈÄûÂº∑','ÊÑõÈù¢Â≠ê',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ§æ‰∫§ÈöúÁ§ô„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á§æÊÅê','‰∏çÂñÑË®ÄËæ≠','‰∏çÊúÉËÅäÂ§©','ÂÜ∑Â†¥Áéã','Âè•ÈªûÁéã',
        '‰∏çÊúÉÁúãÊ∞£Ê∞õ','Ë™™Ë©±Áõ¥Êé•ÊòìÂæóÁΩ™‰∫∫','ÊÉÖÂïÜ‰Ωé','‰∏çÊáÇ‰∫∫ÊÉÖ‰∏ñÊïÖ',
        'ÁÑ°Ê≥ïËôïÁêÜ‰∫∫ÈöõÈóú‰øÇ','‰∏çÊúÉÊãíÁµï','Ë®éÂ•ΩÂûã‰∫∫Ê†º','ÈÇäÁ∑£‰∫∫',
        'Áç®‰æÜÁç®ÂæÄ','ÁÑ°Ê≥ïËûçÂÖ•Áæ§È´î','Ë¢´Â≠§Á´ã','‰∏çÂêàÁæ§',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêËÉΩÂäõÁº∫Èô∑„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏çÊìÖÈï∑Ë™™Ë¨ä','Ëáâ‰∏äËóè‰∏ç‰Ωè‰∫ã','‰∏ÄË™™Ë¨äÂ∞±ÂøÉËôõ','Ë°®ÊÉÖÁÆ°ÁêÜÂ∑Æ',
        'Ë∑ØÁó¥','ÁµïÂ∞çÊñπÂêëÊÑüÁº∫Â§±','ÁúãÂú∞Âúñ‰πüÊúÉËø∑Ë∑Ø','ÂéüÂú∞ËΩâÂúà',
        'ËáâÁõ≤','Ë®ò‰∏ç‰Ωè‰∫∫Ëáâ','Âè´ÈåØÂêçÂ≠ó','Ë™çÈåØ‰∫∫',
        'ÊâãÊÆò','ÊâãÁ¨®','ÂãïÊâãËÉΩÂäõÂ∑Æ','‰ªÄÈ∫ºÈÉΩÊúÉÂ£û',
        'ÂªöËóùÁÅΩÈõ£','ÊöóÈªëÊñôÁêÜ','ÈÄ£Ê∞¥ÈÉΩËÉΩÁÖÆÁ≥ä','ÈÄ≤ÂªöÊàøÂ∞±ÁàÜÁÇ∏',
        '‰∫îÈü≥‰∏çÂÖ®','Âî±Ê≠åË∑ëË™ø','ÁØÄÂ•èÊÑüÂ∑Æ','ËàûËπàÁôΩÁó¥',
        'Êï∏Â≠∏ÁôΩÁó¥','ÁêÜÁßëÂª¢Áâ©','ÈÇèËºØÊÄùÁ∂≠Âº±','Ë®àÁÆóËÉΩÂäõÂ∑Æ',
        'ÁßëÊäÄËã¶Êâã','ÈõªÂ≠êÁî¢ÂìÅÊÆ∫Êâã','‰ªÄÈ∫ºÈÉΩÊúÉÁï∂Ê©ü',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁîüÊ¥ªÊäÄËÉΩÁº∫Â§±„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏çÊúÉÊ∏∏Ê≥≥','Êó±È¥®Â≠ê','‰∏çÊúÉÈ®éËªä','‰∏çÊúÉÈñãËªä',
        'ÊÅêÊ©ü','ÊöàËªäÊöàËàπ','Êöà3D','ÂãïÊöàÁóá',
        '‰∏çÊúÉÁêÜË≤°','ÊúàÂÖâÊóè','Â≠ò‰∏ç‰ΩèÈå¢','Ë°ùÂãïÊ∂àË≤ª',
        'ÂÅ•Âøò','‰∏ü‰∏âËêΩÂõõ','Ê≥®ÊÑèÂäõÁº∫Â§±','ÁÑ°Ê≥ïÂ∞àÊ≥®',
        'ÁîüÊ¥ª‰∏çËÉΩËá™ÁêÜ','‰∏çÊúÉÂÅöÂÆ∂Âãô','‰∏çÊúÉÁÖßÈ°ßËá™Â∑±',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ•áÂπªË®≠ÂÆöÂº±Èªû„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁâπÂÆöÂííË™ûÊúÉÂ§±Êïà','ÁúüÂêçË¢´Áü•ÈÅìÊúÉË¢´ÊéßÂà∂','Ë¢´ÂøµÂá∫ÂÖ®ÂêçÊúÉËôõÂº±',
        'Ë¶ãÂà∞ÂçÅÂ≠óÊû∂ÊúÉËôõÂº±','ÁÑ°Ê≥ïÈÄ≤ÂÖ•ËÅñÂú∞','Á•ûËÅñÁ≥ªÊîªÊìäÂÇ∑ÂÆ≥Âä†ÂÄç',
        'Ë¢´ÁâπÂÆöÊùêË≥™ÊâÄÂÇ∑ÊúÉËá¥ÂëΩ','ÈäÄÂô®','ÂØíÈêµ','ÁéÑÈêµ','ÁâπÊÆäÊú®Êùê',
        'Âº±ÈªûÂú®ÂøÉËáüÈÉ®‰Ωç','Âº±ÈªûË¢´ÊâìÊúÉ‰∏ÄÊìäËá¥ÂëΩ','ÊúâÊòéÈ°ØÁöÑÁ†¥Á∂ª',
        'ÈúÄË¶ÅÂÆöÊúüÂê∏ÂèñËÉΩÈáè','ÈúÄË¶ÅÊúàÂÖâ','ÈúÄË¶ÅË°ÄÊ∂≤','ÈúÄË¶ÅÈùàÊ∞£',
        'Èõ¢ÈñãÊ∞¥Ê∫êÊúÉËôõÂº±','‰∏çËÉΩË¶ãÂÖâ','Êó•ÂÖâÊúÉÁÅºÂÇ∑','Âè™ËÉΩÂ§úÈñìË°åÂãï',
        'ÂäõÈáè‰æÜÊ∫êÊúÉË¢´ÂâùÂ•™','Â§±Âéª‰ø°Áâ©Â∞±Â§±ÂéªËÉΩÂäõ','Â•ëÁ¥ÑÊúâËá¥ÂëΩÊ¢ùÊ¨æ',
        'ÊØèÊ¨°ÈáçÁîüÊúÉ‰∏üÂ§±‰∏ÄÊÆµË®òÊÜ∂','Ë®òÊÜ∂ÊúÉÈö®ÊôÇÈñìÊ∂àÂ§±','ÈÅ∫ÂøòË©õÂíí',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÊÑüËªüËÇã„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âü∑ËëóÊñºÈÅéÂéª','ÁÑ°Ê≥ïÊîæ‰∏ã','Ê¥ªÂú®ÂõûÊÜ∂Ë£°','Ëµ∞‰∏çÂá∫‰æÜ',
        'ÁÑ°Ê≥ïÊîæ‰∏ã‰ªáÊÅ®','Ë¢´‰ªáÊÅ®ËíôËîΩ','ÁÇ∫Âæ©‰ªáÂ§±ÂéªÁêÜÊô∫',
        'Â∞çÁâπÂÆö‰∫∫Áâ©Ë®ÄËÅΩË®àÂæû','Ë¢´Êüê‰∫∫ÊãøÊçè','ÁÑ°Ê¢ù‰ª∂‰ø°‰ªªÊüê‰∫∫',
        'ÂÆπÊòìË¢´ÁæéËâ≤Ëø∑ÊÉë','Ë¶ãÂà∞Áæé‰∫∫Ëµ∞‰∏çÂãïË∑Ø','Ëã±ÈõÑÈõ£ÈÅéÁæé‰∫∫Èóú',
        'Ë¶ã‰∏çÂæóÂà•‰∫∫ÂèóËã¶','ËÅñÊØçÂøÉ','ÊúÉÁÇ∫ÈôåÁîü‰∫∫Âá∫È†≠',
        'ÊúÉÁÇ∫ÈáçË¶Å‰πã‰∫∫‰∏çÈ°ß‰∏ÄÂàá','ÂÆπÊòìË¢´Â®ÅËÑÖ','ËªüËÇãÊòéÈ°Ø',
        'ÁÑ°Ê≥ïÂ∞çÂ≠©Â≠ê‰∏ãÊâã','Â∞çËÄÅ‰∫∫ÂøÉËªü','Â∞çÂº±ËÄÖÂøÉËªü',
        'ËÅΩ‰∏çÂæóË¶™‰∫∫Ë¢´‰æÆËæ±','‰∏ÄË∏©Âç≥Ë∑≥ÁöÑÈªû','ÂÆπÊòìË¢´ÊøÄÊÄí',
        'Â∞çÊïÖÈÑâÊúâÂü∑Âøµ','ÈÑâÊÑÅ','ÊÄùÂøµ‰πãÊÉÖ','ÁâΩÊéõÂ§™Â§ö',
        'ÊúÉË¢´ÁúüÂøÉË©±ÊâìÂãï','ÂêÉËªü‰∏çÂêÉÁ°¨','ÂøÉËªü',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁèæ‰ª£ÊàêÁôÆ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á∂≤Ë∑ØÊàêÁôÆ','ÊâãÊ©ü‰æùË≥¥Áóá','Á§æÁæ§Â™íÈ´îÁÑ¶ÊÖÆ','FOMOÁóáÂÄôÁæ§',
        'ÈÅäÊà≤ÊàêÁôÆ','ËøΩÂäáÊàêÁôÆ','ÂíñÂï°Âõ†‰∏äÁôÆ','Â•∂Ëå∂Á∫åÂëΩ',
        'Ë≥ºÁâ©ÁãÇ','Ë°ùÂãïÊ∂àË≤ª','ÈÅ∏ÊìáÂõ∞Èõ£Áóá','Âõ§Á©çÁóá',
        'Â∑•‰ΩúÁãÇ','ÈÅéÂãûÈ´îË≥™','ÂÅú‰∏ç‰∏ã‰æÜ','‰∏çÊúÉ‰ºëÊÅØ'
      ];

      // ========== ÁßòÂØÜÈÅ∏È†ÖÔºàÂ§ßÂπÖÊì¥ÂÖÖÔºâ==========
      const secretOptions = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁöáÂÆ§Ë≤¥ÊóèË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁúüÂØ¶Ë∫´‰ªΩÊòØÁéãÊóè','ÊòØ‰∫°ÂúãÂÖ¨‰∏ª/ÁéãÂ≠ê','ÊòØÁöáÂ∏ùÁßÅÁîüÂ≠ê','ÊòØÂ§™Â≠ê','ÊòØÊîùÊîøÁéã',
        'ÊòØÂ§±ËêΩÂ∏ùÂúãÁöÑÁπºÊâø‰∫∫','ÊòØË¢´Âª¢ÈªúÁöÑÁöáÊóè','ÊòØÊµÅËêΩÊ∞ëÈñìÁöÑË≤¥Êóè','ÊòØÂâçÊúùÈÅ∫Â≠§',
        'ÊòØ‰∏ñÂÆ∂Â´°Â≠ê/Â´°Â•≥','ÊòØË±™ÈñÄÁßÅÁîüÂ≠ê','ÊòØË¢´Ë™øÊèõÁöÑÁúüÊ≠£ÁπºÊâø‰∫∫','ÊòØË¢´Èö±ËóèÁöÑË°ÄËÑà',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ•ûÈ≠îÂ¶ñË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁúüÂØ¶Ë∫´‰ªΩÊòØÈ≠îÁéã','ÊòØÈ≠îÁéãËΩâ‰∏ñ','ÊòØÈ≠îÁéã‰πãÂ≠ê','ÊòØÂ¢ÆËêΩÁöÑÂ§©‰Ωø',
        'ÁúüÂØ¶Ë∫´‰ªΩÊòØÁ•ûÁöÑÂ≠©Â≠ê','ÊòØÁ•ûÁöÑËΩâ‰∏ñ','ÊòØÁ•ûÁöÑ‰ª£Ë°åËÄÖ','ÊòØÁ•ûÈÅ∏‰πã‰∫∫',
        'ÊòØÈ†êË®Ä‰πãÂ≠ê','ÊòØÂ§©ÂëΩ‰πã‰∫∫','ÊòØÊïë‰∏ñ‰∏ª','ÊòØÊØÄÊªÖËÄÖ',
        'ÊòØÂ¶ñÊÄ™ËÆäÁöÑ','ÊòØÁãêÂ¶ñ','ÊòØËõáÂ¶ñ','ÊòØÈæçÊóè','ÊòØÈ≥≥Âá∞',
        'ÊòØÁ•ûÁç∏ÂåñÂΩ¢','ÊòØ‰∏äÂè§Á•ûÁç∏','ÊòØÊ¥™ËçíÁï∞Á®Æ','ÊòØÂ§©Â§ñ‰æÜÂÆ¢',
        'ÊòØÂê∏Ë°ÄÈ¨º','ÊòØÁãº‰∫∫','ÊòØ‰∫°Èùà','ÊòØÈ¨ºÈ≠Ç','ÊòØÊÉ°ÈùàËΩâÁîü',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈñìË´úËá•Â∫ïË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊòØËá•Â∫ïÈñìË´ú','ÊòØÈõôÈù¢ÈñìË´ú','ÊòØÊïµÂúãÁ¥∞‰Ωú','ÊòØÁµÑÁπîÂÆâÊèíÁöÑÈáòÂ≠ê',
        'ÊòØÊïµ‰∫∫Ê¥æ‰æÜÁöÑ','ÊòØ‰æÜÁõ£Ë¶ñÁöÑ','ÊòØÊúâ‰ªªÂãôÂú®Ë∫´','ÁúüÊ≠£ÊïàÂø†ÁöÑÂè¶ÊúâÂÖ∂‰∫∫',
        'ÊòØÂèõÂæí','ÊòØÂÖßÈ¨º','ÊòØÂëäÂØÜËÄÖ','ÊòØËÉåÂèõËÄÖ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈö±ËóèÈ´òÊâãË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊòØÈö±Â±ÖÁöÑÁµï‰∏ñÈ´òÊâã','ÊòØÈÄÄÈö±ÁöÑÊÆ∫Á•û','ÊòØÂ∞ÅÂàÄÁöÑÂäçËÅñ','ÊòØÊ≠∏Èö±ÁöÑÂÆóÂ∏´',
        'ÊòØÈÄÉ‰∫°ÁöÑÈÄöÁ∑ùÁäØ','ÊòØË¢´ËøΩÊÆ∫ÁöÑ‰∫∫','ÊòØÈö±ÂßìÂüãÂêçÁöÑÂæ©‰ªáËÄÖ','ÊòØÊîπÈ†≠ÊèõÈù¢ÁöÑ‰∫∫',
        'ÂØ¶Âäõ‰∏ÄÁõ¥Âú®Èö±Ëóè','Â¢ÉÁïåÈÅ†Ë∂ÖË°®Èù¢','ÊâÆË±¨ÂêÉËÄÅËôé','Ê∑±Ëóè‰∏çÈú≤',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ©øË∂äÈáçÁîüË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊòØÁ©øË∂äËÄÖ','ÊòØÁï∞‰∏ñÁïå‰æÜÁöÑ','ÊòØÂæûÁèæ‰ª£Á©øË∂äÁöÑ','ÊòØÂæûÊú™‰æÜÁ©øË∂äÁöÑ',
        'ÊòØÈáçÁîüËÄÖ','ÊòØÂõûÂà∞ÈÅéÂéªÁöÑ','ÊòØÈáçÊ¥ª‰∏Ä‰∏ñÁöÑ','Ë®òÂæóÂâç‰∏ñÁöÑ‰∏ÄÂàá',
        'ÊòØÁ≥ªÁµ±ÂÆø‰∏ª','Á∂ÅÂÆö‰∫ÜÁ≥ªÁµ±','ÊúâÈáëÊâãÊåá','ÊúâÂ§ñÊéõ',
        'ÊòØÁé©ÂÆ∂','ÊòØÊõ∏‰∏≠ËßíËâ≤Ë¶∫ÈÜí‰∫Ü','Áü•ÈÅìÂäáÊÉÖËµ∞Âêë','ÊòØÁ©øÊõ∏ÁöÑ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∫∫ÈÄ†ÁîüÂëΩË∫´‰ªΩ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊòØÂÖãÈöÜ‰∫∫','ÊòØË§áË£ΩÈ´î','ÊòØÂØ¶È©óÂìÅ','ÊòØ‰∫∫ÈÄ†‰∫∫',
        'ÊòØÊ©üÂô®‰∫∫','ÊòØAIË¶∫ÈÜíÈ´î','ÊòØ‰ªøÁîü‰∫∫','ÊòØÊîπÈÄ†‰∫∫',
        'ÊòØË©¶ÁÆ°Â¨∞ÂÖí','ÊòØÂü∫Âõ†ÊîπÈÄ†Áî¢Áâ©','ÊòØÁîüÂåñÊ≠¶Âô®','ÊòØË∂ÖÁ¥öÂ£´ÂÖµË®àÂäÉÁî¢Áâ©',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÄßÂà•Ëàá‰∫∫Ê†ºÁßòÂØÜ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂÖ∂ÂØ¶ÊòØÂè¶‰∏ÄÂÄãÊÄßÂà•','Â•≥ÊâÆÁî∑Ë£ù','Áî∑ÊâÆÂ•≥Ë£ù','Èö±ÁûûÁúüÂØ¶ÊÄßÂà•',
        'ÊúâÈõôÈáç‰∫∫Ê†º','È´îÂÖßÊúâÂè¶‰∏ÄÂÄãÈùàÈ≠Ç','Ë¢´ÈôÑË∫´','Ëàá‰ªñ‰∫∫ÂÖ±Áî®Ë∫´È´î',
        'ÂÖ∂ÂØ¶Â∑≤Á∂ìÊ≠ª‰∫ÜÂè™ÊòØ‰∏çÁü•ÈÅì','ÊòØÈ¨º‰ΩÜËá™Â∑±‰∏çÁü•ÈÅì','Ê¥ªÂú®ÂπªË¶∫‰∏≠','‰∏ÄÂàáÈÉΩÊòØÂ§¢',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêË°ÄÁµ±ÁßòÂØÜ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'È´îÂÖßÊúâÈæçÊóèË°ÄËÑà','ÊòØÈæçÁöÑÂæåË£î','Êúâ‰∏äÂè§Ë°ÄËÑà','ÊòØÁ¥îË°ÄÁ®Æ',
        'È´îÂÖßÂ∞ÅÂç∞ËëóÈÇ™Á•û','ÊòØÈÇ™Á•ûÂÆπÂô®','Ë¢´ÈÅ∏ÁÇ∫Á•≠ÂìÅ','ÊòØË©õÂííÁöÑËºâÈ´î',
        'È´îÂÖßÊúâÈÅ†Âè§Á•ûÁç∏','ËàáÈ≠îÊóèÊúâË°ÄÁ∑£','ÊòØÁ•ûÈ≠îÊ∑∑Ë°Ä','ÊòØÁ¶ÅÂøå‰πãÂ≠ê',
        'ÊòØÁ¶ÅÂøå‰πãÊàÄÁöÑÁî¢Áâ©','ÊòØ‰ªá‰∫∫‰πãÂ≠ê','ÊòØ‰∏çË©≤Â≠òÂú®ÁöÑ','Âá∫ÁîüÂ∞±ÊòØÈåØË™§',
        'Ë°ÄÊ∂≤ÊúâÁâπÊÆäËÉΩÂäõ','Ë°ÄËÉΩÊ≤ªÁóÖ','Ë°ÄËÉΩËß£ÊØí','Ë°ÄÊòØÊúÄÂº∑ÁöÑËó•',
        'Ë°ÄÁµ±Ë¢´Ë©õÂíí','Áîü‰æÜÂ∏∂ËëóË©õÂíí','ÂëΩ‰∏≠Ê≥®ÂÆöÊÇ≤Âäá','ÁÑ°Ê≥ïÈÄÉËÑ´ÁöÑÂÆøÂëΩ',
        'ÊòØÊúÄÂæå‰∏ÄÂÄãÁ¥îË°Ä','ÊòØÁÄïÂç±Á®ÆÊóè','ÊòØÊªÖÊóèÁöÑÂÄñÂ≠òËÄÖ','ÊòØÂîØ‰∏ÄÁöÑË°ÄËÑà',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈªëÊöóÈÅéÂéª„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊõæÁ∂ìÊÆ∫ÈÅé‰∫∫','Êâã‰∏äÊ≤æÊªøÈÆÆË°Ä','ÊÆ∫‰∫∫Â¶ÇÈ∫ª','ÊòØÂääÂ≠êÊâã',
        'ÊõæÁ∂ìÊØÄÊªÖÈÅé‰∏ÄÂÄãÂüéÂ∏Ç','ÈÄ†ÊàêÈÅéÂ§ßÂ±†ÊÆ∫','ÊòØÊà∞ÁäØ','ÊòØÊªÖÊóèÁöÑÂá∂Êâã',
        'ÊõæÁ∂ìËÉåÂèõÈÅéÊëØÂèã','Âá∫Ë≥£ÈÅéÂêå‰º¥','ÁÇ∫‰∫ÜÊ¥ªÂëΩÁäßÁâ≤Âà•‰∫∫','Ë∏©ËëóÂà•‰∫∫‰∏ä‰Ωç',
        'ÊõæÁ∂ìÊòØÂèçÊ¥æ','ÂÅöÈÅéÂ£û‰∫ã','ÈªëÊ≠∑Âè≤','‰∏çÂ†™ÂõûÈ¶ñÁöÑÈÅéÂéª',
        'ÊõæÁ∂ìÊòØÈÇ™ÊïôÊàêÂì°','ÂèÉËàáÈÅéÈÇ™ÊÉ°ÂÑÄÂºè','ÁçªÁ•≠ÈÅé‰ªñ‰∫∫','ËàáÈÇ™Á•ûÊúâÁâΩÈÄ£',
        'ÊõæËàáÊÉ°È≠îÁ∞ΩÁ¥Ñ','Âá∫Ë≥£‰∫ÜÈùàÈ≠Ç','Êúâ‰∏çÂèØÈÅïÊäóÁöÑÂ•ëÁ¥Ñ','Ë¢´ÊùüÁ∏õËëó',
        'ÊõæÂú®Âú∞ÁçÑÂæÖÈÅé','ÂéªÈÅéÂÜ•Áïå','Á∂ìÊ≠∑ÈÅéÊ≠ª‰∫°','Ê≠ªËÄåÂæ©Áîü',
        'ÊõæÁ∂ìÊ≠∑ÈÅéÁÑ°Êï∏Ëº™Ëø¥','Ê¥ª‰∫ÜÁÑ°Êï∏‰∏ñ','Ë¶ãË≠âÈÅéÊªÑÊµ∑Ê°ëÁî∞','Ê∞∏ÁîüÁöÑË©õÂíí',
        'ÊõæÁ∂ìÂ§±ÂéªÈÅéË®òÊÜ∂','Ë¢´Ê∂àÈô§‰∫ÜË®òÊÜ∂','Êúâ‰∏ÄÊÆµÁ©∫ÁôΩ','‰∏çÁü•ÈÅìËá™Â∑±ÊòØË™∞',
        'ÈÅéÂéªÊòØÊÆ∫Êâã','ÊòØÊöóÊÆ∫ËÄÖ','ÊòØÊ≠ªÁ•û','ÊòØÂääÂ≠êÊâã',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÊÑüÁΩ™ÈÅé„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊõæÁ∂ìÊÑõÈÅéÊïµ‰∫∫','ÊÑõÈÅé‰∏çË©≤ÊÑõÁöÑ‰∫∫','ËÉåÂèõÈÅéÊÑõ‰∫∫','ËæúË≤†ÈÅéÊ∑±ÊÉÖ',
        'ÊõæÊããÊ£ÑÈÅéÂ≠©Â≠ê','Êúâ‰∏çË™çÁöÑË¶™‰∫∫','ÈÄÉÈÅøÈÅéË≤¨‰ªª','ËôßÊ¨†‰∫ÜÂÆ∂‰∫∫',
        'ÊõæË¶ãÊ≠ª‰∏çÊïë','ÁúºÁùúÁùúÁúãËëó‰∫∫Ê≠ª','Ê≤íËÉΩÊïë‰∏ãÈáçË¶ÅÁöÑ‰∫∫','ÊòØÂÄñÂ≠òËÄÖ',
        'ÊõæÁÇ∫‰∫ÜÊ¥ªÂëΩÂá∫Ë≥£Âêå‰º¥','ÁäßÁâ≤‰∫ÜÂà•‰∫∫','Ë∏èËëóÂ±çÈ™®Ê¥ª‰∏ã‰æÜ','ËÉåË≤†Ëëó‰∫°ËÄÖ',
        'ÂÅöÈÅé‰∏çÂèØÂëä‰∫∫ÁöÑ‰∫§Êòì','Âá∫Ë≥£ÈÅéÂéüÂâá','ÈÅïËÉåÈÅéË™ìË®Ä','Ê¨∫È®ôÈÅé‰ø°‰ªªËá™Â∑±ÁöÑ‰∫∫',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈö±ËóèËÉΩÂäõ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊìÅÊúâÈ†êÁü•ËÉΩÂäõ','ËÉΩÁúãÂà∞Êú™‰æÜ','Áü•ÈÅìÊúÉÁôºÁîü‰ªÄÈ∫º','ÂÖàÁü•',
        'ÊìÅÊúâËÆÄÂøÉË°ì','ËÉΩËÅΩÂà∞‰ªñ‰∫∫ÂøÉËÅ≤','Áü•ÈÅìÊâÄÊúâ‰∫∫Âú®ÊÉ≥‰ªÄÈ∫º','ÁÑ°Ê≥ïÈóúÈñâ',
        'ËÉΩÁúãË¶ãÈ¨ºÈ≠Ç','Èô∞ÈôΩÁúº','ËÉΩË¶ãÂà∞Â∏∏‰∫∫Áúã‰∏çË¶ãÁöÑ','ÈÄöÈùà',
        'ËÉΩÁ©øÊ¢≠Â§¢Â¢É','ÂÖ•Â§¢','ÊìçÊéßÂ§¢Â¢É','Â§¢Â¢ÉË°åËÄÖ',
        'ËÉΩÊìçÊéßÊôÇÈñì','ÊôÇÈñìÁ≥ªËÉΩÂäõ','Êö´ÂÅúÊôÇÈñì','ÊôÇÈñìÂÄíÊµÅ',
        'ÊìÅÊúâÊØÄÊªÖ‰∏ñÁïåÁöÑÂäõÈáè','ÊòØË°åËµ∞ÁöÑÊ†∏ÂΩà','Â§±ÊéßÂ∞±ÊòØÊú´Êó•','Ë¢´Â∞ÅÂç∞ÁöÑÂäõÈáè',
        'ÊìÅÊúâËµ∑Ê≠ªÂõûÁîüÁöÑËÉΩÂäõ','ËÉΩÂæ©Ê¥ªÊ≠ªËÄÖ','ÈÄÜËΩâÁîüÊ≠ª','Ê≠ªÁ•û',
        'ÊìÅÊúâÊ≠ª‰∫°ÂõûÊ∫Ø','Ê≠ªÂæåËÉΩÈáç‰æÜ','ÁÑ°ÈôêÂæ©Ê¥ª','Â≠òÊ™îËÆÄÊ™î',
        'ËÉΩËàáÂãïÁâ©‰∫§ÊµÅ','ËÉΩËÅΩÊáÇÁç∏Ë™û','ËÉΩÊìçÊéßÂãïÁâ©','Ëê¨Áç∏‰πãÁéã',
        'ËÉΩ‰ΩøÁî®Á¶ÅË°ì','ÊéåÊè°Á¶ÅÂøå‰πãÂäõ','ÊúÉË¢´Â§©ÈÅìËøΩÊÆ∫','‰ª£ÂÉπÂ∑®Â§ß',
        'Ë∫´È´îÈáåÂ∞ÅÂç∞ËëóÂº∑Â§ßÂ≠òÂú®','ÊòØÂÆπÂô®','ÊòØÂô®Áöø','ÂÖßÊúâÂ§ß‰Ω¨',
        'ÂäõÈáè‰∏ÄÁõ¥Âú®Â£ìÂà∂‰∏≠','Âè™Â±ïÁèæ‰∫Ü‰∏ÄÊàê','ÁúüÊ≠£ÂØ¶ÂäõÊ∑±‰∏çÂèØÊ∏¨',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÉÖÊÑüÁßòÂØÜ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊöóÊàÄËëóÊüê‰∫∫','ÂñÆÁõ∏ÊÄù','ÊÑõËÄå‰∏çÊï¢Ë™™','ÈªòÈªòÂÆàË≠∑',
        'ÊõæÁ∂ìÊ∑±ÊÑõÈÅé‰ªáÊïµ','ÊÑõ‰∏ä‰∫Ü‰∏çË©≤ÊÑõÁöÑ‰∫∫','Á¶ÅÂøå‰πãÊàÄ','ÈåØË™§ÁöÑÊÑüÊÉÖ',
        'Êúâ‰∏ÄÊÆµ‰∏çËÉΩË™™ÁöÑÊàÄÊÉÖ','ÁßòÂØÜÊàÄÊÑõ','Âú∞‰∏ãÊÉÖ','‰∏çË¢´Á•ùÁ¶èÁöÑÊÑõ',
        'ÊúâÁßÅÁîüÂ≠ê','ÊúâÂ≠©Â≠ê‰ΩÜÊ≤íÂÖ¨Èñã','Èö±Áûû‰∫ÜÂæå‰ª£','‰∏çÁü•ÈÅìËá™Â∑±ÊúâÂ≠©Â≠ê',
        'ÊõæË¢´ÊÑõ‰∫∫ËÉåÂèõ','Ë¢´ÊããÊ£ÑÈÅé','Ë¢´ËæúË≤†ÈÅé','ÊÑõÊÉÖÂâµÂÇ∑',
        'ÂÖ∂ÂØ¶ÊÅ®ËëóË°®Èù¢Ë¶™ËøëÁöÑ‰∫∫','Á¨ëË£°ËóèÂàÄ','Ë°®Èù¢ÂíåÂñÑÂÖßÂøÉÊÜéÊÅ®',
        'ÂÅáË£ùÊÑõËëó‰∏çÊÑõÁöÑ‰∫∫','ÈÄ¢Â†¥‰ΩúÊà≤','Âà©Áî®ÊÑüÊÉÖ','ÊîøÊ≤ªÂ©öÂßª',
        'ÁÇ∫ÊÑõÂÅöÈÅéÁòãÁãÇÁöÑ‰∫ã','ÁÇ∫ÊÑõÊÆ∫‰∫∫','ÁÇ∫ÊÑõËÉåÂèõ‰∏ÄÂàá','ÁÇ∫ÊÑõÁçªÂá∫ÁîüÂëΩ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁèæ‰ª£Ë∫´‰ªΩÁßòÂØÜ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊòØÁ∂≤Á¥ÖÁöÑÂ∞èËôü','ÊòØÂåøÂêçÂ§ßV','ÊúâÁßòÂØÜÂ∏≥Ëôü','ÊòØÁü•ÂêçÂçö‰∏ª',
        'ÊòØÂåøÂêç‰ΩúÂÆ∂','ÊòØÊö¢Èä∑Êõ∏‰ΩúËÄÖ','ÊòØÁ•ûÁßòÁöÑÂâµ‰ΩúËÄÖ','Á≠ÜÂêçÁÑ°‰∫∫Áü•Êõâ',
        'ÊúâÈæêÂ§ßÁöÑÁßòÂØÜË≤°Áî¢','ÊòØÈö±ÂΩ¢ÂØåË±™','ÂÖ∂ÂØ¶ÂæàÊúâÈå¢','Ë£ùÁ™Æ',
        'ÊòØÂú∞‰∏ãÂã¢ÂäõÁöÑÈáë‰∏ª','ËÉåÂæåÊòØÈªëÈÅì','Êúâ‰∏ç‰πæÊ∑®ÁöÑÈóú‰øÇ','ÁÅ∞Ëâ≤Êî∂ÂÖ•',
        'ÊúâÊµ∑Â§ñÁßòÂØÜË∫´‰ªΩ','ÈõôÈáçÂúãÁ±ç','Âè¶‰∏ÄÂÄãË∫´‰ªΩ','ÈÄÉ‰∫°Âú®Â§ñ',
        'Âæû‰∫ãÁÅ∞Ëâ≤ËÅ∑Ê•≠','ÊòØÈß≠ÂÆ¢','ÊòØË©êÈ®ôÁäØ','ÊòØÊ¥óÈå¢ÁöÑ','ÊòØËµ∞ÁßÅÁöÑ',
        'Âú®ÊöóÁ∂≤ÊúâË∫´‰ªΩ','ÊòØÊöóÁ∂≤Â§ß‰Ω¨','‰∫§ÊòìÈÅéÈÅïÁ¶ÅÂìÅ','Ë¶ã‰∏çÂæóÂÖâ',
        'ÊéåÊè°Êüê‰∫∫ÁöÑÊääÊüÑ','Êè°ÊúâË≠âÊìö','Áü•ÈÅìÁßòÂØÜ','ËÉΩÂ®ÅËÑÖÂà•‰∫∫',
        'Áü•ÈÅìÊüêÂÄãÈ©öÂ§©Â§ßÁßòÂØÜ','ÊòØÁü•ÊÉÖËÄÖ','ÊòØÁõÆÊìäËÄÖ','Ë¢´ÊªÖÂè£ÂêçÂñÆ‰∏äÁöÑ‰∫∫',
        'Ë¢´Â®ÅËÑÖ‰øùÂÆàÁßòÂØÜ','Ë¢´Ë¶ÅÊåæ','ÊúâÊääÊüÑÂú®Âà•‰∫∫ÊâãË£°','Ë∫´‰∏çÁî±Â∑±',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∏ñÁïåÁúüÁõ∏ÁßòÂØÜ„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ËàáÁ•ûÁ∞ΩË®Ç‰∫ÜÂ•ëÁ¥Ñ','ËàáÂ§©ÈÅìÊúâÁ¥ÑÂÆö','ÊòØÁ•ûÁöÑÊ£ãÂ≠ê','ËÉåË≤†Ëëó‰ΩøÂëΩ',
        'Áü•ÈÅì‰∏ñÁïåÁöÑÁúüÁõ∏','Áü•ÈÅìÈÄôÊòØÂ∞èË™™','Áü•ÈÅìÈÄôÊòØÈÅäÊà≤','Ê∏ÖÈÜíËÄÖ',
        'Ë¶ãÈÅéÂâµ‰∏ñÁöÑÂ†¥ÊôØ','Ë¶ãË≠âÈÅé‰∏ñÁïåË™ïÁîü','Áü•ÈÅì‰∏ÄÂàáÁöÑËµ∑Ê∫ê','‰∏äÂè§Ë®òÊÜ∂',
        'Ë®òÂæóÂâç‰∏ñÊâÄÊúâË®òÊÜ∂','Ëº™Ëø¥Ë®òÊÜ∂','ÁÑ°Êï∏‰∏ñÁöÑË®òÊÜ∂','Ê∞∏ÊÅÜÁöÑË®òÊÜ∂',
        'ÊòØÂæûÊú™‰æÜ‰æÜÁöÑ','ÊòØÊú™‰æÜ‰∫∫','Áü•ÈÅìÊ≠∑Âè≤Ëµ∞Âêë','Á©øË∂äÊôÇÈñìÁ∑ö',
        'ÊòØÂæûÂπ≥Ë°å‰∏ñÁïå‰æÜÁöÑ','ÊòØÂè¶‰∏ÄÂÄã‰∏ñÁïåÁöÑ','Á∂≠Â∫¶ÊóÖË°åËÄÖ','‰ΩçÈù¢Ë°åËÄÖ',
        'Ê¥ª‰∫ÜÂπæÁôæÂπ¥','‰∏çËÄÅ‰∏çÊ≠ª','Ë¶ãË≠â‰∫ÜÊ≠∑Âè≤','Ê∞∏ÁîüËÄÖ',
        'Á∂ìÊ≠∑ÈÅé‰∏ñÁïåÊØÄÊªÖ','Êú´Êó•ÂÄñÂ≠òËÄÖ','Ë¶ãÈÅéÁµÇÁµê','Áü•ÈÅì‰∏ñÁïåÊúÉÊÄéÈ∫ºÊªÖ‰∫°',
        'Áü•ÈÅìÊâÄÊúâ‰∫∫ÁöÑÂëΩÈÅã','ÂëΩÈÅãËßÄÊ∏¨ËÄÖ','ËÉΩÁúãÂà∞Ê≠ªÊúü','Áü•ÈÅìÁµêÂ±Ä'
      ];

      // ========== ‰∫∫ÈöõÈóú‰øÇÈÅ∏È†ÖÔºàÂ§ßÂπÖÊì¥ÂÖÖÔºâ==========
      const relationOptions = [
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁõ¥Á≥ªË°ÄË¶™„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Áà∂ÊØçËàáÂ≠êÂ•≥','ÂñÆË¶™ÂÆ∂Â∫≠','ÁπºÁà∂ÁπºÊØç','È§äÁà∂È§äÊØç','ÁîüÁà∂ÁîüÊØç',
        'Â§±Êï£Â§öÂπ¥ÁöÑË¶™‰∫∫','ÂæûÂ∞èÂàÜÈõ¢','Ë¢´ÊãêËµ∞ÁöÑÂ≠©Â≠ê','Ë¢´Ë™øÊèõÁöÑÂ¨∞ÂÖí',
        'Èö±ÁûûÁöÑË¶™Â≠êÈóú‰øÇ','ÁßÅÁîüÂ≠ê','‰∏çË¢´ÊâøË™çÁöÑÂ≠©Â≠ê','Ë¶ã‰∏çÂæóÂÖâÁöÑË°ÄËÑà',
        'Á•ñÂ≠´Èóú‰øÇ','Èöî‰ª£Êí´È§ä','Â§™Áà∫Áà∫Ëº©ÁöÑÂ≠òÂú®','Ë∑®Ë∂äÊôÇÁ©∫ÁöÑÁ•ñÂ≠´',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÖÑÂºüÂßêÂ¶π„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ë¶™ÂÖÑÂºüÂßêÂ¶π','ÈæçÈ≥≥ËÉé','ÈõôËÉûËÉé','Â§öËÉûËÉé','Âπ¥ÈΩ°Â∑ÆË∑ùÂ§ßÁöÑÂÖÑÂºüÂßêÂ¶π',
        'ÂêåÁà∂Áï∞ÊØç','ÂêåÊØçÁï∞Áà∂','Á¥†Êú™Ë¨ÄÈù¢ÁöÑÊâãË∂≥','Â§±Êï£ÁöÑÂ≠øÁîü',
        'ÁπºÂÖÑÂºüÂßêÂ¶π','Áæ©ÂÖÑÂºüÂßêÂ¶π','ÁµêÊãúÂÖÑÂºü','ÁµêÁæ©ÂßêÂ¶π','ÊãúÊääÂ≠ê',
        'ÂÖÑÂºüÈ¨©ÁâÜ','ÂßêÂ¶πÂèçÁõÆ','ÊâãË∂≥Áõ∏ÊÆò','È™®ËÇâÁõ∏Áà≠',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÖ∂‰ªñË¶™Êàö„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Âèî‰ºØÂßëËàÖÂß®','Ë°®ÂÖÑÂºüÂßêÂ¶π','Â†ÇÂÖÑÂºüÂßêÂ¶π','ÈÅ†ÊàøË¶™Êàö',
        'ÂÖ∂ÂØ¶ÊòØÈÅ†ÊàøË¶™Êàö','Èö±ËóèÁöÑË°ÄÁ∑£','ÂêåÊóè','ÂêåÂÆó',
        'ÂÅΩË£ùÁöÑÂÆ∂‰∫∫','ÂÜíÂÖÖÁöÑË¶™‰∫∫','ÂÅáÁöÑÂÆ∂‰∫∫','ÂÖ•Ë¥Ö','ÊãõË¶™',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈùíÊ¢ÖÁ´πÈ¶¨È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÈùíÊ¢ÖÁ´πÈ¶¨','ÂÖ©Â∞èÁÑ°Áåú','‰∏ÄËµ∑Èï∑Â§ß','ÂæûÂ∞èË™çË≠ò',
        'ÈÑ∞Â±ÖÂÆ∂ÁöÑÂ≠©Â≠ê','ÊåáËÖπÁÇ∫Â©ö','Â®ÉÂ®ÉË¶™','‰∏ñ‰∫§‰πãÂ•Ω',
        'Â∞èÊôÇÂÄôË®ÇÁöÑÂ©öÁ¥Ñ','ÂÖíÊôÇÁöÑÁ¥ÑÂÆö','Á´•Âπ¥ÁöÑÊâøË´æ','ÂàªÂú®Ê®π‰∏äÁöÑË™ìË®Ä',
        'Èï∑Â§ßÂæåÈáçÈÄ¢','Â§öÂπ¥ÂæåÂÜçË¶ã','Áâ©ÊòØ‰∫∫Èùû','‰Ω†ÈÇÑË®òÂæóÊàëÂóé',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∏ÄË¶ãÈçæÊÉÖÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏ÄË¶ãÈçæÊÉÖ','‰∏ÄÁúºËê¨Âπ¥','ÂàùË¶ãÂÇæÂøÉ','Ë¶ãËâ≤Ëµ∑ÊÑè',
        'ÂëΩ‰∏≠Ê≥®ÂÆö','Á∑£ÂàÜÂ§©ÂÆö','Á¥ÖÁ∑öÁâΩÂºï','Â§©Áîü‰∏ÄÂ∞ç',
        'ÊïëÂëΩ‰πãÊÅ©‰ª•Ë∫´Áõ∏Ë®±','Ëã±ÈõÑÊïëÁæé','ÁæéÊïëËã±ÈõÑ','Á™ÆÈÄîÊú´Ë∑ØË¢´Êî∂Áïô',
        'Á¥†‰∏çÁõ∏Ë≠òÂçªËé´Âêç‰ø°‰ªª','ÈôåÁîüÁöÑÁÜüÊÇâÊÑü','‰ººÊõæÁõ∏Ë≠ò','Ââç‰∏ñÁöÑÁâΩÁµÜ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊó•‰πÖÁîüÊÉÖÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Êó•‰πÖÁîüÊÉÖ','ÊÇ£Èõ£Ë¶ãÁúüÊÉÖ','ÂÖ±ÊÇ£Èõ£','ÂêåÁîüÂÖ±Ê≠ª',
        'ÂæûË®éÂé≠Âà∞ÂñúÊ≠°','Ê≠°ÂñúÂÜ§ÂÆ∂','‰∏çÊâì‰∏çÁõ∏Ë≠ò','ÂêµËëóÂêµËëóÂ∞±Âú®‰∏ÄËµ∑‰∫Ü',
        'ÂæûÈôåÁîüÂà∞ÁÜüÊÇâ','Êº∏Êº∏ÁøíÊÖ£‰Ω†ÁöÑÂ≠òÂú®','‰ªÄÈ∫ºÊôÇÂÄôÈñãÂßãÂú®ÊÑè‰Ω†ÁöÑ',
        'ÂèãÈÅî‰ª•‰∏äÊàÄ‰∫∫Êú™Êªø','ÊõñÊòß‰∏çÊòé','Ëã•Âç≥Ëã•Èõ¢','Ê¨≤Ë™™ÈÇÑ‰ºë',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁ¶ÅÂøå‰πãÊàÄÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á¶ÅÂøå‰πãÊàÄ','‰∏çÂÄ´‰πãÊàÄ','Â∏´ÁîüÊàÄ','‰∏ªÂÉïÊàÄ','Âπ¥ÈΩ°Â∑Æ',
        'Ë∑®Ë∂äÁ®ÆÊóèÁöÑÊÑõÊÉÖ','‰∫∫Â¶ñÊÆäÈÄî','‰∫∫È¨ºÊÉÖÊú™‰∫Ü','‰∫∫Á•û‰πãÊàÄ',
        'ÊïµÂ∞çÈô£ÁáüÁöÑÊàÄ‰∫∫','ÁæÖÂØÜÊ≠êËàáËå±È∫óËëâ','ÊÑõ‰∏ä‰∫Ü‰∏çË©≤ÊÑõÁöÑ‰∫∫',
        '‰ªá‰∫∫‰πãÂ≠ê/Â•≥','ÊÑõ‰∏ä‰ªá‰∫∫','Áõ∏ÊÑõÁõ∏ÊÆ∫','ÂèàÊÑõÂèàÊÅ®',
        'ÂåÖËæ¶Â©öÁ¥Ñ','ÊîøÊ≤ªËÅØÂßª','ÂíåË¶™','Âà©ÁõäÂ©öÂßª','ÂïÜÊ•≠ËÅØÂßª',
        'ÂêåÊÄßÊÑõ‰∫∫','Èö±ÁßòÁöÑÊàÄÊÉÖ','‰∏çË¢´Êé•ÂèóÁöÑÊÑõ','ÁÇ∫ÊÑõÂ∞çÊäó‰∏ñÁïå',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂñÆÊàÄÊöóÊàÄÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊöóÊàÄÂ§öÂπ¥','ÂñÆÁõ∏ÊÄù','ÊÑõËÄå‰∏çÂæó','Âæó‰∏çÂà∞ÁöÑÊ∞∏ÈÅ†Âú®È®∑Âãï',
        'ÈªòÈªòÂÆàË≠∑','ÈÅ†ÈÅ†ÁúãËëóÂ∞±Â•Ω','Âè™Ë¶Å‰Ω†Âπ∏Á¶è','ÊàêÂÖ®‰Ω†ÂíåÂà•‰∫∫',
        'ÂÇôËÉé','Á¨¨‰∫åÈÅ∏Êìá','Ê∞∏ÈÅ†ÁöÑÊúãÂèãÂçÄ','Ë¢´ÁôºÂ•Ω‰∫∫Âç°',
        'ÈåØÈÅé','‰æÜ‰∏çÂèäË™™Âá∫Âè£','‰∏ÄÁõ¥Á≠âÂæÖ','Á≠â‰∏ÄÂÄã‰∏çÊúÉÂõû‰æÜÁöÑ‰∫∫',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊÑüÊÉÖÁ≥æËëõÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏âËßíÊàÄ','Â§öËßíÈóú‰øÇ','ÊÉÖÊïµ','Êê∂Â•™ÊàÄ‰∫∫',
        'Ââç‰ªª','Áèæ‰ªª','Â∞è‰∏â','‰ªãÂÖ•ËÄÖ',
        'ÂàÜÊâãÂæåÂÜçÁõ∏ÈÅá','ËàäÊÉÖÂæ©ÁáÉ','Á†¥Èè°ÈáçÂúì','ÂíåÂ•ΩÂ¶ÇÂàù',
        'Ë¢´ÊÑõ‰∫∫ËÉåÂèõ','Ë¢´ÊããÊ£Ñ','Ë¢´ÂäàËÖø','‰ø°‰ªªÂ¥©Â°å',
        'ÁÇ∫ÊÑõÊîæÊ£Ñ‰∏ÄÂàá','ÊÑõÂà∞ÂçëÂæÆ','Â§±ÂéªËá™Êàë','ÊÇ£ÂæóÊÇ£Â§±',
        'Áï∞Âú∞ÊàÄ','Á∂≤ÊàÄ','Ë∑®ÂúãÊàÄ','ÊôÇÂ∑ÆÊàÄÊÑõ',
        'ËôêÊàÄ','ÁóÖÊÖã‰æùÊàÄ','ÊéßÂà∂Ê¨≤','‰ΩîÊúâÊ¨≤','‰Ω†ÊòØÊàëÁöÑ',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÊëØÂèãÁü•Â∑±È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÊúÄÂ•ΩÁöÑÊúãÂèã','Èñ®Ëúú','ÂÖÑÂºü','ÈêµÂì•ÂÄë','Ê≠ªÈª®',
        'ÊÇ£Èõ£‰πã‰∫§','ÁîüÊ≠ª‰πã‰∫§','ÈÅéÂëΩÁöÑ‰∫§ÊÉÖ','‰∏ÄËµ∑ÊâõÈÅéÊßç',
        'Áü•Â∑±','ÈùàÈ≠Ç‰º¥‰æ∂','ÊúÄÊáÇÊàëÁöÑ‰∫∫','ÁÑ°Ë©±‰∏çË´á',
        'ÊõæÁ∂ìÊïëÂëΩÊÅ©‰∫∫','ÊõæË¢´Â∞çÊñπÊïëÈÅé','‰ª•ÂëΩÊèõÂëΩ','ÁîüÊ≠ªËàáÂÖ±',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêË°®Èù¢ÊúãÂèãÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Ë°®Èù¢ÊúãÂèã','Â°ëËÜ†ÂßêÂ¶π','ÈÖíËÇâÊúãÂèã','Âà©Áõä‰πã‰∫§',
        'ÈªûÈ†≠‰πã‰∫§','Ê≥õÊ≥õ‰πã‰∫§','Ë™çË≠ò‰ΩÜ‰∏çÁÜü','Ë¶ãÈù¢ÊâìÊãõÂëº',
        'Âà©ÁõäÂêåÁõü','‰∫íÁõ∏Âà©Áî®','ÂêÑÂèñÊâÄÈúÄ','ÂêàÂâáËÅöÊï£ÂâáÈõ¢',
        'ÂÖ±ÂêåÁßòÂØÜ','ÊúâÊääÊüÑÂú®Â∞çÊñπÊâã‰∏ä','‰∫íÁõ∏ÁâΩÂà∂','‰∫íÁõ∏ÂøåÊÜö',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂèçÁõÆÊàê‰ªáÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÁúüÂøÉÊèõÁµïÊÉÖ','ÊúãÂèãËÆä‰ªá‰∫∫','ÂèçÁõÆÊàê‰ªá','ÂΩ¢ÂêåÈôåË∑Ø',
        'Êº∏Ë°åÊº∏ÈÅ†','Ëµ∞Êï£‰∫Ü','‰∏çÂÜçËÅØÁπ´','ËÄÅÊ≠ª‰∏çÁõ∏ÂæÄ‰æÜ',
        'Ë™§ÊúÉ','Ëß£‰∏çÈñãÁöÑÂøÉÁµê','Ë™™‰∏çÊ∏ÖÁöÑÂæÄ‰∫ã','ÂêÑÂü∑‰∏ÄË©û',
        'ËÉåÂèõ','Âá∫Ë≥£','ËêΩ‰∫ï‰∏ãÁü≥','ÂèçÊàà‰∏ÄÊìä',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂ∏´ÂæíÂÇ≥ÊâøÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Â∏´Âæí','Â∏´Áà∂ËàáÂæíÂºü','ÊéåÈñÄËàáÂºüÂ≠ê','ÂâçËº©ËàáÂæåËº©',
        'Â∏´ÂÖÑÂºü','Â∏´ÂßêÂ¶π','ÂêåÈñÄ','Âêå‰∏ÄÂÄãÂ∏´Áà∂',
        'Â§ßÂ∏´ÂÖÑ','ÈóúÈñÄÂºüÂ≠ê','ÂÖ•ÂÆ§ÂºüÂ≠ê','Ë®òÂêçÂºüÂ≠ê',
        'ÁπºÊâøË°£ÁºΩ','ÂÇ≥ÊéàÁµïÂ≠∏','ÁßòÂØÜÊïôÂ∞é','ÂÇæÂõäÁõ∏Êéà',
        'ÂêçÁæ©‰∏äÁöÑÂæíÂºü','ÊéõÂêçÂºüÂ≠ê','Âè™ÊòØË°®Èù¢','Âè¶ÊúâÂ∏´Êâø',
        'Â∏´ÁîüËΩâÁÇ∫ÊàÄ‰∫∫','Ë∂ÖË∂äÂ∏´ÂæíÁöÑÊÑüÊÉÖ','‰∫¶Â∏´‰∫¶Áà∂','Â¶ÇÁà∂Â¶ÇÂÖÑ',
        'ÂèõÂá∫Â∏´ÈñÄ','Ê¨∫Â∏´ÊªÖÁ•ñ','ÂºíÂ∏´','ÊÅ©Êñ∑Áæ©Áµï',
        'Â∞çÂ∏´Áà∂ÂèàÊï¨ÂèàÊÅ®','ÊÑõÊÅ®‰∫§Áπî','Á≥æËëõ‰∏çÊ∏Ö',
        'Â∏´ÂæíÂèçÁõÆ','Ë∂ÖË∂äÂ∏´Áà∂','ÈùíÂá∫ÊñºËóç','ÂæíÂºüÊâìÊïóÂ∏´Áà∂',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∏ªÂæûÊïàÂø†È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∏ª‰∫∫ËàáÂÉïÂæû','‰∏ªÂ≠êËàáÂ•¥Êâç','Â∞ëÁà∫Â∞èÂßêËàá‰∏´È¨üÂ∞èÂªù',
        'ÂêõÁéãËàáËá£Â≠ê','Â∏ùÁéãËàáÂ∞áËªç','ÁöáÂ∏ùËàáËøëËá£','ÁéãËàáÈ®éÂ£´',
        'È†ò‰∏ªËàáÈ®éÂ£´','Â∞áËªçËàáÂ£´ÂÖµ','È†≠È†òËàáÈÉ®‰∏ã','ËÄÅÂ§ßËàáÂ∞èÂºü',
        'Èõá‰∏ªËàáÂì°Â∑•','ËÄÅÈóÜËàáÊâìÂ∑•‰∫∫','Áî≤ÊñπËàá‰πôÊñπ',
        '‰∏ª‰∫∫ËàáÂ•ëÁ¥ÑËÄÖ','Âè¨ÂñöÂ∏´ËàáÂè¨ÂñöÁç∏','È¶¥Áç∏Â∏´ËàáÈùàÁç∏',
        'Á•ûËàá‰ø°Âæí','Êïô‰∏ªËàáÊïôÂæí','Á•ûÁà∂Ëàá‰ø°Áúæ',
        'Á≥ªÁµ±ËàáÂÆø‰∏ª','AIËàá‰ΩøÁî®ËÄÖ','ÂâµÈÄ†ËÄÖËàáË¢´ÈÄ†Áâ©',
        'ÊïàÂø†','Ë™ìÊ≠ªËøΩÈö®','‰ª•ÂëΩÁõ∏Ë≠∑','ÁÇ∫‰∏ªËµ¥Ê≠ª',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂÆøÊïµ‰ªáÊÅ®È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂÆøÊïµ','‰∏ÄÁîü‰πãÊïµ','ÂëΩ‰∏≠Ê≥®ÂÆöÁöÑÂ∞çÊâã','Ê≠§ÁîüÂøÖÈ†àÊâìÊïóÁöÑ‰∫∫',
        '‰∏ñ‰ªá','ÂÆ∂Êóè‰∏ñ‰ªá','ÈñÄÊ¥æ‰∏ñ‰ªá','Âúã‰ªáÂÆ∂ÊÅ®',
        'ÊÆ∫Áà∂/ÊØç‰πã‰ªá','ÊªÖÈñÄ‰πã‰ªá','Â•™Â¶ª/Â§´‰πãÊÅ®','ÊØÄÊàë‰∏ÄÂàá',
        '‰∏çÂÖ±Êà¥Â§©','‰Ω†Ê≠ªÊàëÊ¥ª','Êúâ‰Ω†Ê≤íÊàë','‰∏ÄÂ±±‰∏çÂÆπ‰∫åËôé',
        'Á´∂Áà≠Â∞çÊâã','ÂïÜÊ•≠Â∞çÊâã','ÊÉÖÊïµ','ËÅ∑Â†¥Â∞çÊâã','ÊîøÊïµ',
        'Êöó‰∏≠ËºÉÂãÅ','ÊòéÁà≠ÊöóÈ¨•','‰∫íÁõ∏Áúã‰∏çÈ†ÜÁúº','ÈáùÈãíÁõ∏Â∞ç',
        'Ë°®Èù¢ÂíåÂπ≥ÂØ¶ÂâáÂ∞çÁ´ã','Á¨ëË£°ËóèÂàÄ','ÂêÑÊá∑È¨ºËÉé','ËôõËàáÂßîËõá',
        'Ë¢´Ëø´ÊïµÂ∞ç','Ë∫´‰∏çÁî±Â∑±','ÂêÑÁÇ∫ÂÖ∂‰∏ª','Á´ãÂ†¥‰∏çÂêå',
        'Âõ†Ë™§ÊúÉÊàê‰ªá','Êú¨‰∏çË©≤ÊòØÊïµ‰∫∫','Èô∞Â∑ÆÈôΩÈåØ','Ë¢´‰∫∫ÊåëÊí•',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „Äê‰∫¶Êïµ‰∫¶ÂèãÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        '‰∫¶Êïµ‰∫¶Âèã','Âêà‰ΩúËàáÂ∞çÊäó','‰∫íÁõ∏Ê¨£Ë≥ûÁöÑÂ∞çÊâã','ÊÉ∫ÊÉ∫Áõ∏ÊÉú',
        'Ë°®Èù¢‰ªáÊïµÂØ¶ÂâáÂêà‰Ωú','Êöó‰∏≠ËÅØÊâã','ÂÖ±ÂêåÁöÑÊïµ‰∫∫','Êïµ‰∫∫ÁöÑÊïµ‰∫∫ÊòØÊúãÂèã',
        '‰∫íÁõ∏Âà©Áî®','ÂêÑÂèñÊâÄÈúÄ','Ëá®ÊôÇÂêåÁõü','Âà©Áõä‰∏ÄËá¥',
        '‰∫íÁõ∏ÁåúÂøåÂçªÂèàÂêà‰Ωú','‰ø°‰ªªÂèàÈò≤ÂÇô','Âêà‰Ωú‰ΩÜ‰øùÊåÅË∑ùÈõ¢',
        'ÂëΩÈÅãÁ∂ÅÂÆö','‰∏ÄÊ¶Æ‰ø±Ê¶Æ‰∏ÄÊêç‰ø±Êêç','ÈÄ£Âùê','ÁâΩ‰∏ÄÈ´ÆÂãïÂÖ®Ë∫´',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÈùàÈ≠ÇÁæàÁµÜÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÈùàÈ≠ÇÈÄ£Áµê','ÂøÉÈùàÊÑüÊáâ','ËÉΩÊÑüÁü•Â∞çÊñπ','ÂøÉÊúâÈùàÁäÄ',
        'ÂÖ±Áî®‰∏ÄÂÄãË∫´È´î','Ëº™ÊµÅÊéßÂà∂','‰Ω†‰∏≠ÊúâÊàëÊàë‰∏≠Êúâ‰Ω†',
        '‰∏ÄÊñπÊòØÂè¶‰∏ÄÊñπÁöÑÂàÜË∫´','ÂΩ±Â≠ê','Èè°ÂÉè','Âè¶‰∏ÄÂÄãËá™Â∑±',
        '‰∫íÁÇ∫Â∞çÊñπÁöÑÂÖâËàáÊöó','‰∏ÄÈ´îÂÖ©Èù¢','Áõ∏ÁîüÁõ∏ÂÖã','ÂëΩÈÅãÂ∞çÁ´ã',
        'Â•ëÁ¥ÑÈóú‰øÇ','ÈùàÈ≠ÇÂ•ëÁ¥Ñ','Ë°ÄÂ•ë','‰∏çÂèØÈÅïËÉåÁöÑÁ¥ÑÂÆö',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÂëΩÈÅãÁ≥æÁ∫èÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂëΩÈÅãÁöÑÁæàÁµÜ','ÂÜ•ÂÜ•‰∏≠Ê≥®ÂÆö','Á¥ÖÁ∑öÁâΩÂºï','Âä´Êï∏Èõ£ÈÄÉ',
        'Ëº™Ëø¥‰∏≠ÂèçË¶ÜÁõ∏ÈÅá','ÊØè‰∏Ä‰∏ñÈÉΩÊúÉÈÅáË¶ã','ÈÄÉ‰∏çÈñãÁöÑÂõ†Êûú',
        '‰∏çÂêåÊôÇÁ©∫ÁöÑÂêå‰∏Ä‰∫∫','Âπ≥Ë°å‰∏ñÁïåÁöÑËá™Â∑±','Âè¶‰∏ÄÂÄãÁâàÊú¨ÁöÑÊàë',
        'Êú™‰æÜÁöÑËá™Â∑±','ÈÅéÂéªÁöÑËá™Â∑±','ÊôÇÈñìÁ∑ö‰∏äÁöÑÁõ∏ÈÅá',
        'Á©øË∂äÂâçÂ∞±Ë™çË≠ò','Êõ∏‰∏≠ËÆÄÈÅéÂ∞çÊñπÁöÑÊïÖ‰∫ã','Â§¢‰∏≠Ë¶ãÈÅé','‰ººÊõæÁõ∏Ë≠ò',
        'ËΩâ‰∏ñÁöÑË¶™‰∫∫','Ââç‰∏ñÁöÑÊàÄ‰∫∫','‰∏äËº©Â≠êÁöÑ‰ªá‰∫∫','Âõ†ÊûúËº™Ëø¥',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁµÑÁπîÂêåÂÉöÈ°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'ÂêåÈñÄ','Âêå‰∫ã','ÂêåÂ≠∏','ÂêåÁ™ó','ÂêåÁè≠ÂêåÂ≠∏',
        'ÂÆ§Âèã','ËàçÂèã','ÈÑ∞Â±Ö','Ê®ì‰∏äÊ®ì‰∏ã','ÈöîÂ£Å',
        'Âêå‰∏ÄÂÄãÁµÑÁπîÊàêÂì°','Êà∞Âèã','ÈöäÂèã','Âêå‰º¥','Â§•‰º¥',
        'Âêà‰ΩúÂ§•‰º¥','ÁîüÊÑèÂ§•‰º¥','ÂâµÊ•≠Â§•‰º¥','ÊãçÊ™î',
        'ÊäïË≥áÈóú‰øÇ','ÂÇµÂãôÈóú‰øÇ','Ê¨†Èå¢ÁöÑ','Ë¢´Ê¨†Èå¢ÁöÑ',
        'Ëá®ÊôÇÁµÑÈöä','Ë¢´Ëø´Âêà‰Ωú','ÂãâÂº∑ÊπäÂêà','‰∏çÂæó‰∏ç‰∏ÄËµ∑',
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê „ÄêÁèæ‰ª£Á§æ‰∫§È°û„Äë‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'Á∂≤Âèã','Á∂≤ÊàÄÂ∞çË±°','ÂæûÊú™Ë¶ãÈÅéÈù¢','Âè™Âú®Á∂≤‰∏äË™çË≠ò',
        'Á≤âÁµ≤ËàáÂÅ∂ÂÉè','ËøΩÊòü','È£ØÂúà','Á´ôÂßê',
        'Áõ¥Êí≠ÈñìË™çË≠ò','ÂΩàÂπïËÅäÂ§©','ÊâìË≥ûÈóú‰øÇ','Ê¶ú‰∏ÄÂ§ßÂì•',
        'ÈÅäÊà≤ÈöäÂèã','ÈñãÈªë','Á∂≤ÈÅäÂ§´Â¶ª','ÂÖ¨ÊúÉÊàêÂì°',
        'Áõ∏Ë¶™Â∞çË±°','‰ªãÁ¥πË™çË≠ò','Áà∂ÊØçÂÆâÊéí','Ë¢´ÂÇ¨Â©ö',
        'Ââç‰ªªÁöÑÊúãÂèã','Èñ®ËúúÁöÑÂâç‰ªª','ÊúãÂèãÁöÑÊúãÂèã','ÂúàÂ≠êÂ§™Â∞è',
        'ÈÜ´ÊÇ£Èóú‰øÇ','ÂæãÂ∏´ËàáÂßîË®ó‰∫∫','Ë®òËÄÖËàáÁ∑ö‰∫∫','Ë≠¶ÂØüËàáÁ∑ö‰∫∫',
        'ÊàøÊù±ËàáÁßüÂÆ¢','Âø´ÈÅûÂ∞èÂì•','Â§ñË≥£Âì°','Â∏∏ÂéªÁöÑÂ∫óÁöÑÂ∫óÂì°'
      ];

      // ==================== Â°´ÂÖÖ Datalist ====================
      function populateDatalist(listId, options) {
        const datalist = document.getElementById(listId);
        if (datalist) {
          datalist.innerHTML = options.map(opt => `<option value="${opt}">`).join('');
        }
      }
      
      // ÂàùÂßãÂåñÊâÄÊúâ datalist
      populateDatalist('personality-list', personalityOptions);
      populateDatalist('goal-list', goalOptions);
      populateDatalist('weakness-list', weaknessOptions);
      populateDatalist('secret-list', secretOptions);
      populateDatalist('relation-list', relationOptions);

      // ==================== ÈÄ≤ÈöéË®≠ÂÆöË≥áÊñô ====================
      // Êïò‰∫ãË¶ñËßí
      const narrativeOptions = [
        // Âü∫Êú¨Ë¶ñËßí
        { value: 'Á¨¨‰∏Ä‰∫∫Á®±', label: 'üë§ Á¨¨‰∏Ä‰∫∫Á®± - „ÄåÊàëËµ∞ÈÄ≤ÊàøÈñì...„Äç' },
        { value: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•', label: 'üëÅÔ∏è Á¨¨‰∏â‰∫∫Á®±ÈôêÁü• - Ë∑üÈö®‰∏ªËßíË¶ñËßí' },
        { value: 'Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü•', label: 'üåê Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü• - ‰∏äÂ∏ùË¶ñËßí' },
        { value: 'Á¨¨‰∫å‰∫∫Á®±', label: 'ü´µ Á¨¨‰∫å‰∫∫Á®± - „Äå‰Ω†Ëµ∞ÈÄ≤ÊàøÈñì...„Äç' },
        // ÂàáÊèõË¶ñËßí
        { value: 'Â§öË¶ñËßíÂàáÊèõ', label: 'üîÑ Â§öË¶ñËßíÂàáÊèõ - ÊØèÁ´†‰∏çÂêåËßíËâ≤' },
        { value: 'ÈõôÁ∑öÊïò‰∫ã', label: '‚ö° ÈõôÁ∑öÊïò‰∫ã - ÂÖ©Ê¢ù‰∏ªÁ∑ö‰∫§Áπî' },
        { value: 'Áæ§ÂÉèÂäáË¶ñËßí', label: 'üë• Áæ§ÂÉèÂäáË¶ñËßí - ÁÑ°Âõ∫ÂÆö‰∏ªËßí' },
        { value: 'Â∞çÁ´ãË¶ñËßí', label: '‚öîÔ∏è Â∞çÁ´ãË¶ñËßí - ÊïµÂ∞çÈõôÊñπ‰∫§Êõø' },
        // ÁâπÊÆäÊïò‰∫ã
        { value: 'Êõ∏‰ø°È´î', label: '‚úâÔ∏è Êõ∏‰ø°È´î - ‰ª•Êõ∏‰ø°ÂëàÁèæ' },
        { value: 'Êó•Ë®òÈ´î', label: 'üìî Êó•Ë®òÈ´î - Êó•Ë®òÂΩ¢ÂºèË®òÈåÑ' },
        { value: 'ÂõûÊÜ∂ÈåÑ', label: 'üìú ÂõûÊÜ∂ÈåÑ - ‰∏ªËßíÂõûÈ°ßÂæÄ‰∫ã' },
        { value: 'ÊóÅÁôΩÊïòËø∞', label: 'üéôÔ∏è ÊóÅÁôΩÊïòËø∞ - ÊïÖ‰∫ãÂ§ñÁöÑË¨õËø∞ËÄÖ' },
        { value: 'Êé°Ë®™È´î', label: 'üé§ Êé°Ë®™È´î - Ë®™Ë´áÂïèÁ≠îÂΩ¢Âºè' },
        { value: 'Ê™îÊ°àÈ´î', label: 'üìÅ Ê™îÊ°àÈ´î - Ê™îÊ°àÂ†±ÂëäÂΩ¢Âºè' },
        // ÂâµÊñ∞Êïò‰∫ã
        { value: 'ÊÑèË≠òÊµÅ', label: 'üåä ÊÑèË≠òÊµÅ - ËßíËâ≤ÂÖßÂøÉÁç®ÁôΩ' },
        { value: 'Á¢éÁâáÂºè', label: 'üß© Á¢éÁâáÂºè - ÈùûÁ∑öÊÄßÊïò‰∫ã' },
        { value: 'ÂÄíÊïò', label: '‚è™ ÂÄíÊïò - ÂæûÁµêÂ±ÄÈñãÂßã' },
        { value: 'ÊèíÊïò', label: 'üìç ÊèíÊïò - Á©øÊèíÂõûÊÜ∂' },
        { value: 'Áí∞ÂΩ¢Êïò‰∫ã', label: 'üîÅ Áí∞ÂΩ¢Êïò‰∫ã - È¶ñÂ∞æÂëºÊáâ' },
        { value: '‰∏çÂèØÈù†ÊïòËø∞ËÄÖ', label: 'üé≠ ‰∏çÂèØÈù†ÊïòËø∞ËÄÖ - ÊïòËø∞ÂèØËÉΩÊúâË™§' },
        { value: 'ÂÖÉÊïò‰∫ã', label: 'üìñ ÂÖÉÊïò‰∫ã - ÊâìÁ†¥Á¨¨ÂõõÈù¢ÁâÜ' },
        { value: 'Á≥ªÁµ±ÊèêÁ§∫È¢®Ê†º', label: 'üíª Á≥ªÁµ±ÊèêÁ§∫È¢®Ê†º - „ÄêÁ≥ªÁµ±„ÄëÂΩ¢Âºè' }
      ];

      // ÊôÇ‰ª£Ë®≠ÂÆö
      const eraOptions = [
        // ‚ïê‚ïê‚ïê ‰∏≠ÂúãÂè§‰ª£ ‚ïê‚ïê‚ïê
        { value: 'ÈÅ†Âè§Á•ûË©±ÊôÇ‰ª£', label: 'üèõÔ∏è ÈÅ†Âè§Á•ûË©± - Áõ§Âè§Â•≥Â™ßÊôÇ‰ª£' },
        { value: '‰∏äÂè§‰∏âÁöá‰∫îÂ∏ù', label: 'üëë ‰∏âÁöá‰∫îÂ∏ù - ÈªÉÂ∏ùÁÇéÂ∏ù' },
        { value: 'Â§èÂïÜÂë®', label: 'üè∫ Â§èÂïÜÂë® - ÈùíÈäÖÁ¶ÆÂô®' },
        { value: 'ÂÖàÁß¶ÊôÇ‰ª£', label: '‚öîÔ∏è Êò•ÁßãÊà∞Âúã - ÁôæÂÆ∂Áà≠È≥¥' },
        { value: 'Áß¶Êúù', label: 'üêâ Áß¶Êúù - ÂßãÁöá‰∏ÄÁµ±' },
        { value: 'Êº¢Êúù', label: 'üèØ ÂÖ©Êº¢ - Áµ≤Ë∑ØÈñãÈÄö' },
        { value: '‰∏âÂúã', label: '‚öîÔ∏è ‰∏âÂúã - Áæ§ÈõÑÈÄêÈπø' },
        { value: 'È≠èÊôâÂçóÂåóÊúù', label: 'üé≠ È≠èÊôâ - È¢®ÊµÅÂêçÂ£´' },
        { value: 'ÈöãÂîêÊôÇ‰ª£', label: 'üå∏ ÈöãÂîê - Áõõ‰∏ñÁπÅËèØ' },
        { value: '‰∫î‰ª£ÂçÅÂúã', label: 'üó°Ô∏è ‰∫î‰ª£ÂçÅÂúã - ‰∫Ç‰∏ñÁ¥õÁà≠' },
        { value: 'ÂÆãÊúù', label: 'üìú ÂÖ©ÂÆã - Êñá‰∫∫ÈõÖÈüª' },
        { value: 'ÂÖÉÊúù', label: 'üêé ÂÖÉÊúù - ËçâÂéüÂ∏ùÂúã' },
        { value: 'ÊòéÊúù', label: 'üèÆ ÊòéÊúù - Èå¶Ë°£Ë°õÊù±Âª†' },
        { value: 'Ê∏ÖÊúù', label: 'üëò Ê∏ÖÊúù - ÂÆÆÂª∑ÁöáÊ¨ä' },
        // ‚ïê‚ïê‚ïê ‰∏≠ÂúãËøëÁèæ‰ª£ ‚ïê‚ïê‚ïê
        { value: 'Ê∏ÖÊú´Ê∞ëÂàù', label: 'üé© Ê∏ÖÊú´Ê∞ëÂàù - ËÆäÈù©ÂãïÁõ™' },
        { value: 'Ê∞ëÂúãÊôÇ‰ª£', label: 'üåá Ê∞ëÂúã - ‰∏äÊµ∑ÁÅò' },
        { value: 'ÊäóÊà∞ÊôÇÊúü', label: 'üí£ ÊäóÊó•Êà∞Áà≠ - ÁÉΩÁÅ´Ê≠≤Êúà' },
        { value: 'Âª∫ÂúãÂàùÊúü', label: 'üö© Âª∫ÂúãÂàùÊúü - 1949-1960' },
        { value: 'ÁâπÊÆäÂπ¥‰ª£', label: 'üìï ÁâπÊÆäÂπ¥‰ª£ - 1960-1980' },
        { value: 'ÊîπÈù©ÈñãÊîæ', label: 'üåÖ ÊîπÈù©ÈñãÊîæ - 1980-2000' },
        // ‚ïê‚ïê‚ïê Ë•øÊñπÊ≠∑Âè≤ ‚ïê‚ïê‚ïê
        { value: 'Âè§Â∏åËáò', label: 'üèõÔ∏è Âè§Â∏åËáò - ÂüéÈÇ¶Âì≤Â≠∏' },
        { value: 'Âè§ÁæÖÈ¶¨', label: '‚öîÔ∏è Âè§ÁæÖÈ¶¨ - Â∏ùÂúãÊ¶ÆÂÖâ' },
        { value: 'ÈªëÊöóÊôÇ‰ª£', label: 'üåë ÈªëÊöóÊôÇ‰ª£ - ‰∏≠‰∏ñÁ¥ÄÊó©Êúü' },
        { value: 'Ë•øÊñπ‰∏≠‰∏ñÁ¥Ä', label: 'üè∞ ‰∏≠‰∏ñÁ¥Ä - È®éÂ£´ÂüéÂ†°' },
        { value: 'ÊñáËóùÂæ©Ëàà', label: 'üé® ÊñáËóùÂæ©Ëàà - ËóùË°ìË¶∫ÈÜí' },
        { value: 'Â§ßËà™Êµ∑ÊôÇ‰ª£', label: '‚õµ Â§ßËà™Êµ∑ - Âú∞ÁêÜÂ§ßÁôºÁèæ' },
        { value: 'ÂïüËíôÊôÇ‰ª£', label: 'üí° ÂïüËíôÊôÇ‰ª£ - ÁêÜÊÄß‰πãÂÖâ' },
        { value: 'Á∂≠Â§öÂà©‰∫ûÊôÇ‰ª£', label: 'üëí Á∂≠Â§öÂà©‰∫û - Ëã±ÂÄ´È¢®ÊÉÖ' },
        { value: 'Â∑•Ê•≠Èù©ÂëΩ', label: '‚öôÔ∏è Â∑•Ê•≠Èù©ÂëΩ - Ëí∏Ê±ΩÊôÇ‰ª£' },
        { value: '‰∏ÄÊà∞ÊôÇÊúü', label: 'üéñÔ∏è ‰∏ÄÊà∞ÊôÇÊúü - Â£ïÊ∫ùÊà∞' },
        { value: '‰∫åÊà∞ÊôÇÊúü', label: 'üí£ ‰∫åÊà∞ÊôÇÊúü - ‰∏ñÁïåÂ§ßÊà∞' },
        { value: 'ÂÜ∑Êà∞ÊôÇÊúü', label: 'üïµÔ∏è ÂÜ∑Êà∞ - ÈêµÂπïÊôÇ‰ª£' },
        // ‚ïê‚ïê‚ïê ÂÖ∂‰ªñÊñáÊòé ‚ïê‚ïê‚ïê
        { value: 'Âè§ÂüÉÂèä', label: 'üè∫ Âè§ÂüÉÂèä - ÈáëÂ≠óÂ°îÊ≥ïËÄÅ' },
        { value: 'Âè§Â∑¥ÊØîÂÄ´', label: 'üåô Âè§Â∑¥ÊØîÂÄ´ - Á©∫‰∏≠Ëä±Âúí' },
        { value: 'Âè§Âç∞Â∫¶', label: 'üïâÔ∏è Âè§Âç∞Â∫¶ - ÊÅÜÊ≤≥ÊñáÊòé' },
        { value: 'Êó•Êú¨Êà∞Âúã', label: '‚öîÔ∏è Êó•Êú¨Êà∞Âúã - Ê≠¶Â£´ÊôÇ‰ª£' },
        { value: 'Ê±üÊà∂ÊôÇ‰ª£', label: 'üéå Ê±üÊà∂ÊôÇ‰ª£ - ÂøçËÄÖÊ≠¶Â£´ÈÅì' },
        { value: 'ÊòéÊ≤ªÁ∂≠Êñ∞', label: 'üåÖ ÊòéÊ≤ªÁ∂≠Êñ∞ - Êù±Ê¥ãËÆäÈù©' },
        { value: 'ÂåóÊ≠êÁ∂≠‰∫¨', label: 'ü™ì Á∂≠‰∫¨ÊôÇ‰ª£ - Êµ∑ÁõúÊé†Â•™' },
        { value: 'Â•ßÊñØÊõºÂ∏ùÂúã', label: 'üåô Â•ßÊñØÊõº - Ëòá‰∏πÂÆÆÂª∑' },
        { value: 'ËíôÂè§Â∏ùÂúã', label: 'üêé ËíôÂè§Â∏ùÂúã - ÂæÅÊúç‰∏ñÁïå' },
        { value: 'ÁæéÂúãË•øÈÉ®', label: 'ü§† ÁæéÂúãË•øÈÉ® - Áâõ‰ªîÊôÇ‰ª£' },
        // ‚ïê‚ïê‚ïê Áèæ‰ª£ËàáÊú™‰æÜ ‚ïê‚ïê‚ïê
        { value: 'Áèæ‰ª£', label: 'üèôÔ∏è Áèæ‰ª£ - Áï∂‰ª£ÈÉΩÂ∏Ç' },
        { value: 'ËøëÊú™‰æÜ', label: 'üîÆ ËøëÊú™‰æÜ - 2030-2050' },
        { value: '‰∏≠Êú™‰æÜ', label: 'üåê ‰∏≠Êú™‰æÜ - 2050-2100' },
        { value: 'ÈÅ†Êú™‰æÜ', label: 'üöÄ ÈÅ†Êú™‰æÜ - ÊòüÈöõÊôÇ‰ª£' },
        { value: 'Ë∂ÖÊú™‰æÜ', label: 'üåå Ë∂ÖÊú™‰æÜ - ÂÆáÂÆôÁµÇÊú´' },
        // ‚ïê‚ïê‚ïê Êú´‰∏ñËàáÊû∂Á©∫ ‚ïê‚ïê‚ïê
        { value: 'Êú´Êó•Âæå', label: '‚ò¢Ô∏è Êú´Êó•Âæå - Âª¢Âúü‰∏ñÁïå' },
        { value: 'Âñ™Â±çÊú´Êó•', label: 'üßü Âñ™Â±çÊú´Êó• - Ê¥ªÊ≠ª‰∫∫' },
        { value: 'Ê†∏Êà∞Âæå', label: '‚ò£Ô∏è Ê†∏Êà∞Âæå - ËºªÂ∞ÑÂª¢Âúü' },
        { value: 'Ê∞£ÂÄôÁÅΩËÆä', label: 'üåä Ê∞£ÂÄôÁÅΩËÆä - ÁîüÊÖãÂ¥©ÊΩ∞' },
        { value: 'Êû∂Á©∫Ê≠∑Âè≤', label: 'üåÄ Êû∂Á©∫Ê≠∑Âè≤ - Â¶ÇÊûúÊ≠∑Âè≤...' },
        { value: 'Âπ≥Ë°åÊôÇÁ©∫', label: 'üîÑ Âπ≥Ë°åÊôÇÁ©∫ - Âè¶‰∏ÄÂÄã‰∏ñÁïå' },
        { value: 'ÊôÇÈñìÁ©øË∂ä', label: '‚è≥ ÊôÇÈñìÁ©øË∂ä - Ë∑®Ë∂äÊôÇ‰ª£' },
        { value: 'Ê∞∏ÊÅÜ‰πãÂüé', label: 'üèõÔ∏è Ê∞∏ÊÅÜ‰πãÂüé - ÊôÇÈñìÂáçÁµê' },
        // ‚ïê‚ïê‚ïê Â•áÂπªÊû∂Á©∫ ‚ïê‚ïê‚ïê
        { value: 'Ê¥™Ëçí', label: 'üåã Ê¥™Ëçí - Â§©Âú∞ÂàùÈñã' },
        { value: '‰ªô‰ø†‰∏ñÁïå', label: '‚òØÔ∏è ‰ªô‰ø† - ‰øÆ‰ªôÂïèÈÅì' },
        { value: 'ÁéÑÂπªÂ§ßÈô∏', label: '‚ú® ÁéÑÂπª - È¨•Ê∞£È≠îÊ≥ï' },
        { value: 'Ë•øÂπªÂ§ßÈô∏', label: 'üè∞ Ë•øÂπª - ÂäçËàáÈ≠îÊ≥ï' },
        { value: 'Ëí∏Ê±ΩÈæêÂÖã', label: '‚öôÔ∏è Ëí∏Ê±ΩÈæêÂÖã - ÈΩíËº™Ëí∏Ê±Ω' },
        { value: 'Ë≥ΩÂçöÈæêÂÖã', label: 'üåÉ Ë≥ΩÂçöÈæêÂÖã - È´òÁßëÊäÄ‰ΩéÁîüÊ¥ª' },
        { value: 'ÂÖãËòáÈ≠Ø', label: 'üêô ÂÖãËòáÈ≠Ø - ÂÆáÂÆôÊÅêÊáº' },
        { value: 'Âì•ÁâπÈ¢®', label: 'ü¶á Âì•ÁâπÈ¢® - ÈªëÊöóÊµ™Êº´' }
      ];

      // ÊïÖ‰∫ãÁØÄÂ•è
      const pacingOptions = [
        // Âü∫Êú¨ÁØÄÂ•è
        { value: 'ÊÖ¢ÁÜ±Èã™Èô≥', label: 'üê¢ ÊÖ¢ÁÜ±Èã™Èô≥ - Á¥∞ËÜ©ÊèèÂØ´ÔºåÂ®ìÂ®ìÈÅì‰æÜ' },
        { value: 'Ê®ôÊ∫ñÁØÄÂ•è', label: '‚öñÔ∏è Ê®ôÊ∫ñÁØÄÂ•è - ÂºµÂºõÊúâÂ∫¶ÔºåÊî∂ÊîæËá™Â¶Ç' },
        { value: 'Âø´ÁØÄÂ•è', label: 'üèÉ Âø´ÁØÄÂ•è - Á∑äÊπäÂà∫ÊøÄÔºå‰∫ã‰ª∂ÂØÜÈõÜ' },
        { value: 'Ê•µÈÄüÁØÄÂ•è', label: '‚ö° Ê•µÈÄüÁØÄÂ•è - ÂàÜÁßíÂøÖÁà≠ÔºåÂñò‰∏çÈÅéÊ∞£' },
        // È°ûÂûãÁØÄÂ•è
        { value: 'ÁàΩÊñáÁØÄÂ•è', label: 'üí• ÁàΩÊñáÁØÄÂ•è - È´òÊΩÆËø≠Ëµ∑ÔºåÊâìËáâ‰∏çÊñ∑' },
        { value: 'Êá∏ÁñëÁØÄÂ•è', label: 'üîç Êá∏ÁñëÁØÄÂ•è - Â±§Â±§ÂâùÁπ≠ÔºåÁúüÁõ∏Êº∏Èú≤' },
        { value: 'ÊñáËóùÁØÄÂ•è', label: 'üé≠ ÊñáËóùÁØÄÂ•è - ÈáçË¶ñÂÖßÂøÉÔºåÊ∑°ÂåñÊÉÖÁØÄ' },
        { value: 'Âè≤Ë©©ÁØÄÂ•è', label: 'üìñ Âè≤Ë©©ÁØÄÂ•è - ÂÆèÂ§ßÊïò‰∫ãÔºåÊôÇÈñìË∑®Â∫¶Èï∑' },
        { value: 'Êó•Â∏∏ÁØÄÂ•è', label: '‚òï Êó•Â∏∏ÁØÄÂ•è - ÁîüÊ¥ªÁë£‰∫ãÔºåÊ≤ªÁôíËàíÈÅ©' },
        { value: 'È©öÊÇöÁØÄÂ•è', label: 'üò± È©öÊÇöÁØÄÂ•è - Á∑äÂºµÂ£ìËø´ÔºåÊ≠•Ê≠•È©öÂøÉ' },
        { value: 'Êµ™Êº´ÁØÄÂ•è', label: 'üíï Êµ™Êº´ÁØÄÂ•è - ÊÉÖÊÑüÁ¥∞ËÜ©ÔºåÊÄ¶ÁÑ∂ÂøÉÂãï' },
        { value: 'ÁÜ±Ë°ÄÁØÄÂ•è', label: 'üî• ÁÜ±Ë°ÄÁØÄÂ•è - Êà∞È¨•ÊøÄÊòÇÔºåÁáÉÈªû‰∏çÊñ∑' },
        // ÁâπÊÆäÁØÄÂ•è
        { value: 'ÂÄíÊïòÁØÄÂ•è', label: '‚è™ ÂÄíÊïòÁØÄÂ•è - ÁµêÂ±ÄÈñãÂ†¥ÔºåËøΩÊ∫ØÂéüÂõ†' },
        { value: 'Áí∞ÂΩ¢ÁØÄÂ•è', label: 'üîÅ Áí∞ÂΩ¢ÁØÄÂ•è - È¶ñÂ∞æÂëºÊáâÔºåÂëΩÈÅãËº™Ëø¥' },
        { value: 'Á¢éÁâáÁØÄÂ•è', label: 'üß© Á¢éÁâáÁØÄÂ•è - ÊôÇÈñìË∑≥Ë∫çÔºåÊãºÊπäÁúüÁõ∏' },
        { value: 'Êº∏ÈÄ≤ÁØÄÂ•è', label: 'üìà Êº∏ÈÄ≤ÁØÄÂ•è - Áî±ÊÖ¢Âà∞Âø´ÔºåÊº∏ÂÖ•‰Ω≥Â¢É' },
        { value: 'Ê≥¢Êµ™ÁØÄÂ•è', label: 'üåä Ê≥¢Êµ™ÁØÄÂ•è - Ëµ∑‰ºè‰∫§ÊõøÔºåÂºµÂºõÊúâÂ∫¶' },
        { value: 'ÈöéÊ¢ØÁØÄÂ•è', label: 'üì∂ ÈöéÊ¢ØÁØÄÂ•è - ÈÄêÊ≠•ÂçáÁ¥öÔºåÂ±§Â±§ÈÅûÈÄ≤' },
        { value: 'ÁàÜÁôºÁØÄÂ•è', label: 'üí£ ÁàÜÁôºÁØÄÂ•è - ËìÑÂäõÁàÜÁôºÔºåÈ´òÊΩÆÈõÜ‰∏≠' },
        { value: 'ÈõôÁ∑öÁØÄÂ•è', label: 'üîÄ ÈõôÁ∑öÁØÄÂ•è - ‰∏¶Ë°åÊé®ÈÄ≤Ôºå‰∫§ÂåØÈ´òÊΩÆ' }
      ];

      // ÂÖßÂÆπÂàÜÁ¥ö
      const ratingOptions = [
        // Âπ¥ÈΩ°ÂàÜÁ¥ö
        { value: 'ÂÖ®Âπ¥ÈΩ°', label: 'üë∂ ÂÖ®Âπ¥ÈΩ° - ÈÅ©ÂêàÊâÄÊúâ‰∫∫Èñ±ËÆÄ' },
        { value: '12+', label: 'üîπ 12Ê≠≤‰ª•‰∏ä - ËºïÂæÆË°ùÁ™Å/ÊÉÖÊÑü' },
        { value: '15+', label: 'üî∏ 15Ê≠≤‰ª•‰∏ä - ‰∏≠Â∫¶Êà∞È¨•/ÊõñÊòß' },
        { value: '18+', label: 'üî¥ 18Ê≠≤‰ª•‰∏ä - ËºÉÊøÄÁÉàÂÖßÂÆπ' },
        // ÂÖßÂÆπÂÇæÂêë
        { value: 'Á¥îÊÑõÂêë', label: 'üíï Á¥îÊÑõÂêë - Ê∏ÖÊ∞¥ÁîúÊñáÔºåÊ∫´È¶®Ê≤ªÁôí' },
        { value: 'ËºïÂ∫¶ÊõñÊòß', label: 'üíó ËºïÂ∫¶ÊõñÊòß - ÈªûÂà∞ÁÇ∫Ê≠¢ÔºåÊÑèÁå∂Êú™Áõ°' },
        { value: '‰∏≠Â∫¶ÊÉÖÊÑü', label: 'üíñ ‰∏≠Â∫¶ÊÉÖÊÑü - ÊÉÖÊÑüÊèèÂØ´ËºÉÊ∑±ÂÖ•' },
        { value: 'ÊöóÈªëÂêë', label: 'üñ§ ÊöóÈªëÂêë - ÈªëÊöóÂäáÊÉÖÔºåÈÅìÂæ∑ÁÅ∞Ëâ≤' },
        { value: 'ÁçµÂ•áÂêë', label: 'üëÅÔ∏è ÁçµÂ•áÂêë - Â•áÁâπË®≠ÂÆöÔºåÊåëÊà∞Â∏∏Ë¶è' },
        { value: 'Ë°ÄËÖ•Âêë', label: 'ü©∏ Ë°ÄËÖ•Âêë - Êà∞È¨•ÊèèÂØ´ËºÉÊøÄÁÉà' },
        { value: 'È©öÊÇöÂêë', label: 'üëª È©öÊÇöÂêë - ÊÅêÊÄñÈ©öÊÇöÂÖÉÁ¥†' },
        { value: 'ËôêÂøÉÂêë', label: 'üíî ËôêÂøÉÂêë - ÊÉÖÊÑüÊãâÊâØÔºåÂàÄÁâá‰∏çÊñ∑' },
        { value: 'Ëá¥È¨±Âêë', label: 'üò¢ Ëá¥È¨±Âêë - Ê≤âÈáçÂ£ìÊäëÔºåÊÇ≤ÂäáËµ∞Âêë' },
        { value: 'Ê≤ªÁôíÂêë', label: 'üå∏ Ê≤ªÁôíÂêë - Ê∫´Êöñ‰∫∫ÂøÉÔºåÁôÇÁôíÁ≥ª' },
        { value: 'ÊêûÁ¨ëÂêë', label: 'üòÇ ÊêûÁ¨ëÂêë - ËºïÈ¨ÜÊ≠°Ê®ÇÔºåÁ¨ëÈªûÂØÜÈõÜ' },
        { value: 'Ê≠£ÂäáÂêë', label: 'üìñ Ê≠£ÂäáÂêë - Âö¥ËÇÖË™çÁúüÔºåÂäáÊÉÖÁÇ∫‰∏ª' }
      ];

      // ‰∏ñÁïåËßÄË§áÈõúÂ∫¶
      const worldComplexityOptions = [
        // Âü∫Êú¨Ë§áÈõúÂ∫¶
        { value: 'Ê•µÁ∞°', label: '‚ö™ Ê•µÁ∞° - ËÉåÊôØÊ®°Á≥äÔºåËÅöÁÑ¶ËßíËâ≤' },
        { value: 'Á∞°ÂñÆ', label: 'üîò Á∞°ÂñÆ - ÂñÆ‰∏ÄÂ†¥ÊôØÔºåÊòìÊñºÁêÜËß£' },
        { value: '‰∏≠Á≠â', label: 'üîµ ‰∏≠Á≠â - 2-3ÂÄãÈô£Ááü/ÂúãÂÆ∂' },
        { value: 'Ë§áÈõú', label: 'üî¥ Ë§áÈõú - Â§öÂúãÂ§öÂã¢ÂäõÔºåË©≥Á¥∞Ë®≠ÂÆö' },
        { value: 'Âè≤Ë©©Á¥ö', label: 'üåü Âè≤Ë©©Á¥ö - ÈæêÂ§ß‰∏ñÁïåËßÄÔºåÂ§öÁ∑ö‰∏¶ÈÄ≤' },
        { value: 'Ë∂ÖÂè≤Ë©©', label: 'üåå Ë∂ÖÂè≤Ë©© - Â§ö‰ΩçÈù¢/Â§öÊôÇ‰ª£‰∫§Áπî' },
        // ÁâπÊÆäË®≠ÂÆö
        { value: 'ÂñÆÂ†¥ÊôØÊ∑±Êåñ', label: 'üî¨ ÂñÆÂ†¥ÊôØÊ∑±Êåñ - ‰∏ÄÂú∞‰∏Ä‰∫ãÔºåÊ∑±Â∫¶ÂàªÁï´' },
        { value: 'ÂüéÂ∏ÇÁ¥ö', label: 'üèôÔ∏è ÂüéÂ∏ÇÁ¥ö - ‰∏ÄÂüé‰πãÂÖßÔºåÂã¢ÂäõÈåØÁ∂ú' },
        { value: 'ÂúãÂÆ∂Á¥ö', label: 'üèØ ÂúãÂÆ∂Á¥ö - ÊúùÂ†ÇÊ±üÊπñÔºåÂÖßÂ§ñ‰∫§Âõ∞' },
        { value: 'Â§ßÈô∏Á¥ö', label: 'üó∫Ô∏è Â§ßÈô∏Á¥ö - Â§öÂúãÁà≠Èú∏ÔºåË´∏‰æØÂâ≤Êìö' },
        { value: '‰∏ñÁïåÁ¥ö', label: 'üåç ‰∏ñÁïåÁ¥ö - ÂÖ®ÁêÉÊ†ºÂ±ÄÔºåÂ§ßÂúãÂçöÂºà' },
        { value: 'ÂÆáÂÆôÁ¥ö', label: 'üöÄ ÂÆáÂÆôÁ¥ö - ÊòüÈöõÊñáÊòéÔºåÁ®ÆÊóèÂ∞çÊäó' },
        { value: 'Â§öÂÖÉÂÆáÂÆô', label: 'üåê Â§öÂÖÉÂÆáÂÆô - Âπ≥Ë°å‰∏ñÁïåÔºåÁ∂≠Â∫¶Á©øÊ¢≠' },
        // È´îÁ≥ªË®≠ÂÆö
        { value: 'È¨ÜÊï£Ë®≠ÂÆö', label: 'üé≤ È¨ÜÊï£Ë®≠ÂÆö - ÊúçÂãôÂäáÊÉÖÔºåÈö®ÂØ´Èö®Á∑®' },
        { value: 'Á°¨Ê†∏Ë®≠ÂÆö', label: 'üìê Á°¨Ê†∏Ë®≠ÂÆö - Âö¥Ê†ºÈ´îÁ≥ªÔºåÈÇèËºØËá™Ê¥Ω' },
        { value: 'ËªüÁßëÂπª', label: 'üîÆ ËªüÁßëÂπª - ÁßëÊäÄÁÇ∫ËÉåÊôØÔºå‰∏çÊ∑±Á©∂' },
        { value: 'Á°¨ÁßëÂπª', label: '‚öõÔ∏è Á°¨ÁßëÂπª - ÁßëÂ≠∏Âö¥Ë¨πÔºåÈÇèËºØÊé®Êºî' }
      ];

      // ÊÉÖÊÑüÂü∫Ë™ø
      const emotionalToneOptions = [
        // Ê≠£ÂêëÂü∫Ë™ø
        { value: 'Ê≠°Ê®ÇËºïÈ¨Ü', label: 'üòÑ Ê≠°Ê®ÇËºïÈ¨Ü - Á¨ëÈªûÊªøÊªøÔºåÈñãÂøÉÈñ±ËÆÄ' },
        { value: 'Ê∫´È¶®Ê≤ªÁôí', label: 'üå∏ Ê∫´È¶®Ê≤ªÁôí - ÊöñÂøÉÊïÖ‰∫ãÔºåÁôÇÁôí‰∫∫ÂøÉ' },
        { value: 'Êµ™Êº´ÁîúËúú', label: 'üíó Êµ™Êº´ÁîúËúú - ÁîúÂà∞ÈΩÅÔºåÊàÄÊÑõËÖ¶ÂøÖÁúã' },
        { value: 'ÁÜ±Ë°ÄÁáÉÂêë', label: 'üî• ÁÜ±Ë°ÄÁáÉÂêë - ÁáÉÁàÜÂÖ®Â†¥ÔºåÊøÄÊÉÖÊæéÊπÉ' },
        { value: 'ÈùíÊò•Ê¥ªÂäõ', label: 'üåà ÈùíÊò•Ê¥ªÂäõ - ÊúùÊ∞£Ëì¨ÂãÉÔºåÈùíÊò•ÁÑ°ÊÇî' },
        { value: 'ÂãµÂøóÂêë‰∏ä', label: 'üí™ ÂãµÂøóÂêë‰∏ä - Âä™ÂäõÂ∞±ÊúÉÊúâÂõûÂ†±' },
        { value: 'Â∏åÊúõÂÖâÊòé', label: '‚òÄÔ∏è Â∏åÊúõÂÖâÊòé - ÈªëÊöóÂæåÊòØÈªéÊòé' },
        // Ë≤†ÂêëÂü∫Ë™ø
        { value: 'ËôêÂøÉÁ≥æÁµê', label: 'üíî ËôêÂøÉÁ≥æÁµê - ÊÉÖÊÑüÊãâÊâØÔºåÂàÄÁâáÈ†êË≠¶' },
        { value: 'ÈªëÊöóÊ≤âÈáç', label: 'üñ§ ÈªëÊöóÊ≤âÈáç - Ëá¥È¨±Ëµ∞ÂêëÔºåÂ£ìÊäëÊ∞õÂúç' },
        { value: 'ÊÇ≤ÂÇ∑ÊÜÇÈ¨±', label: 'üò¢ ÊÇ≤ÂÇ∑ÊÜÇÈ¨± - Ê∑öÈªûÊªøÊªøÔºåÊÑèÈõ£Âπ≥' },
        { value: 'ÁµïÊúõÁ™íÊÅØ', label: 'üò∞ ÁµïÊúõÁ™íÊÅØ - Áúã‰∏çÂà∞Â∏åÊúõ' },
        { value: 'Â≠§Áç®ÂØÇÂØû', label: 'üåô Â≠§Áç®ÂØÇÂØû - ‰∏ÄÂÄã‰∫∫ÁöÑÂ§úÊôö' },
        { value: 'ËíºÊ∂ºÊÇ≤Â£Ø', label: 'üçÇ ËíºÊ∂ºÊÇ≤Â£Ø - ÊÇ≤ÂäáËã±ÈõÑÔºåÂ£ØÁÉàÁäßÁâ≤' },
        // Á∑äÂºµÂà∫ÊøÄÂü∫Ë™ø
        { value: 'Êá∏ÁñëÁ∑äÂºµ', label: 'üîç Êá∏ÁñëÁ∑äÂºµ - Ê≠•Ê≠•ÁÇ∫ÁáüÔºåÁúüÁõ∏Êí≤Êúî' },
        { value: 'Ë©≠Áï∞È©öÊÇö', label: 'üëª Ë©≠Áï∞È©öÊÇö - Á¥∞ÊÄùÊ•µÊÅêÔºåËÑäËÉåÁôºÊ∂º' },
        { value: 'È©öÈö™Âà∫ÊøÄ', label: 'üí• È©öÈö™Âà∫ÊøÄ - ÂøÉË∑≥Âä†ÈÄüÔºåÂñò‰∏çÈÅéÊ∞£' },
        { value: 'Â£ìËø´Á™íÊÅØ', label: 'üò± Â£ìËø´Á™íÊÅØ - Âç±Ê©üÂõõ‰ºèÔºåÁÑ°ËôïÂèØÈÄÉ' },
        { value: 'Á•ûÁßòË©≠Ë≠é', label: 'üåÄ Á•ûÁßòË©≠Ë≠é - Ëø∑ÈúßÈáçÈáçÔºåÁñëÈªûÂè¢Áîü' },
        // Ë§áÈõúÂü∫Ë™ø
        { value: 'Âè≤Ë©©Â£ØÈóò', label: '‚öîÔ∏è Âè≤Ë©©Â£ØÈóò - ÂÆèÂ§ßÊïò‰∫ãÔºåËã±ÈõÑÂÇ≥Ë™™' },
        { value: 'Ë´∑Âà∫ÂπΩÈªò', label: 'üòè Ë´∑Âà∫ÂπΩÈªò - ÈªëËâ≤ÂñúÂäáÔºåÂò≤Ë´∑ÁèæÂØ¶' },
        { value: 'Âì≤ÁêÜÊ∑±Ê≤â', label: 'ü§î Âì≤ÁêÜÊ∑±Ê≤â - Êé¢Ë®é‰∫∫ÁîüÔºåÁôº‰∫∫Ê∑±ÁúÅ' },
        { value: 'ËçíË™ïÈõ¢Â•á', label: 'üé™ ËçíË™ïÈõ¢Â•á - È≠îÂπªÁèæÂØ¶ÔºåËçíË™ï‰∏çÁ∂ì' },
        { value: 'Ë§áÈõúÁ≥æËëõ', label: 'üîÄ Ë§áÈõúÁ≥æËëõ - ÊÑõÊÅ®‰∫§ÁπîÔºåÁ´ãÂ†¥Ê®°Á≥ä' },
        { value: 'ÁÅ∞Ëâ≤Âú∞Â∏∂', label: '‚¨õ ÁÅ∞Ëâ≤Âú∞Â∏∂ - ÁÑ°ÁµïÂ∞çÂñÑÊÉ°ÔºåÈÅìÂæ∑Ê®°Á≥ä' },
        // ÁâπÊÆäÂü∫Ë™ø
        { value: 'ÁàΩÂø´Ëß£Â£ì', label: 'üíØ ÁàΩÂø´Ëß£Â£ì - ÁúãÂÆåÁ•ûÊ∏ÖÊ∞£ÁàΩ' },
        { value: 'ÊÖ¢ÁîüÊ¥ª', label: '‚òï ÊÖ¢ÁîüÊ¥ª - Ê≠≤ÊúàÈùúÂ•ΩÔºåÂπ≥Ê∑°ÊòØÁúü' },
        { value: 'Âæ©Âè§Êá∑Ëàä', label: 'üìª Âæ©Âè§Êá∑Ëàä - Âπ¥‰ª£ÊÑüÔºåÂõûÊÜ∂ÊÆ∫' },
        { value: 'Â§¢ÂπªÂîØÁæé', label: '‚ú® Â§¢ÂπªÂîØÁæé - Â¶ÇÂ§¢‰ººÂπªÔºåÁæéËº™ÁæéÂ•ê' },
        { value: 'ÁèæÂØ¶ÊÆòÈÖ∑', label: 'üèöÔ∏è ÁèæÂØ¶ÊÆòÈÖ∑ - Á§æÊúÉÂØ´ÂØ¶ÔºåÊÆòÈÖ∑‰∫∫Áîü' },
        { value: 'Ë∂ÖËÑ´‰∏ñ‰øó', label: 'üèîÔ∏è Ë∂ÖËÑ´‰∏ñ‰øó - Âá∫‰∏ñÊÉÖÊá∑ÔºåÈÅìÊ≥ïËá™ÁÑ∂' }
      ];

      // ÁµêÂ±ÄÂÇæÂêë
      const endingOptions = [
        // Á∂ìÂÖ∏ÁµêÂ±Ä
        { value: 'HE', label: 'üòä HEÔºàHappy EndÔºâ- Â§ßÂúòÂúìÔºåÁöÜÂ§ßÊ≠°Âñú' },
        { value: 'BE', label: 'üò¢ BEÔºàBad EndÔºâ- ÊÇ≤ÂäáÊî∂Â†¥ÔºåÊÑèÈõ£Âπ≥' },
        { value: 'OE', label: 'ü§î OEÔºàOpen EndÔºâ- ÈñãÊîæÁµêÂ±ÄÔºåÁïôÁµ¶ËÆÄËÄÖ' },
        { value: 'TE', label: '‚ú® TEÔºàTrue EndÔºâ- ÁúüÁµêÂ±ÄÔºåÈö±ËóèÁúüÁõ∏' },
        { value: 'NE', label: 'üò∂ NEÔºàNormal EndÔºâ- ÊôÆÈÄöÁµêÂ±ÄÔºå‰∏≠Ë¶è‰∏≠Áü©' },
        // ÁâπÊÆäHE
        { value: 'ÂúìÊªøHE', label: 'üéâ ÂúìÊªøHE - ÊâÄÊúâ‰∫∫ÈÉΩÂπ∏Á¶è' },
        { value: 'ÈÅ∫ÊÜæHE', label: 'üåÖ ÈÅ∫ÊÜæHE - Â§ßÊñπÂêëÂ•ΩÔºå‰ΩÜÊúâÈÅ∫ÊÜæ' },
        { value: 'Ëã¶Áõ°Áîò‰æÜHE', label: 'üåà Ëã¶Áõ°Áîò‰æÜHE - Ê≠∑Áõ°Ëâ±ËæõÁµÇÂæóÂπ∏Á¶è' },
        { value: 'ÈõôÂêëÂ•îËµ¥HE', label: 'üíï ÈõôÂêëÂ•îËµ¥HE - ÊúâÊÉÖ‰∫∫ÁµÇÊàêÁú∑Â±¨' },
        // ÁâπÊÆäBE
        { value: 'ËôêÂøÉBE', label: 'üíî ËôêÂøÉBE - ÊòéÊòéÁõ∏ÊÑõÂçªÁÑ°Ê≥ïÂú®‰∏ÄËµ∑' },
        { value: 'Â£ØÁÉàÁäßÁâ≤BE', label: '‚öîÔ∏è Â£ØÁÉàBE - Ëã±ÈõÑÁäßÁâ≤ÔºåËΩüËΩüÁÉàÁÉà' },
        { value: 'ÂÆøÂëΩBE', label: 'üé≠ ÂÆøÂëΩBE - ÂëΩÈÅã‰ΩøÁÑ∂ÔºåÁÑ°ÂäõÂõûÂ§©' },
        { value: 'ÈªëÂåñBE', label: 'üñ§ ÈªëÂåñBE - ‰∏ªËßíÂ¢ÆËêΩÔºåËê¨Âä´‰∏çÂæ©' },
        { value: 'ÊªÖ‰∏ñBE', label: 'üíÄ ÊªÖ‰∏ñBE - ‰∏ñÁïåÊØÄÊªÖÔºåÁÑ°‰∫∫ÂÄñÂÖç' },
        // ÂèçËΩâÁµêÂ±Ä
        { value: 'ÈÄÜËΩâÁµêÂ±Ä', label: 'üò± ÈÄÜËΩâÁµêÂ±Ä - ÊúÄÂæåÂ§ßÂèçËΩâÔºåÁúüÁõ∏ÈúáÊíº' },
        { value: 'ÂèçÊÆ∫ÁµêÂ±Ä', label: 'üó°Ô∏è ÂèçÊÆ∫ÁµêÂ±Ä - ÁµïÂú∞ÂèçÊìäÔºåÈÄÜÈ¢®ÁøªÁõ§' },
        { value: 'ÂèçÊ¥æÂãùÂà©', label: 'üòà ÂèçÊ¥æÂãùÂà© - Ê≠£Áæ©ÊïóÂåóÔºåÈªëÊöóÂãùÂá∫' },
        { value: 'Á¨¨‰∏âÊñπÁµêÂ±Ä', label: 'ü¶Ö Á¨¨‰∏âÊñπÁµêÂ±Ä - Ëû≥ËûÇÊçïËü¨ÈªÉÈõÄÂú®Âæå' },
        // ÈñãÊîæÂºèÁµêÂ±Ä
        { value: 'ÂçäÈñãÊîæ', label: 'üåÖ ÂçäÈñãÊîæ - ‰∏ªÁ∑öÂÆåÁµêÔºåÊîØÁ∑öÁïôÁôΩ' },
        { value: '‰ºèÁ≠ÜÁµêÂ±Ä', label: '‚ùì ‰ºèÁ≠ÜÁµêÂ±Ä - ÊöóÁ§∫Á∫å‰ΩúÔºåÊá∏ÂøµÂæÖËß£' },
        { value: 'ÊÑèË≠òÊµÅÁµêÂ±Ä', label: 'üåÄ ÊÑèË≠òÊµÅÁµêÂ±Ä - Â§¢Â¢ÉËà¨Ê®°Á≥ä' },
        { value: 'ËÆÄËÄÖÈÅ∏Êìá', label: 'üìñ ËÆÄËÄÖÈÅ∏Êìá - ‰Ω†Ë™çÁÇ∫ÊòØ‰ªÄÈ∫ºÂ∞±ÊòØ‰ªÄÈ∫º' },
        // ÁâπÊÆäÁµêÂ±Ä
        { value: 'Ëº™Ëø¥ÁµêÂ±Ä', label: 'üîÑ Ëº™Ëø¥ÁµêÂ±Ä - È¶ñÂ∞æÂëºÊáâÔºåÂÆøÂëΩÂæ™Áí∞' },
        { value: 'Ë¶∫ÈÜíÁµêÂ±Ä', label: 'üëÅÔ∏è Ë¶∫ÈÜíÁµêÂ±Ä - ÊâìÁ†¥Á¨¨ÂõõÈù¢ÁâÜ' },
        { value: 'Â§öÁµêÂ±Ä', label: 'üîÄ Â§öÁµêÂ±ÄÊöóÁ§∫ - IFÁ∑öÔºåÂπ≥Ë°å‰∏ñÁïå' },
        { value: 'Á∫åÈõÜÈã™Â¢ä', label: 'üìö Á∫åÈõÜÈã™Â¢ä - Êñ∞ÁöÑÊóÖÁ®ãÂç≥Â∞áÈñãÂßã' },
        { value: 'Áï™Â§ñÈ†êÂëä', label: 'üé¨ Áï™Â§ñÈ†êÂëä - ‰∏ªÁ∑öÂÆåÁµêÔºåÁï™Â§ñÁπºÁ∫å' },
        { value: 'Â§¢ÈÜíÁµêÂ±Ä', label: 'üí≠ Â§¢ÈÜíÁµêÂ±Ä - Âéü‰æÜÊòØ‰∏ÄÂ†¥Â§¢' },
        { value: 'Ê≠ª‰∫°ÁµêÂ±Ä', label: '‚ò†Ô∏è Ê≠ª‰∫°ÁµêÂ±Ä - ‰∏ªËßíÊ≠ª‰∫°ÔºåÊïÖ‰∫ãÁµÇÁµê' },
        { value: 'ÊòáËèØÁµêÂ±Ä', label: 'üåü ÊòáËèØÁµêÂ±Ä - Ë∂ÖËÑ´Âá°Â°µÔºåÂ¢ÉÁïåÊèêÂçá' }
      ];

      // ÁâπÊÆäÂÖÉÁ¥†ÔºàÂàÜÈ°ûÔºâ
      const specialElementCategories = [
        {
          name: 'Á≥ªÁµ±Ê©üÂà∂',
          icon: '‚öôÔ∏è',
          items: [
            { id: 'system', icon: 'üìä', label: 'Á≥ªÁµ±/Èù¢Êùø' },
            { id: 'goldenFinger', icon: '‚ú®', label: 'ÈáëÊâãÊåá/Â§ñÊéõ' },
            { id: 'upgrade', icon: 'üìà', label: 'ÂçáÁ¥öÊâìÊÄ™' },
            { id: 'skill', icon: 'üéØ', label: 'ÊäÄËÉΩÊ®π' },
            { id: 'inventory', icon: 'üéí', label: 'Èö®Ë∫´Á©∫Èñì' },
            { id: 'shop', icon: 'üõí', label: 'Á≥ªÁµ±ÂïÜÂ∫ó' },
            { id: 'mission', icon: 'üìã', label: '‰ªªÂãôÁ≥ªÁµ±' },
            { id: 'lottery', icon: 'üé∞', label: 'ÊäΩÁçé/ËΩâÁõ§' },
            { id: 'achievement', icon: 'üèÖ', label: 'ÊàêÂ∞±Á≥ªÁµ±' },
            { id: 'title', icon: 'üéñÔ∏è', label: 'Á®±ËôüÁ≥ªÁµ±' },
            { id: 'attribute', icon: 'üìâ', label: 'Â±¨ÊÄßÈù¢Êùø' },
            { id: 'level', icon: '‚¨ÜÔ∏è', label: 'Á≠âÁ¥öÂà∂Â∫¶' },
            { id: 'exp', icon: 'üí†', label: 'Á∂ìÈ©óÂÄº' },
            { id: 'points', icon: 'üîµ', label: 'ÈªûÊï∏ÂàÜÈÖç' },
            { id: 'mall', icon: 'üè¨', label: 'Á©çÂàÜÂïÜÂüé' },
            { id: 'daily', icon: 'üìÖ', label: 'ÊØèÊó•Á∞ΩÂà∞' },
            { id: 'synthesis', icon: 'üîß', label: 'ÂêàÊàêÁ≥ªÁµ±' },
            { id: 'gacha', icon: 'üéÅ', label: 'ÊäΩÂç°/Âè¨Âñö' },
            { id: 'binding', icon: 'üîó', label: 'Á∂ÅÂÆö/Ë™ç‰∏ª' },
            { id: 'ranking-sys', icon: 'üìä', label: 'ÊéíË°åÊ¶úÁ≥ªÁµ±' },
          ]
        },
        {
          name: 'Á©øË∂äÈáçÁîü',
          icon: 'üîÑ',
          items: [
            { id: 'transmigration', icon: 'üîÑ', label: 'Á©øË∂äÁï∞‰∏ñÁïå' },
            { id: 'rebirth', icon: 'üåÖ', label: 'ÈáçÁîüÂõûÊ∫Ø' },
            { id: 'timeLoop', icon: '‚è∞', label: 'ÊôÇÈñìËº™Ëø¥' },
            { id: 'gameWorld', icon: 'üéÆ', label: 'Á©øË∂äÈÅäÊà≤' },
            { id: 'bookWorld', icon: 'üìñ', label: 'Á©øÊõ∏/Á©øÂäá' },
            { id: 'soulSwap', icon: 'üëª', label: 'ÈùàÈ≠Ç‰∫íÊèõ' },
            { id: 'regression', icon: '‚è™', label: 'ÂõûÊ™îÈáç‰æÜ' },
            { id: 'parallel', icon: 'üåê', label: 'Âπ≥Ë°å‰∏ñÁïå' },
            { id: 'dream', icon: 'üí≠', label: 'Â§¢Â¢ÉÁ©øË∂ä' },
            { id: 'death', icon: 'üíÄ', label: 'Ê≠ªÂæåËΩâÁîü' },
            { id: 'summon', icon: 'üåÄ', label: 'Ë¢´Âè¨Âñö' },
            { id: 'possession', icon: 'üë§', label: 'Â•™ËàçÈôÑË∫´' },
            { id: 'infant', icon: 'üëí', label: 'ËÉéÁ©ø/ÂπºÂπ¥' },
            { id: 'npc', icon: 'ü§ñ', label: 'Á©øÊàêNPC' },
            { id: 'mob', icon: 'üëæ', label: 'Á©øÊàêÁÇÆÁÅ∞' },
            { id: 'future', icon: 'üöÄ', label: 'Êú™‰æÜÁ©øË∂ä' },
            { id: 'villain-cross', icon: 'üòà', label: 'Á©øÊàêÂèçÊ¥æ' },
            { id: 'cannon-fodder', icon: 'üí•', label: 'Á©øÊàêÁÇÆÁÅ∞Â•≥ÈÖç' },
            { id: 'quick-transmig', icon: '‚ö°', label: 'Âø´Á©ø‰ªªÂãô' },
            { id: 'world-hopping', icon: 'üåç', label: 'ÁÑ°ÈôêÊµÅ' },
          ]
        },
        {
          name: 'ÊÑüÊÉÖÁ∑ö',
          icon: 'üíï',
          items: [
            { id: 'romance', icon: 'üíï', label: 'ÊàÄÊÑõÁ∑ö' },
            { id: 'harem', icon: 'üë•', label: 'ÂæåÂÆÆ/ÈÄÜÂæåÂÆÆ' },
            { id: 'slowBurn', icon: 'üî•', label: 'ÊÖ¢ÁÜ±ÊàÄÊÑõ' },
            { id: 'enemies', icon: '‚öîÔ∏èüíï', label: 'Ê≠°ÂñúÂÜ§ÂÆ∂' },
            { id: 'arranged', icon: 'üíç', label: 'Â•ëÁ¥ÑÂ©öÂßª' },
            { id: 'unrequited', icon: 'üíî', label: 'ÊöóÊàÄ/ÂñÆÊàÄ' },
            { id: 'reunion', icon: 'ü§ù', label: 'Á†¥Èè°ÈáçÂúì' },
            { id: 'forbidden', icon: 'üö´üíï', label: 'Á¶ÅÂøå‰πãÊàÄ' },
            { id: 'childhood', icon: 'üíí', label: 'ÈùíÊ¢ÖÁ´πÈ¶¨' },
            { id: 'firstLove', icon: 'üå∏', label: 'ÂàùÊàÄÊÉÖÊá∑' },
            { id: 'jealousy', icon: 'üò§', label: 'ÂêÉÈÜãÊÉÖÁØÄ' },
            { id: 'love-hate', icon: 'üí¢üíï', label: 'ÊÑõÊÅ®Á≥æËëõ' },
            { id: 'secret-love', icon: 'ü§´üíï', label: 'Èö±Â©ö/ÁßòÊàÄ' },
            { id: 'redemption-love', icon: 'üïäÔ∏èüíï', label: 'ÊïëË¥ñ‰πãÊàÄ' },
            { id: 'triangle', icon: 'üî∫', label: '‰∏âËßíÊàÄ' },
            { id: 'double', icon: 'üë´üë´', label: 'ÈõôCPÁ∑ö' },
            { id: 'age-gap', icon: 'üë¥üëß', label: 'Âπ¥ÈΩ°Â∑Æ' },
            { id: 'master-disciple', icon: 'üë®‚Äçüè´üíï', label: 'Â∏´ÂæíÊàÄ' },
            { id: 'boss-employee', icon: 'üëîüíï', label: '‰∏ä‰∏ãÁ¥öÊàÄÊÑõ' },
            { id: 'rival-love', icon: 'ü§ùüíï', label: 'ÂÆøÊïµËÆäÊÑõ‰∫∫' },
            { id: 'pet-love', icon: 'üêæüíï', label: '‰∫∫Â§ñ/Áç∏‰∫∫ÊàÄ' },
            { id: 'reincarnation-love', icon: 'üîÑüíï', label: 'Ââç‰∏ñ‰ªäÁîüÊàÄ' },
          ]
        },
        {
          name: '‰∏ªËßíÈ°ûÂûã',
          icon: 'ü¶∏',
          items: [
            { id: 'invincible', icon: 'üí™', label: 'ÁÑ°ÊïµÊµÅ' },
            { id: 'underdog', icon: 'üêï', label: 'Âª¢Êü¥ÈÄÜË•≤' },
            { id: 'villain', icon: 'üòà', label: 'ÂèçÊ¥æ‰∏ªËßí' },
            { id: 'healer', icon: 'üíö', label: 'ËºîÂä©/Â•∂Â™Ω' },
            { id: 'strategist', icon: 'üß†', label: 'Êô∫Ë¨ÄÂûã' },
            { id: 'salted', icon: 'üßÇ', label: 'ÈππÈ≠öË∫∫Âπ≥' },
            { id: 'lucky', icon: 'üçÄ', label: 'Ê≠êÁöáÈÅãÊ∞£' },
            { id: 'hardworking', icon: 'üí¶', label: 'Âä™ÂäõÂûã' },
            { id: 'cold', icon: 'üßä', label: 'È´òÂÜ∑Á¶ÅÊÖæ' },
            { id: 'sunny', icon: '‚òÄÔ∏è', label: 'ÈôΩÂÖâÈñãÊúó' },
            { id: 'dark', icon: 'üåë', label: 'ÈªëÂåñ‰∏ªËßí' },
            { id: 'dual', icon: 'üé≠', label: 'ÈõôÈáç‰∫∫Ê†º' },
            { id: 'genius', icon: 'üßí', label: 'Â§©ÊâçÂ∞ëÂπ¥' },
            { id: 'veteran', icon: 'üë¥', label: 'ËÄÅË¨ÄÊ∑±ÁÆó' },
            { id: 'naive', icon: 'üòá', label: 'Â§©ÁúüÂñÆÁ¥î' },
            { id: 'schemer', icon: 'ü¶ä', label: 'ËÖπÈªëÂøÉÊ©ü' },
            { id: 'tsundere', icon: 'üò§', label: 'ÂÇ≤Â¨å‰∏ªËßí' },
            { id: 'yandere', icon: 'üî™üíï', label: 'ÁóÖÂ¨å‰∏ªËßí' },
            { id: 'chuuni', icon: '‚ú®', label: '‰∏≠‰∫å‰∏ªËßí' },
            { id: 'mob-face', icon: 'üë§', label: 'Ë∑Ø‰∫∫Ëáâ‰∏ªËßí' },
            { id: 'anti-hero', icon: 'ü¶á', label: 'ÂèçËã±ÈõÑ' },
            { id: 'reluctant', icon: 'üò©', label: 'Ë¢´Ëø´ÁáüÊ•≠Âûã' },
          ]
        },
        {
          name: 'ÂäáÊÉÖÂÖÉÁ¥†',
          icon: 'üìú',
          items: [
            { id: 'revenge', icon: 'üó°Ô∏è', label: 'Âæ©‰ªá‰∏ªÁ∑ö' },
            { id: 'conspiracy', icon: 'üï∏Ô∏è', label: 'Èô∞Ë¨ÄË©≠Ë®à' },
            { id: 'puzzle', icon: 'üß©', label: 'Ëß£Ë¨éÊé¢Èö™' },
            { id: 'mystery', icon: 'üîÆ', label: 'Á•ûÁßòÂäõÈáè' },
            { id: 'prophecy', icon: 'üìú', label: 'È†êË®Ä/Â§©ÂëΩ' },
            { id: 'secret', icon: 'ü§´', label: 'Ë∫´‰∏ñ‰πãË¨é' },
            { id: 'betrayal', icon: 'üó°Ô∏è', label: 'ËÉåÂèõÂèçËΩâ' },
            { id: 'redemption', icon: 'üïäÔ∏è', label: 'ÊïëË¥ñ' },
            { id: 'faceSlap', icon: 'üëã', label: 'ÊâìËáâÁàΩÊñá' },
            { id: 'comeback', icon: 'üîô', label: 'ÁµïÂú∞ÂèçÊìä' },
            { id: 'inheritance', icon: 'üìø', label: 'ÈÅ∫Ë∑°ÂÇ≥Êâø' },
            { id: 'treasure', icon: 'üíé', label: 'Â∞ãÂØ∂Â•™ÂØ∂' },
            { id: 'escape', icon: 'üèÉ', label: 'ÈÄÉ‰∫°ËøΩÊÆ∫' },
            { id: 'rescue', icon: 'üÜò', label: 'ÁáüÊïë‰ªªÂãô' },
            { id: 'trial', icon: '‚öñÔ∏è', label: 'Ë©¶ÁÖâËÄÉÈ©ó' },
            { id: 'awakening', icon: 'üëÅÔ∏è', label: 'Ë¶∫ÈÜíÂäáÊÉÖ' },
            { id: 'disguise', icon: 'üé≠', label: 'ÂÅΩË£ùËá•Â∫ï' },
            { id: 'investigation', icon: 'üîç', label: 'Ë™øÊü•ÁúüÁõ∏' },
            { id: 'misunderstanding', icon: '‚ùì', label: 'Ë™§ÊúÉÂäáÊÉÖ' },
            { id: 'pretend', icon: 'üíë', label: 'ÂÅáÊà≤ÁúüÂÅö' },
            { id: 'sacrifice', icon: 'üïØÔ∏è', label: 'ÁäßÁâ≤Â•âÁçª' },
            { id: 'reunion-plot', icon: 'ü§ù', label: 'ÈáçÈÄ¢Áõ∏Ë™ç' },
          ]
        },
        {
          name: '‰∏ñÁïåËßÄ',
          icon: 'üåç',
          items: [
            { id: 'magic', icon: 'ü™Ñ', label: 'È≠îÊ≥ïÈ´îÁ≥ª' },
            { id: 'martial', icon: 'ü•ã', label: 'Ê≠¶Âäü‰øÆÁÖâ' },
            { id: 'cultivation', icon: '‚òØÔ∏è', label: '‰ªô‰ø†‰øÆÁúü' },
            { id: 'technology', icon: 'ü§ñ', label: 'ÁßëÊäÄÊú™‰æÜ' },
            { id: 'steampunk', icon: '‚öôÔ∏è', label: 'Ëí∏Ê±ΩÈæêÂÖã' },
            { id: 'cyberpunk', icon: 'üåÉ', label: 'Ë≥ΩÂçöÈæêÂÖã' },
            { id: 'apocalypse', icon: '‚ò†Ô∏è', label: 'Êú´Êó•Âª¢Âúü' },
            { id: 'zombie', icon: 'üßü', label: 'Âñ™Â±çÊú´Êó•' },
            { id: 'multiverse', icon: 'üåå', label: 'Â§öÂÖÉÂÆáÂÆô' },
            { id: 'virtual', icon: 'ü•Ω', label: 'ËôõÊì¨ÂØ¶Â¢É' },
            { id: 'western', icon: 'üè∞', label: 'Ë•øÊñπÂ•áÂπª' },
            { id: 'eastern', icon: 'üèØ', label: 'Êù±ÊñπÁéÑÂπª' },
            { id: 'urban', icon: 'üåÉ', label: 'ÈÉΩÂ∏ÇÁï∞ËÉΩ' },
            { id: 'prehistoric', icon: 'ü¶ï', label: 'Ê¥™ËçíÈÅ†Âè§' },
            { id: 'myth', icon: '‚ö°', label: 'Á•ûË©±È´îÁ≥ª' },
            { id: 'demon', icon: 'üëπ', label: 'Â¶ñÈ≠îÈ¨ºÊÄ™' },
            { id: 'mecha', icon: 'ü§ñ', label: 'Ê©üÁî≤ÁßëÂπª' },
            { id: 'hybrid', icon: 'üîÄ', label: 'Ê∑∑Âêà‰∏ñÁïåËßÄ' },
            { id: 'cthulhu', icon: 'üêô', label: 'ÂÖãËòáÈ≠ØÁ•ûË©±' },
            { id: 'gothic', icon: 'ü¶á', label: 'Âì•ÁâπÂºèÈªëÊöó' },
            { id: 'fairy', icon: 'üßö', label: 'Á´•Ë©±‰∏ñÁïå' },
            { id: 'spirit', icon: 'üëª', label: 'ÈùàÁï∞‰∏ñÁïå' },
          ]
        },
        {
          name: 'Â†¥ÊôØË®≠ÂÆö',
          icon: 'üèõÔ∏è',
          items: [
            { id: 'school', icon: 'üè´', label: 'Â≠∏Èô¢/ÈñÄÊ¥æ' },
            { id: 'dungeon', icon: 'üè∞', label: 'ÂâØÊú¨/Ëø∑ÂÆÆ' },
            { id: 'kingdom', icon: 'üëë', label: 'ÁéãÂúãÂª∫Ë®≠' },
            { id: 'tower', icon: 'üóº', label: 'Áà¨Â°î/ÁôªÈ†Ç' },
            { id: 'guild', icon: 'üè†', label: 'ÂÖ¨ÊúÉÁ∂ìÁáü' },
            { id: 'arena', icon: 'üèüÔ∏è', label: 'Á´∂ÊäÄÂ†¥' },
            { id: 'auction', icon: 'üî®', label: 'ÊãçË≥£ÊúÉ' },
            { id: 'secretRealm', icon: 'üåÄ', label: 'ÁßòÂ¢ÉÊé¢Á¥¢' },
            { id: 'palace', icon: 'üèØ', label: 'ÁöáÂÆÆÂæåÂÆÆ' },
            { id: 'sect', icon: '‚õ©Ô∏è', label: 'ÂÆóÈñÄÂ§ßÊ¥æ' },
            { id: 'city', icon: 'üåÜ', label: 'ÈÉΩÂ∏ÇÂè¢Êûó' },
            { id: 'village', icon: 'üèòÔ∏è', label: 'ÈÑâÊùëÂ∞èÈéÆ' },
            { id: 'forest', icon: 'üå≤', label: 'Ê£ÆÊûóËçíÈáé' },
            { id: 'ocean', icon: 'üåä', label: 'Êµ∑Ê¥ãÂÜíÈö™' },
            { id: 'sky', icon: '‚òÅÔ∏è', label: 'Â§©Á©∫ÊµÆÂ≥∂' },
            { id: 'underground', icon: 'üï≥Ô∏è', label: 'Âú∞‰∏ã‰∏ñÁïå' },
            { id: 'space-station', icon: 'üõ∏', label: 'Â§™Á©∫Á´ô' },
            { id: 'ancient-ruins', icon: 'üèöÔ∏è', label: 'Âè§‰ª£ÈÅ∫Ë∑°' },
            { id: 'military-base', icon: 'üéñÔ∏è', label: 'Ëªç‰∫ãÂü∫Âú∞' },
            { id: 'hospital', icon: 'üè•', label: 'ÈÜ´Èô¢Ë®∫ÊâÄ' },
            { id: 'prison', icon: 'üîí', label: 'Áõ£ÁçÑÂõöÁ±†' },
            { id: 'casino', icon: 'üé∞', label: 'Ë≥≠Â†¥Â®õÊ®ÇÂüé' },
          ]
        },
        {
          name: 'ÁîüÊ¥ªÂÖÉÁ¥†',
          icon: 'üè°',
          items: [
            { id: 'farming', icon: 'üåæ', label: 'Á®ÆÁî∞/Á∂ìÁáü' },
            { id: 'food', icon: 'üçú', label: 'ÁæéÈ£üÊèèÂØ´' },
            { id: 'pet', icon: 'üêæ', label: 'ÂØµÁâ©/ÈùàÁç∏' },
            { id: 'craft', icon: 'üî®', label: 'ÈçõÈÄ†/ÁÖâ‰∏π' },
            { id: 'healing', icon: 'üåø', label: 'Ê≤ªÁôíÊó•Â∏∏' },
            { id: 'travel', icon: 'üó∫Ô∏è', label: 'ÊóÖË°åÂÜíÈö™' },
            { id: 'collection', icon: 'üì¶', label: 'Êî∂ÈõÜÁôñ' },
            { id: 'decoration', icon: 'üè†', label: 'Ë£ùÈ£æ‰ΩàÁΩÆ' },
            { id: 'music', icon: 'üéµ', label: 'Èü≥Ê®ÇËóùË°ì' },
            { id: 'fashion', icon: 'üëó', label: 'ÊúçË£ùË®≠Ë®à' },
            { id: 'medicine', icon: 'üíä', label: 'ÈÜ´Ë°ìÈÜ´ÈÅì' },
            { id: 'teaching', icon: 'üìö', label: 'ÊïôÊõ∏ËÇ≤‰∫∫' },
            { id: 'fishing', icon: 'üé£', label: 'Èá£È≠öÈ§äÊÆñ' },
            { id: 'garden', icon: 'üå∑', label: 'ÂúíËóùËä±Âçâ' },
            { id: 'tea', icon: 'üçµ', label: 'Ëå∂ÈÅìÈõÖ‰∫ã' },
            { id: 'writing', icon: '‚úçÔ∏è', label: 'ËëóÊõ∏Á´ãÂÇ≥' },
            { id: 'cooking', icon: 'üë®‚Äçüç≥', label: 'ÂªöËóùÁÉπÈ£™' },
            { id: 'painting', icon: 'üé®', label: 'Áπ™Áï´ËóùË°ì' },
            { id: 'dance', icon: 'üíÉ', label: 'ËàûËπàË°®Êºî' },
            { id: 'sports', icon: '‚öΩ', label: 'È´îËÇ≤ÈÅãÂãï' },
            { id: 'gambling', icon: 'üé≤', label: 'Ë≥≠ÂçöÂçöÂºà' },
            { id: 'streaming', icon: 'üì∫', label: 'Áõ¥Êí≠/Á∂≤Á¥Ö' },
          ]
        },
        {
          name: 'Á´∂Áà≠Â∞çÊäó',
          icon: '‚öîÔ∏è',
          items: [
            { id: 'faction', icon: '‚öîÔ∏è', label: 'Èô£ÁáüÂ∞çÁ´ã' },
            { id: 'competition', icon: 'üèÜ', label: 'ÊØîË≥ΩÁ´∂ÊäÄ' },
            { id: 'military', icon: 'üéñÔ∏è', label: 'Ëªç‰∫ãÊà∞Áà≠' },
            { id: 'politics', icon: 'üèõÔ∏è', label: 'Ê¨äË¨ÄÊîøÊ≤ª' },
            { id: 'family', icon: 'üë®‚Äçüë©‚Äçüëß', label: 'ÂÆ∂ÊóèËààË°∞' },
            { id: 'trade', icon: 'üí∞', label: 'ÂïÜÊà∞Á∂ìÂïÜ' },
            { id: 'heist', icon: 'üé≠', label: 'ÁõúË≥äË©êÈ®ô' },
            { id: 'survival', icon: 'üèïÔ∏è', label: 'ÁîüÂ≠òÊ∑òÊ±∞' },
            { id: 'ranking', icon: 'üìä', label: 'ÊéíË°åÊ¶úÊà∞' },
            { id: 'territory', icon: 'üó∫Ô∏è', label: 'Âú∞Áõ§Áà≠Â•™' },
            { id: 'resources', icon: '‚õèÔ∏è', label: 'Ë≥áÊ∫êÊé†Â•™' },
            { id: 'throne', icon: 'üëë', label: 'Â•™Â´°Áà≠‰Ωç' },
            { id: 'exam', icon: 'üìù', label: 'ËÄÉË©¶ÁßëËàâ' },
            { id: 'spy', icon: 'üïµÔ∏è', label: 'ÈñìË´úÊΩõ‰ºè' },
            { id: 'assassination', icon: 'üó°Ô∏è', label: 'Âà∫ÊÆ∫ÊöóÊÆ∫' },
            { id: 'rebellion', icon: '‚úä', label: 'Ëµ∑Áæ©ÈÄ†Âèç' },
            { id: 'court-intrigue', icon: 'üèØ', label: 'ÂÆÆÂª∑È¨•Áà≠' },
            { id: 'gang-war', icon: 'üî´', label: 'ÈªëÂπ´ÁÅ´Êãº' },
            { id: 'esports', icon: 'üéÆ', label: 'ÈõªÁ´∂Â∞çÊ±∫' },
            { id: 'idol-battle', icon: 'üé§', label: 'ÂÅ∂ÂÉèÁ´∂Áà≠' },
            { id: 'school-rivalry', icon: 'üè´', label: 'Ê†°ÂúíÂ∞çÁ´ã' },
            { id: 'dimension-war', icon: 'üåå', label: '‰ΩçÈù¢Êà∞Áà≠' },
          ]
        },
        {
          name: 'ÁâπÊÆäËÉΩÂäõ',
          icon: 'üåü',
          items: [
            { id: 'eye', icon: 'üëÅÔ∏è', label: 'ÁâπÊÆäÁúºÁùõ' },
            { id: 'bloodline', icon: 'ü©∏', label: 'Ë°ÄËÑàË¶∫ÈÜí' },
            { id: 'contract', icon: 'üìú', label: 'Â•ëÁ¥ÑÂè¨Âñö' },
            { id: 'transformation', icon: 'ü¶ã', label: 'ËÆäË∫´/ÂåñÂΩ¢' },
            { id: 'mind', icon: 'üß†', label: 'ËÆÄÂøÉ/ÂøÉÈùà' },
            { id: 'element', icon: 'üî•üíß', label: 'ÂÖÉÁ¥†ÊìçÊéß' },
            { id: 'time', icon: '‚è≥', label: 'ÊôÇÈñìËÉΩÂäõ' },
            { id: 'space', icon: 'üåÄ', label: 'Á©∫ÈñìËÉΩÂäõ' },
            { id: 'gravity', icon: 'üåç', label: 'ÈáçÂäõÊìçÊéß' },
            { id: 'illusion', icon: 'üé™', label: 'ÂπªË°ì/ÂπªË±°' },
            { id: 'poison', icon: '‚ò†Ô∏è', label: 'ÊØíË°ìÁî®ÊØí' },
            { id: 'necro', icon: 'üíÄ', label: '‰∫°ÈùàÊ≠ªÈùà' },
            { id: 'holy', icon: 'üòá', label: 'Á•ûËÅñÂÖâÊòé' },
            { id: 'dark', icon: 'üåë', label: 'ÈªëÊöóÂäõÈáè' },
            { id: 'beast', icon: 'üê∫', label: 'Áç∏ÂåñÈáéÊÄß' },
            { id: 'copy', icon: 'üìã', label: 'Ë§áË£ΩËÉΩÂäõ' },
            { id: 'prediction', icon: 'üîÆ', label: 'È†êÁü•Êú™‰æÜ' },
            { id: 'healing-power', icon: 'üíö', label: 'Ê≤ªÁôíËÉΩÂäõ' },
            { id: 'luck-power', icon: 'üçÄ', label: 'Ê∞£ÈÅãÂä†ÊåÅ' },
            { id: 'charm', icon: 'üíã', label: 'È≠ÖÊÉëËÉΩÂäõ' },
            { id: 'domination', icon: 'üëë', label: 'ÊîØÈÖçÈú∏Ê∞£' },
            { id: 'creation', icon: 'üåü', label: 'ÂâµÈÄ†ËÉΩÂäõ' },
          ]
        },
        {
          name: 'Ë∫´‰ªΩËÅ∑Ê•≠',
          icon: 'üëî',
          items: [
            { id: 'prince', icon: 'ü§¥', label: 'ÁéãÂ≠êÂÖ¨‰∏ª' },
            { id: 'assassin', icon: 'üó°Ô∏è', label: 'ÊÆ∫ÊâãÂà∫ÂÆ¢' },
            { id: 'merchant', icon: 'üíº', label: 'ÂïÜ‰∫∫ÂØåË±™' },
            { id: 'knight', icon: '‚öîÔ∏è', label: 'È®éÂ£´ÂãáËÄÖ' },
            { id: 'mage', icon: 'üßô', label: 'Ê≥ïÂ∏´È≠îÊ≥ïÂ∏´' },
            { id: 'thief', icon: 'ü¶π', label: 'ÁõúË≥ä‰ø†Áõú' },
            { id: 'priest', icon: '‚õ™', label: 'Á•ûÂÆòÁ•≠Âè∏' },
            { id: 'hunter', icon: 'üèπ', label: 'Áçµ‰∫∫ÁçµÈ≠î' },
            { id: 'chef', icon: 'üë®‚Äçüç≥', label: 'ÂªöÂ∏´ÁæéÈ£üÂÆ∂' },
            { id: 'doctor', icon: 'üë®‚Äç‚öïÔ∏è', label: 'ÈÜ´ÁîüËó•Â∏´' },
            { id: 'teacher', icon: 'üë®‚Äçüè´', label: 'ËÄÅÂ∏´Â∞éÂ∏´' },
            { id: 'emperor', icon: 'üëë', label: 'Â∏ùÁéãÁöáÂ∏ù' },
            { id: 'slave', icon: '‚õìÔ∏è', label: 'Â•¥Èö∏ÂõöÂæí' },
            { id: 'orphan', icon: 'ü•∫', label: 'Â≠§ÂÖíÊ£ÑÂ≠ê' },
            { id: 'noble', icon: 'üé©', label: 'Ë≤¥Êóè‰∏ñÂÆ∂' },
            { id: 'commoner', icon: 'üë§', label: 'Âπ≥Ê∞ëÁôæÂßì' },
            { id: 'idol', icon: 'üé§', label: 'ÂÅ∂ÂÉèÊòéÊòü' },
            { id: 'programmer', icon: 'üíª', label: 'Á®ãÂ∫èÂì°/Èß≠ÂÆ¢' },
            { id: 'detective', icon: 'üîç', label: 'ÂÅµÊé¢Ë≠¶Êé¢' },
            { id: 'soldier', icon: 'üéñÔ∏è', label: 'Ëªç‰∫∫Â£´ÂÖµ' },
            { id: 'pirate', icon: 'üè¥‚Äç‚ò†Ô∏è', label: 'Êµ∑ÁõúËàπÈï∑' },
            { id: 'necromancer', icon: 'üíÄ', label: 'Ê≠ªÈùàÊ≥ïÂ∏´' },
          ]
        },
        {
          name: 'ÁâπÊÆäË®≠ÂÆö',
          icon: 'üé≤',
          items: [
            { id: 'nonHuman', icon: 'üßù', label: 'Èùû‰∫∫Á®ÆÊóè' },
            { id: 'immortal', icon: '‚ôæÔ∏è', label: '‰∏çÊ≠ªÊ∞∏Áîü' },
            { id: 'reincarnator', icon: 'üîÅ', label: 'Â§öÂë®ÁõÆ' },
            { id: 'reader', icon: 'üìñ', label: 'ÂéüËëóÈª®' },
            { id: 'cannon', icon: 'üí•', label: 'ÁÇÆÁÅ∞Ê±ÇÁîü' },
            { id: 'sickly', icon: 'ü§í', label: 'ÁóÖÂº±È´îË≥™' },
            { id: 'amnesia', icon: '‚ùì', label: 'Â§±ÊÜ∂Ë®≠ÂÆö' },
            { id: 'mute', icon: 'ü§ê', label: 'ÂïûÂ∑¥/Â§±ËÅ≤' },
            { id: 'blind', icon: 'üëì', label: 'Áõ≤‰∫∫Ë®≠ÂÆö' },
            { id: 'curse', icon: 'üîÆ', label: 'Ë©õÂííÁ∫èË∫´' },
            { id: 'seal', icon: 'üîí', label: 'Â∞ÅÂç∞Ëß£Â∞Å' },
            { id: 'clone', icon: 'üë•', label: 'ÂàÜË∫´/Ë§áË£ΩÈ´î' },
            { id: 'ai', icon: 'ü§ñ', label: 'AI/‰∫∫Â∑•Êô∫ÊÖß' },
            { id: 'hybrid', icon: 'üß¨', label: 'Ê∑∑Ë°Ä/Èõú‰∫§' },
            { id: 'gender', icon: '‚ößÔ∏è', label: 'ÊÄßËΩâË®≠ÂÆö' },
            { id: 'age', icon: 'üë∂üë¥', label: 'Âπ¥ÈΩ°ËÆäÂåñ' },
            { id: 'possession', icon: 'üëª', label: 'Ë¢´ÈôÑË∫´' },
            { id: 'shared-body', icon: 'üîÑ', label: 'ÂÖ±Áî®Ë∫´È´î' },
            { id: 'invisible', icon: 'üëÅÔ∏è‚Äçüó®Ô∏è', label: 'Èö±ÂΩ¢‰∫∫' },
            { id: 'miniature', icon: 'üêú', label: 'Á∏ÆÂ∞èËÆäÂ§ß' },
            { id: 'multiple-lives', icon: 'üíú', label: 'Â§öÊ¢ùÂëΩ' },
            { id: 'deadline', icon: '‚è∞', label: 'ÂÄíË®àÊôÇË®≠ÂÆö' },
          ]
        },
        {
          name: 'Á®ÆÊóèË®≠ÂÆö',
          icon: 'üß¨',
          items: [
            { id: 'elf', icon: 'üßù', label: 'Á≤æÈùàÊóè' },
            { id: 'dwarf', icon: '‚õèÔ∏è', label: 'ÁüÆ‰∫∫Êóè' },
            { id: 'dragon', icon: 'üêâ', label: 'ÈæçÊóè' },
            { id: 'vampire', icon: 'üßõ', label: 'Âê∏Ë°ÄÈ¨º' },
            { id: 'werewolf', icon: 'üê∫', label: 'Áãº‰∫∫' },
            { id: 'demon-race', icon: 'üëπ', label: 'È≠îÊóèÊÉ°È≠î' },
            { id: 'angel', icon: 'üòá', label: 'Â§©‰ΩøÊóè' },
            { id: 'beastman', icon: 'ü¶Å', label: 'Áç∏‰∫∫Êóè' },
            { id: 'mermaid', icon: 'üßú', label: '‰∫∫È≠öÊóè' },
            { id: 'ghost', icon: 'üëª', label: 'ÂπΩÈùà‰∫°Èùà' },
            { id: 'spirit', icon: '‚ú®', label: 'Á≤æÈùà/Â¶ñÁ≤æ' },
            { id: 'goblin', icon: 'üë∫', label: 'Âì•Â∏ÉÊûó' },
            { id: 'orc', icon: 'üëπ', label: 'Áç∏‰∫∫/ÂçäÁç∏‰∫∫' },
            { id: 'android', icon: 'ü§ñ', label: 'Ê©üÂô®‰∫∫/‰ªøÁîü‰∫∫' },
            { id: 'alien', icon: 'üëΩ', label: 'Â§ñÊòüÁ®ÆÊóè' },
            { id: 'deity', icon: 'üåü', label: 'Á•ûÊóè' },
          ]
        },
        {
          name: 'Áèæ‰ª£ËÅ∑Â†¥',
          icon: 'üè¢',
          items: [
            { id: 'ceo', icon: 'üëî', label: 'Èú∏ÈÅìÁ∏ΩË£Å' },
            { id: 'secretary', icon: 'üìã', label: 'ÁßòÊõ∏Âä©ÁêÜ' },
            { id: 'lawyer', icon: '‚öñÔ∏è', label: 'ÂæãÂ∏´Ê≥ïÂÆò' },
            { id: 'journalist', icon: 'üì∞', label: 'Ë®òËÄÖÁ∑®ËºØ' },
            { id: 'designer', icon: 'üé®', label: 'Ë®≠Ë®àÂ∏´' },
            { id: 'model', icon: 'üì∏', label: 'Ê®°ÁâπÂÖí' },
            { id: 'athlete', icon: 'üèÉ', label: 'ÈÅãÂãïÂì°' },
            { id: 'scientist', icon: 'üî¨', label: 'ÁßëÂ≠∏ÂÆ∂' },
            { id: 'pilot', icon: '‚úàÔ∏è', label: 'È£õË°åÂì°' },
            { id: 'firefighter', icon: 'üöí', label: 'Ê∂àÈò≤Âì°' },
            { id: 'chef-modern', icon: 'üë®‚Äçüç≥', label: '‰∏ªÂªö' },
            { id: 'baker', icon: 'ü•ñ', label: 'ÁÉòÁÑôÂ∏´' },
            { id: 'barista', icon: '‚òï', label: 'ÂíñÂï°Â∏´' },
            { id: 'bartender', icon: 'üç∏', label: 'Ë™øÈÖíÂ∏´' },
            { id: 'youtuber', icon: 'üì±', label: 'YouTuber' },
            { id: 'writer-modern', icon: '‚úçÔ∏è', label: '‰ΩúÂÆ∂Á∑®Âäá' },
          ]
        },
        {
          name: 'ÊÉÖÂ¢ÉÊ®°Âºè',
          icon: 'üé¨',
          items: [
            { id: 'escape-room', icon: 'üö™', label: 'ÂØÜÂÆ§ÈÄÉËÑ´' },
            { id: 'death-game', icon: '‚ò†Ô∏è', label: 'Ê≠ª‰∫°ÈÅäÊà≤' },
            { id: 'battle-royale', icon: 'üèÜ', label: 'Â§ßÈÄÉÊÆ∫' },
            { id: 'deserted-island', icon: 'üèùÔ∏è', label: 'ËçíÂ≥∂Ê±ÇÁîü' },
            { id: 'haunted-house', icon: 'üëª', label: 'È¨ºÂ±ãÊé¢Èö™' },
            { id: 'treasure-hunt', icon: 'üó∫Ô∏è', label: 'Â∞ãÂØ∂ÈÅäÊà≤' },
            { id: 'murder-mystery', icon: 'üî™', label: 'Ë¨ÄÊÆ∫‰πãË¨é' },
            { id: 'dating-sim', icon: 'üíï', label: 'ÊàÄÊÑõÈÅäÊà≤' },
            { id: 'idol-raising', icon: 'üåü', label: 'ÂÅ∂ÂÉèÈ§äÊàê' },
            { id: 'cooking-battle', icon: 'üç≥', label: 'ÊñôÁêÜÂ∞çÊ±∫' },
            { id: 'music-competition', icon: 'üéµ', label: 'Èü≥Ê®ÇÁ´∂Ë≥Ω' },
            { id: 'fashion-show', icon: 'üëó', label: 'ÊôÇË£ùÁßÄ' },
            { id: 'reality-show', icon: 'üì∫', label: 'Áúü‰∫∫ÁßÄ' },
            { id: 'talent-show', icon: 'üé≠', label: 'ÈÅ∏ÁßÄÁØÄÁõÆ' },
            { id: 'game-show', icon: 'üéÆ', label: 'ÈÅäÊà≤ÁØÄÁõÆ' },
            { id: 'apocalypse-survival', icon: 'üåã', label: 'Êú´Êó•ÁîüÂ≠ò' },
          ]
        }
      ];
      
      // ÊâÅÂπ≥ÂåñÁî®ÊñºÁõ∏ÂÆπËàäÁ®ãÂºèÁ¢º
      const specialElements = specialElementCategories.flatMap(cat => cat.items);

      function pickRandom(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      // ==================== ‰∫∫Áâ©Ë®≠ÂÆö ====================
      function addCharacterRow(randomize = false) {
        const row = document.createElement('div');
        row.className = 'character-row';
        updateCharacterIndices();
        const index = charactersContainer.children.length + 1;
        row.innerHTML = `
          <div class="char-index">‰∫∫Áâ© ${index}</div>
          <select class="char-gender" style="flex: 0 0 70px; min-width: 70px;">
            <option value="Áî∑">Áî∑</option>
            <option value="Â•≥">Â•≥</option>
            <option value="‰∏çÊòé">‰∏çÊòé</option>
          </select>
          <input type="number" class="char-age" placeholder="Âπ¥ÈΩ°" min="1" max="9999" style="flex: 0 0 70px; min-width: 70px;" />
          <input type="text" class="char-name" placeholder="ÂßìÂêç" />
          <input type="text" class="char-personality" placeholder="ÂÄãÊÄß" list="personality-list" />
          <input type="text" class="char-goal" placeholder="ÁõÆÊ®ô" list="goal-list" />
          <input type="text" class="char-weakness" placeholder="Âº±Èªû" list="weakness-list" />
          <input type="text" class="char-secret" placeholder="ÁßòÂØÜ" list="secret-list" />
          <input type="text" class="char-relation" placeholder="‰∫∫Èöõ" list="relation-list" />
          <button type="button" class="char-random-btn btn-outline btn-small">üé≤</button>
          <button type="button" class="char-remove-btn btn-outline btn-small" title="ÁßªÈô§Ê≠§‰∫∫Áâ©">‚úï</button>
        `;
        const randBtn = row.querySelector('.char-random-btn');
        randBtn.addEventListener('click', () => {
          randomizeRow(row, false);
          saveSettingsToLocal();
        });
        
        const removeBtn = row.querySelector('.char-remove-btn');
        removeBtn.addEventListener('click', () => {
          if (charactersContainer.children.length > 1) {
            row.remove();
            updateCharacterIndices();
            saveSettingsToLocal();
          } else {
            alert('Ëá≥Â∞ëÈúÄË¶Å‰øùÁïô‰∏Ä‰Ωç‰∫∫Áâ©ÔºÅ');
          }
        });
        
        // Áõ£ËÅΩËº∏ÂÖ•ËÆäÊõ¥‰ª•Ëá™ÂãïÂÑ≤Â≠ò
        row.querySelectorAll('input, select').forEach(el => {
          el.addEventListener('change', saveSettingsToLocal);
          el.addEventListener('input', debounce(saveSettingsToLocal, 500));
        });
        
        charactersContainer.appendChild(row);
        if (randomize) {
          // Êñ∞Â¢û‰∫∫Áâ©ÊôÇÔºåÂÖàÊî∂ÈõÜÂ∑≤ÊúâÁöÑÂêçÂ≠óÈÅøÂÖçÈáçË§á
          usedNames.clear();
          Array.from(charactersContainer.children).forEach(r => {
            if (r !== row) {
              const name = r.querySelector('.char-name').value.trim();
              if (name) usedNames.add(name);
            }
          });
          randomizeRow(row, false);
        }
      }
      
      // Êõ¥Êñ∞‰∫∫Áâ©Á∑®Ëôü
      function updateCharacterIndices() {
        Array.from(charactersContainer.children).forEach((row, idx) => {
          const indexEl = row.querySelector('.char-index');
          if (indexEl) indexEl.textContent = `‰∫∫Áâ© ${idx + 1}`;
        });
      }
      
      // Èò≤ÊäñÂáΩÊï∏
      function debounce(func, wait) {
        let timeout;
        return function(...args) {
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(this, args), wait);
        };
      }

      // Êô∫ËÉΩÈö®Ê©üÈÅ∏ÊìáÔºöÈÅøÂÖçÈáçË§áÔºà‰∫∫ÂêçÁµïÂ∞ç‰∏çÈáçË§áÔºåÂÖ∂‰ªñÁõ°Èáè‰∏çÈáçË§áÔºâ
      function pickRandomUnique(arr, usedSet, allowRepeat = false) {
        // ÈÅéÊøæÊéâÂ∑≤‰ΩøÁî®ÁöÑÈÅ∏È†Ö
        const available = arr.filter(item => !usedSet.has(item));
        
        // Â¶ÇÊûúÊ≤íÊúâÂèØÁî®ÈÅ∏È†Ö
        if (available.length === 0) {
          if (allowRepeat) {
            // ÂÖÅË®±ÈáçË§áÊôÇÔºåÂæûÂÖ®ÈÉ®ÈÅ∏È†Ö‰∏≠ÈÅ∏
            return arr[Math.floor(Math.random() * arr.length)];
          } else {
            // ‰∏çÂÖÅË®±ÈáçË§áÊôÇÔºåËøîÂõû nullÔºà‰∫∫ÂêçÁî®Ôºâ
            return null;
          }
        }
        
        const chosen = available[Math.floor(Math.random() * available.length)];
        usedSet.add(chosen);
        return chosen;
      }

      // Áî®ÊñºËøΩËπ§Â∑≤‰ΩøÁî®ÁöÑÈÅ∏È†Ö
      let usedNames = new Set();
      let usedPersonalities = new Set();
      let usedGoals = new Set();
      let usedWeaknesses = new Set();
      let usedSecrets = new Set();
      let usedRelations = new Set();

      // ÈáçÁΩÆÊâÄÊúâËøΩËπ§ÔºàÁï∂ÈáçÊñ∞Èö®Ê©üÂÖ®ÈÉ®‰∫∫Áâ©ÊôÇÔºâ
      function resetUsedOptions() {
        usedNames.clear();
        usedPersonalities.clear();
        usedGoals.clear();
        usedWeaknesses.clear();
        usedSecrets.clear();
        usedRelations.clear();
        
        // ÊääÁõÆÂâçÂ∑≤Â°´ÂÖ•ÁöÑ‰∫∫ÂêçÂä†ÂÖ• usedNamesÔºàÈÅøÂÖçËàáÁèæÊúâÈáçË§áÔºâ
        Array.from(charactersContainer.children).forEach(row => {
          const name = row.querySelector('.char-name').value.trim();
          if (name) usedNames.add(name);
        });
      }

      // ÂñÆË°åÈö®Ê©üÂåñÔºàÁî®ÊñºÂñÆÂÄã‰∫∫Áâ©ÁöÑÈö®Ê©üÊåâÈàïÔºâ
      function randomizeRow(row, isFullRandom = false) {
        // Â¶ÇÊûúÊòØÂñÆÁç®Èö®Ê©ü‰∏ÄË°åÔºåÂÖàÊî∂ÈõÜÂÖ∂‰ªñË°åÂ∑≤Áî®ÁöÑÂêçÂ≠ó
        if (!isFullRandom) {
          usedNames.clear();
          Array.from(charactersContainer.children).forEach(r => {
            if (r !== row) {
              const name = r.querySelector('.char-name').value.trim();
              if (name) usedNames.add(name);
            }
          });
        }
        
        // ÂÖàÈö®Ê©üÊÄßÂà•
        const genderSelect = row.querySelector('.char-gender');
        const genders = ['Áî∑', 'Â•≥'];
        genderSelect.value = genders[Math.floor(Math.random() * genders.length)];
        
        // Ê†πÊìöÊÄßÂà•ÈÅ∏ÊìáÂêçÂ≠óÂ∫´
        const gender = genderSelect.value;
        let namePool;
        if (gender === 'Áî∑') {
          namePool = maleNames;
        } else if (gender === 'Â•≥') {
          namePool = femaleNames;
        } else {
          namePool = nameOptions; // ‰∏çÊòéÊÄßÂà•Áî®ÂÖ®ÈÉ®ÂêçÂ≠ó
        }
        
        // ‰∫∫ÂêçÔºöÁµïÂ∞ç‰∏çÈáçË§á
        const newName = pickRandomUnique(namePool, usedNames, false);
        if (newName) {
          row.querySelector('.char-name').value = newName;
        } else {
          // Â¶ÇÊûúË©≤ÊÄßÂà•ÂêçÂ≠óÈÉΩÁî®ÂÆå‰∫ÜÔºåÂæûÂÖ®ÈÉ®ÂêçÂ≠ó‰∏≠ÈÅ∏
          const fallbackName = pickRandomUnique(nameOptions, usedNames, false);
          if (fallbackName) {
            row.querySelector('.char-name').value = fallbackName;
          } else {
            // ÁúüÁöÑÈÉΩÁî®ÂÆå‰∫ÜÔºåÂä†Á∑®Ëôü
            const baseName = namePool[Math.floor(Math.random() * namePool.length)];
            row.querySelector('.char-name').value = baseName + (Math.floor(Math.random() * 100));
          }
        }
        
        // ÂÖ∂‰ªñÂ±¨ÊÄßÔºöÁõ°Èáè‰∏çÈáçË§áÔºå‰ΩÜÂÖÅË®±Âú®ÈÅ∏È†ÖÁî®ÂÆåÊôÇÈáçË§á
        row.querySelector('.char-personality').value = pickRandomUnique(personalityOptions, usedPersonalities, true);
        row.querySelector('.char-goal').value = pickRandomUnique(goalOptions, usedGoals, true);
        row.querySelector('.char-weakness').value = pickRandomUnique(weaknessOptions, usedWeaknesses, true);
        row.querySelector('.char-secret').value = pickRandomUnique(secretOptions, usedSecrets, true);
        row.querySelector('.char-relation').value = pickRandomUnique(relationOptions, usedRelations, true);
        
        // Âπ¥ÈΩ°Èö®Ê©üÔºàÊ†πÊìöÊïÖ‰∫ãÈ°ûÂûãÂèØËÉΩÊúâ‰∏çÂêåÁØÑÂúçÔºåÈÄôË£°Áî®ÈÄöÁî®ÁØÑÂúçÔºâ
        const ageRanges = [
          { min: 6, max: 12, weight: 1 },    // ÂÖíÁ´•
          { min: 13, max: 17, weight: 2 },   // ÈùíÂ∞ëÂπ¥
          { min: 18, max: 25, weight: 4 },   // ÈùíÂπ¥
          { min: 26, max: 35, weight: 3 },   // Â£ØÂπ¥
          { min: 36, max: 50, weight: 2 },   // ‰∏≠Âπ¥
          { min: 51, max: 70, weight: 1 },   // ËÄÅÂπ¥
        ];
        const totalWeight = ageRanges.reduce((sum, r) => sum + r.weight, 0);
        let rand = Math.random() * totalWeight;
        let selectedRange = ageRanges[0];
        for (const range of ageRanges) {
          rand -= range.weight;
          if (rand <= 0) {
            selectedRange = range;
            break;
          }
        }
        row.querySelector('.char-age').value = Math.floor(Math.random() * (selectedRange.max - selectedRange.min + 1)) + selectedRange.min;
      }

      // ÂÖ®ÈÉ®‰∫∫Áâ©Èö®Ê©üÂåñ
      function randomizeAllCharacters() {
        // ÈáçÁΩÆËøΩËπ§
        usedNames.clear();
        usedPersonalities.clear();
        usedGoals.clear();
        usedWeaknesses.clear();
        usedSecrets.clear();
        usedRelations.clear();
        
        // ‰æùÂ∫èÈö®Ê©üÂåñÊØè‰∏ÄË°å
        Array.from(charactersContainer.children).forEach(row => {
          randomizeRow(row, true);
        });
      }

      // ==================== Êú¨Âú∞ÂÑ≤Â≠òË®≠ÂÆö ====================
      function saveSettingsToLocal() {
        try {
          // Êî∂ÈõÜÂ∑≤ÈÅ∏ÊìáÁöÑÁâπÊÆäÂÖÉÁ¥†
          const selectedElements = [];
          specialElementsContainer.querySelectorAll('.special-element-item.selected').forEach(item => {
            selectedElements.push(item.dataset.id);
          });

          const settings = {
            theme: themeSelect.value,
            setting: settingSelect.value,
            style: styleSelect.value,
            chapters: chaptersInput.value,
            length: lengthInput.value,
            notes: notesInput.value,
            // ÈÄ≤ÈöéË®≠ÂÆö
            narrative: narrativeSelect.value,
            era: eraSelect.value,
            pacing: pacingSelect.value,
            rating: ratingSelect.value,
            worldComplexity: worldComplexitySelect.value,
            emotionalTone: emotionalToneSelect.value,
            ending: endingSelect.value,
            specialElements: selectedElements,
            characters: []
          };
          
          Array.from(charactersContainer.children).forEach(row => {
            settings.characters.push({
              gender: row.querySelector('.char-gender').value,
              age: row.querySelector('.char-age').value,
              name: row.querySelector('.char-name').value,
              personality: row.querySelector('.char-personality').value,
              goal: row.querySelector('.char-goal').value,
              weakness: row.querySelector('.char-weakness').value,
              secret: row.querySelector('.char-secret').value,
              relation: row.querySelector('.char-relation').value
            });
          });
          
          localStorage.setItem('novelGeneratorSettings', JSON.stringify(settings));
        } catch (e) {
          console.warn('ÁÑ°Ê≥ïÂÑ≤Â≠òË®≠ÂÆöÔºö', e);
        }
      }
      
      function loadSettingsFromLocal() {
        try {
          const raw = localStorage.getItem('novelGeneratorSettings');
          if (!raw) return false;
          
          const settings = JSON.parse(raw);
          let hasData = false;
          
          // ËºâÂÖ•Âü∫Êú¨Ë®≠ÂÆö
          if (settings.theme) { themeSelect.value = settings.theme; hasData = true; }
          if (settings.setting) { settingSelect.value = settings.setting; hasData = true; }
          if (settings.style) { styleSelect.value = settings.style; hasData = true; }
          if (settings.chapters) { chaptersInput.value = settings.chapters; hasData = true; }
          if (settings.length) { lengthInput.value = settings.length; hasData = true; }
          if (settings.notes) { notesInput.value = settings.notes; hasData = true; }

          // ËºâÂÖ•ÈÄ≤ÈöéË®≠ÂÆö
          if (settings.narrative) { narrativeSelect.value = settings.narrative; hasData = true; }
          if (settings.era) { eraSelect.value = settings.era; hasData = true; }
          if (settings.pacing) { pacingSelect.value = settings.pacing; hasData = true; }
          if (settings.rating) { ratingSelect.value = settings.rating; hasData = true; }
          if (settings.worldComplexity) { worldComplexitySelect.value = settings.worldComplexity; hasData = true; }
          if (settings.emotionalTone) { emotionalToneSelect.value = settings.emotionalTone; hasData = true; }
          if (settings.ending) { endingSelect.value = settings.ending; hasData = true; }

          // ËºâÂÖ•ÁâπÊÆäÂÖÉÁ¥†
          if (settings.specialElements && settings.specialElements.length > 0) {
            settings.specialElements.forEach(id => {
              const item = specialElementsContainer.querySelector(`[data-id="${id}"]`);
              if (item) {
                item.classList.add('selected');
                const checkbox = item.querySelector('input[type="checkbox"]');
                if (checkbox) checkbox.checked = true;
              }
            });
            hasData = true;
          }
          
          // ËºâÂÖ•‰∫∫Áâ©Ë®≠ÂÆö
          if (settings.characters && settings.characters.length > 0) {
            // Ê∏ÖÁ©∫ÁèæÊúâ‰∫∫Áâ©
            charactersContainer.innerHTML = '';
            
            settings.characters.forEach(char => {
              addCharacterRow(false); // ‰∏çÈö®Ê©ü
              const row = charactersContainer.lastElementChild;
              if (row) {
                row.querySelector('.char-gender').value = char.gender || '‰∏çÊòé';
                row.querySelector('.char-age').value = char.age || '';
                row.querySelector('.char-name').value = char.name || '';
                row.querySelector('.char-personality').value = char.personality || '';
                row.querySelector('.char-goal').value = char.goal || '';
                row.querySelector('.char-weakness').value = char.weakness || '';
                row.querySelector('.char-secret').value = char.secret || '';
                row.querySelector('.char-relation').value = char.relation || '';
              }
            });
            hasData = true;
          }
          
          console.log('Ë®≠ÂÆöÂ∑≤ÂæûÊú¨Âú∞ËºâÂÖ•', settings);
          return hasData;
        } catch (e) {
          console.warn('ÁÑ°Ê≥ïËºâÂÖ•Ë®≠ÂÆöÔºö', e);
          return false;
        }
      }
      
      // Áõ£ËÅΩÂü∫Êú¨Ë®≠ÂÆöÁöÑËÆäÊõ¥
      [themeSelect, settingSelect, styleSelect, chaptersInput, lengthInput, notesInput,
       narrativeSelect, eraSelect, pacingSelect, ratingSelect, worldComplexitySelect, emotionalToneSelect, endingSelect].forEach(el => {
        el.addEventListener('change', saveSettingsToLocal);
        el.addEventListener('input', debounce(saveSettingsToLocal, 500));
      });
      
      // ÂãïÊÖãÁîüÊàê‰∏ãÊãâÈÅ∏ÂñÆÈÅ∏È†Ö
      function populateSelectOptions() {
        // ‰∏ªÈ°åÈÅ∏È†Ö
        themes.forEach(theme => {
          const option = document.createElement('option');
          option.value = theme;
          option.textContent = theme;
          themeSelect.appendChild(option);
        });
        
        // ËÉåÊôØË®≠ÂÆöÈÅ∏È†Ö
        settingsData.forEach(setting => {
          const option = document.createElement('option');
          option.value = setting;
          option.textContent = setting;
          settingSelect.appendChild(option);
        });
        
        // È¢®Ê†ºÈÅ∏È†Ö
        stylesArr.forEach(style => {
          const option = document.createElement('option');
          option.value = style;
          option.textContent = style;
          styleSelect.appendChild(option);
        });

        // Êïò‰∫ãË¶ñËßíÈÅ∏È†Ö
        narrativeOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          narrativeSelect.appendChild(option);
        });

        // ÊôÇ‰ª£Ë®≠ÂÆöÈÅ∏È†Ö
        eraOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          eraSelect.appendChild(option);
        });

        // ÊïÖ‰∫ãÁØÄÂ•èÈÅ∏È†Ö
        pacingOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          pacingSelect.appendChild(option);
        });

        // ÂÖßÂÆπÂàÜÁ¥öÈÅ∏È†Ö
        ratingOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          ratingSelect.appendChild(option);
        });

        // ‰∏ñÁïåËßÄË§áÈõúÂ∫¶ÈÅ∏È†Ö
        worldComplexityOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          worldComplexitySelect.appendChild(option);
        });

        // ÊÉÖÊÑüÂü∫Ë™øÈÅ∏È†Ö
        emotionalToneOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          emotionalToneSelect.appendChild(option);
        });

        // ÁµêÂ±ÄÂÇæÂêëÈÅ∏È†Ö
        endingOptions.forEach(item => {
          const option = document.createElement('option');
          option.value = item.value;
          option.textContent = item.label;
          endingSelect.appendChild(option);
        });

        // ÁâπÊÆäÂÖÉÁ¥†Â§öÈÅ∏ÔºàÂàÜÈ°ûÁâàÔºâ
        const categoryTabs = document.getElementById('elementCategoryTabs');
        const elementSearch = document.getElementById('elementSearch');
        const clearElementsBtn = document.getElementById('clearElementsBtn');
        const selectedCountSpan = document.getElementById('selectedCount');
        let currentCategory = 'all';
        
        // Êõ¥Êñ∞Â∑≤ÈÅ∏Êï∏Èáè
        function updateSelectedCount() {
          const count = specialElementsContainer.querySelectorAll('.special-element-item.selected').length;
          selectedCountSpan.textContent = `Â∑≤ÈÅ∏ ${count} È†Ö`;
        }
        
        // Ê∏≤ÊüìÂàÜÈ°ûÊ®ôÁ±§
        function renderCategoryTabs() {
          categoryTabs.innerHTML = '';
          
          // ÂÖ®ÈÉ®Ê®ôÁ±§
          const allTab = document.createElement('button');
          allTab.type = 'button';
          allTab.className = 'category-tab active';
          allTab.dataset.category = 'all';
          allTab.innerHTML = `<span>üìã</span> ÂÖ®ÈÉ® <span class="tab-count">${specialElements.length}</span>`;
          allTab.addEventListener('click', () => selectCategory('all'));
          categoryTabs.appendChild(allTab);
          
          // ÂêÑÂàÜÈ°ûÊ®ôÁ±§
          specialElementCategories.forEach(cat => {
            const tab = document.createElement('button');
            tab.type = 'button';
            tab.className = 'category-tab';
            tab.dataset.category = cat.name;
            tab.innerHTML = `<span>${cat.icon}</span> ${cat.name} <span class="tab-count">${cat.items.length}</span>`;
            tab.addEventListener('click', () => selectCategory(cat.name));
            categoryTabs.appendChild(tab);
          });
        }
        
        // ÈÅ∏ÊìáÂàÜÈ°û
        function selectCategory(category) {
          currentCategory = category;
          
          // Êõ¥Êñ∞Ê®ôÁ±§Ê®£Âºè
          categoryTabs.querySelectorAll('.category-tab').forEach(tab => {
            tab.classList.toggle('active', tab.dataset.category === category);
          });
          
          // ÈÅéÊøæÈ°ØÁ§∫
          filterElements();
        }
        
        // ÈÅéÊøæÂÖÉÁ¥†ÔºàÊ†πÊìöÂàÜÈ°ûÂíåÊêúÂ∞ãÔºâ
        function filterElements() {
          const searchText = elementSearch.value.toLowerCase().trim();
          
          specialElementsContainer.querySelectorAll('.special-element-item').forEach(item => {
            const itemId = item.dataset.id;
            const itemLabel = item.querySelector('.element-label').textContent.toLowerCase();
            
            // Ê™¢Êü•ÂàÜÈ°û
            let inCategory = currentCategory === 'all';
            if (!inCategory) {
              const cat = specialElementCategories.find(c => c.name === currentCategory);
              if (cat) {
                inCategory = cat.items.some(i => i.id === itemId);
              }
            }
            
            // Ê™¢Êü•ÊêúÂ∞ã
            const matchSearch = !searchText || itemLabel.includes(searchText);
            
            // È°ØÁ§∫/Èö±Ëóè
            item.style.display = (inCategory && matchSearch) ? '' : 'none';
          });
        }
        
        // Ê∏≤ÊüìÊâÄÊúâÂÖÉÁ¥†
        function renderAllElements() {
          specialElementsContainer.innerHTML = '';
          
          specialElements.forEach(item => {
            const div = document.createElement('div');
            div.className = 'special-element-item';
            div.dataset.id = item.id;
            div.innerHTML = `
              <input type="checkbox" id="element-${item.id}" />
              <span class="checkbox-custom"></span>
              <span class="element-icon">${item.icon}</span>
              <span class="element-label">${item.label}</span>
            `;
            div.addEventListener('click', () => {
              div.classList.toggle('selected');
              const checkbox = div.querySelector('input[type="checkbox"]');
              checkbox.checked = !checkbox.checked;
              updateSelectedCount();
              saveSettingsToLocal();
            });
            specialElementsContainer.appendChild(div);
          });
        }
        
        // Ê∏ÖÈô§ÊâÄÊúâÈÅ∏Êìá
        clearElementsBtn.addEventListener('click', () => {
          specialElementsContainer.querySelectorAll('.special-element-item.selected').forEach(item => {
            item.classList.remove('selected');
            item.querySelector('input[type="checkbox"]').checked = false;
          });
          updateSelectedCount();
          saveSettingsToLocal();
        });
        
        // ÊêúÂ∞ã‰∫ã‰ª∂
        elementSearch.addEventListener('input', filterElements);
        
        // ÂàùÂßãÂåñ
        renderCategoryTabs();
        renderAllElements();
        updateSelectedCount();
      }

      // ÂàùÂßãÂåñÔºöËºâÂÖ•Ë®≠ÂÆöÊàñÂª∫Á´ãÈ†êË®≠‰∫∫Áâ©
      (function initSettings() {
        // ÂÖàÁîüÊàê‰∏ãÊãâÈÅ∏ÂñÆÈÅ∏È†Ö
        populateSelectOptions();
        
        // ÂòóË©¶ËºâÂÖ•Â∑≤ÂÑ≤Â≠òÁöÑË®≠ÂÆö
        const hasSettings = loadSettingsFromLocal();
        
        // Â¶ÇÊûúÊ≤íÊúâÂ∑≤ÂÑ≤Â≠òÁöÑË®≠ÂÆöÔºåÊâçÂª∫Á´ãÈ†êË®≠‰∫∫Áâ©
        if (!hasSettings) {
          addCharacterRow(true);
          addCharacterRow(true);
        }
        
        // renderBookmarks ÊúÉÂú® initBookmarks ÂÆåÊàêÂæåËá™ÂãïÂëºÂè´
      })();

      randomAllCharactersBtn.addEventListener('click', () => {
        randomizeAllCharacters();
        saveSettingsToLocal();
      });

      addCharacterBtn.addEventListener('click', () => {
        addCharacterRow(true);
        saveSettingsToLocal();
      });

      randomBtn.addEventListener('click', () => {
        themeSelect.value = pickRandom(themes);
        settingSelect.value = pickRandom(settingsData);
        styleSelect.value = pickRandom(stylesArr);
        chaptersInput.value = pickRandom(chapterOpts);
        lengthInput.value = pickRandom(lengthOpts);
        
        // ÈÄ≤ÈöéË®≠ÂÆöÈö®Ê©ü
        narrativeSelect.value = pickRandom(narrativeOptions).value;
        eraSelect.value = pickRandom(eraOptions).value;
        pacingSelect.value = pickRandom(pacingOptions).value;
        ratingSelect.value = pickRandom(ratingOptions).value;
        worldComplexitySelect.value = pickRandom(worldComplexityOptions).value;
        emotionalToneSelect.value = pickRandom(emotionalToneOptions).value;
        endingSelect.value = pickRandom(endingOptions).value;
        
        // Èö®Ê©üÈÅ∏Êìá 2-5 ÂÄãÁâπÊÆäÂÖÉÁ¥†
        const allItems = specialElementsContainer.querySelectorAll('.special-element-item');
        allItems.forEach(item => {
          item.classList.remove('selected');
          const checkbox = item.querySelector('input[type="checkbox"]');
          if (checkbox) checkbox.checked = false;
        });
        
        const shuffled = Array.from(allItems).sort(() => Math.random() - 0.5);
        const numToSelect = Math.floor(Math.random() * 4) + 2; // 2-5 ÂÄã
        shuffled.slice(0, numToSelect).forEach(item => {
          item.classList.add('selected');
          const checkbox = item.querySelector('input[type="checkbox"]');
          if (checkbox) checkbox.checked = true;
        });
        
        randomizeAllCharacters();
        saveSettingsToLocal();
      });

      // ==================== Êô∫ËÉΩÊµÆÂãïÁ´†ÁØÄÂ∞éËà™ ====================

      // ÂàáÊèõÈù¢ÊùøÈ°ØÁ§∫
      chapterNavToggle.addEventListener('click', () => {
        isPanelOpen = !isPanelOpen;
        chapterNavPanel.classList.toggle('open', isPanelOpen);
        // ÈóúÈñâÊõ∏Á±§Èù¢Êùø
        bookmarkNavPanel.classList.remove('open');
        isBookmarkPanelOpen = false;
      });

      chapterNavClose.addEventListener('click', () => {
        isPanelOpen = false;
        chapterNavPanel.classList.remove('open');
      });

      // ==================== ÊµÆÂãïÊõ∏Á±§Â∞éËà™ ====================
      const bookmarkNavContainer = document.getElementById('bookmarkNavContainer');
      const bookmarkNavToggle = document.getElementById('bookmarkNavToggle');
      const bookmarkNavPanel = document.getElementById('bookmarkNavPanel');
      const bookmarkNavClose = document.getElementById('bookmarkNavClose');
      const bookmarkBadge = document.getElementById('bookmarkBadge');
      const bookmarkEmpty = document.getElementById('bookmarkEmpty');
      let isBookmarkPanelOpen = false;

      // ÂàáÊèõÊõ∏Á±§Èù¢Êùø
      bookmarkNavToggle.addEventListener('click', () => {
        isBookmarkPanelOpen = !isBookmarkPanelOpen;
        bookmarkNavPanel.classList.toggle('open', isBookmarkPanelOpen);
        // ÈóúÈñâÁ´†ÁØÄÈù¢Êùø
        chapterNavPanel.classList.remove('open');
        isPanelOpen = false;
      });

      bookmarkNavClose.addEventListener('click', () => {
        isBookmarkPanelOpen = false;
        bookmarkNavPanel.classList.remove('open');
      });

      // ÈªûÊìäÈù¢ÊùøÂ§ñÈÉ®ÈóúÈñâ
      document.addEventListener('click', (e) => {
        // ÈóúÈñâÁ´†ÁØÄÈù¢Êùø
        if (isPanelOpen && 
            !chapterNavPanel.contains(e.target) && 
            !chapterNavToggle.contains(e.target)) {
          isPanelOpen = false;
          chapterNavPanel.classList.remove('open');
        }
        // ÈóúÈñâÊõ∏Á±§Èù¢Êùø
        if (isBookmarkPanelOpen && 
            !bookmarkNavPanel.contains(e.target) && 
            !bookmarkNavToggle.contains(e.target)) {
          isBookmarkPanelOpen = false;
          bookmarkNavPanel.classList.remove('open');
        }
      });

      // Êõ¥Êñ∞Êõ∏Á±§ÂæΩÁ´†Êï∏Èáè
      function updateBookmarkBadge() {
        const count = bookmarksCache.length;
        bookmarkBadge.textContent = count;
        bookmarkBadge.style.display = count > 0 ? 'block' : 'none';
        
        // Êõ¥Êñ∞Á©∫ÁãÄÊÖãÈ°ØÁ§∫
        if (bookmarkEmpty) {
          bookmarkEmpty.style.display = count === 0 ? 'block' : 'none';
        }
        if (bookmarkList) {
          bookmarkList.style.display = count > 0 ? 'flex' : 'none';
        }
      }

      // Èñ±ËÆÄÈÄ≤Â∫¶ËøΩËπ§
      window.addEventListener('scroll', () => {
        if (!resultDiv.textContent) return;
        
        const rect = resultDiv.getBoundingClientRect();
        const windowHeight = window.innerHeight;
        const docHeight = resultDiv.offsetHeight;
        
        // Ë®àÁÆóÈñ±ËÆÄÈÄ≤Â∫¶
        if (rect.top < windowHeight && rect.bottom > 0) {
          const visibleTop = Math.max(0, -rect.top);
          const progress = Math.min(100, (visibleTop / (docHeight - windowHeight)) * 100);
          readingProgress.style.width = Math.max(0, Math.min(100, progress)) + '%';
        }
        
        // Ëá™ÂãïÊõ¥Êñ∞Áï∂ÂâçÁ´†ÁØÄÈ´ò‰∫Æ
        updateCurrentChapter();
      });

      function updateCurrentChapter() {
        if (chapterMatches.length === 0) return;
        
        const scrollY = window.scrollY;
        const resultRect = resultDiv.getBoundingClientRect();
        const resultTop = resultRect.top + window.scrollY;
        
        let currentChapterIdx = 0;
        
        for (let i = 0; i < chapterMatches.length; i++) {
          const chapterTitle = chapterMatches[i].title;
          const textContent = resultDiv.textContent;
          const chapterIndex = textContent.indexOf(chapterTitle);
          
          // ‰º∞ÁÆóÁ´†ÁØÄÂú®È†ÅÈù¢‰∏≠ÁöÑ‰ΩçÁΩÆ
          const ratio = chapterIndex / textContent.length;
          const estimatedPos = resultTop + (resultDiv.offsetHeight * ratio);
          
          if (scrollY >= estimatedPos - 100) {
            currentChapterIdx = i;
          }
        }
        
        // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
        const buttons = chapterNavList.querySelectorAll('button');
        buttons.forEach((btn, idx) => {
          btn.classList.toggle('active', idx === currentChapterIdx);
        });
      }

      function parseAndShowChapters(text) {
        chapterMatches = [];
        
        // Á≠ñÁï•ÔºöÂè™ÂåπÈÖçÊ≠£Êñá‰∏≠ÁöÑÁ´†ÁØÄÊ®ôÈ°å
        // Ê≠£ÊñáÁ´†ÁØÄÁâπÂæµÔºö‰ª• ## Êàñ ### ÈñãÈ†≠ÔºàmarkdownÊ†ºÂºèÔºâ
        // ÁõÆÈåÑÁ´†ÁØÄÁâπÂæµÔºö‰ª•Êï∏Â≠óÁ∑®ËôüÈñãÈ†≠ÔºåÂ¶Ç "1." "2." ÊàñÊúâ ** Á≤óÈ´îÊ®ôË®ò
        
        // Á´†ÁØÄÊ®°ÂºèÔºöÁ¨¨XÁ´†„ÄÅÂ∫èÁ´†„ÄÅÊ•îÂ≠ê„ÄÅÂ∞æËÅ≤„ÄÅÁµÇÁ´†„ÄÅÁï™Â§ñÁ≠â
        // ÊîØÊè¥Ôºö‰∏Ä‰∫å‰∏â...ÔºàÂ∞èÂØ´Ôºâ„ÄÅÂ£πË≤≥ÂèÉ...ÔºàÂ§ßÂØ´Ôºâ„ÄÅ1234...ÔºàÈòøÊãâ‰ºØÊï∏Â≠óÔºâ
        const chapterNumPattern = '[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÈõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞\\d]+';
        const chapterPattern = new RegExp(`(?:Á¨¨${chapterNumPattern}Á´†|Â∫èÁ´†|Ê•îÂ≠ê|ÂºïÂ≠ê|ÂâçË®Ä|Â∞æËÅ≤|ÁµÇÁ´†|Áï™Â§ñ|ÂæåË®ò|epilogue|prologue)[Ôºö:]*[^\\n]*`, 'i');
        
        const lines = text.split('\n');
        
        for (let i = 0; i < lines.length; i++) {
          const line = lines[i];
          
          // ÂåπÈÖç‰ª• ## Êàñ ### ÈñãÈ†≠ÁöÑÁ´†ÁØÄÊ®ôÈ°åÔºàÈÄôÊòØÊ≠£ÊñáÁ´†ÁØÄÔºâ
          const markdownRegex = new RegExp(`^##[#]?\\s*((?:Á¨¨${chapterNumPattern}Á´†|Â∫èÁ´†|Ê•îÂ≠ê|ÂºïÂ≠ê|ÂâçË®Ä|Â∞æËÅ≤|ÁµÇÁ´†|Áï™Â§ñ|ÂæåË®ò)[Ôºö:].*)$`, 'i');
          const markdownMatch = line.match(markdownRegex);
          
          if (markdownMatch) {
            // Ë®àÁÆóÈÄô‰∏ÄË°åÂú®ÂéüÊñá‰∏≠ÁöÑ‰ΩçÁΩÆ
            let index = 0;
            for (let j = 0; j < i; j++) {
              index += lines[j].length + 1; // +1 for \n
            }
            
            chapterMatches.push({
              title: markdownMatch[1].trim(),
              fullLine: line,
              index: index
            });
          }
        }
        
        // Â¶ÇÊûúÊ≤íÊúâÊâæÂà∞ ### Ê†ºÂºèÔºåÂòóË©¶ÊâæÁç®Á´ãË°åÁöÑÁ´†ÁØÄÊ®ôÈ°åÔºà‰∏çÊòØÂàóË°®È†ÖÔºâ
        if (chapterMatches.length === 0) {
          for (let i = 0; i < lines.length; i++) {
            const line = lines[i];
            const prevLine = i > 0 ? lines[i - 1] : '';
            
            // ÊéíÈô§ÁõÆÈåÑÈ†ÖÔºö‰∏ç‰ª•Êï∏Â≠óÈñãÈ†≠„ÄÅ‰∏çÂê´ ** Á≤óÈ´î„ÄÅÂâç‰∏ÄË°åÊòØÁ©∫Ë°å
            const isListItem = /^\d+\.\s/.test(line) || /\*\*/.test(line);
            const isAfterBlankLine = prevLine.trim() === '' || prevLine.trim() === '---';
            
            if (!isListItem && isAfterBlankLine) {
              const standaloneRegex = new RegExp(`^((?:Á¨¨${chapterNumPattern}Á´†|Â∫èÁ´†|Ê•îÂ≠ê|ÂºïÂ≠ê|ÂâçË®Ä|Â∞æËÅ≤|ÁµÇÁ´†|Áï™Â§ñ|ÂæåË®ò)[Ôºö:].*)$`, 'i');
              const match = line.match(standaloneRegex);
              if (match) {
                let index = 0;
                for (let j = 0; j < i; j++) {
                  index += lines[j].length + 1;
                }
                chapterMatches.push({
                  title: match[1].trim(),
                  fullLine: line,
                  index: index
                });
              }
            }
          }
        }
        
        // ÂéªÈô§ÈáçË§áÔºà‰ª•Á´†ÁØÄÁ∑®ËôüÊàñÂêçÁ®±ÁÇ∫Ê∫ñÔºâ
        const seenChapters = new Set();
        chapterMatches = chapterMatches.filter(m => {
          // ÊèêÂèñÁ´†ÁØÄÊ®ôË≠òÔºàÂ¶Ç„ÄåÁ¨¨‰∏ÄÁ´†„Äç„ÄåÁ¨¨Â£πÁ´†„Äç„ÄåÂ∫èÁ´†„Äç„ÄåÊ•îÂ≠ê„ÄçÁ≠âÔºâ
          const chapterIdRegex = new RegExp(`Á¨¨${chapterNumPattern}Á´†|Â∫èÁ´†|Ê•îÂ≠ê|ÂºïÂ≠ê|ÂâçË®Ä|Â∞æËÅ≤|ÁµÇÁ´†|Áï™Â§ñ|ÂæåË®ò`, 'i');
          const chapterIdMatch = m.title.match(chapterIdRegex);
          if (chapterIdMatch) {
            const chapterId = chapterIdMatch[0];
            if (!seenChapters.has(chapterId)) {
              seenChapters.add(chapterId);
              return true;
            }
          }
          return false;
        });

        // Âè™Ë¶ÅÊúâÁ´†ÁØÄÂ∞±È°ØÁ§∫ÔºàÊîπÁÇ∫ >= 1Ôºâ
        if (chapterMatches.length >= 1) {
          // È°ØÁ§∫ÊµÆÂãïÂ∞éËà™
          chapterNavContainer.classList.add('show');
          chapterBadge.textContent = chapterMatches.length;
          
          // ÁîüÊàêÁ´†ÁØÄÂàóË°®
          chapterNavList.innerHTML = chapterMatches.map((m, i) => 
            `<button type="button" data-chapter="${i}">
              <span class="chapter-num">${i + 1}</span>
              ${m.title.substring(0, 20)}${m.title.length > 20 ? '...' : ''}
            </button>`
          ).join('');
          
          // Á∂ÅÂÆöÈªûÊìä‰∫ã‰ª∂
          chapterNavList.querySelectorAll('button').forEach((btn, idx) => {
            btn.addEventListener('click', () => {
              const chapter = chapterMatches[idx];
              const fullText = resultDiv.textContent;
              
              // ÊêúÂ∞ãÂÆåÊï¥ÁöÑÁ´†ÁØÄË°åÔºàÂåÖÂê´ ### Êàñ‰∏çÂê´Ôºâ
              // Âõ†ÁÇ∫ textContent ‰∏çÊúÉ‰øùÁïô ### Á¨¶ËôüÔºåÈúÄË¶ÅÊêúÂ∞ãÊ®ôÈ°åÊú¨Ë∫´
              const searchTitle = chapter.title;
              
              // ÂæûÂÑ≤Â≠òÁöÑ index ÈôÑËøëÊêúÂ∞ãÔºàÈÅøÂÖçÊâæÂà∞ÁõÆÈåÑÔºâ
              // ÊâæÊâÄÊúâÂá∫Áèæ‰ΩçÁΩÆÔºåÈÅ∏ÊìáÊúÄÊé•ËøëÂÑ≤Â≠ò index ÁöÑÈÇ£ÂÄã
              let bestIndex = -1;
              let searchStart = 0;
              
              while (true) {
                const foundIndex = fullText.indexOf(searchTitle, searchStart);
                if (foundIndex === -1) break;
                
                // Ê™¢Êü•ÈÄôÂÄã‰ΩçÁΩÆÊòØÂê¶Êõ¥Êé•ËøëÁõÆÊ®ô
                if (bestIndex === -1 || Math.abs(foundIndex - chapter.index) < Math.abs(bestIndex - chapter.index)) {
                  // È°çÂ§ñÊ™¢Êü•ÔºöÈÄôÂÄã‰ΩçÁΩÆÂâçÈù¢‰∏çÊáâË©≤ÊòØÊï∏Â≠óÁ∑®ËôüÔºàÊéíÈô§ÁõÆÈåÑÔºâ
                  const beforeText = fullText.substring(Math.max(0, foundIndex - 10), foundIndex);
                  const isInTOC = /\d+\.\s*$/.test(beforeText) || /\*\*\s*$/.test(beforeText);
                  
                  if (!isInTOC) {
                    bestIndex = foundIndex;
                  }
                }
                searchStart = foundIndex + 1;
              }
              
              if (bestIndex !== -1) {
                const beforeChapter = fullText.substring(0, bestIndex);
                const chapterText = searchTitle;
                const afterChapter = fullText.substring(bestIndex + searchTitle.length);
                
                resultDiv.innerHTML = 
                  escapeHtml(beforeChapter) + 
                  '<span id="chapter-target" style="scroll-margin-top: 20px;">' + escapeHtml(chapterText) + '</span>' + 
                  escapeHtml(afterChapter);
                
                const target = document.getElementById('chapter-target');
                if (target) {
                  target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                  
                  // È´ò‰∫ÆÊïàÊûú
                  target.style.background = 'linear-gradient(90deg, rgba(233, 69, 96, 0.3), rgba(244, 162, 97, 0.1))';
                  target.style.borderRadius = '4px';
                  target.style.padding = '4px 8px';
                  target.style.marginLeft = '-8px';
                  
                  setTimeout(() => {
                    target.style.transition = 'background 1.5s ease';
                    target.style.background = 'transparent';
                  }, 2000);
                }
              }
              
              // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
              chapterNavList.querySelectorAll('button').forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
              
              // Ë°åÂãïË£ùÁΩÆ‰∏äËá™ÂãïÈóúÈñâÈù¢Êùø
              if (window.innerWidth <= 768) {
                isPanelOpen = false;
                chapterNavPanel.classList.remove('open');
              }
            });
          });
        } else {
          chapterNavContainer.classList.remove('show');
          chapterMatches = [];
        }
      }

      // HTML ËΩâÁæ©ÂáΩÊï∏
      function escapeHtml(text) {
        return text
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
      }

      // ==================== ÁîüÊàêÊïÖ‰∫ã ====================
      generateBtn.addEventListener('click', async () => {
        // Ê™¢Êü•Èõ¢Á∑öÁãÄÊÖã
        if (!navigator.onLine) {
          showStatus('error', 'üì¥ ÁõÆÂâçÁÇ∫Èõ¢Á∑öÊ®°ÂºèÔºåÁÑ°Ê≥ïÁîüÊàêÊïÖ‰∫ã„ÄÇË´ãÈÄ£Êé•Á∂≤Ë∑ØÂæåÂÜçË©¶„ÄÇ');
          return;
        }
        
        hideStatus();
        resultDiv.textContent = '';
        chapterNavContainer.classList.remove('show');
        chapterMatches = [];
        localStorage.removeItem('savedStory');
        latestStory = '';
        downloadBtn.disabled = true;
        continueBtn.disabled = true;

        const apiKey = apiKeyInput.value.trim();
        const model = modelSelect.value;
        const theme = themeSelect.value.trim();
        const setting = settingSelect.value.trim();
        
        const characterRows = Array.from(charactersContainer.querySelectorAll('.character-row'));
        let charactersInfo = '';
        let characterNames = [];
        let characterCount = 0;
        
        characterRows.forEach((row, idx) => {
          const fields = [];
          const gender = row.querySelector('.char-gender').value;
          const age = row.querySelector('.char-age').value.trim();
          const name = row.querySelector('.char-name').value.trim();
          const personality = row.querySelector('.char-personality').value.trim();
          const goal = row.querySelector('.char-goal').value.trim();
          const weakness = row.querySelector('.char-weakness').value.trim();
          const secret = row.querySelector('.char-secret').value.trim();
          const relation = row.querySelector('.char-relation').value.trim();
          if (name) {
            fields.push(`„Äê${name}„Äë`);
            characterNames.push(name);
          }
          if (gender && gender !== '‰∏çÊòé') fields.push(`ÊÄßÂà•Ôºö${gender}`);
          if (age) fields.push(`Âπ¥ÈΩ°Ôºö${age}Ê≠≤`);
          if (personality) fields.push(`ÂÄãÊÄßÔºö${personality}`);
          if (goal) fields.push(`ÁõÆÊ®ôÔºö${goal}`);
          if (weakness) fields.push(`Âº±ÈªûÔºö${weakness}`);
          if (secret) fields.push(`ÁßòÂØÜÔºö${secret}`);
          if (relation) fields.push(`‰∫∫ÈöõÈóú‰øÇÔºö${relation}`);
          if (fields.length > 0) {
            charactersInfo += `ËßíËâ≤${idx + 1}Ôºö${fields.join('Ôºå')}„ÄÇ\n`;
            characterCount++;
          }
        });
        
        const style = styleSelect.value.trim();
        const chapters = chaptersInput.value.trim();
        const length = lengthInput.value.trim();
        const notes = notesInput.value.trim();

        // ÈÄ≤ÈöéË®≠ÂÆö
        const narrative = narrativeSelect.value.trim();
        const era = eraSelect.value.trim();
        const pacing = pacingSelect.value.trim();
        const rating = ratingSelect.value.trim();
        const worldComplexity = worldComplexitySelect.value.trim();
        const emotionalTone = emotionalToneSelect.value.trim();
        const ending = endingSelect.value.trim();
        
        // Êî∂ÈõÜÁâπÊÆäÂÖÉÁ¥†
        const selectedElements = [];
        specialElementsContainer.querySelectorAll('.special-element-item.selected').forEach(item => {
          const label = item.querySelector('.element-label').textContent;
          selectedElements.push(label);
        });

        if (!apiKey) {
          showStatus('error', 'Ë´ãËº∏ÂÖ• API ÈáëÈë∞');
          return;
        }
        
        if (!theme && !setting && !charactersInfo && !style && !chapters && !length && !notes) {
          showStatus('error', 'Ë´ãËá≥Â∞ëÂ°´ÂØ´‰∏ÄÈ†ÖË®≠ÂÆöÊàñ‰ΩøÁî®Èö®Ê©üÂ°´ÂÖÖ');
          return;
        }

        // ÊßãÂª∫ÁµêÊßãÂåñÁöÑ prompt
        let prompt = '„ÄêÂ∞èË™™Ââµ‰ΩúË®≠ÂÆö„Äë\n\n';
        
        // ===== Âü∫Êú¨Ë®≠ÂÆöÂçÄ =====
        let basicSettings = [];
        if (theme) basicSettings.push(`‰∏ªÈ°åÔºö${theme}`);
        if (setting) basicSettings.push(`ËÉåÊôØË®≠ÂÆöÔºö${setting}`);
        if (era) basicSettings.push(`ÊôÇ‰ª£ËÉåÊôØÔºö${era}`);
        if (style) basicSettings.push(`ÊïÖ‰∫ãÈ¢®Ê†ºÔºö${style}`);
        
        if (basicSettings.length > 0) {
          prompt += `„ÄêÂü∫Êú¨Ë®≠ÂÆö„Äë\n${basicSettings.join('\n')}\n\n`;
        }
        
        // ===== ‰∫∫Áâ©Ë®≠ÂÆöÂçÄ =====
        if (charactersInfo) {
          prompt += `„Äê‰∏ªË¶ÅÁôªÂ†¥‰∫∫Áâ©ÔºàÂÖ±${characterCount}‰ΩçÔºå‚òÖÂÖ®ÈÉ®ÂøÖÈ†àÂá∫Áèæ‚òÖÔºâ„Äë\n${charactersInfo}`;
          if (characterNames.length > 0) {
            prompt += `‚ö†Ô∏è ÈáçË¶ÅÔºö‰ª•‰∏äÊâÄÊúâËßíËâ≤Ôºà${characterNames.join('„ÄÅ')}ÔºâÈÉΩÂøÖÈ†àÂú®ÊïÖ‰∫ã‰∏≠ÁôªÂ†¥‰∏¶ÊúâÂØ¶ÈöõÊà≤‰ªΩÔºÅ\n`;
          }
          prompt += '\n';
        }
        
        // ===== ÂØ´‰ΩúÈ¢®Ê†ºË®≠ÂÆöÂçÄ =====
        let styleSettings = [];
        if (narrative) styleSettings.push(`Êïò‰∫ãË¶ñËßíÔºö${narrative}`);
        if (pacing) styleSettings.push(`ÊïÖ‰∫ãÁØÄÂ•èÔºö${pacing}`);
        if (emotionalTone) styleSettings.push(`ÊÉÖÊÑüÂü∫Ë™øÔºö${emotionalTone}`);
        if (worldComplexity) styleSettings.push(`‰∏ñÁïåËßÄË§áÈõúÂ∫¶Ôºö${worldComplexity}`);
        if (rating) styleSettings.push(`ÂÖßÂÆπÂàÜÁ¥öÔºö${rating}`);
        if (ending) styleSettings.push(`ÁµêÂ±ÄÂÇæÂêëÔºö${ending}`);
        
        if (styleSettings.length > 0) {
          prompt += `„ÄêÂØ´‰ΩúÈ¢®Ê†ºË®≠ÂÆöÔºà‚òÖÂøÖÈ†àÂö¥Ê†ºÈÅµÂÆà‚òÖÔºâ„Äë\n${styleSettings.join('\n')}\n\n`;
        }
        
        // ===== ÁâπÊÆäÂÖÉÁ¥†ÂçÄ =====
        if (selectedElements.length > 0) {
          prompt += `„ÄêÁâπÊÆäÂÖÉÁ¥†Ôºà‚òÖÂøÖÈ†àËûçÂÖ•ÊïÖ‰∫ã‚òÖÔºâ„Äë\n${selectedElements.join('„ÄÅ')}\n\n`;
        }
        
        // ===== ÁØáÂπÖË®≠ÂÆöÂçÄ =====
        let lengthSettings = [];
        if (chapters) lengthSettings.push(`Á´†ÁØÄÊï∏Ôºö${chapters} Á´†`);
        if (length) lengthSettings.push(`Á∏ΩÂ≠óÊï∏ÔºöÁ¥Ñ ${length} Â≠ó`);
        
        if (lengthSettings.length > 0) {
          prompt += `„ÄêÁØáÂπÖË®≠ÂÆö„Äë\n${lengthSettings.join('\n')}\n\n`;
        }
        
        // ===== Ë£úÂÖÖË™™ÊòéÂçÄ =====
        if (notes) {
          prompt += `„ÄêË£úÂÖÖË™™Êòé„Äë\n${notes}\n\n`;
        }
        
        // ===== ÁîüÊàêË®≠ÂÆöÊ∏ÖÂñÆÔºàÁî®ÊñºÊúÄÂæåÁöÑÂº∑Ë™øÔºâ =====
        let settingsList = [];
        if (theme) settingsList.push(`‰∏ªÈ°å„Äå${theme}„Äç`);
        if (setting) settingsList.push(`ËÉåÊôØ„Äå${setting}„Äç`);
        if (era) settingsList.push(`ÊôÇ‰ª£„Äå${era}„Äç`);
        if (style) settingsList.push(`È¢®Ê†º„Äå${style}„Äç`);
        if (narrative) settingsList.push(`Ë¶ñËßí„Äå${narrative}„Äç`);
        if (pacing) settingsList.push(`ÁØÄÂ•è„Äå${pacing}„Äç`);
        if (emotionalTone) settingsList.push(`Âü∫Ë™ø„Äå${emotionalTone}„Äç`);
        if (worldComplexity) settingsList.push(`‰∏ñÁïåËßÄ„Äå${worldComplexity}„Äç`);
        if (rating) settingsList.push(`ÂàÜÁ¥ö„Äå${rating}„Äç`);
        if (ending) settingsList.push(`ÁµêÂ±Ä„Äå${ending}„Äç`);
        
        // Á´†ÁØÄÂÆåÁµêÊèêÁ§∫
        let chapterEndingHint = '';
        if (chapters) {
          chapterEndingHint = `
12. ÊïÖ‰∫ãÁ∏ΩÂÖ± ${chapters} Á´†ÔºåÁ¨¨ ${chapters} Á´†ÂøÖÈ†àÊòØ„ÄêÂÆåÁµêÁØá„ÄëÔºåË¶ÅÂ¶•ÂñÑÊî∂Â∞æÊâÄÊúâÂäáÊÉÖÁ∑ö
13. Âú®ÊúÄÂæå‰∏ÄÁ´†ÁµêÊùüÂæåÔºåÂä†‰∏ä„ÄåÔºàÂÖ®ÊñáÂÆåÔºâ„ÄçÊàñ„Äå‚îÄ ÂÆå ‚îÄ„ÄçÊ®ôË®ò`;
        }
        
        // ‰∫∫Áâ©ÁôªÂ†¥Âº∑Ë™ø
        let characterReminder = '';
        if (characterCount > 0) {
          characterReminder = `
11. ‚òÖ‚òÖ‚òÖ„ÄêÊ•µÈáçË¶Å„ÄëÊïÖ‰∫ã‰∏≠ÂøÖÈ†àËÆìÊâÄÊúâ ${characterCount} ‰ΩçË®≠ÂÆöËßíËâ≤ÈÉΩÁôªÂ†¥${characterNames.length > 0 ? `Ôºà${characterNames.join('„ÄÅ')}Ôºâ` : ''}ÔºåÊØè‰ΩçËßíËâ≤ÈÉΩË¶ÅÊúâÂè∞Ë©ûÊàñË°åÂãïÔºå‰∏çÂèØÈÅ∫Êºè‰ªª‰Ωï‰∏Ä‰Ωç`;
        }
        
        // Ë®≠ÂÆöÈÅµÂÆàÂº∑Ë™ø
        let settingsReminder = '';
        if (settingsList.length > 0) {
          settingsReminder = `
10. ‚òÖ‚òÖ‚òÖ„ÄêÂøÖÈ†àÈÅµÂÆàÊâÄÊúâË®≠ÂÆö„Äë${settingsList.join('„ÄÅ')}`;
        }
        
        // ÁâπÊÆäÂÖÉÁ¥†Âº∑Ë™ø
        let elementsReminder = '';
        if (selectedElements.length > 0) {
          elementsReminder = `
9. ÂøÖÈ†àÂ∞áÁâπÊÆäÂÖÉÁ¥†„Äå${selectedElements.join('„ÄÅ')}„ÄçËá™ÁÑ∂ËûçÂÖ•ÊïÖ‰∫ãÊÉÖÁØÄ‰∏≠`;
        }
        
        prompt += `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
„ÄêÈáçË¶ÅÊåáÁ§∫„ÄëË´ãÁõ¥Êé•Êí∞ÂØ´Â∞èË™™„ÄåÊ≠£ÊñáÂÖßÂÆπ„ÄçÔºåÂö¥Ê†ºÊåâÁÖß‰ª•‰∏äÊâÄÊúâË®≠ÂÆöÈÄ≤Ë°åÂâµ‰Ωú„ÄÇ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ÂØ´‰ΩúË¶ÅÊ±ÇÔºö
1. Áõ¥Êé•ÈñãÂßãÂØ´ÊïÖ‰∫ãÊ≠£ÊñáÔºåÂåÖÂê´Â†¥ÊôØÊèèÂØ´„ÄÅ‰∫∫Áâ©Â∞çË©±„ÄÅÂøÉÁêÜÊ¥ªÂãï„ÄÅÊÉÖÁØÄÁôºÂ±ï
2. ÊØèÂÄãÁ´†ÁØÄÈÉΩË¶ÅÊúâÂÆåÊï¥ÁöÑÊïÖ‰∫ãÂÖßÂÆπÔºàËá≥Â∞ë2000-3000Â≠óÔºâÔºå‰∏çÊòØÁ∞°Áü≠ÁöÑÊëòË¶Å
3. Á´†ÁØÄÊ®ôÈ°åÊ†ºÂºèÔºö### Á¨¨XÁ´†ÔºöÊ®ôÈ°åÔºàÊàñ ### Â∫èÁ´†ÔºöÊ®ôÈ°åÔºâ
4. ‰ΩøÁî®ÁπÅÈ´î‰∏≠ÊñáÊí∞ÂØ´
5. ÊïÖ‰∫ãË¶ÅÊúâËµ∑ÊâøËΩâÂêàÔºåÊÉÖÁØÄÂÆåÊï¥
6. Á¶ÅÊ≠¢Âá∫Áèæ„ÄåÊïÖ‰∫ãÂ§ßÁ∂±„Äç„ÄåÁ´†ÁØÄÂàóË°®„Äç„ÄåÊïÖ‰∫ãÁ∞°‰ªã„Äç„Äå‰∫∫Áâ©Ë®≠ÂÆö„ÄçÁ≠âË¶èÂäÉÊÄßÂÖßÂÆπ
7. Á¶ÅÊ≠¢‰ΩøÁî®Ê¢ùÂàóÂºèË™™ÊòéÔºåË¶ÅÁî®Êïò‰∫ãÊñáÈ´î
8. Âö¥Ê†ºÈÅµÂÆàÊåáÂÆöÁöÑÊïò‰∫ãË¶ñËßí„ÄÅÊïÖ‰∫ãÁØÄÂ•è„ÄÅÊÉÖÊÑüÂü∫Ë™ø„ÄÅÂÖßÂÆπÂàÜÁ¥ö${elementsReminder}${settingsReminder}${characterReminder}${chapterEndingHint}

ÁèæÂú®ÈñãÂßãÊí∞ÂØ´Â∞èË™™Ê≠£ÊñáÔºö`;

        showStatus('loading', 'ÊïÖ‰∫ãÁîüÊàê‰∏≠ÔºåË´ãÁ®çÂÄô...');
        generateBtn.disabled = true;
        
        // È°ØÁ§∫ÁîüÊàêÈÄ≤Â∫¶
        showGenerationProgress();
        document.getElementById('progressChapter').textContent = 'Ê≠£Âú®Ê∫ñÂÇôÁîüÊàê...';

        try {
          const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(model)}:generateContent`;
          document.getElementById('progressChapter').textContent = 'Ê≠£Âú®ÈÄ£Êé• AI ÊúçÂãô...';
          
          const response = await fetch(endpoint, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'x-goog-api-key': apiKey,
            },
            body: JSON.stringify({
              contents: [{ parts: [{ text: prompt }] }],
            }),
          });
          const data = await response.json();
          
          if (data.error) {
            showStatus('error', 'ÈåØË™§Ôºö' + data.error.message);
            return;
          }
          
          if (data.candidates && data.candidates.length > 0) {
            const parts = data.candidates[0].content.parts || [];
            const story = parts.map(p => p.text || '').join('');
            latestStory = story.trim();
            resultDiv.textContent = latestStory;
            
            try {
              localStorage.setItem('savedStory', latestStory);
            } catch (e) {
              console.warn('ÁÑ°Ê≥ïÂÑ≤Â≠òÊïÖ‰∫ãËá≥ localStorageÔºö', e);
            }
            
            // Êõ¥Êñ∞Â≠óÊï∏Áµ±Ë®à
            updateWordCount(latestStory);
            
            // Èö±ËóèÈÄ≤Â∫¶Ê¢ù
            hideGenerationProgress();
            
            showStatus('success', 'ÁîüÊàêÂÆåÊàêÔºÅ');
            downloadBtn.disabled = false;
            continueBtn.disabled = false;
            speakBtn.disabled = false;
            generateImageBtn.disabled = false;
            parseAndShowChapters(latestStory);
          } else {
            showStatus('error', 'Ê≤íÊúâÁç≤ÂæóÂÖßÂÆπÔºåË´ãË™øÊï¥Ë®≠ÂÆö');
            hideGenerationProgress();
          }
        } catch (err) {
          showStatus('error', 'Ë´ãÊ±ÇÂ§±ÊïóÔºö' + err.message);
          hideGenerationProgress();
        } finally {
          generateBtn.disabled = false;
        }
      });

      // ==================== ÁπºÁ∫åÁîüÊàê ====================
      continueBtn.addEventListener('click', async () => {
        // Ê™¢Êü•Èõ¢Á∑öÁãÄÊÖã
        if (!navigator.onLine) {
          showStatus('error', 'üì¥ ÁõÆÂâçÁÇ∫Èõ¢Á∑öÊ®°ÂºèÔºåÁÑ°Ê≥ïÁπºÁ∫åÁîüÊàê„ÄÇË´ãÈÄ£Êé•Á∂≤Ë∑ØÂæåÂÜçË©¶„ÄÇ');
          return;
        }
        
        if (!latestStory) {
          showStatus('error', 'Â∞öÊú™ÊúâÊïÖ‰∫ãÂèØÁπºÁ∫åÔºåË´ãÂÖàÁîüÊàê');
          return;
        }
        
        // Ê™¢Êü•ÊòØÂê¶Â∑≤ÈÅîÂà∞Ë®≠ÂÆöÁöÑÁ´†ÁØÄÊï∏‰∏äÈôê
        const targetChapters = parseInt(chaptersInput.value) || 0;
        if (targetChapters > 0) {
          // Ë®àÁÆóÁõÆÂâçÂ∑≤ÊúâÁöÑÁ´†ÁØÄÊï∏
          const chapterPattern = /###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/g;
          const currentChapters = (latestStory.match(chapterPattern) || []).length;
          
          if (currentChapters >= targetChapters) {
            const confirmContinue = confirm(`ÁõÆÂâçÂ∑≤Êúâ ${currentChapters} Á´†ÔºåÂ∑≤ÈÅîÂà∞Ë®≠ÂÆöÁöÑ ${targetChapters} Á´†‰∏äÈôê„ÄÇ\n\nÁ¢∫ÂÆöË¶ÅÁπºÁ∫åÁîüÊàêÊõ¥Â§öÁ´†ÁØÄÂóéÔºü`);
            if (!confirmContinue) {
              return;
            }
          }
        }
        
        const apiKey = apiKeyInput.value.trim();
        const model = modelSelect.value;
        
        if (!apiKey) {
          showStatus('error', 'Ë´ãËº∏ÂÖ• API ÈáëÈë∞');
          return;
        }

        // Ë®àÁÆóÈÇÑÈúÄË¶ÅÁîüÊàêÂ§öÂ∞ëÁ´†Ôºå‰∏¶Ê±∫ÂÆöÊòØÂê¶ÈúÄË¶ÅÁµêÂ±Ä
        let remainingChaptersHint = '';
        let isNearEnding = false;
        let isFinalChapter = false;
        let isAlreadyComplete = false;
        
        if (targetChapters > 0) {
          const chapterPattern = /###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/g;
          const currentChapters = (latestStory.match(chapterPattern) || []).length;
          const remaining = targetChapters - currentChapters;
          
          if (remaining <= 0) {
            // Â∑≤ÈÅîÂà∞ÊàñË∂ÖÈÅéÁõÆÊ®ôÁ´†ÁØÄÊï∏ÔºåÈÄôÊ¨°ÁîüÊàêÊáâË©≤Âè™Ë£úÁµêÂ±ÄÔºà‰∏çÂ¢ûÂä†Êñ∞Á´†ÁØÄÔºâ
            isAlreadyComplete = true;
            remainingChaptersHint = `
10. ‚ö†Ô∏è„ÄêÊ•µÈáçË¶Å„ÄëÊïÖ‰∫ãÂ∑≤ÈÅîÂà∞ ${targetChapters} Á´†Ôºå‰∏çË¶ÅÂÜçÊñ∞Â¢ûÁ´†ÁØÄÔºÅ
11. Â¶ÇÊûúÊïÖ‰∫ãÂ∞öÊú™ÊúâÁµêÂ±ÄÔºåË´ãÁõ¥Êé•Âú®ÁõÆÂâçÂÖßÂÆπÂæåË£ú‰∏äÁ∞°Áü≠ÁöÑÁµêÂ±ÄÊÆµËêΩ
12. ÁµêÂ∞æÂøÖÈ†àÂä†‰∏ä„ÄåÔºàÂÖ®ÊñáÂÆåÔºâ„ÄçÊ®ôË®ò
13. Á¶ÅÊ≠¢Êñ∞Â¢û„ÄåÁ¨¨${currentChapters + 1}Á´†„ÄçÊàñ‰ªª‰ΩïÊñ∞Á´†ÁØÄ`;
          } else if (remaining === 1) {
            // Âè™Ââ©ÊúÄÂæå‰∏ÄÁ´†ÔºåÈÄôÁ´†ÂøÖÈ†àÂåÖÂê´ÁµêÂ±Ä
            isFinalChapter = true;
            remainingChaptersHint = `
10. ‚ö†Ô∏è„ÄêÈáçË¶Å„ÄëÈÄôÊòØÊúÄÂæå‰∏ÄÁ´†ÔºàÁ¨¨ ${targetChapters} Á´†ÔºâÔºåÂøÖÈ†àÂú®Êú¨Á´†ÂÆåÊàêÊïÖ‰∫ãÁµêÂ±Ä
11. Ë´ãÊî∂ÊùüÊâÄÊúâ‰ºèÁ≠ÜÂíåÂäáÊÉÖÁ∑öÔºåÁµ¶ËßíËâ≤‰∏ÄÂÄãÊòéÁ¢∫ÁöÑÁµêÂ±Ä
12. Êú¨Á´†ÁµêÂ∞æÂøÖÈ†àÂä†‰∏ä„ÄåÔºàÂÖ®ÊñáÂÆåÔºâ„ÄçÊàñ„ÄåÔºàÂÆåÁµêÔºâ„ÄçÊ®ôË®ò`;
          } else if (remaining === 2) {
            // Ââ©ÂÖ©Á´†ÔºåÈñãÂßãÊî∂Â∞æ
            isNearEnding = true;
            remainingChaptersHint = `
10. ÁõÆÊ®ôÁ∏ΩÁ´†ÁØÄÊï∏ÁÇ∫ ${targetChapters} Á´†ÔºåÁõÆÂâçÂ∑≤Êúâ ${currentChapters} Á´†ÔºåÈÇÑÂâ© ${remaining} Á´†
11. ÊïÖ‰∫ãÂç≥Â∞áÈÄ≤ÂÖ•Â∞æËÅ≤ÔºåË´ãÈñãÂßãÊî∂Êùü‰ºèÁ≠ÜÔºåÁÇ∫ÁµêÂ±ÄÂÅöÊ∫ñÂÇô`;
          } else if (remaining > 0) {
            remainingChaptersHint = `
10. ÁõÆÊ®ôÁ∏ΩÁ´†ÁØÄÊï∏ÁÇ∫ ${targetChapters} Á´†ÔºåÁõÆÂâçÂ∑≤Êúâ ${currentChapters} Á´†ÔºåÈÇÑÂâ© ${remaining} Á´†ÂæÖÊí∞ÂØ´`;
          }
        }

        // Êî∂ÈõÜ‰∫∫Áâ©ÂêçÂ≠óÁî®ÊñºÊèêÈÜí
        const characterRows = Array.from(charactersContainer.querySelectorAll('.character-row'));
        const characterNames = characterRows
          .map(row => row.querySelector('.char-name').value.trim())
          .filter(name => name !== '');
        
        // Êî∂ÈõÜÊâÄÊúâË®≠ÂÆöÁî®ÊñºÊèêÈÜíÔºà‰ΩøÁî®Â∑≤Â≠òÂú®ÁöÑÂÖÉÁ¥†ÂºïÁî®Ôºâ
        const currentTheme = themeSelect.value.trim();
        const currentSetting = settingSelect.value.trim();
        const currentStyle = styleSelect.value.trim();
        const currentNarrative = narrativeSelect.value.trim();
        const currentEra = eraSelect.value.trim();
        const currentPacing = pacingSelect.value.trim();
        const currentEmotionalTone = emotionalToneSelect.value.trim();
        const currentWorldComplexity = worldComplexitySelect.value.trim();
        const currentRating = ratingSelect.value.trim();
        const currentEnding = endingSelect.value.trim();
        
        // Êî∂ÈõÜÁâπÊÆäÂÖÉÁ¥†
        const selectedElements = [];
        specialElementsContainer.querySelectorAll('.special-element-item.selected').forEach(item => {
          const label = item.querySelector('.element-label').textContent;
          selectedElements.push(label);
        });
        
        // ÊßãÂª∫Ë®≠ÂÆöÊèêÈÜí
        let settingsReminder = '\n\n„ÄêÂøÖÈ†àÈÅµÂÆàÁöÑË®≠ÂÆöÊèêÈÜí„Äë\n';
        let hasSettings = false;
        
        if (currentTheme) { settingsReminder += `‚Ä¢ ‰∏ªÈ°åÔºö${currentTheme}\n`; hasSettings = true; }
        if (currentSetting) { settingsReminder += `‚Ä¢ ËÉåÊôØÔºö${currentSetting}\n`; hasSettings = true; }
        if (currentStyle) { settingsReminder += `‚Ä¢ È¢®Ê†ºÔºö${currentStyle}\n`; hasSettings = true; }
        if (currentNarrative) { settingsReminder += `‚Ä¢ Ë¶ñËßíÔºö${currentNarrative}\n`; hasSettings = true; }
        if (currentPacing) { settingsReminder += `‚Ä¢ ÁØÄÂ•èÔºö${currentPacing}\n`; hasSettings = true; }
        if (currentEmotionalTone) { settingsReminder += `‚Ä¢ Âü∫Ë™øÔºö${currentEmotionalTone}\n`; hasSettings = true; }
        if (currentRating) { settingsReminder += `‚Ä¢ ÂàÜÁ¥öÔºö${currentRating}\n`; hasSettings = true; }
        if (currentEnding) { settingsReminder += `‚Ä¢ ÁµêÂ±ÄÂÇæÂêëÔºö${currentEnding}\n`; hasSettings = true; }
        if (selectedElements.length > 0) { settingsReminder += `‚Ä¢ ÁâπÊÆäÂÖÉÁ¥†Ôºö${selectedElements.join('„ÄÅ')}\n`; hasSettings = true; }
        if (characterNames.length > 0) { settingsReminder += `‚Ä¢ ÁôªÂ†¥‰∫∫Áâ©Ôºö${characterNames.join('„ÄÅ')}ÔºàÂÖ®ÈÉ®ÂøÖÈ†àÊåÅÁ∫åÂá∫ÁèæÔºâ\n`; hasSettings = true; }
        
        if (!hasSettings) settingsReminder = '';
        
        let characterReminder = '';
        if (characterNames.length > 1) {
          characterReminder = `
9. ‚òÖ‚òÖ‚òÖ Á¢∫‰øùÊâÄÊúâ‰∏ªË¶ÅËßíËâ≤Ôºà${characterNames.join('„ÄÅ')}ÔºâÂú®ÂæåÁ∫åÂäáÊÉÖ‰∏≠ÊåÅÁ∫åÁôºÊèÆ‰ΩúÁî®Ôºå‰∏çÂèØÈÅ∫Êºè‰ªª‰Ωï‰∏Ä‰Ωç`;
        }

        // Â¶ÇÊûúÊïÖ‰∫ãÂ§™Èï∑ÔºåÂè™ÂèñÊúÄÂæåÈÉ®ÂàÜ‰æÜÈÅøÂÖçË∂ÖÂá∫ API ÈôêÂà∂
        // Gemini ÁöÑ context window Á¥Ñ 30k tokensÔºå‰∏≠ÊñáÁ¥Ñ 1 token = 1.5 Â≠ó
        // ‰øùÂÆà‰º∞Ë®àÂèñÊúÄÂæå 15000 Â≠ó + Ë®≠ÂÆöÊèêÈÜí
        const MAX_CONTEXT_LENGTH = 15000;
        let storyContext = latestStory;
        let truncatedNotice = '';
        
        if (latestStory.length > MAX_CONTEXT_LENGTH) {
          // ÊâæÂà∞‰∏ÄÂÄãÁ´†ÁØÄÁöÑÈñãÈ†≠‰æÜÊà™Êñ∑ÔºåÈÅøÂÖçÊà™Âú®ÊÆµËêΩ‰∏≠Èñì
          const chapterPattern = /###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/g;
          const chapters = [...latestStory.matchAll(chapterPattern)];
          
          if (chapters.length > 2) {
            // ÂæûÂÄíÊï∏Á¨¨ 3 Á´†ÈñãÂßãÂèñ
            const startChapterIndex = Math.max(0, chapters.length - 3);
            const startPosition = chapters[startChapterIndex].index;
            storyContext = latestStory.substring(startPosition);
            truncatedNotice = `ÔºàÂâçÊñáÊëòË¶ÅÔºöÊïÖ‰∫ãÂ∑≤ÈÄ≤Ë°åÂà∞Á¨¨ ${chapters.length} Á´†Ôºå‰ª•‰∏ãÊòØÊúÄËøëÁöÑÂÖßÂÆπÔºâ\n\n`;
          } else {
            // Á´†ÁØÄÂ§™Â∞ëÔºåÁõ¥Êé•ÂèñÊúÄÂæåÈÉ®ÂàÜ
            storyContext = latestStory.substring(latestStory.length - MAX_CONTEXT_LENGTH);
            // ÊâæÂà∞Á¨¨‰∏ÄÂÄãÂÆåÊï¥ÊÆµËêΩÁöÑÈñãÈ†≠
            const firstNewline = storyContext.indexOf('\n');
            if (firstNewline > 0 && firstNewline < 500) {
              storyContext = storyContext.substring(firstNewline + 1);
            }
            truncatedNotice = `ÔºàÂâçÊñáÁúÅÁï•Ôºå‰ª•‰∏ãÊòØÊúÄËøëÁöÑÂÖßÂÆπÔºâ\n\n`;
          }
        }

        const continuePrompt = truncatedNotice + storyContext + settingsReminder + `

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
„ÄêÈáçË¶ÅÊåáÁ§∫„ÄëË´ãÁπºÁ∫åÊí∞ÂØ´Â∞èË™™„ÄåÊ≠£ÊñáÂÖßÂÆπ„ÄçÔºåÂö¥Ê†ºÈÅµÂÆà‰ª•‰∏äÊâÄÊúâË®≠ÂÆö„ÄÇ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Ë¶ÅÊ±ÇÔºö
1. ‰øùÊåÅ‰ª•‰∏äÊïÖ‰∫ãÁöÑ‰∏ªÈ°å„ÄÅËÉåÊôØ„ÄÅ‰∫∫Áâ©ËàáÈ¢®Ê†ºÔºå‰∏çÂèØÂÅèÈõ¢Ë®≠ÂÆö
2. Áõ¥Êé•ÁπºÁ∫åÂØ´ÊïÖ‰∫ãÊ≠£ÊñáÔºåÂåÖÂê´Â†¥ÊôØÊèèÂØ´„ÄÅ‰∫∫Áâ©Â∞çË©±„ÄÅÂøÉÁêÜÊ¥ªÂãï„ÄÅÊÉÖÁØÄÁôºÂ±ï
3. ÊØèÂÄãÁ´†ÁØÄÈÉΩË¶ÅÊúâÂÆåÊï¥ÁöÑÊïÖ‰∫ãÂÖßÂÆπÔºàËá≥Â∞ë2000-3000Â≠óÔºâ
4. Â¶ÇÊûú‰∏ä‰∏ÄÁ´†Â∞öÊú™ÁµêÊùüÔºåË´ãÂÖàÂÆåÊàêË©≤Á´†ÁØÄ
5. Á´†ÁØÄÊ®ôÈ°åÊ†ºÂºèÔºö### Á¨¨XÁ´†ÔºöÊ®ôÈ°å
6. Á¶ÅÊ≠¢Âá∫ÁèæÂ§ßÁ∂±„ÄÅË¶èÂäÉ„ÄÅÊïÖ‰∫ãÁ∞°‰ªãÁ≠âÂÖßÂÆπ
7. Á¶ÅÊ≠¢‰ΩøÁî®Ê¢ùÂàóÂºèË™™ÊòéÔºåË¶ÅÁî®Êïò‰∫ãÊñáÈ´î
8. Âö¥Ê†ºÈÅµÂÆàÊåáÂÆöÁöÑÊïò‰∫ãË¶ñËßí„ÄÅÊïÖ‰∫ãÁØÄÂ•è„ÄÅÊÉÖÊÑüÂü∫Ë™ø„ÄÅÂÖßÂÆπÂàÜÁ¥ö${characterReminder}${remainingChaptersHint}

ÁπºÁ∫åÊí∞ÂØ´Â∞èË™™Ê≠£ÊñáÔºö`;
        
        if (isAlreadyComplete) {
          showStatus('loading', 'Ê≠£Âú®Ë£ú‰∏äÊïÖ‰∫ãÁµêÂ±Ä...');
        } else if (isFinalChapter) {
          showStatus('loading', 'Ê≠£Âú®Êí∞ÂØ´ÊúÄÁµÇÁ´†ËàáÁµêÂ±Ä...');
        } else if (isNearEnding) {
          showStatus('loading', 'Á∫åÁØáÁîüÊàê‰∏≠ÔºàÂç≥Â∞áÈÄ≤ÂÖ•ÁµêÂ±ÄÔºâ...');
        } else {
          showStatus('loading', 'Á∫åÁØáÁîüÊàê‰∏≠...');
        }
        continueBtn.disabled = true;
        generateBtn.disabled = true;

        try {
          const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(model)}:generateContent`;
          const response = await fetch(endpoint, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'x-goog-api-key': apiKey,
            },
            body: JSON.stringify({
              contents: [{ parts: [{ text: continuePrompt }] }],
            }),
          });
          const data = await response.json();
          
          if (data.error) {
            // ÈáùÂ∞ç‰∏çÂêåÈåØË™§È°ûÂûãÁµ¶‰∫à‰∏çÂêåÊèêÁ§∫
            const errorMsg = data.error.message || 'Êú™Áü•ÈåØË™§';
            if (errorMsg.includes('internal error') || errorMsg.includes('Internal')) {
              showStatus('error', '‚ö†Ô∏è API Êö´ÊôÇÊÄßÈåØË™§ÔºåË´ãÁ®çÂæåÈáçË©¶ÔºàÂª∫Ë≠∞Á≠âÂæÖ 10 ÁßíÔºâ');
            } else if (errorMsg.includes('quota') || errorMsg.includes('limit')) {
              showStatus('error', '‚ö†Ô∏è API È°çÂ∫¶‰∏çË∂≥ÊàñË´ãÊ±ÇÈ†ªÁπÅÔºåË´ãÁ®çÂæåÂÜçË©¶');
            } else if (errorMsg.includes('token') || errorMsg.includes('length') || errorMsg.includes('size')) {
              showStatus('error', '‚ö†Ô∏è ÂÖßÂÆπÈÅéÈï∑ÔºåË´ãÂòóË©¶ÈáçÊñ∞ÁîüÊàê');
            } else {
              showStatus('error', 'ÈåØË™§Ôºö' + errorMsg);
            }
            return;
          }
          
          if (data.candidates && data.candidates.length > 0) {
            const parts = data.candidates[0].content.parts || [];
            const continuation = parts.map(p => p.text || '').join('').trim();
            if (continuation) {
              latestStory += '\n\n' + continuation;
              resultDiv.textContent = latestStory;
              try {
                localStorage.setItem('savedStory', latestStory);
              } catch (e) {
                showStatus('error', 'ÊïÖ‰∫ãÂÖßÂÆπÈÅéÈï∑ÔºåÊú™ËÉΩËá™ÂãïÂÑ≤Â≠ò');
              }
              
              // Ê™¢Êü•ÊïÖ‰∫ãÊòØÂê¶Â∑≤ÂÆåÁµê
              const isCompleted = /[Ôºà(](?:ÂÖ®ÊñáÂÆå|ÂÆåÁµê|ÂÖ®Êõ∏ÂÆå|ÁµÇ|The End)[Ôºâ)]|„ÄêÂÆå„Äë|‚ÄîÂÆå‚Äî|ÔΩûÂÆåÔΩû|ÔºàENDÔºâ|‚îÄ\s*ÂÆå\s*‚îÄ/i.test(latestStory);
              
              // Ê™¢Êü•ÊòØÂê¶Â∑≤ÈÅîÂà∞ÁõÆÊ®ôÁ´†ÁØÄÊï∏
              let storyCompleted = false;
              if (targetChapters > 0) {
                const chapterPattern = /###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/g;
                const currentChapters = (latestStory.match(chapterPattern) || []).length;
                
                if (isCompleted) {
                  showStatus('success', `üéâ ÊïÖ‰∫ãÂÆåÁµêÔºÅÂÖ± ${currentChapters} Á´†`);
                  storyCompleted = true;
                } else if (currentChapters >= targetChapters) {
                  // Â∑≤ÈÅîÂà∞Á´†ÁØÄÊï∏‰ΩÜÊ≤íÊúâÁµêÂ±ÄÊ®ôË®ò
                  showStatus('success', `‚úÖ Â∑≤ÈÅî ${targetChapters} Á´†ÔºåÂª∫Ë≠∞ÈªûÊìäÁπºÁ∫åÁîüÊàê‰æÜË£ú‰∏äÁµêÂ±Ä`);
                } else {
                  showStatus('success', `Á∫åÁØáÂÆåÊàêÔºÅÁõÆÂâç ${currentChapters}/${targetChapters} Á´†`);
                }
              } else {
                if (isCompleted) {
                  showStatus('success', 'üéâ ÊïÖ‰∫ãÂÆåÁµêÔºÅ');
                  storyCompleted = true;
                } else {
                  showStatus('success', 'Á∫åÁØáÂÆåÊàêÔºÅ');
                }
              }
              
              // ÂÆåÁµêÂæåÁ¶ÅÁî®ÁπºÁ∫åÁîüÊàêÊåâÈàï
              if (storyCompleted) {
                continueBtn.disabled = true;
                continueBtn.title = 'ÊïÖ‰∫ãÂ∑≤ÂÆåÁµê';
              }
              
              // Êõ¥Êñ∞Â≠óÊï∏Áµ±Ë®à
              updateWordCount(latestStory);
              
              downloadBtn.disabled = false;
              speakBtn.disabled = false;
              generateImageBtn.disabled = false;
              parseAndShowChapters(latestStory);
            } else {
              showStatus('error', 'Ê≤íÊúâÁç≤ÂæóÁ∫åÁØáÂÖßÂÆπÔºåÂèØËÉΩÂ∑≤ÂÆåÁµê');
            }
          } else {
            showStatus('error', 'Ê≤íÊúâÁç≤ÂæóÁ∫åÁØáÂÖßÂÆπÔºåÂèØËÉΩÂ∑≤ÂÆåÁµê');
          }
        } catch (err) {
          // ÈáùÂ∞ç‰∏çÂêåÈåØË™§Áµ¶‰∫à‰∏çÂêåÊèêÁ§∫
          const errorMsg = err.message || '';
          if (errorMsg.includes('Failed to fetch') || errorMsg.includes('NetworkError') || errorMsg.includes('network')) {
            showStatus('error', '‚ö†Ô∏è Á∂≤Ë∑ØÈÄ£Á∑öÂ§±ÊïóÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÂæåÈáçË©¶');
          } else if (errorMsg.includes('timeout') || errorMsg.includes('Timeout')) {
            showStatus('error', '‚ö†Ô∏è Ë´ãÊ±ÇË∂ÖÊôÇÔºåË´ãÁ®çÂæåÈáçË©¶');
          } else if (errorMsg.includes('abort') || errorMsg.includes('Abort')) {
            showStatus('error', '‚ö†Ô∏è Ë´ãÊ±ÇË¢´‰∏≠Êñ∑');
          } else {
            showStatus('error', 'Ë´ãÊ±ÇÂ§±ÊïóÔºö' + errorMsg + 'ÔºàË´ãÊ™¢Êü•Á∂≤Ë∑ØÈÄ£Á∑öÔºâ');
          }
        } finally {
          // Â¶ÇÊûúÊïÖ‰∫ãÊú™ÂÆåÁµêÊâçÈáçÊñ∞ÂïüÁî®ÊåâÈàï
          const isCompleted = /[Ôºà(](?:ÂÖ®ÊñáÂÆå|ÂÆåÁµê|ÂÖ®Êõ∏ÂÆå|ÁµÇ|The End)[Ôºâ)]|„ÄêÂÆå„Äë|‚ÄîÂÆå‚Äî|ÔΩûÂÆåÔΩû|ÔºàENDÔºâ|‚îÄ\s*ÂÆå\s*‚îÄ/i.test(latestStory);
          if (!isCompleted) {
            continueBtn.disabled = false;
          }
          generateBtn.disabled = false;
        }
      });

      // ==================== ‰∏ãËºâÂäüËÉΩ ====================
      function downloadFile(filename, text, mimeType = 'text/plain') {
        const link = document.createElement('a');
        link.setAttribute('href', `data:${mimeType};charset=utf-8,` + encodeURIComponent(text));
        link.setAttribute('download', filename);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }

      function generateFilename(extension = 'txt') {
        // ÂèñÂæó‰∏ªÈ°å
        const theme = themeSelect.value || '';
        
        // ÂèñÂæóÊâÄÊúâ‰∫∫Áâ©ÂêçÂ≠ó
        const characterRows = Array.from(charactersContainer.querySelectorAll('.character-row'));
        const names = characterRows
          .map(row => row.querySelector('.char-name').value.trim())
          .filter(name => name !== '');
        
        // ÂòóË©¶ÂæûÊïÖ‰∫ãÂÖßÂÆπ‰∏≠ÊèêÂèñÊ®ôÈ°åÔºàÈÄöÂ∏∏Âú®ÈñãÈ†≠Êúâ ## Ê®ôÈ°å Ê†ºÂºèÔºâ
        let storyTitle = '';
        if (latestStory) {
          const titleMatch = latestStory.match(/##\s*([^\n#]+)/);
          if (titleMatch) {
            storyTitle = titleMatch[1].trim();
          }
        }
        
        // ÁµÑÂêàÊ™îÂêç
        let filename = '';
        
        // ÂÑ™ÂÖà‰ΩøÁî®ÊïÖ‰∫ãÊ®ôÈ°å
        if (storyTitle) {
          filename = storyTitle;
        } else if (theme) {
          filename = theme;
        } else {
          filename = 'ÁîüÊàêÂ∞èË™™';
        }
        
        // Âä†ÂÖ•‰∫∫Áâ©ÂêçÂ≠óÔºàÊúÄÂ§ö3ÂÄãÔºâ
        if (names.length > 0) {
          const displayNames = names.slice(0, 3).join('„ÄÅ');
          filename += `_${displayNames}`;
          if (names.length > 3) {
            filename += 'Á≠â';
          }
        }
        
        // ÁßªÈô§‰∏çÈÅ©ÂêàÊ™îÂêçÁöÑÂ≠óÂÖÉ
        filename = filename.replace(/[\\/:*?"<>|]/g, '_');
        
        return filename + '.' + extension;
      }

      // ÁîüÊàêÊâãÊ©üÈñ±ËÆÄÁâà HTMLÔºàÂÆåÂÖ®Èõ¢Á∑öÂèØÁî®Ôºâ
      function generateMobileHTML(text) {
        // ÊèêÂèñÊ®ôÈ°å
        let title = 'Â∞èË™™Èñ±ËÆÄ';
        const titleMatch = text.match(/##\s*([^\n#]+)/);
        if (titleMatch) {
          title = titleMatch[1].trim();
        }
        
        // ËôïÁêÜÊñáÂ≠óÂÖßÂÆπ
        // 1. Â∞á ### Ê®ôÈ°åËΩâÁÇ∫ HTML Ê®ôÁ±§
        // 2. Â∞áÊÆµËêΩËΩâÁÇ∫ <p> Ê®ôÁ±§
        // 3. ‰øùÁïôÁ©∫Ë°å‰ΩúÁÇ∫ÊÆµËêΩÂàÜÈöî
        
        let processedContent = text
          // Á´†ÁØÄÊ®ôÈ°å (### Á¨¨XÁ´†ÔºöÊ®ôÈ°å)
          .replace(/^###\s*(.+)$/gm, '<h2 class="chapter-title">$1</h2>')
          // ‰∏ªÊ®ôÈ°å (## Ê®ôÈ°å)
          .replace(/^##\s*(.+)$/gm, '<h1 class="main-title">$1</h1>')
          // ÂàÜÈöîÁ∑ö
          .replace(/^[-‚Äî]{3,}$/gm, '<hr class="divider">')
          // Á≤óÈ´î
          .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
          // ÊñúÈ´î
          .replace(/\*(.+?)\*/g, '<em>$1</em>');
        
        // Â∞áÈÄ£Á∫åÊñáÂ≠óËΩâÁÇ∫ÊÆµËêΩ
        const lines = processedContent.split('\n');
        let htmlContent = '';
        let currentParagraph = '';
        
        for (const line of lines) {
          const trimmed = line.trim();
          
          if (trimmed === '') {
            // Á©∫Ë°åÔºöÁµêÊùüÁï∂ÂâçÊÆµËêΩ
            if (currentParagraph) {
              htmlContent += `<p>${currentParagraph}</p>\n`;
              currentParagraph = '';
            }
          } else if (trimmed.startsWith('<h1') || trimmed.startsWith('<h2') || trimmed.startsWith('<hr')) {
            // Â∑≤ËôïÁêÜÁöÑ HTML Ê®ôÁ±§ÔºöÂÖàÁµêÊùüÁï∂ÂâçÊÆµËêΩÔºåÂÜçÊ∑ªÂä†Ê®ôÁ±§
            if (currentParagraph) {
              htmlContent += `<p>${currentParagraph}</p>\n`;
              currentParagraph = '';
            }
            htmlContent += trimmed + '\n';
          } else {
            // ÊôÆÈÄöÊñáÂ≠óÔºöÁ¥ØÂä†Âà∞Áï∂ÂâçÊÆµËêΩ
            currentParagraph += (currentParagraph ? '' : '') + trimmed;
          }
        }
        
        // ËôïÁêÜÊúÄÂæå‰∏ÄÂÄãÊÆµËêΩ
        if (currentParagraph) {
          htmlContent += `<p>${currentParagraph}</p>\n`;
        }
        
        // Ë®àÁÆóÂ≠óÊï∏
        const wordCount = text.replace(/[\\s\\n#*_\\-]/g, '').length;
        const wordCountDisplay = wordCount >= 10000 
          ? (wordCount / 10000).toFixed(1) + ' Ëê¨Â≠ó'
          : wordCount >= 1000 
            ? (wordCount / 1000).toFixed(1) + ' ÂçÉÂ≠ó'
            : wordCount + ' Â≠ó';
        
        // ÁîüÊàêÂÆåÊï¥ÁöÑÈõ¢Á∑ö HTML
        return `<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#faf8f5">
  <title>${title}</title>
  <style>
    /* ===== Âü∫Á§éÈáçÁΩÆ ===== */
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* ===== CSS ËÆäÊï∏ÔºàÊîØÊè¥Ê∑±Ëâ≤Ê®°ÂºèÔºâ===== */
    :root {
      --bg: #faf8f5;
      --bg-card: #ffffff;
      --text: #2c2c2c;
      --text-light: #666666;
      --accent: #d4a574;
      --border: #e8e4e0;
      --shadow: rgba(0, 0, 0, 0.06);
    }
    
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #1a1a1a;
        --bg-card: #242424;
        --text: #e8e4e0;
        --text-light: #999999;
        --accent: #d4a574;
        --border: #333333;
        --shadow: rgba(0, 0, 0, 0.3);
      }
    }
    
    /* ===== ‰∏ªÈ´îÊ®£Âºè ===== */
    html {
      scroll-behavior: smooth;
    }
    
    body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: 
        "Noto Serif TC", 
        "Source Han Serif TC", 
        "PingFang TC", 
        "Microsoft JhengHei", 
        "ÂæÆËªüÊ≠£ÈªëÈ´î",
        "Apple LiGothic",
        serif;
      font-size: 18px;
      line-height: 1.9;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* ===== È†ÇÈÉ®Ë≥áË®äÊ¨Ñ ===== */
    .header {
      position: sticky;
      top: 0;
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 100;
      box-shadow: 0 2px 8px var(--shadow);
    }
    
    .header-title {
      font-size: 14px;
      color: var(--text-light);
      margin: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 60%;
    }
    
    .header-info {
      font-size: 12px;
      color: var(--text-light);
    }
    
    /* ===== ÊéßÂà∂Èù¢Êùø ===== */
    .controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 100;
    }
    
    .control-btn {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: none;
      background: var(--bg-card);
      color: var(--text);
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px var(--shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .control-btn:active {
      transform: scale(0.95);
    }
    
    /* ===== Ë®≠ÂÆöÈù¢Êùø ===== */
    .settings-panel {
      display: none;
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 32px var(--shadow);
      z-index: 101;
      min-width: 200px;
    }
    
    .settings-panel.show {
      display: block;
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .setting-item {
      margin-bottom: 16px;
    }
    
    .setting-item:last-child {
      margin-bottom: 0;
    }
    
    .setting-label {
      display: block;
      font-size: 13px;
      color: var(--text-light);
      margin-bottom: 8px;
    }
    
    .setting-buttons {
      display: flex;
      gap: 8px;
    }
    
    .setting-btn {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .setting-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    /* ===== ÂÖßÂÆπÂçÄÂüü ===== */
    .content {
      max-width: 700px;
      margin: 0 auto;
      padding: 30px 24px 100px;
    }
    
    /* ===== Ê®ôÈ°åÊ®£Âºè ===== */
    .main-title {
      font-size: 1.6em;
      font-weight: 700;
      text-align: center;
      margin: 0 0 30px 0;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--accent);
      color: var(--text);
      line-height: 1.4;
    }
    
    .chapter-title {
      font-size: 1.25em;
      font-weight: 600;
      margin: 50px 0 25px 0;
      padding: 15px 0;
      color: var(--text);
      border-left: 4px solid var(--accent);
      padding-left: 16px;
      background: linear-gradient(90deg, var(--bg-card), transparent);
    }
    
    /* ===== ÊÆµËêΩÊ®£Âºè ===== */
    p {
      margin: 0 0 1.5em 0;
      text-align: justify;
      text-indent: 2em;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    /* ===== ÂàÜÈöîÁ∑ö ===== */
    .divider {
      border: none;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border), transparent);
      margin: 40px 0;
    }
    
    /* ===== Âº∑Ë™øÊ®£Âºè ===== */
    strong {
      color: var(--accent);
      font-weight: 600;
    }
    
    em {
      font-style: italic;
      color: var(--text-light);
    }
    
    /* ===== ÂõûÂà∞È†ÇÈÉ®ÊåâÈàï ===== */
    .back-to-top {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    
    .back-to-top.show {
      opacity: 1;
      pointer-events: auto;
    }
    
    /* ===== Â≠óÈ´îÂ§ßÂ∞èËÆäÂåñ ===== */
    body.font-small {
      font-size: 16px;
    }
    
    body.font-medium {
      font-size: 18px;
    }
    
    body.font-large {
      font-size: 21px;
    }
    
    body.font-xlarge {
      font-size: 24px;
    }
    
    /* ===== Ë°åË∑ùËÆäÂåñ ===== */
    body.line-compact {
      line-height: 1.6;
    }
    
    body.line-normal {
      line-height: 1.9;
    }
    
    body.line-loose {
      line-height: 2.2;
    }
    
    /* ===== ÈüøÊáâÂºèË™øÊï¥ ===== */
    @media (max-width: 480px) {
      body {
        font-size: 17px;
      }
      
      .content {
        padding: 20px 18px 100px;
      }
      
      .main-title {
        font-size: 1.4em;
      }
      
      .chapter-title {
        font-size: 1.15em;
      }
    }
    
    /* ===== Èñ±ËÆÄÈÄ≤Â∫¶Ê¢ù ===== */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: var(--accent);
      width: 0%;
      z-index: 1000;
      transition: width 0.1s;
    }
  </style>
</head>
<body class="font-medium line-normal">
  <!-- Èñ±ËÆÄÈÄ≤Â∫¶Ê¢ù -->
  <div class="progress-bar" id="progressBar"></div>
  
  <!-- È†ÇÈÉ®Ë≥áË®äÊ¨Ñ -->
  <header class="header">
    <h1 class="header-title">${title}</h1>
    <span class="header-info">${wordCountDisplay}</span>
  </header>
  
  <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
  <main class="content">
    ${htmlContent}
  </main>
  
  <!-- ÊéßÂà∂ÊåâÈàï -->
  <div class="controls">
    <button class="control-btn back-to-top" id="backToTop" title="ÂõûÂà∞È†ÇÈÉ®">‚Üë</button>
    <button class="control-btn" id="settingsBtn" title="Èñ±ËÆÄË®≠ÂÆö">‚öô</button>
  </div>
  
  <!-- Ë®≠ÂÆöÈù¢Êùø -->
  <div class="settings-panel" id="settingsPanel">
    <div class="setting-item">
      <span class="setting-label">Â≠óÈ´îÂ§ßÂ∞è</span>
      <div class="setting-buttons">
        <button class="setting-btn" data-font="small">Â∞è</button>
        <button class="setting-btn active" data-font="medium">‰∏≠</button>
        <button class="setting-btn" data-font="large">Â§ß</button>
        <button class="setting-btn" data-font="xlarge">ÁâπÂ§ß</button>
      </div>
    </div>
    <div class="setting-item">
      <span class="setting-label">Ë°åË∑ù</span>
      <div class="setting-buttons">
        <button class="setting-btn" data-line="compact">Á∑äÊπä</button>
        <button class="setting-btn active" data-line="normal">Ê®ôÊ∫ñ</button>
        <button class="setting-btn" data-line="loose">ÂØ¨È¨Ü</button>
      </div>
    </div>
  </div>
  
  <` + `script>
    // Èñ±ËÆÄÈÄ≤Â∫¶
    const progressBar = document.getElementById('progressBar');
    const backToTop = document.getElementById('backToTop');
    
    window.addEventListener('scroll', () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = (scrollTop / docHeight) * 100;
      progressBar.style.width = progress + '%';
      
      // È°ØÁ§∫/Èö±ËóèÂõûÂà∞È†ÇÈÉ®ÊåâÈàï
      if (scrollTop > 500) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });
    
    // ÂõûÂà∞È†ÇÈÉ®
    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    // Ë®≠ÂÆöÈù¢Êùø
    const settingsBtn = document.getElementById('settingsBtn');
    const settingsPanel = document.getElementById('settingsPanel');
    
    settingsBtn.addEventListener('click', () => {
      settingsPanel.classList.toggle('show');
    });
    
    // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâË®≠ÂÆöÈù¢Êùø
    document.addEventListener('click', (e) => {
      if (!settingsPanel.contains(e.target) && e.target !== settingsBtn) {
        settingsPanel.classList.remove('show');
      }
    });
    
    // Â≠óÈ´îÂ§ßÂ∞èË®≠ÂÆö
    document.querySelectorAll('[data-font]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('[data-font]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        document.body.classList.remove('font-small', 'font-medium', 'font-large', 'font-xlarge');
        document.body.classList.add('font-' + btn.dataset.font);
        
        // ÂÑ≤Â≠òË®≠ÂÆö
        localStorage.setItem('reader-font', btn.dataset.font);
      });
    });
    
    // Ë°åË∑ùË®≠ÂÆö
    document.querySelectorAll('[data-line]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('[data-line]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        document.body.classList.remove('line-compact', 'line-normal', 'line-loose');
        document.body.classList.add('line-' + btn.dataset.line);
        
        // ÂÑ≤Â≠òË®≠ÂÆö
        localStorage.setItem('reader-line', btn.dataset.line);
      });
    });
    
    // ËºâÂÖ•Â∑≤ÂÑ≤Â≠òÁöÑË®≠ÂÆö
    const savedFont = localStorage.getItem('reader-font');
    const savedLine = localStorage.getItem('reader-line');
    
    if (savedFont) {
      document.querySelectorAll('[data-font]').forEach(b => b.classList.remove('active'));
      const fontBtn = document.querySelector('[data-font="' + savedFont + '"]');
      if (fontBtn) {
        fontBtn.classList.add('active');
        document.body.classList.remove('font-small', 'font-medium', 'font-large', 'font-xlarge');
        document.body.classList.add('font-' + savedFont);
      }
    }
    
    if (savedLine) {
      document.querySelectorAll('[data-line]').forEach(b => b.classList.remove('active'));
      const lineBtn = document.querySelector('[data-line="' + savedLine + '"]');
      if (lineBtn) {
        lineBtn.classList.add('active');
        document.body.classList.remove('line-compact', 'line-normal', 'line-loose');
        document.body.classList.add('line-' + savedLine);
      }
    }
  <` + `/script>
</body>
</html>`;
      }

      // ‰∏ãËºâÂäüËÉΩÂáΩÊï∏
      function downloadAsTxt() {
        if (!latestStory) return;
        const optimizedTxt = optimizeTxtForMobile(latestStory);
        const filename = generateFilename('txt');
        downloadFile(filename, optimizedTxt, 'text/plain');
        showStatus('success', `üìÑ Â∑≤‰∏ãËºâ ${filename}`);
      }

      function downloadAsHtml() {
        if (!latestStory) return;
        const htmlContent = generateMobileHTML(latestStory);
        const filename = generateFilename('html');
        downloadFile(filename, htmlContent, 'text/html');
        showStatus('success', `üì± Â∑≤‰∏ãËºâ ${filename}ÔºàÊâãÊ©üÈñ±ËÆÄÁâàÔºâ`);
      }

      // ÂÑ™Âåñ TXT Ê†ºÂºèÔºåËÆìÊâãÊ©üÈñ±ËÆÄÊõ¥ËàíÈÅ©
      function optimizeTxtForMobile(text) {
        const MAX_LINE_WIDTH = 25; // ÊØèË°åÊúÄÂ§ßÂ≠óÊï∏ÔºàÈÅ©ÂêàÊâãÊ©üËû¢ÂπïÔºâ
        
        let result = '';
        const paragraphs = text.split(/\n/);
        
        for (let i = 0; i < paragraphs.length; i++) {
          const para = paragraphs[i];
          const trimmed = para.trim();
          
          // Á©∫Ë°å‰øùÁïô
          if (trimmed === '') {
            result += '\n';
            continue;
          }
          
          // Ê™¢Ê∏¨ÊòØÂê¶ÁÇ∫Ê®ôÈ°åË°åÔºà## Êàñ ### ÈñãÈ†≠ÔºåÊàñ„ÄåÁ¨¨XÁ´†„ÄçÁ≠âÔºâ
          const isTitle = /^#{1,3}\s/.test(trimmed) || 
                          /^Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/.test(trimmed) ||
                          /^[Â∫èÊ•îÁµÇÂ∞æÁï™Â§ñ]/.test(trimmed) ||
                          /^[-‚Äî=]{3,}$/.test(trimmed);
          
          if (isTitle) {
            // Ê®ôÈ°åÔºöÁßªÈô§ markdown Á¨¶ËôüÔºåÂâçÂæåÂä†Á©∫Ë°å
            let titleText = trimmed.replace(/^#{1,3}\s*/, '');
            
            // Âä†ÂÖ•ÂàÜÈöîÁ∑öË£ùÈ£æ
            if (/^Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/.test(titleText) ||
                /^[Â∫èÊ•îÁµÇÂ∞æÁï™Â§ñ]/.test(titleText)) {
              result += '\n';
              result += '‚ïê'.repeat(20) + '\n';
              result += '\n';
              result += '„ÄÄ„ÄÄ' + titleText + '\n';
              result += '\n';
              result += '‚ïê'.repeat(20) + '\n';
            } else {
              // ‰∏ªÊ®ôÈ°å
              result += '\n';
              result += '‚òÖ ' + titleText + ' ‚òÖ\n';
            }
            result += '\n';
            continue;
          }
          
          // ÊôÆÈÄöÊÆµËêΩÔºöËá™ÂãïÊèõË°å
          // ÂÖàËôïÁêÜÈ¶ñË°åÁ∏ÆÊéí
          let content = trimmed;
          let lines = [];
          let currentLine = '„ÄÄ„ÄÄ'; // È¶ñË°åÁ∏ÆÊéíÔºàÂÖ©ÂÄãÂÖ®ÂΩ¢Á©∫Ê†ºÔºâ
          
          for (let j = 0; j < content.length; j++) {
            const char = content[j];
            currentLine += char;
            
            // Ê™¢Êü•ÊòØÂê¶ÈúÄË¶ÅÊèõË°å
            // Ë®àÁÆóÂØ¶ÈöõÂØ¨Â∫¶Ôºà‰∏≠ÊñáÂ≠óÁÆó1ÔºåËã±ÊñáÂ≠óÊØç/Êï∏Â≠óÁÆó0.5Ôºâ
            const lineWidth = [...currentLine].reduce((sum, c) => {
              return sum + (/[\u4e00-\u9fff\u3000-\u303f\uff00-\uffef]/.test(c) ? 1 : 0.5);
            }, 0);
            
            if (lineWidth >= MAX_LINE_WIDTH) {
              // ÂòóË©¶Âú®Ê®ôÈªûÁ¨¶ËôüËôïÊñ∑Ë°å
              const lastPunctuationIndex = currentLine.search(/[Ôºå„ÄÇÔºÅÔºüÔºõÔºö„ÄÅ„Äç„ÄèÔºâ„Äë‚Ä¶‚ÄîÔΩû\s][^Ôºå„ÄÇÔºÅÔºüÔºõÔºö„ÄÅ„Äç„ÄèÔºâ„Äë‚Ä¶‚ÄîÔΩû\s]*$/);
              
              if (lastPunctuationIndex > currentLine.length * 0.5) {
                // Âú®Ê®ôÈªûÂæåÊñ∑Ë°å
                lines.push(currentLine.substring(0, lastPunctuationIndex + 1));
                currentLine = currentLine.substring(lastPunctuationIndex + 1);
              } else {
                // Áõ¥Êé•Êñ∑Ë°å
                lines.push(currentLine);
                currentLine = '';
              }
            }
          }
          
          // Âä†ÂÖ•ÊúÄÂæå‰∏ÄË°å
          if (currentLine) {
            lines.push(currentLine);
          }
          
          result += lines.join('\n') + '\n\n';
        }
        
        // Ê∏ÖÁêÜÂ§öÈ§òÁ©∫Ë°åÔºàË∂ÖÈÅé2ÂÄãÈÄ£Á∫åÁ©∫Ë°åËÆäÊàê2ÂÄãÔºâ
        result = result.replace(/\n{4,}/g, '\n\n\n');
        
        return result.trim();
      }

      // ==================== AI Êº´Áï´ÂäüËÉΩ ====================
      const imageStyle = document.getElementById('imageStyle');
      const comicChapterSelect = document.getElementById('comicChapterSelect');
      const panelsPerPage = document.getElementById('panelsPerPage');
      const generateImageNowBtn = document.getElementById('generateImageNowBtn');
      const imageResult = document.getElementById('imageResult');
      const imageLoading = document.getElementById('imageLoading');
      const comicProgress = document.getElementById('comicProgress');
      const comicProgressBar = document.getElementById('comicProgressBar');
      const comicPageInfo = document.getElementById('comicPageInfo');
      const comicContentProgress = document.getElementById('comicContentProgress');
      const comicProgressFill = document.getElementById('comicProgressFill');
      const comicContainer = document.getElementById('comicContainer');
      const imageActions = document.getElementById('imageActions');
      const continueComicBtn = document.getElementById('continueComicBtn');
      const downloadImageBtn = document.getElementById('downloadImageBtn');
      const regenerateImageBtn = document.getElementById('regenerateImageBtn');
      const comicCompleteMsg = document.getElementById('comicCompleteMsg');

      // Êº´Áï´ÁîüÊàêÁãÄÊÖã
      let comicState = {
        chapterContent: '',      // ÂÆåÊï¥Á´†ÁØÄÂÖßÂÆπ
        chapterTitle: '',        // Á´†ÁØÄÊ®ôÈ°å
        style: null,             // È¢®Ê†ºË®≠ÂÆö
        numPanels: 6,            // ÊØèÈ†ÅÊ†ºÊï∏
        currentPosition: 0,      // ÁõÆÂâçËôïÁêÜÂà∞ÁöÑ‰ΩçÁΩÆ
        pages: [],               // Â∑≤ÁîüÊàêÁöÑÈ†ÅÈù¢ÂúñÁâá
        isComplete: false,       // ÊòØÂê¶ÂÆåÊàê
        characterDesigns: '',    // ËßíËâ≤Ë®≠Ë®àÊèèËø∞Ôºà‰øùÊåÅ‰∏ÄËá¥ÊÄßÔºâ
        firstPageImage: null     // Á¨¨‰∏ÄÈ†ÅÂúñÁâáÔºàÁî®ÊñºÂèÉËÄÉÔºâ
      };

      // ËøΩËπ§Êº´Áï´ÊòØÂê¶Ê≠£Âú®ÁîüÊàê
      let isGeneratingComic = false;

      // ÈñãÂïü/ÈóúÈñâÊº´Áï´Ê®°ÊÖãË¶ñÁ™ó
      generateImageBtn.addEventListener('click', () => {
        comicModal.classList.add('open');
        updateComicChapterList();
      });

      closeComicModal.addEventListener('click', () => {
        comicModal.classList.remove('open');
        if (isGeneratingComic) {
          showStatus('info', 'üìö Êº´Áï´ÁîüÊàê‰∏≠... ÈªûÊìäÊº´Áï´ÊåâÈàïÂèØËøîÂõûÊü•ÁúãÈÄ≤Â∫¶');
        }
      });

      // ÈªûÊìäËÉåÊôØÈóúÈñâÊ®°ÊÖãË¶ñÁ™ó
      comicModal.addEventListener('click', (e) => {
        if (e.target === comicModal) {
          comicModal.classList.remove('open');
          if (isGeneratingComic) {
            showStatus('info', 'üìö Êº´Áï´ÁîüÊàê‰∏≠... ÈªûÊìäÊº´Áï´ÊåâÈàïÂèØËøîÂõûÊü•ÁúãÈÄ≤Â∫¶');
          }
        }
      });

      // Êõ¥Êñ∞Á´†ÁØÄÂàóË°®
      function updateComicChapterList() {
        if (!latestStory) return;
        
        const chapterPattern = /###?\s*(Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá][Ôºö:].*)/g;
        const matches = [...latestStory.matchAll(chapterPattern)];
        
        comicChapterSelect.innerHTML = '';
        matches.forEach((match, index) => {
          const option = document.createElement('option');
          option.value = index;
          option.textContent = match[1].slice(0, 30) + (match[1].length > 30 ? '...' : '');
          comicChapterSelect.appendChild(option);
        });
        
        if (matches.length === 0) {
          const option = document.createElement('option');
          option.value = '0';
          option.textContent = 'ÔºàÊï¥ÁØáÊïÖ‰∫ãÔºâ';
          comicChapterSelect.appendChild(option);
        }
      }

      // ÈñãÂßãÁîüÊàêÊº´Áï´ÔºàÈáçÊñ∞ÈñãÂßãÔºâ
      generateImageNowBtn.addEventListener('click', () => startComicGeneration(true));
      regenerateImageBtn.addEventListener('click', () => startComicGeneration(true));
      
      // ÁπºÁ∫åÁîüÊàê
      continueComicBtn.addEventListener('click', () => startComicGeneration(false));

      async function startComicGeneration(isNewStart) {
        const apiKey = apiKeyInput.value.trim();
        if (!apiKey) {
          showStatus('error', 'Ë´ãÂÖàËº∏ÂÖ• Gemini API Key');
          return;
        }

        if (!latestStory) {
          showStatus('error', 'Ë´ãÂÖàÁîüÊàêÂ∞èË™™ÂÖßÂÆπ');
          return;
        }

        // Ê®ôË®òÈñãÂßãÁîüÊàê
        isGeneratingComic = true;
        generateImageBtn.classList.add('active-task');

        if (isNewStart) {
          // ÈáçÊñ∞ÈñãÂßãÔºåÈáçÁΩÆÁãÄÊÖã
          const chapterPattern = /###?\s*(Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá][Ôºö:].*)/g;
          const matches = [...latestStory.matchAll(chapterPattern)];
          const allParts = latestStory.split(chapterPattern).filter(s => s.trim());
          
          const idx = parseInt(comicChapterSelect.value) || 0;
          let chapterContent = '';
          let chapterTitle = '';
          
          if (matches.length > 0 && allParts.length > idx * 2 + 1) {
            chapterTitle = matches[idx]?.[1] || 'Á¨¨' + (idx + 1) + 'Á´†';
            chapterContent = allParts[idx * 2 + 1] || '';
          } else {
            chapterTitle = 'ÊïÖ‰∫ã';
            chapterContent = latestStory.slice(0, 5000);
          }

          // È¢®Ê†ºË®≠ÂÆö
          const styleSettings = {
            'manga': { name: 'Êó•ÂºèÊº´Áï´', desc: 'Japanese manga style, black and white, screentone effects, dynamic action lines, expressive faces, clear panel borders' },
            'manhwa': { name: 'ÈüìÂºèÊº´Áï´', desc: 'Korean manhwa style, full color, soft pastel tones, beautiful detailed characters, romantic atmosphere' },
            'manhua': { name: '‰∏≠ÂºèÊº´Áï´', desc: 'Chinese manhua style, traditional ink wash or ancient style coloring, Eastern aesthetics, flowing robes' },
            'comic': { name: 'ÁæéÂºèÊº´Áï´', desc: 'American comic style, vivid bold colors, strong contrast, dynamic poses, superhero comic feel' },
            'webtoon': { name: 'Ê¢ùÊº´È¢®Ê†º', desc: 'Modern webtoon style, clean lines, soft colors, contemporary setting, vertical scroll friendly' }
          };

          // ÂæûÂ∞èË™™Ë®≠ÂÆö‰∏≠ÊèêÂèñÂ§öËßíËâ≤Ë≥áË®ä
          let characters = [];
          const characterInputs = document.querySelectorAll('.character-card');
          if (characterInputs.length > 0) {
            characterInputs.forEach((card, idx) => {
              const nameInput = card.querySelector('input[placeholder*="ÂêçÂ≠ó"]');
              const descInput = card.querySelector('textarea');
              if (nameInput && nameInput.value) {
                const name = nameInput.value.trim();
                const desc = descInput ? descInput.value.trim() : '';
                characters.push({
                  id: idx + 1,
                  name: name,
                  description: desc,
                  // ÁÇ∫ÊØèÂÄãËßíËâ≤ÁîüÊàêÂîØ‰∏ÄÁöÑË¶ñË¶∫Ê®ôË≠òÂª∫Ë≠∞
                  visualId: generateVisualIdentifier(idx, name)
                });
              }
            });
          }
          
          // Â¶ÇÊûúÊ≤íÊúâËßíËâ≤Ë®≠ÂÆöÔºåÂæûÁ´†ÁØÄÂÖßÂÆπÂàÜÊûêËßíËâ≤
          if (characters.length === 0 && chapterContent) {
            // ÊèêÂèñÂ∞çË©±‰∏≠ÁöÑËßíËâ≤Âêç
            const dialoguePattern = /[„Äå„Äé]([^„Äç„Äè]+)[„Äç„Äè]\s*[Ôºå,„ÄÇÔºÅÔºü]?\s*([^\s„Äå„Äé„Äç„Äè]{2,4})(Ë™™|ÈÅì|Âïè|Á≠î|Âñä|Âè´|Á¨ë|ÂòÜ)/g;
            const matches = [...chapterContent.matchAll(dialoguePattern)];
            const nameCount = {};
            matches.forEach(m => {
              const name = m[2];
              if (name && name.length >= 2 && name.length <= 4) {
                nameCount[name] = (nameCount[name] || 0) + 1;
              }
            });
            
            // ÂèñÂá∫ÁèæÊ¨°Êï∏ÊúÄÂ§öÁöÑÂâç5ÂÄãËßíËâ≤
            const sortedNames = Object.entries(nameCount)
              .sort((a, b) => b[1] - a[1])
              .slice(0, 5);
            
            sortedNames.forEach(([name, count], idx) => {
              characters.push({
                id: idx + 1,
                name: name,
                description: `appears ${count} times in dialogue`,
                visualId: generateVisualIdentifier(idx, name)
              });
            });
          }

          // ÈôêÂà∂ÊúÄÂ§ö5ÂÄãËßíËâ≤ÔºàGemini 3 Pro Image ÁöÑÈôêÂà∂Ôºâ
          characters = characters.slice(0, 5);

          comicState = {
            chapterContent: chapterContent,
            chapterTitle: chapterTitle,
            style: styleSettings[imageStyle.value] || styleSettings['manga'],
            numPanels: parseInt(panelsPerPage.value) || 6,
            currentPosition: 0,
            pages: [],
            isComplete: false,
            characters: characters,  // ÊîπÁî®ÁµêÊßãÂåñÁöÑËßíËâ≤Èô£Âàó
            firstPageImage: null
          };

          // Ê∏ÖÁ©∫ÂÆπÂô®ÂíåËàäË≥áÊñô
          comicContainer.innerHTML = '';
          comicCompleteMsg.style.display = 'none';
          
          // Ê∏ÖÈô§ IndexedDB ‰∏≠ÁöÑËàäÊº´Áï´
          await clearComicFromDB();
        }

        // È°ØÁ§∫ËºâÂÖ•ÁãÄÊÖã
        imageResult.style.display = 'block';
        imageLoading.style.display = 'flex';
        comicProgressBar.style.display = 'block';
        imageActions.style.display = 'none';
        generateImageNowBtn.disabled = true;
        continueComicBtn.disabled = true;
        
        const pageNum = comicState.pages.length + 1;
        comicPageInfo.textContent = `Á¨¨ ${pageNum} È†Å`;
        comicProgress.textContent = 'Ê∫ñÂÇôÁπ™Ë£Ω‰∏≠...';

        try {
          await generateComicPage(apiKey);
        } catch (err) {
          console.error('Êº´Áï´ÁîüÊàêÈåØË™§Ôºö', err);
          imageLoading.style.display = 'none';
          
          const errorMsg = err.message || '';
          if (errorMsg.includes('quota') || errorMsg.includes('limit') || errorMsg.includes('429')) {
            showStatus('error', '‚ö†Ô∏è API ÈÖçÈ°çÂ∑≤Áî®ÂÆåÔºåË´ãÁ®çÂæåÂÜçË©¶');
          } else if (errorMsg.includes('not found') || errorMsg.includes('404')) {
            showStatus('error', '‚ö†Ô∏è ÂúñÁâáÁîüÊàêÊ®°Âûã‰∏çÂèØÁî®ÔºåË´ãÁ¢∫Ë™ç API Ê¨äÈôê');
          } else if (errorMsg.includes('safety') || errorMsg.includes('blocked')) {
            showStatus('error', '‚ö†Ô∏è ÂÖßÂÆπË¢´ÂÆâÂÖ®ÈÅéÊøæÔºåË´ãË™øÊï¥Á´†ÁØÄÂÖßÂÆπÂæåÈáçË©¶');
          } else {
            showStatus('error', 'Êº´Áï´ÁîüÊàêÂ§±ÊïóÔºö' + errorMsg);
          }
          
          // È°ØÁ§∫Êìç‰ΩúÊåâÈàïËÆì‰ΩøÁî®ËÄÖÂèØ‰ª•ÈáçË©¶
          imageActions.style.display = 'flex';
          if (comicState.pages.length > 0) {
            comicContainer.style.display = 'flex';
            continueComicBtn.style.display = 'inline-block';
          }
          
          isGeneratingComic = false; // ÁîüÊàêÂ§±ÊïóÔºåÈáçÁΩÆÁãÄÊÖã
          generateImageBtn.classList.remove('active-task');
        } finally {
          generateImageNowBtn.disabled = false;
          continueComicBtn.disabled = false;
        }
      }

      // ÁÇ∫ËßíËâ≤ÁîüÊàêÁç®ÁâπÁöÑË¶ñË¶∫Ê®ôË≠ò
      function generateVisualIdentifier(index, name) {
        // È†êË®≠ÁöÑË¶ñË¶∫ÁâπÂæµÁµÑÂêàÔºåÁ¢∫‰øùÊØèÂÄãËßíËâ≤ÈÉΩÊúâÁç®ÁâπÂ§ñËßÄ
        const hairStyles = ['short spiky', 'long straight', 'medium wavy', 'ponytail', 'twin tails', 'bob cut', 'braided', 'messy'];
        const hairColors = ['black', 'dark brown', 'light brown', 'blonde', 'silver/white', 'dark blue', 'auburn red', 'purple'];
        const eyeColors = ['brown', 'dark brown', 'blue', 'green', 'amber', 'gray', 'violet', 'golden'];
        const features = ['sharp eyes', 'soft features', 'strong jawline', 'gentle smile', 'serious expression', 'cheerful face', 'mysterious aura', 'determined look'];
        const clothingStyles = ['formal suit', 'casual modern', 'traditional robes', 'school uniform', 'military style', 'elegant dress', 'adventurer gear', 'simple clothes'];
        const accessories = ['glasses', 'earrings', 'necklace', 'hair ribbon', 'headband', 'scarf', 'watch', 'bracelet'];
        
        // Ê†πÊìöËßíËâ≤Á¥¢ÂºïÈÅ∏Êìá‰∏çÂêåÁâπÂæµÔºåÁ¢∫‰øùÂ§öËßíËâ≤ÊúâÊòéÈ°ØÂçÄÂà•
        return {
          hair: `${hairColors[index % hairColors.length]} ${hairStyles[index % hairStyles.length]} hair`,
          eyes: `${eyeColors[(index + 3) % eyeColors.length]} eyes`,
          feature: features[index % features.length],
          clothing: clothingStyles[index % clothingStyles.length],
          accessory: accessories[(index + 2) % accessories.length]
        };
      }

      // Âª∫Á´ãÂ§öËßíËâ≤ÊèèËø∞ÊñáÂ≠ó
      function buildCharacterSheet(characters, isFirstPage) {
        if (!characters || characters.length === 0) {
          return '';
        }

        let sheet = '';
        
        if (isFirstPage) {
          sheet = `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CHARACTER DESIGN SHEET - ESTABLISH THESE EXACTLY (${characters.length} characters)
These designs MUST remain IDENTICAL throughout ALL pages!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

`;
          characters.forEach((char, idx) => {
            const v = char.visualId;
            sheet += `„ÄêCHARACTER ${idx + 1}: "${char.name}"„Äë
‚Ä¢ Hair: ${v.hair}
‚Ä¢ Eyes: ${v.eyes}
‚Ä¢ Face: ${v.feature}
‚Ä¢ Outfit: ${v.clothing}
‚Ä¢ Accessory: ${v.accessory}
${char.description ? `‚Ä¢ Description: ${char.description}` : ''}
‚Ä¢ UNIQUE IDENTIFIER: Always draw ${char.name} with ${v.hair} and ${v.accessory}

`;
          });
          
          sheet += `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CRITICAL: Each character MUST be visually DISTINCT and CONSISTENT!
- Different hair colors/styles for each character
- Consistent clothing throughout all pages  
- Same facial features every time they appear
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;
        } else {
          // ÂæåÁ∫åÈ†ÅÈù¢ÁöÑÁ∞°ÂåñÁâàÊú¨ÔºåÂº∑Ë™ø‰∏ÄËá¥ÊÄß
          sheet = `
„ÄêMANDATORY CHARACTER CONSISTENCY - ${characters.length} CHARACTERS„Äë
You MUST draw these characters EXACTLY as established on page 1:

`;
          characters.forEach((char, idx) => {
            const v = char.visualId;
            sheet += `${idx + 1}. "${char.name}": ${v.hair}, ${v.eyes}, ${v.clothing}, wearing ${v.accessory}
`;
          });
          
          sheet += `
‚ö†Ô∏è DO NOT CHANGE ANY CHARACTER'S APPEARANCE!
‚ö†Ô∏è Same hair, same eyes, same clothes, same accessories!
‚ö†Ô∏è Characters must be IMMEDIATELY recognizable from page 1!`;
        }
        
        return sheet;
      }

      async function generateComicPage(apiKey) {
        const { chapterContent, chapterTitle, style, numPanels, currentPosition, pages, characters, firstPageImage } = comicState;
        
        // Ë®àÁÆóÈÄô‰∏ÄÈ†ÅË¶ÅËôïÁêÜÁöÑÂÖßÂÆπ
        const chunkSize = Math.ceil(chapterContent.length / Math.ceil(chapterContent.length / 800)); // ÊØèÈ†ÅÁ¥Ñ 800 Â≠ó
        const startPos = currentPosition;
        const endPos = Math.min(currentPosition + chunkSize, chapterContent.length);
        const pageContent = chapterContent.slice(startPos, endPos);
        
        // Êõ¥Êñ∞ÈÄ≤Â∫¶
        const progress = Math.round((endPos / chapterContent.length) * 100);
        comicContentProgress.textContent = `${progress}%`;
        comicProgressFill.style.width = `${progress}%`;
        
        const pageNum = pages.length + 1;
        comicProgress.textContent = `Áπ™Ë£ΩÁ¨¨ ${pageNum} È†Å...ÔºàÁ¥ÑÈúÄ 30-60 ÁßíÔºâ`;

        // Âª∫Á´ãÊèêÁ§∫Ë©û
        const isFirstPage = pages.length === 0;
        const isLastPage = endPos >= chapterContent.length;
        
        // Âª∫Á´ãËßíËâ≤ÊèèËø∞Ë°®
        const characterSheet = buildCharacterSheet(characters, isFirstPage);
        
        // ÂàÜÊûêÈÄô‰∏ÄÈ†ÅÂá∫ÁèæÁöÑËßíËâ≤
        let appearingCharacters = '';
        if (characters && characters.length > 0) {
          const appearing = characters.filter(char => 
            pageContent.includes(char.name)
          );
          if (appearing.length > 0) {
            appearingCharacters = `\n\n„ÄêCharacters appearing in this page's scene„Äë:\n` +
              appearing.map(c => `- ${c.name} (${c.visualId.hair}, ${c.visualId.clothing})`).join('\n');
          }
        }
        
        const prompt = `Create a ${numPanels}-panel comic/manga page with CRYSTAL CLEAR TEXT.

${characterSheet}
${appearingCharacters}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
STORY CONTENT FOR THIS PAGE:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${pageContent}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ART STYLE & REQUIREMENTS:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Style: ${style.desc}

Panel Layout:
- Draw exactly ${numPanels} panels in a professional comic page layout
- Clear panel borders and consistent gutters
- Varied panel sizes for visual interest

„ÄêTEXT RENDERING - HIGHEST PRIORITY„Äë
- ALL text MUST be SHARP, CLEAR, and PERFECTLY READABLE
- Use HIGH CONTRAST colors for text (black text on white bubbles)
- Speech bubbles must have CLEAN WHITE backgrounds
- Text size must be LARGE ENOUGH to read easily
- Use BOLD, CLEAN fonts - no thin or decorative fonts
- NO blurry, fuzzy, or distorted text allowed
- Chinese characters must be correctly formed and legible
- Keep dialogue SHORT and CONCISE for better readability

${isFirstPage ? `
„ÄêFIRST PAGE INSTRUCTIONS„Äë
- This is PAGE 1 - establish ALL character designs clearly
- Show each character's full appearance at least once
- Make sure each character is visually DISTINCT from others
- These designs will be the REFERENCE for all future pages
` : `
„ÄêCONTINUATION PAGE ${pageNum} INSTRUCTIONS„Äë  
- MAINTAIN EXACT character consistency with page 1
- DO NOT modify any character's appearance
- Same hair color, same clothes, same accessories
- Characters must be INSTANTLY recognizable
`}

Content Requirements:
- Include speech bubbles with CHINESE dialogue (Traditional Chinese)
- Speech bubbles: white background, black outline, BLACK TEXT
- Show character emotions and actions vividly
- ${isLastPage ? 'This is the LAST page - provide story closure' : 'End with a hook leading to next page'}
- Add speed lines, emotion effects, and detailed backgrounds

Chapter: ${chapterTitle}
Page: ${pageNum}
${characters.length > 0 ? `Total characters to maintain: ${characters.length}` : ''}
${!isFirstPage ? '\n‚ö†Ô∏è CRITICAL: Characters MUST match page 1 EXACTLY! Same hair, eyes, clothes!' : ''}
‚ö†Ô∏è REMINDER: Text must be PERFECTLY CLEAR and READABLE!`;

        // Âª∫Á´ãË´ãÊ±ÇÂÖßÂÆπ
        const requestParts = [];
        
        // Â¶ÇÊûú‰∏çÊòØÁ¨¨‰∏ÄÈ†Å‰∏îÊúâÁ¨¨‰∏ÄÈ†ÅÂúñÁâáÔºåÂä†ÂÖ•‰ΩúÁÇ∫ÂèÉËÄÉ
        if (!isFirstPage && firstPageImage) {
          const base64Data = firstPageImage.split(',')[1];
          if (base64Data) {
            requestParts.push({
              inlineData: {
                mimeType: 'image/png',
                data: base64Data
              }
            });
            requestParts.push({
              text: `„ÄêREFERENCE IMAGE - PAGE 1„Äë
This is the first page of this comic. You MUST maintain the EXACT SAME:
- Character designs (face, hair, body, clothes)
- Art style and line work
- Color palette
- Panel border style

ALL characters must look IDENTICAL to how they appear in this reference!

` + prompt
            });
          } else {
            requestParts.push({ text: prompt });
          }
        } else {
          requestParts.push({ text: prompt });
        }

        // ‰ΩøÁî® Gemini 3 Pro Image ÂúñÁâáÁîüÊàêÊ®°Âûã
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent?key=${apiKey}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{
              parts: requestParts
            }],
            generationConfig: {
              responseModalities: ["IMAGE", "TEXT"],
              // Ë¶ÅÊ±ÇÈ´òËß£ÊûêÂ∫¶Ëº∏Âá∫
              imageConfig: {
                imageSize: "2K",        // 2K Ëß£ÊûêÂ∫¶
                aspectRatio: "3:4"      // ÈÅ©ÂêàÊº´Áï´ÁöÑÊØî‰æã
              }
            }
          })
        });

        const data = await response.json();
        
        if (data.error) {
          throw new Error(data.error.message);
        }

        // Â∞ãÊâæÂúñÁâáÂõûÊáâ
        let imageUrl = null;
        if (data.candidates && data.candidates[0]?.content?.parts) {
          for (const part of data.candidates[0].content.parts) {
            if (part.inlineData && part.inlineData.mimeType?.startsWith('image/')) {
              imageUrl = `data:${part.inlineData.mimeType};base64,${part.inlineData.data}`;
              break;
            }
          }
        }

        if (!imageUrl) {
          throw new Error('Êú™Êî∂Âà∞ÂúñÁâáÔºåAPI ÂèØËÉΩ‰∏çÊîØÊè¥ÂúñÁâáÁîüÊàê');
        }

        // Â¶ÇÊûúÊòØÁ¨¨‰∏ÄÈ†ÅÔºåÂÑ≤Â≠ò‰ΩúÁÇ∫ÂèÉËÄÉ
        if (isFirstPage) {
          comicState.firstPageImage = imageUrl;
        }

        // ÂÑ≤Â≠òÈÄô‰∏ÄÈ†Å
        comicState.pages.push({
          pageNum: pageNum,
          imageUrl: imageUrl,
          content: pageContent
        });
        comicState.currentPosition = endPos;
        comicState.isComplete = (endPos >= chapterContent.length);

        // Ê∏≤ÊüìÈÄô‰∏ÄÈ†Å
        renderComicPage(pageNum, imageUrl);

        // Êõ¥Êñ∞ UI
        imageLoading.style.display = 'none';
        comicContainer.style.display = 'flex';
        imageActions.style.display = 'flex';

        if (comicState.isComplete) {
          // Á´†ÁØÄÂÆåÊàê
          continueComicBtn.style.display = 'none';
          comicCompleteMsg.style.display = 'block';
          comicProgressFill.style.width = '100%';
          comicContentProgress.textContent = '100%';
          showStatus('success', `üìö ${chapterTitle} Êº´Áï´ÂÖ®ÈÉ®ÁîüÊàêÂÆåÊàêÔºÅÂÖ± ${pages.length} È†Å`);
          isGeneratingComic = false; // ÁîüÊàêÂÆåÊàê
          generateImageBtn.classList.remove('active-task');
        } else {
          // ÈÇÑÊúâÊõ¥Â§öÂÖßÂÆπ
          continueComicBtn.style.display = 'inline-block';
          comicCompleteMsg.style.display = 'none';
          showStatus('success', `üìñ Á¨¨ ${pageNum} È†ÅÂÆåÊàêÔºÅÈªûÊìä„ÄåÁπºÁ∫åÁîüÊàê„ÄçÁî¢Áîü‰∏ã‰∏ÄÈ†Å`);
          isGeneratingComic = false; // ÂñÆÈ†ÅÂÆåÊàêÔºåÁ≠âÂæÖÁî®Êà∂ÁπºÁ∫å
          generateImageBtn.classList.remove('active-task');
        }
        
        // Ëá™ÂãïÂÑ≤Â≠òÊº´Áï´Âà∞ IndexedDB
        await saveComicToDB();
      }

      // Ê∏≤ÊüìÂñÆÈ†ÅÊº´Áï´
      function renderComicPage(pageNum, imageUrl) {
        const pageDiv = document.createElement('div');
        pageDiv.className = 'comic-page';
        pageDiv.innerHTML = `
          <div class="comic-page-header">
            <span>üìñ ${comicState.chapterTitle} - Á¨¨ ${pageNum} È†Å</span>
            <button class="comic-page-download-btn" onclick="downloadSinglePage(${pageNum})" title="‰∏ãËºâÊ≠§È†Å">
              ‚¨áÔ∏è ‰∏ãËºâ
            </button>
          </div>
          <div style="padding: 5px; background: #f5f5f5;">
            <img src="${imageUrl}" alt="Êº´Áï´Á¨¨${pageNum}È†Å" style="width: 100%; border-radius: 4px; display: block;">
          </div>
        `;
        comicContainer.appendChild(pageDiv);
        
        // ÊªæÂãïÂà∞Êñ∞È†ÅÈù¢
        pageDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      // ‰∏ãËºâÂñÆÂºµÊº´Áï´
      function downloadSinglePage(pageNum) {
        const page = comicState.pages.find(p => p.pageNum === pageNum);
        if (!page) {
          showStatus('error', 'Êâæ‰∏çÂà∞Ë©≤È†ÅÊº´Áï´');
          return;
        }
        
        const link = document.createElement('a');
        link.href = page.imageUrl;
        link.download = `Êº´Áï´_${comicState.chapterTitle}_Á¨¨${pageNum}È†Å.png`;
        link.click();
        showStatus('success', `üì• Á¨¨ ${pageNum} È†ÅÂ∑≤‰∏ãËºâ`);
      }

      // ‰∏ãËºâÊº´Áï´
      downloadImageBtn.addEventListener('click', async () => {
        if (!comicState.pages || comicState.pages.length === 0) {
          showStatus('error', 'Ê≤íÊúâÂèØ‰∏ãËºâÁöÑÊº´Áï´');
          return;
        }

        if (comicState.pages.length === 1) {
          // ÂñÆÈ†ÅÁõ¥Êé•‰∏ãËºâÂúñÁâá
          const link = document.createElement('a');
          link.href = comicState.pages[0].imageUrl;
          link.download = `Êº´Áï´_${comicState.chapterTitle}_Á¨¨1È†Å.png`;
          link.click();
          showStatus('success', 'üì• Êº´Áï´Â∑≤‰∏ãËºâ');
        } else {
          // Â§öÈ†ÅÁîüÊàê HTML
          const htmlContent = `<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${comicState.chapterTitle} - Êº´Áï´</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #222; padding: 20px; font-family: sans-serif; }
    .comic-page { max-width: 800px; margin: 0 auto 30px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
    .page-header { background: #333; color: white; padding: 12px 20px; font-weight: bold; }
    .page-image { padding: 5px; background: #f5f5f5; }
    .page-image img { width: 100%; display: block; }
    h1 { color: white; text-align: center; margin-bottom: 30px; }
  </style>
</head>
<body>
  <h1>üìö ${comicState.chapterTitle}</h1>
  ${comicState.pages.map(p => `
    <div class="comic-page">
      <div class="page-header">Á¨¨ ${p.pageNum} È†Å</div>
      <div class="page-image"><img src="${p.imageUrl}" alt="Á¨¨${p.pageNum}È†Å"></div>
    </div>
  `).join('')}
</body>
</html>`;

          const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `Êº´Áï´_${comicState.chapterTitle}.html`;
          link.click();
          URL.revokeObjectURL(url);
          showStatus('success', `üì• Â∑≤‰∏ãËºâ ${comicState.pages.length} È†ÅÊº´Áï´`);
        }
      });

      // Ê∏ÖÈô§Êº´Áï´ÊåâÈàï
      document.getElementById('clearComicBtn').addEventListener('click', async () => {
        if (!comicState.pages || comicState.pages.length === 0) {
          showStatus('info', 'Ê≤íÊúâÊº´Áï´ÈúÄË¶ÅÊ∏ÖÈô§');
          return;
        }
        
        if (confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊº´Áï´ÂóéÔºüÔºàÂÖ± ${comicState.pages.length} È†ÅÔºâ\nÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`)) {
          // ÈáçÁΩÆÁãÄÊÖã
          comicState = {
            chapterContent: '',
            chapterTitle: '',
            style: null,
            numPanels: 6,
            currentPosition: 0,
            pages: [],
            isComplete: false,
            characters: [],
            firstPageImage: null
          };
          
          // Ê∏ÖÁ©∫ UI
          comicContainer.innerHTML = '';
          imageResult.style.display = 'none';
          comicProgressBar.style.display = 'none';
          imageActions.style.display = 'none';
          comicCompleteMsg.style.display = 'none';
          
          // Ê∏ÖÈô§ IndexedDB
          await clearComicFromDB();
          
          showStatus('success', 'üóëÔ∏è Êº´Áï´Â∑≤Ê∏ÖÈô§');
        }
      });

      // ==================== Êõ∏Á±§ÂäüËÉΩ (Â§ßÂπÖÂÑ™Âåñ) ====================
      // ==================== IndexedDB Êõ∏Á±§ÂÑ≤Â≠ò ====================
      const DB_NAME = 'NovelGeneratorDB';
      const DB_VERSION = 2;  // ÂçáÁ¥öÁâàÊú¨‰ª•Âä†ÂÖ•Êº´Áï´ÂÑ≤Â≠ò
      const STORE_NAME = 'bookmarks';
      const COMIC_STORE_NAME = 'comics';  // Êº´Áï´ÂÑ≤Â≠òÂçÄ
      let db = null;

      // ÂàùÂßãÂåñ IndexedDB
      function initDB() {
        return new Promise((resolve, reject) => {
          const request = indexedDB.open(DB_NAME, DB_VERSION);
          
          request.onerror = () => {
            console.error('IndexedDB ÈñãÂïüÂ§±ÊïóÔºåÂòóË©¶‰ΩøÁî® localStorage');
            resolve(false);
          };
          
          request.onsuccess = (event) => {
            db = event.target.result;
            console.log('IndexedDB ÂàùÂßãÂåñÊàêÂäü');
            resolve(true);
          };
          
          request.onupgradeneeded = (event) => {
            const database = event.target.result;
            if (!database.objectStoreNames.contains(STORE_NAME)) {
              database.createObjectStore(STORE_NAME, { keyPath: 'id' });
              console.log('Âª∫Á´ãÊõ∏Á±§ÂÑ≤Â≠òÂçÄ');
            }
            // Âä†ÂÖ•Êº´Áï´ÂÑ≤Â≠òÂçÄ
            if (!database.objectStoreNames.contains(COMIC_STORE_NAME)) {
              database.createObjectStore(COMIC_STORE_NAME, { keyPath: 'id' });
              console.log('Âª∫Á´ãÊº´Áï´ÂÑ≤Â≠òÂçÄ');
            }
          };
        });
      }

      // ==================== Êº´Áï´Ë≥áÊñôÊåÅ‰πÖÂåñ ====================
      // ÂÑ≤Â≠òÊº´Áï´Âà∞ IndexedDB
      async function saveComicToDB() {
        if (!db || !comicState.pages || comicState.pages.length === 0) return;
        
        try {
          const comicData = {
            id: 'current_comic',  // ‰ΩøÁî®Âõ∫ÂÆö IDÔºåÊØèÊ¨°Ë¶ÜËìã
            chapterTitle: comicState.chapterTitle,
            chapterContent: comicState.chapterContent,
            style: comicState.style,
            numPanels: comicState.numPanels,
            currentPosition: comicState.currentPosition,
            pages: comicState.pages,
            characters: comicState.characters,
            firstPageImage: comicState.firstPageImage,
            isComplete: comicState.isComplete,
            savedAt: new Date().toISOString()
          };
          
          const transaction = db.transaction([COMIC_STORE_NAME], 'readwrite');
          const store = transaction.objectStore(COMIC_STORE_NAME);
          await store.put(comicData);
          console.log('Êº´Áï´Â∑≤ÂÑ≤Â≠òÂà∞ IndexedDB');
        } catch (err) {
          console.error('ÂÑ≤Â≠òÊº´Áï´Â§±ÊïóÔºö', err);
        }
      }

      // Âæû IndexedDB ËºâÂÖ•Êº´Áï´
      async function loadComicFromDB() {
        if (!db) return null;
        
        return new Promise((resolve) => {
          try {
            const transaction = db.transaction([COMIC_STORE_NAME], 'readonly');
            const store = transaction.objectStore(COMIC_STORE_NAME);
            const request = store.get('current_comic');
            
            request.onsuccess = () => {
              if (request.result) {
                console.log('Âæû IndexedDB ËºâÂÖ•Êº´Áï´ÔºåÂÖ±', request.result.pages?.length || 0, 'È†Å');
                resolve(request.result);
              } else {
                resolve(null);
              }
            };
            
            request.onerror = () => {
              console.error('ËºâÂÖ•Êº´Áï´Â§±Êïó');
              resolve(null);
            };
          } catch (err) {
            console.error('ËºâÂÖ•Êº´Áï´ÈåØË™§Ôºö', err);
            resolve(null);
          }
        });
      }

      // Ê∏ÖÈô§ÂÑ≤Â≠òÁöÑÊº´Áï´
      async function clearComicFromDB() {
        if (!db) return;
        
        try {
          const transaction = db.transaction([COMIC_STORE_NAME], 'readwrite');
          const store = transaction.objectStore(COMIC_STORE_NAME);
          await store.delete('current_comic');
          console.log('Â∑≤Ê∏ÖÈô§ÂÑ≤Â≠òÁöÑÊº´Áï´');
        } catch (err) {
          console.error('Ê∏ÖÈô§Êº´Áï´Â§±ÊïóÔºö', err);
        }
      }

      // ÊÅ¢Âæ©Êº´Áï´ÁãÄÊÖã‰∏¶Ê∏≤Êüì
      async function restoreComic() {
        const savedComic = await loadComicFromDB();
        if (!savedComic || !savedComic.pages || savedComic.pages.length === 0) {
          return false;
        }
        
        // ÊÅ¢Âæ©ÁãÄÊÖã
        comicState = {
          chapterContent: savedComic.chapterContent || '',
          chapterTitle: savedComic.chapterTitle || 'Êº´Áï´',
          style: savedComic.style || { name: 'Êó•ÂºèÊº´Áï´', desc: '' },
          numPanels: savedComic.numPanels || 6,
          currentPosition: savedComic.currentPosition || 0,
          pages: savedComic.pages || [],
          isComplete: savedComic.isComplete || false,
          characters: savedComic.characters || [],
          firstPageImage: savedComic.firstPageImage || null
        };
        
        // Ê∏≤ÊüìÊâÄÊúâÈ†ÅÈù¢
        comicContainer.innerHTML = '';
        savedComic.pages.forEach(page => {
          renderComicPage(page.pageNum, page.imageUrl);
        });
        
        // Êõ¥Êñ∞ UI
        imageResult.style.display = 'block';
        imageLoading.style.display = 'none';
        comicProgressBar.style.display = 'block';
        comicContainer.style.display = 'flex';
        imageActions.style.display = 'flex';
        
        // Êõ¥Êñ∞ÈÄ≤Â∫¶
        const progress = comicState.isComplete ? 100 : 
          Math.round((comicState.currentPosition / comicState.chapterContent.length) * 100);
        comicProgressFill.style.width = `${progress}%`;
        comicContentProgress.textContent = `${progress}%`;
        comicPageInfo.textContent = `ÂÖ± ${comicState.pages.length} È†Å`;
        
        if (comicState.isComplete) {
          continueComicBtn.style.display = 'none';
          comicCompleteMsg.style.display = 'block';
        } else {
          continueComicBtn.style.display = 'inline-block';
          comicCompleteMsg.style.display = 'none';
        }
        
        console.log('Â∑≤ÊÅ¢Âæ©Êº´Áï´ÔºåÂÖ±', comicState.pages.length, 'È†Å');
        return true;
      }

      // Âæû IndexedDB ËºâÂÖ•ÊâÄÊúâÊõ∏Á±§
      function loadBookmarksFromDB() {
        return new Promise((resolve) => {
          if (!db) {
            resolve([]);
            return;
          }
          
          const transaction = db.transaction([STORE_NAME], 'readonly');
          const store = transaction.objectStore(STORE_NAME);
          const request = store.getAll();
          
          request.onsuccess = () => {
            console.log('Âæû IndexedDB ËºâÂÖ•Êõ∏Á±§Êï∏ÈáèÔºö', request.result.length);
            resolve(request.result || []);
          };
          
          request.onerror = () => {
            console.error('ËºâÂÖ•Êõ∏Á±§Â§±Êïó');
            resolve([]);
          };
        });
      }

      // ÂÑ≤Â≠òÊõ∏Á±§Âà∞ IndexedDB
      function saveBookmarksToDB(bookmarks) {
        return new Promise((resolve) => {
          if (!db) {
            resolve(false);
            return;
          }
          
          const transaction = db.transaction([STORE_NAME], 'readwrite');
          const store = transaction.objectStore(STORE_NAME);
          
          // ÂÖàÊ∏ÖÁ©∫ÂÜçÂØ´ÂÖ•
          const clearRequest = store.clear();
          
          clearRequest.onsuccess = () => {
            let addedCount = 0;
            bookmarks.forEach(bm => {
              const addRequest = store.add(bm);
              addRequest.onsuccess = () => addedCount++;
            });
            
            transaction.oncomplete = () => {
              console.log(`IndexedDB ÂÑ≤Â≠òÂÆåÊàêÔºåÂÖ± ${addedCount} ÂÄãÊõ∏Á±§`);
              resolve(true);
            };
            
            transaction.onerror = () => {
              console.error('IndexedDB ÂÑ≤Â≠òÂ§±Êïó');
              resolve(false);
            };
          };
          
          clearRequest.onerror = () => {
            resolve(false);
          };
        });
      }

      // Áõ∏ÂÆπÂ±§ÔºöÂÑ™ÂÖà‰ΩøÁî® IndexedDBÔºåÂÇôÁî® localStorage
      let bookmarksCache = [];
      let useIndexedDB = false;

      function loadBookmarks() {
        return bookmarksCache;
      }

      function saveBookmarks(bookmarks) {
        bookmarksCache = bookmarks;
        
        if (useIndexedDB && db) {
          saveBookmarksToDB(bookmarks).then(success => {
            if (!success) {
              console.warn('IndexedDB ÂÑ≤Â≠òÂ§±ÊïóÔºåÂòóË©¶ localStorage');
              saveToLocalStorage(bookmarks);
            }
          });
          return true;
        } else {
          return saveToLocalStorage(bookmarks);
        }
      }

      function saveToLocalStorage(bookmarks) {
        try {
          const json = JSON.stringify(bookmarks);
          const sizeInMB = (json.length / 1024 / 1024).toFixed(2);
          console.log(`localStorage ÂÑ≤Â≠ò ${bookmarks.length} ÂÄãÊõ∏Á±§ÔºåÂ§ßÂ∞è: ${sizeInMB} MB`);
          localStorage.setItem('bookmarks', json);
          return true;
        } catch (e) {
          console.error('localStorage ÂÑ≤Â≠òÂ§±ÊïóÔºö', e);
          if (e.name === 'QuotaExceededError') {
            showStatus('error', 'Êõ∏Á±§Â§™Â§ßÔºåË∂ÖÂá∫ÁÄèË¶ΩÂô®ÂÑ≤Â≠òÈôêÂà∂„ÄÇÂª∫Ë≠∞ÂÆöÊúüÂåØÂá∫ÂÇô‰ªΩ„ÄÇ');
          }
          return false;
        }
      }

      function loadFromLocalStorage() {
        try {
          const raw = localStorage.getItem('bookmarks');
          if (!raw) return [];
          return JSON.parse(raw);
        } catch (e) {
          return [];
        }
      }

      // ÂàùÂßãÂåñÊõ∏Á±§Á≥ªÁµ±
      async function initBookmarks() {
        // ÂòóË©¶‰ΩøÁî® IndexedDB
        useIndexedDB = await initDB();
        
        if (useIndexedDB) {
          // Âæû IndexedDB ËºâÂÖ•
          bookmarksCache = await loadBookmarksFromDB();
          
          // Â¶ÇÊûú IndexedDB ÊòØÁ©∫ÁöÑÔºåÂòóË©¶Âæû localStorage ÈÅ∑Áßª
          if (bookmarksCache.length === 0) {
            const localData = loadFromLocalStorage();
            if (localData.length > 0) {
              console.log('Âæû localStorage ÈÅ∑ÁßªÊõ∏Á±§Âà∞ IndexedDB...');
              bookmarksCache = localData;
              await saveBookmarksToDB(localData);
              // ÈÅ∑ÁßªÊàêÂäüÂæåÊ∏ÖÈô§ localStorage
              try {
                localStorage.removeItem('bookmarks');
                console.log('ÈÅ∑ÁßªÂÆåÊàêÔºåÂ∑≤Ê∏ÖÈô§ localStorage');
              } catch (e) {}
            }
          }
          
          // ÂòóË©¶ÊÅ¢Âæ©Êº´Áï´ÔºàÂè™ÊÅ¢Âæ©Êï∏ÊìöÔºå‰∏çËá™ÂãïÊâìÈñãË¶ñÁ™óÔºâ
          const comicRestored = await restoreComic();
          if (comicRestored) {
            console.log('Â∑≤ÊÅ¢Âæ©‰∏äÊ¨°ÁöÑÊº´Áï´ÔºåÂèØÈªûÊìäÊº´Áï´ÊåâÈàïÊü•Áúã');
            // Âè™ÂïüÁî®ÊåâÈàïÔºå‰∏çËá™ÂãïÊâìÈñãË¶ñÁ™ó
            generateImageBtn.disabled = false;
          }
        } else {
          // ÈÄÄÂõû‰ΩøÁî® localStorage
          bookmarksCache = loadFromLocalStorage();
        }
        
        // Á¢∫‰øùÂ¶ÇÊûúÊúâÂÑ≤Â≠òÁöÑÊïÖ‰∫ãÔºåÊåâÈàïÈÉΩÊúÉÂïüÁî®
        if (latestStory) {
          downloadBtn.disabled = false;
          continueBtn.disabled = false;
          speakBtn.disabled = false;
          generateImageBtn.disabled = false;
        }
        
        console.log(`Êõ∏Á±§Á≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàêÔºå‰ΩøÁî® ${useIndexedDB ? 'IndexedDB' : 'localStorage'}ÔºåÂÖ± ${bookmarksCache.length} ÂÄãÊõ∏Á±§`);
        renderBookmarks();
      }

      // È†ÅÈù¢ËºâÂÖ•ÊôÇÂàùÂßãÂåñ
      initBookmarks();

      function formatDate(timestamp) {
        const date = new Date(timestamp);
        return `${date.getFullYear()}/${(date.getMonth()+1).toString().padStart(2,'0')}/${date.getDate().toString().padStart(2,'0')} ${date.getHours().toString().padStart(2,'0')}:${date.getMinutes().toString().padStart(2,'0')}`;
      }

      function formatWordCount(text) {
        const count = text.length;
        if (count >= 10000) return (count / 10000).toFixed(1) + ' Ëê¨Â≠ó';
        if (count >= 1000) return (count / 1000).toFixed(1) + ' ÂçÉÂ≠ó';
        return count + ' Â≠ó';
      }

      function getFilteredAndSortedBookmarks() {
        let bookmarks = loadBookmarks();
        const searchTerm = bookmarkSearch.value.trim().toLowerCase();
        const sortBy = bookmarkSort.value;

        // ÊêúÂ∞ãÈÅéÊøæ
        if (searchTerm) {
          bookmarks = bookmarks.filter(bm => 
            (bm.title && bm.title.toLowerCase().includes(searchTerm)) ||
            (bm.tags && bm.tags.some(t => t.toLowerCase().includes(searchTerm))) ||
            (bm.notes && bm.notes.toLowerCase().includes(searchTerm))
          );
        }

        // ÊéíÂ∫è
        switch (sortBy) {
          case 'newest':
            bookmarks.sort((a, b) => b.id - a.id);
            break;
          case 'oldest':
            bookmarks.sort((a, b) => a.id - b.id);
            break;
          case 'name':
            bookmarks.sort((a, b) => (a.title || '').localeCompare(b.title || ''));
            break;
          case 'length':
            bookmarks.sort((a, b) => (b.content?.length || 0) - (a.content?.length || 0));
            break;
        }

        return bookmarks;
      }

      function renderBookmarks() {
        const allBookmarks = loadBookmarks();
        const bookmarks = getFilteredAndSortedBookmarks();
        
        // Êõ¥Êñ∞ÂæΩÁ´†
        updateBookmarkBadge();
        
        bookmarkList.innerHTML = '';

        if (bookmarks.length === 0) {
          // Á©∫ÁãÄÊÖãÁî± bookmarkEmpty ÂÖÉÁ¥†È°ØÁ§∫
          return;
        }

        bookmarks.forEach(bm => {
          const li = document.createElement('li');
          li.innerHTML = `
            <div class="bookmark-item-title">${bm.title || 'Êú™ÂëΩÂêçÊõ∏Á±§'}</div>
            <div class="bookmark-item-meta">
              <span>üìÖ ${formatDate(bm.id)}</span>
              <span>üìù ${formatWordCount(bm.content || '')}</span>
            </div>
            <div class="bookmark-item-preview">${(bm.content || '').substring(0, 80).replace(/\n/g, ' ')}...</div>
            <div class="bookmark-item-actions">
              <button type="button" data-action="load">üìñ ËºâÂÖ•</button>
              <button type="button" data-action="edit">‚úèÔ∏è Á∑®ËºØ</button>
              <button type="button" class="delete-btn" data-action="delete">üóëÔ∏è</button>
            </div>
          `;

          // ÈªûÊìäÊï¥ÂÄãÈ†ÖÁõÆËºâÂÖ•ÔºàÈô§‰∫ÜÊåâÈàïÂçÄÂüüÔºâ
          li.addEventListener('click', (e) => {
            // Ê™¢Êü•ÊòØÂê¶ÈªûÊìä‰∫ÜÊåâÈàïÊàñÊåâÈàïÂçÄÂüü
            if (e.target.closest('button') || e.target.closest('.bookmark-item-actions')) return;
            loadBookmarkContent(bm);
          });

          // ËºâÂÖ•
          li.querySelector('[data-action="load"]').addEventListener('click', (e) => {
            e.stopPropagation();
            e.preventDefault();
            loadBookmarkContent(bm);
          });

          // Á∑®ËºØ
          li.querySelector('[data-action="edit"]').addEventListener('click', (e) => {
            e.stopPropagation();
            e.preventDefault();
            editingBookmarkId = bm.id;
            editBookmarkTitle.value = bm.title || '';
            editBookmarkTags.value = (bm.tags || []).join(', ');
            editBookmarkNotes.value = bm.notes || '';
            editModal.classList.add('show');
          });

          // Âà™Èô§
          li.querySelector('[data-action="delete"]').addEventListener('click', (e) => {
            e.stopPropagation();
            e.preventDefault();
            if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§Êõ∏Á±§ÂóéÔºü')) {
              const list = loadBookmarks().filter(b => b.id !== bm.id);
              saveBookmarks(list);
              renderBookmarks();
              showStatus('success', 'Êõ∏Á±§Â∑≤Âà™Èô§');
            }
          });

          bookmarkList.appendChild(li);
        });
      }
      
      // ËºâÂÖ•Êõ∏Á±§ÂÖßÂÆπ
      function loadBookmarkContent(bm) {
        latestStory = bm.content;
        resultDiv.textContent = latestStory;
        downloadBtn.disabled = !latestStory;
        continueBtn.disabled = !latestStory;
        speakBtn.disabled = !latestStory;
        try {
          localStorage.setItem('savedStory', latestStory);
        } catch (e) {}
        showStatus('success', `Â∑≤ËºâÂÖ•Ôºö${bm.title || 'Êõ∏Á±§'}`);
        parseAndShowChapters(latestStory);
        
        // ÈóúÈñâÊõ∏Á±§Èù¢Êùø
        isBookmarkPanelOpen = false;
        bookmarkNavPanel.classList.remove('open');
        
        // Êç≤ÂãïÂà∞ÁµêÊûúÂçÄ
        resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      // Êñ∞Â¢ûÊõ∏Á±§
      addBookmarkBtn.addEventListener('click', () => {
        if (!latestStory || latestStory.trim() === '') {
          showStatus('error', 'Ê≤íÊúâÂèØÂÑ≤Â≠òÁöÑÂÖßÂÆπ');
          return;
        }
        const bookmarks = loadBookmarks();
        let title = latestStory.trim().replace(/\s+/g, ' ').substring(0, 50);
        if (title.length < latestStory.trim().length) title += '...';
        
        const newBookmark = {
          id: Date.now(),
          title,
          content: latestStory,
          tags: [],
          notes: '',
        };
        bookmarks.push(newBookmark);
        saveBookmarks(bookmarks);
        renderBookmarks();
        showStatus('success', 'Êõ∏Á±§Â∑≤ÂÑ≤Â≠òÔºÅ');
      });

      // ÊêúÂ∞ãÂíåÊéíÂ∫è
      bookmarkSearch.addEventListener('input', renderBookmarks);
      bookmarkSort.addEventListener('change', renderBookmarks);

      // Á∑®ËºØÂΩàÁ™ó
      cancelEditBtn.addEventListener('click', () => {
        editModal.classList.remove('show');
        editingBookmarkId = null;
      });

      saveEditBtn.addEventListener('click', () => {
        if (!editingBookmarkId) return;
        const bookmarks = loadBookmarks();
        const bm = bookmarks.find(b => b.id === editingBookmarkId);
        if (bm) {
          bm.title = editBookmarkTitle.value.trim() || bm.title;
          bm.tags = editBookmarkTags.value.split(',').map(t => t.trim()).filter(t => t);
          bm.notes = editBookmarkNotes.value.trim();
          saveBookmarks(bookmarks);
          renderBookmarks();
          showStatus('success', 'Êõ∏Á±§Â∑≤Êõ¥Êñ∞');
        }
        editModal.classList.remove('show');
        editingBookmarkId = null;
      });

      editModal.addEventListener('click', (e) => {
        if (e.target === editModal) {
          editModal.classList.remove('show');
          editingBookmarkId = null;
        }
      });

      // ÂåØÂá∫Êõ∏Á±§
      exportBookmarksBtn.addEventListener('click', () => {
        const bookmarks = loadBookmarks();
        if (bookmarks.length === 0) {
          showStatus('error', 'Ê≤íÊúâÊõ∏Á±§ÂèØÂåØÂá∫');
          return;
        }
        const dataStr = JSON.stringify(bookmarks, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `Â∞èË™™Êõ∏Á±§_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
        showStatus('success', 'Êõ∏Á±§Â∑≤ÂåØÂá∫');
      });

      // ÂåØÂÖ•Êõ∏Á±§
      importBookmarksBtn.addEventListener('click', () => {
        importFileInput.click();
      });

      importFileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            console.log('ÈñãÂßãÂåØÂÖ•Êõ∏Á±§...');
            const imported = JSON.parse(event.target.result);
            console.log('Ëß£Êûê JSON ÊàêÂäüÔºåÊõ∏Á±§Êï∏ÈáèÔºö', imported.length);
            
            if (!Array.isArray(imported)) throw new Error('Ê†ºÂºèÈåØË™§Ôºö‰∏çÊòØÈô£Âàó');
            
            if (imported.length === 0) {
              showStatus('error', 'ÂåØÂÖ•Â§±ÊïóÔºöÊ™îÊ°à‰∏≠Ê≤íÊúâÊõ∏Á±§');
              return;
            }
            
            const existing = loadBookmarks();
            console.log('ÁèæÊúâÊõ∏Á±§Êï∏ÈáèÔºö', existing.length);
            const existingIds = new Set(existing.map(b => b.id));
            let added = 0;
            let skipped = 0;
            
            imported.forEach(bm => {
              // Á¢∫‰øùÊõ∏Á±§ÊúâÂøÖË¶ÅÁöÑÊ¨Ñ‰Ωç
              if (bm.content) {
                // Â¶ÇÊûúÊ≤íÊúâ idÔºåÁîüÊàê‰∏ÄÂÄãÊñ∞ÁöÑ
                if (!bm.id) {
                  bm.id = Date.now() + Math.random();
                }
                
                // Ê™¢Êü•ÊòØÂê¶Â∑≤Â≠òÂú®
                if (!existingIds.has(bm.id)) {
                  existing.push(bm);
                  existingIds.add(bm.id);
                  added++;
                } else {
                  skipped++;
                }
              }
            });
            
            console.log('Êñ∞Â¢ûÔºö', added, 'Ë∑≥ÈÅéÔºö', skipped);
            
            if (added > 0) {
              const saveSuccess = saveBookmarks(existing);
              
              if (saveSuccess) {
                // È©óË≠âÂÑ≤Â≠òÁµêÊûú
                const verification = loadBookmarks();
                console.log('È©óË≠âÂÑ≤Â≠òÁµêÊûúÔºåÊï∏ÈáèÔºö', verification.length);
                
                renderBookmarks();
                
                if (skipped > 0) {
                  showStatus('success', `Â∑≤ÂåØÂÖ• ${added} Á≠ÜÊõ∏Á±§Ôºà${skipped} Á≠ÜÈáçË§áÂ∑≤Ë∑≥ÈÅéÔºâ`);
                } else {
                  showStatus('success', `Â∑≤ÂåØÂÖ• ${added} Á≠ÜÊõ∏Á±§`);
                }
              } else {
                showStatus('error', 'ÂåØÂÖ•Â§±ÊïóÔºöÁÑ°Ê≥ïÂÑ≤Â≠òÂà∞Êú¨Âú∞');
              }
            } else if (skipped > 0) {
              showStatus('warning', `ÊâÄÊúâ ${skipped} Á≠ÜÊõ∏Á±§ÈÉΩÂ∑≤Â≠òÂú®ÔºåÊ≤íÊúâÊñ∞Â¢û`);
            } else {
              showStatus('error', 'ÂåØÂÖ•Â§±ÊïóÔºöÊ™îÊ°à‰∏≠Ê≤íÊúâÊúâÊïàÁöÑÊõ∏Á±§ÔºàÈúÄË¶ÅÊúâ content Ê¨Ñ‰ΩçÔºâ');
            }
            
            // Âº∑Âà∂ÈáçÊñ∞Ê∏≤Êüì
            setTimeout(() => {
              renderBookmarks();
            }, 100);
            
          } catch (err) {
            console.error('ÂåØÂÖ•ÈåØË™§Ôºö', err);
            showStatus('error', 'ÂåØÂÖ•Â§±ÊïóÔºö' + (err.message || 'Ê™îÊ°àÊ†ºÂºèÈåØË™§'));
          }
        };
        reader.readAsText(file);
        e.target.value = '';
      });

      // ==================== ÊÉÖÁ∑íÊúóËÆÄÂäüËÉΩ ====================
      let speechSynth = window.speechSynthesis;
      let currentUtterance = null;
      let isSpeaking = false;
      let isPaused = false;
      let speechSegments = [];
      let currentSegmentIndex = 0;
      let availableVoices = [];
      let segmentRanges = []; // ÂÑ≤Â≠òÊØèÂÄãÊÆµËêΩÂú®ÂéüÊñá‰∏≠ÁöÑ‰ΩçÁΩÆ

      // ÊúóËÆÄÊéßÂà∂ÂÖÉÁ¥†
      const prevSegmentBtn = document.getElementById('prevSegmentBtn');
      const nextSegmentBtn = document.getElementById('nextSegmentBtn');
      const currentSegmentDisplay = document.getElementById('currentSegmentDisplay');
      const speechProgressBar = document.getElementById('speechProgressBar');
      const autoScrollCheck = document.getElementById('autoScrollCheck');
      const highlightCheck = document.getElementById('highlightCheck');
      
      // Chrome bug workaround: Èò≤Ê≠¢Èï∑ÊôÇÈñìÊúóËÆÄËá™ÂãïÊö´ÂÅú
      let speechKeepAliveInterval = null;
      
      function startSpeechKeepAlive() {
        if (speechKeepAliveInterval) return;
        speechKeepAliveInterval = setInterval(() => {
          if (isSpeaking && !isPaused && speechSynth.speaking) {
            speechSynth.pause();
            speechSynth.resume();
          }
        }, 10000); // ÊØè 10 Áßí
      }
      
      function stopSpeechKeepAlive() {
        if (speechKeepAliveInterval) {
          clearInterval(speechKeepAliveInterval);
          speechKeepAliveInterval = null;
        }
      }

      // ÂÑ≤Â≠òÊúóËÆÄÈÄ≤Â∫¶
      function saveSpeechProgress() {
        try {
          const progress = {
            segmentIndex: currentSegmentIndex,
            rate: speechRate.value,
            pitch: speechPitch.value,
            voice: voiceSelect.value,
            emotion: emotionMode.value,
            timestamp: Date.now()
          };
          localStorage.setItem('speechProgress', JSON.stringify(progress));
        } catch (e) {
          console.warn('ÁÑ°Ê≥ïÂÑ≤Â≠òÊúóËÆÄÈÄ≤Â∫¶Ôºö', e);
        }
      }

      // ËºâÂÖ•ÊúóËÆÄÈÄ≤Â∫¶
      function loadSpeechProgress() {
        try {
          const raw = localStorage.getItem('speechProgress');
          if (!raw) return null;
          return JSON.parse(raw);
        } catch (e) {
          return null;
        }
      }

      // Ê∏ÖÈô§ÊúóËÆÄÈÄ≤Â∫¶
      function clearSpeechProgress() {
        try {
          localStorage.removeItem('speechProgress');
        } catch (e) {}
      }

      // ËºâÂÖ•Ë™ûÈü≥ÂàóË°®ÔºàÂè™È°ØÁ§∫‰∏≠ÊñáË™ûÈü≥Ôºâ
      function loadVoices() {
        availableVoices = speechSynth.getVoices();
        voiceSelect.innerHTML = '';
        
        // ÁØ©ÈÅ∏‰∏≠ÊñáË™ûÈü≥ÔºàÊîæÂØ¨Ê¢ù‰ª∂Ôºâ
        const zhVoices = availableVoices.filter(v => 
          v.lang.includes('zh') || 
          v.lang.includes('TW') || 
          v.lang.includes('CN') ||
          v.lang.includes('HK') ||
          v.lang.includes('cmn') ||  // ÊôÆÈÄöË©±
          v.lang.includes('yue') ||  // Á≤µË™û
          v.lang.includes('wuu') ||  // Âê≥Ë™û
          v.name.includes('‰∏≠Êñá') ||
          v.name.includes('Chinese') ||
          v.name.includes('Mandarin') ||
          v.name.includes('Cantonese') ||
          v.name.includes('Taiwan') ||
          v.name.includes('Hong Kong') ||
          v.name.includes('Taiwanese') ||
          v.name.toLowerCase().includes('xiaoxiao') ||
          v.name.toLowerCase().includes('yunyang') ||
          v.name.toLowerCase().includes('xiaoyi')
        );
        
        // ÂèñÂæóÊâÄÊúâÈùû‰∏≠ÊñáË™ûÈü≥ÔºàÂÇôÁî®Ôºâ
        const otherVoices = availableVoices.filter(v => !zhVoices.includes(v));
        
        // ÊåâË™ûË®ÄÂàÜÈ°û
        const twVoices = zhVoices.filter(v => 
          v.lang.includes('TW') || 
          v.lang.includes('zh-Hant') || 
          v.name.includes('Âè∞') ||
          v.name.includes('Taiwan')
        );
        const cnVoices = zhVoices.filter(v => 
          (v.lang.includes('CN') || v.lang.includes('zh-Hans') || v.lang === 'zh' || v.lang.includes('cmn')) && 
          !twVoices.includes(v)
        );
        const hkVoices = zhVoices.filter(v => 
          v.lang.includes('HK') || 
          v.lang.includes('yue') ||
          v.name.includes('Á≤µ') || 
          v.name.includes('Cantonese') ||
          v.name.includes('Hong Kong')
        );
        const otherZhVoices = zhVoices.filter(v => 
          !twVoices.includes(v) && !cnVoices.includes(v) && !hkVoices.includes(v)
        );
        
        // Á∞°ÂåñË™ûÈü≥ÂêçÁ®±È°ØÁ§∫
        function formatVoiceName(voice, showLang = false) {
          let name = voice.name;
          // ÁßªÈô§Â∏∏Ë¶ãÁöÑÂÜóÈï∑ÂâçÁ∂¥
          name = name.replace(/Microsoft /gi, '');
          name = name.replace(/Google /gi, '');
          name = name.replace(/Apple /gi, '');
          name = name.replace(/ Online \(Natural\)/gi, '');
          name = name.replace(/ - Chinese \(.*\)/gi, '');
          name = name.replace(/ - .*$/gi, ''); // ÁßªÈô§ÊúÄÂæåÁöÑË™ûË®ÄÊ®ôË®ò
          
          // Ê∑ªÂä†Ë™ûË®ÄÊ®ôË®ò
          if (voice.lang.includes('TW') || voice.lang.includes('zh-Hant')) {
            return `üáπüáº ${name}`;
          } else if (voice.lang.includes('HK') || voice.lang.includes('yue')) {
            return `üá≠üá∞ ${name}`;
          } else if (voice.lang.includes('CN') || voice.lang.includes('zh-Hans') || voice.lang === 'zh' || voice.lang.includes('cmn')) {
            return `üá®üá≥ ${name}`;
          }
          
          if (showLang) {
            return `${name} (${voice.lang})`;
          }
          return name;
        }
        
        // ÁπÅÈ´î‰∏≠ÊñáÔºàÂè∞ÁÅ£Ôºâ
        if (twVoices.length > 0) {
          const group = document.createElement('optgroup');
          group.label = 'üáπüáº ÁπÅÈ´î‰∏≠ÊñáÔºàÂè∞ÁÅ£Ôºâ';
          twVoices.forEach((voice, i) => {
            const option = document.createElement('option');
            option.value = voice.name;
            option.textContent = formatVoiceName(voice);
            if (i === 0) option.selected = true;
            group.appendChild(option);
          });
          voiceSelect.appendChild(group);
        }
        
        // Á∞°È´î‰∏≠ÊñáÔºà‰∏≠ÂúãÔºâ
        if (cnVoices.length > 0) {
          const group = document.createElement('optgroup');
          group.label = 'üá®üá≥ Á∞°È´î‰∏≠ÊñáÔºà‰∏≠ÂúãÔºâ';
          cnVoices.forEach(voice => {
            const option = document.createElement('option');
            option.value = voice.name;
            option.textContent = formatVoiceName(voice);
            group.appendChild(option);
          });
          voiceSelect.appendChild(group);
        }
        
        // Á≤µË™ûÔºàÈ¶ôÊ∏ØÔºâ
        if (hkVoices.length > 0) {
          const group = document.createElement('optgroup');
          group.label = 'üá≠üá∞ Á≤µË™ûÔºàÈ¶ôÊ∏ØÔºâ';
          hkVoices.forEach(voice => {
            const option = document.createElement('option');
            option.value = voice.name;
            option.textContent = formatVoiceName(voice);
            group.appendChild(option);
          });
          voiceSelect.appendChild(group);
        }
        
        // ÂÖ∂‰ªñ‰∏≠Êñá
        if (otherZhVoices.length > 0) {
          const group = document.createElement('optgroup');
          group.label = 'üåè ÂÖ∂‰ªñ‰∏≠Êñá';
          otherZhVoices.forEach(voice => {
            const option = document.createElement('option');
            option.value = voice.name;
            option.textContent = formatVoiceName(voice);
            group.appendChild(option);
          });
          voiceSelect.appendChild(group);
        }
        
        // Â¶ÇÊûúÂÆåÂÖ®Ê≤íÊúâ‰∏≠ÊñáË™ûÈü≥ÔºåÈ°ØÁ§∫ÊâÄÊúâÂèØÁî®Ë™ûÈü≥
        if (zhVoices.length === 0 && otherVoices.length > 0) {
          const group = document.createElement('optgroup');
          group.label = 'üåê ÂÖ∂‰ªñË™ûÈü≥ÔºàÁÑ°‰∏≠ÊñáË™ûÈü≥ÂèØÁî®Ôºâ';
          otherVoices.slice(0, 20).forEach((voice, i) => { // ÊúÄÂ§öÈ°ØÁ§∫ 20 ÂÄã
            const option = document.createElement('option');
            option.value = voice.name;
            option.textContent = formatVoiceName(voice, true);
            if (i === 0) option.selected = true;
            group.appendChild(option);
          });
          voiceSelect.appendChild(group);
        }
        
        // Â¶ÇÊûúÂÆåÂÖ®Ê≤íÊúâË™ûÈü≥
        if (availableVoices.length === 0) {
          const option = document.createElement('option');
          option.textContent = '‚ö†Ô∏è Êú™ÊâæÂà∞‰ªª‰ΩïË™ûÈü≥';
          option.disabled = true;
          voiceSelect.appendChild(option);
          
          // È°ØÁ§∫ÊèêÁ§∫
          const hint = document.createElement('option');
          hint.textContent = 'Ë´ãÂú®Á≥ªÁµ±Ë®≠ÂÆö‰∏≠ÂÆâË£ù‰∏≠ÊñáË™ûÈü≥';
          hint.disabled = true;
          voiceSelect.appendChild(hint);
        }
      }

      // ÂàùÂßãÂåñË™ûÈü≥
      loadVoices();
      if (speechSynth.onvoiceschanged !== undefined) {
        speechSynth.onvoiceschanged = loadVoices;
      }

      // ÊÉÖÁ∑íÂàÜÊûêËàáÂèÉÊï∏Ë™øÊï¥
      function analyzeEmotion(text) {
        const mode = emotionMode.value;
        if (mode !== 'auto') {
          return getEmotionParams(mode);
        }
        
        // Ëá™ÂãïÂÅµÊ∏¨ÊÉÖÁ∑í
        const sadKeywords = ['ÊÇ≤ÂÇ∑', 'Âì≠Ê≥£', 'Ê∑öÊ∞¥', 'Ê≠ª‰∫°', 'Èõ¢Âà•', 'ÁóõËã¶', 'ÁµïÊúõ', 'ÂøÉÁ¢é', 'ÂìÄÂÇ∑', 'ÊÇºÂøµ', 'ÂòÜÊÅØ', 'ÊÜÇÊÑÅ'];
        const excitedKeywords = ['ÊøÄÂãï', 'ËààÂ•Æ', 'ÂãùÂà©', 'Ë°ùÂà∫', 'ÁàÜÁôº', 'ÁÜ±Ë°Ä', 'ÁáÉÁáí', 'Êà∞È¨•', 'Âê∂Âñä', 'Â•ÆËµ∑', 'ÊÄíÂêº', 'Á™ÅÁ†¥'];
        const mysteriousKeywords = ['Á•ûÁßò', 'Èô∞Ê£Æ', 'Ë©≠Áï∞', 'ÈªëÊöó', 'Êú™Áü•', 'ÁßòÂØÜ', 'Èö±Ëóè', 'ÊÅêÊÄñ', 'Êá∏Áñë', 'Ë¨éÂúò', 'ÂπΩÊöó', 'Ë©õÂíí'];
        const gentleKeywords = ['Ê∫´Êüî', 'ËºïËÅ≤', 'ÂæÆÁ¨ë', 'ÊÑõÊÉÖ', 'ÁîúËúú', 'ÊìÅÊä±', 'Ë¶™Âêª', 'Ê∫´Êöñ', 'Âë¢ÂñÉ', 'ÊüîÊÉÖ', 'Êµ™Êº´', 'ÂøÉÂãï'];
        const dramaticKeywords = ['ÈúáÈ©ö', 'Êè≠Èú≤', 'ËΩâÊäò', 'ÊÑèÂ§ñ', 'ÁúüÁõ∏', 'ËÉåÂèõ', 'Âæ©‰ªá', 'ÂëΩÈÅã', 'Â∞çÊ±∫', 'È´òÊΩÆ', 'Ê±∫Êà∞'];
        
        let sadScore = sadKeywords.filter(k => text.includes(k)).length;
        let excitedScore = excitedKeywords.filter(k => text.includes(k)).length;
        let mysteriousScore = mysteriousKeywords.filter(k => text.includes(k)).length;
        let gentleScore = gentleKeywords.filter(k => text.includes(k)).length;
        let dramaticScore = dramaticKeywords.filter(k => text.includes(k)).length;
        
        // Ê™¢Êü•Ê®ôÈªûÁ¨¶Ëôü
        if ((text.match(/ÔºÅ/g) || []).length > 2) excitedScore += 2;
        if ((text.match(/Ôºü/g) || []).length > 2) mysteriousScore += 1;
        if ((text.match(/‚ãØ|‚Ä¶/g) || []).length > 1) sadScore += 1;
        
        const maxScore = Math.max(sadScore, excitedScore, mysteriousScore, gentleScore, dramaticScore);
        
        if (maxScore === 0) return getEmotionParams('narration');
        if (sadScore === maxScore) return getEmotionParams('sad');
        if (excitedScore === maxScore) return getEmotionParams('excited');
        if (mysteriousScore === maxScore) return getEmotionParams('mysterious');
        if (gentleScore === maxScore) return getEmotionParams('gentle');
        if (dramaticScore === maxScore) return getEmotionParams('dramatic');
        
        return getEmotionParams('narration');
      }

      function getEmotionParams(emotion) {
        const baseRate = parseFloat(speechRate.value);
        const basePitch = parseFloat(speechPitch.value);
        
        switch (emotion) {
          case 'sad':
            return { rate: baseRate * 0.8, pitch: basePitch * 0.85, volume: 0.85, pause: 500 };
          case 'excited':
            return { rate: baseRate * 1.15, pitch: basePitch * 1.1, volume: 1.0, pause: 200 };
          case 'mysterious':
            return { rate: baseRate * 0.85, pitch: basePitch * 0.9, volume: 0.9, pause: 450 };
          case 'gentle':
            return { rate: baseRate * 0.9, pitch: basePitch * 1.05, volume: 0.85, pause: 350 };
          case 'dramatic':
            return { rate: baseRate * 1.0, pitch: basePitch * 1.0, volume: 1.0, pause: 400 };
          case 'narration':
          default:
            return { rate: baseRate, pitch: basePitch, volume: 0.95, pause: 300 };
        }
      }
      
      // ËôïÁêÜÊñáÂ≠ó‰ª•ÊîπÂñÑÊúóËÆÄÊïàÊûú
      function preprocessTextForSpeech(text) {
        if (!text || text.trim().length === 0) return '';
        
        let processed = text.trim();
        
        // ÁßªÈô§ Markdown Ê®ôË®ò
        processed = processed.replace(/^#+\s*/gm, '');
        processed = processed.replace(/\*+/g, '');
        
        // ÁßªÈô§ÊâÄÊúâ‰∏çÈúÄË¶ÅÂî∏ÁöÑÁ¨¶Ëôü
        processed = processed.replace(/[„Äå„Äç„Äé„Äè„Äê„Äë„Äà„Äâ„Ää„ÄãÔºàÔºâ()\[\]{}""'']/g, '');
        processed = processed.replace(/[Ôºö:Ôºõ;]/g, 'Ôºå'); // ÂÜíËôüÂàÜËôüËΩâÈÄóËôüÂÅúÈ†ì
        processed = processed.replace(/[‚ãØ‚Ä¶]+/g, 'Ôºå'); // ÁúÅÁï•ËôüËΩâÂÅúÈ†ì
        processed = processed.replace(/[‚Äî‚Äî‚Äì‚Äî‚àí]+/g, 'Ôºå'); // Á†¥ÊäòËôüËΩâÂÅúÈ†ì
        processed = processed.replace(/[ÔΩû~]+/g, ''); // ÁßªÈô§Ê≥¢Êµ™Ëôü
        processed = processed.replace(/[‚òÖ‚òÜ‚óè‚óã‚óÜ‚óá‚ñ†‚ñ°‚ñ≤‚ñ≥‚ñº‚ñΩ‚ÄªÔºä\*#ÔºÉ@Ôº†&ÔºÜ]/g, ''); // ÁßªÈô§ÁâπÊÆäÁ¨¶Ëôü
        processed = processed.replace(/[‚îÄ‚îÅ‚îÉ‚îÇ‚îÑ‚îÖ‚îÜ‚îá]+/g, ''); // ÁßªÈô§Á∑öÊ¢ùÁ¨¶Ëôü
        
        // Ê∏ÖÁêÜÂ§öÈ§òÁöÑÊ®ôÈªûÂíåÁ©∫Ê†º
        processed = processed.replace(/Ôºå+/g, 'Ôºå');
        processed = processed.replace(/„ÄÇ+/g, '„ÄÇ');
        processed = processed.replace(/\s+/g, ' ');
        processed = processed.trim();
        
        // Á¢∫‰øùÊñáÂ≠ó‰∏çÁÇ∫Á©∫
        if (!processed || processed.length === 0) {
          return '';
        }
        
        return processed;
      }

      // ÂàÜÂâ≤ÊñáÂ≠óÁÇ∫ÊÆµËêΩÔºà‰øùÊåÅÊÉÖÁ∑íÈÄ£Ë≤´ÔºâÔºåÂêåÊôÇË®òÈåÑ‰ΩçÁΩÆ
      function splitTextToSegments(text) {
        // ÊåâÊÆµËêΩÂíåÂè•ËôüÂàÜÂâ≤
        const paragraphs = text.split(/\n\n+/);
        const segments = [];
        segmentRanges = []; // ÈáçÁΩÆ‰ΩçÁΩÆË®òÈåÑ
        
        let currentPos = 0;
        
        paragraphs.forEach(para => {
          if (!para.trim()) {
            currentPos += para.length + 2; // +2 for \n\n
            return;
          }
          
          const paraStart = text.indexOf(para, currentPos);
          
          // ËºÉÈï∑ÊÆµËêΩÂÜçÁ¥∞ÂàÜ
          if (para.length > 200) {
            const sentences = para.split(/(?<=[„ÄÇÔºÅÔºü])/);
            let chunk = '';
            let chunkStart = paraStart;
            
            sentences.forEach(s => {
              if ((chunk + s).length > 150) {
                if (chunk) {
                  segments.push(chunk.trim());
                  segmentRanges.push({ start: chunkStart, end: chunkStart + chunk.length, text: chunk.trim() });
                }
                chunkStart = chunkStart + chunk.length;
                chunk = s;
              } else {
                chunk += s;
              }
            });
            if (chunk) {
              segments.push(chunk.trim());
              segmentRanges.push({ start: chunkStart, end: chunkStart + chunk.length, text: chunk.trim() });
            }
          } else {
            segments.push(para.trim());
            segmentRanges.push({ start: paraStart, end: paraStart + para.length, text: para.trim() });
          }
          
          currentPos = paraStart + para.length;
        });
        
        return segments.filter(s => s.length > 0);
      }

      // È´ò‰∫ÆÁõÆÂâçÊúóËÆÄÁöÑÊÆµËêΩ
      function highlightCurrentSegment(index) {
        // ÁßªÈô§ËàäÁöÑÈ´ò‰∫Æ
        clearHighlight();
        
        if (!highlightCheck || !highlightCheck.checked) return;
        if (index < 0 || index >= speechSegments.length) return;
        
        const segmentText = speechSegments[index];
        if (!segmentText) return;
        
        // Âú® resultDiv ‰∏≠ÊâæÂà∞Â∞çÊáâÁöÑÊñáÂ≠ó
        const fullText = latestStory || '';
        
        // ÊâæÂà∞ÈÄôÂÄãÊÆµËêΩÂú®ÂéüÊñá‰∏≠ÁöÑ‰ΩçÁΩÆ
        // Áî±ÊñºÊÆµËêΩÂèØËÉΩÈáçË§áÔºåÊàëÂÄëÈúÄË¶ÅËøΩËπ§Â∑≤Á∂ìËôïÁêÜÈÅéÁöÑ‰ΩçÁΩÆ
        let searchStart = 0;
        for (let i = 0; i < index; i++) {
          const prevSegment = speechSegments[i];
          const foundPos = fullText.indexOf(prevSegment, searchStart);
          if (foundPos !== -1) {
            searchStart = foundPos + prevSegment.length;
          }
        }
        
        const segmentStart = fullText.indexOf(segmentText, searchStart);
        if (segmentStart === -1) return;
        
        const beforeText = fullText.substring(0, segmentStart);
        const afterText = fullText.substring(segmentStart + segmentText.length);
        
        // ‰ΩøÁî® innerHTML ‰æÜÈ´ò‰∫ÆÔºàÈúÄË¶ÅËΩâÁæ© HTMLÔºâ
        const escapeHtml = (text) => {
          return text.replace(/&/g, '&amp;')
                     .replace(/</g, '&lt;')
                     .replace(/>/g, '&gt;')
                     .replace(/\n/g, '<br>');
        };
        
        resultDiv.innerHTML = escapeHtml(beforeText) + 
          '<span class="speaking-segment" id="currentSpeakingSegment">' + escapeHtml(segmentText) + '</span>' + 
          escapeHtml(afterText);
        
        // Ëá™ÂãïÊç≤ÂãïÂà∞È´ò‰∫ÆÁöÑÊÆµËêΩ
        if (autoScrollCheck && autoScrollCheck.checked) {
          // ‰ΩøÁî® setTimeout Á¢∫‰øù DOM Â∑≤Êõ¥Êñ∞
          setTimeout(() => {
            const highlightedEl = document.getElementById('currentSpeakingSegment');
            if (highlightedEl) {
              // Ë®àÁÆóÂÖÉÁ¥†‰ΩçÁΩÆ‰∏¶Êç≤Âãï
              const rect = highlightedEl.getBoundingClientRect();
              const viewportHeight = window.innerHeight;
              
              // Â¶ÇÊûúÂÖÉÁ¥†‰∏çÂú®ÂèØË¶ñÁØÑÂúçÂÖßÔºåÊâçÊç≤Âãï
              if (rect.top < 100 || rect.bottom > viewportHeight - 100) {
                highlightedEl.scrollIntoView({ 
                  behavior: 'smooth', 
                  block: 'center' 
                });
              }
            }
          }, 50);
        }
      }
      
      // Ê∏ÖÈô§È´ò‰∫Æ
      function clearHighlight() {
        const highlightedEl = document.getElementById('currentSpeakingSegment');
        if (highlightedEl || resultDiv.innerHTML.includes('speaking-segment')) {
          // ÊÅ¢Âæ©Á¥îÊñáÂ≠ó
          resultDiv.textContent = latestStory || '';
        }
      }
      
      // Êõ¥Êñ∞ÊÆµËêΩÊéßÂà∂ÊåâÈàïÁãÄÊÖã
      function updateNavButtons() {
        prevSegmentBtn.disabled = !isSpeaking || currentSegmentIndex <= 0;
        nextSegmentBtn.disabled = !isSpeaking || currentSegmentIndex >= speechSegments.length - 1;
        
        if (isSpeaking && speechSegments.length > 0) {
          currentSegmentDisplay.textContent = `${currentSegmentIndex + 1} / ${speechSegments.length}`;
        } else {
          currentSegmentDisplay.textContent = '- / -';
        }
      }

      // ÊúóËÆÄÂñÆ‰∏ÄÊÆµËêΩ
      function speakSegment(index) {
        if (index >= speechSegments.length) {
          // ÊúóËÆÄÂÆåÊàê
          stopSpeech();
          clearSpeechProgress();
          clearHighlight();
          speechProgressText.textContent = '‚úÖ ÊúóËÆÄÂÆåÊàê';
          return;
        }
        
        currentSegmentIndex = index;
        saveSpeechProgress(); // ÂÑ≤Â≠òÁï∂ÂâçÈÄ≤Â∫¶
        updateNavButtons();
        
        // È´ò‰∫ÆÁõÆÂâçÊÆµËêΩ
        highlightCurrentSegment(index);
        
        const text = speechSegments[index];
        const params = analyzeEmotion(text);
        
        // ÂâçËôïÁêÜÊñáÂ≠ó‰ª•ÊîπÂñÑÊúóËÆÄÊïàÊûú
        const processedText = preprocessTextForSpeech(text);
        
        // Â¶ÇÊûúËôïÁêÜÂæåÊñáÂ≠óÁÇ∫Á©∫ÔºåË∑≥Âà∞‰∏ã‰∏ÄÊÆµ
        if (!processedText || processedText.trim().length === 0) {
          if (isSpeaking && !isPaused) {
            speakSegment(index + 1);
          }
          return;
        }
        
        // Êõ¥Êñ∞ÈÄ≤Â∫¶
        const progress = ((index + 1) / speechSegments.length) * 100;
        speechProgressFill.style.width = progress + '%';
        speechProgressText.textContent = `Ê≠£Âú®ÊúóËÆÄ ${index + 1}/${speechSegments.length} ÊÆµ...`;
        currentSegmentDisplay.textContent = `${index + 1} / ${speechSegments.length}`;
        
        // ‰ΩøÁî®ÁÄèË¶ΩÂô®ÂÖßÂª∫Ë™ûÈü≥
        speakWithBrowser(processedText, params, index);
      }
      
      // ‰ΩøÁî®ÁÄèË¶ΩÂô®ÂÖßÂª∫Ë™ûÈü≥ÊúóËÆÄ
      // ËøΩËπ§ÊòØÂê¶Â∑≤Á∂ìÈ†êÁÜ±ÈÅéË™ûÈü≥ÂºïÊìé
      let speechEngineWarmedUp = false;
      let lastSpeechTime = 0;
      
      function speakWithBrowser(processedText, params, index) {
        // Ë®≠ÂÆöË™ûÈü≥
        const selectedVoice = availableVoices.find(v => v.name === voiceSelect.value);
        
        // üîß ‰øÆÂæ©È¶ñÂ≠óË¢´ÂêÉÊéâÁöÑÂ§öÈáçÁ≠ñÁï•
        // Á≠ñÁï•1: Âú®ÊñáÊú¨ÂâçÂä†ÂÖ•‰∏çÂèØË¶ãÁöÑÂâçÂ∞éÂ≠óÁ¨¶ÔºàÈõ∂ÂØ¨Á©∫Ê†º + ÈÄóËôüÔºâ
        // Á≠ñÁï•2: Á¢∫‰øùË™ûÈü≥ÂºïÊìéÂ∑≤È†êÁÜ±
        // Á≠ñÁï•3: Ê∑ªÂä†ÂæÆÂ∞èÂª∂ÈÅ≤ËÆìÂºïÊìéÊ∫ñÂÇôÂ•Ω
        
        const now = Date.now();
        const timeSinceLastSpeech = now - lastSpeechTime;
        
        // Â¶ÇÊûúË∑ùÈõ¢‰∏äÊ¨°ÊúóËÆÄË∂ÖÈÅé 3 ÁßíÔºåÈúÄË¶ÅÈáçÊñ∞È†êÁÜ±
        const needsWarmup = !speechEngineWarmedUp || timeSinceLastSpeech > 3000;
        
        // Âú®ÊñáÊú¨ÂâçÂä†ÂÖ•Á∑©Ë°ùÂ≠óÁ¨¶
        // ‰ΩøÁî®Á©∫Ê†º‰ΩúÁÇ∫Á∑©Ë°ùÔºå‰∏çÊúÉË¢´ÊúóËÆÄÂá∫ËÅ≤Èü≥‰ΩÜËÉΩ‰øùË≠∑È¶ñÂ≠ó
        // Â§öÂÄãÈõ∂ÂØ¨Á©∫Ê†º + ÊôÆÈÄöÁ©∫Ê†ºÁµÑÂêàÊïàÊûúÊúÄ‰Ω≥
        const bufferedText = '\u200B\u200B \u200B' + processedText;
        
        function createAndPlayUtterance(text, isMain = true) {
          const utterance = new SpeechSynthesisUtterance(text);
          if (selectedVoice) utterance.voice = selectedVoice;
          
          utterance.rate = params.rate;
          utterance.pitch = params.pitch;
          utterance.volume = isMain ? params.volume : 0.01;
          
          if (isMain) {
            utterance.onstart = () => {
              lastSpeechTime = Date.now();
              speechEngineWarmedUp = true;
            };
            
            utterance.onend = () => {
              lastSpeechTime = Date.now();
              // ÊÆµËêΩÈñìÂÅúÈ†ì
              setTimeout(() => {
                if (isSpeaking && !isPaused) {
                  speakSegment(index + 1);
                }
              }, params.pause);
            };
            
            utterance.onerror = (e) => {
              // ÂøΩÁï• interrupted ÈåØË™§Ôºà‰ΩøÁî®ËÄÖ‰∏ªÂãïÂÅúÊ≠¢Ôºâ
              if (e.error === 'interrupted' || e.error === 'canceled') {
                return;
              }
              console.warn('ÊúóËÆÄË≠¶ÂëäÔºö', e.error, 'ÊÆµËêΩÔºö', index);
              // ÂòóË©¶ÁπºÁ∫å‰∏ã‰∏ÄÊÆµ
              if (isSpeaking && !isPaused) {
                setTimeout(() => speakSegment(index + 1), 100);
              }
            };
            
            currentUtterance = utterance;
          }
          
          return utterance;
        }
        
        if (needsWarmup) {
          // È†êÁÜ±Á≠ñÁï•ÔºöÂÖàÊí≠Êîæ‰∏ÄÂÄãÈùúÈü≥ÁöÑÁü≠Âè•
          const warmupUtterance = new SpeechSynthesisUtterance('Ê∫ñÂÇô');
          if (selectedVoice) warmupUtterance.voice = selectedVoice;
          warmupUtterance.rate = 10; // ÊúÄÂø´ÈÄüÂ∫¶
          warmupUtterance.volume = 0; // ÂÆåÂÖ®ÈùúÈü≥
          
          warmupUtterance.onend = () => {
            speechEngineWarmedUp = true;
            // È†êÁÜ±ÂÆåÊàêÂæåÁü≠Êö´Âª∂ÈÅ≤ÂÜçÊí≠ÊîæÂØ¶ÈöõÂÖßÂÆπ
            setTimeout(() => {
              const mainUtterance = createAndPlayUtterance(bufferedText, true);
              speechSynth.speak(mainUtterance);
            }, 50);
          };
          
          warmupUtterance.onerror = () => {
            // È†êÁÜ±Â§±Êïó‰πüÁπºÁ∫åÊí≠Êîæ
            setTimeout(() => {
              const mainUtterance = createAndPlayUtterance(bufferedText, true);
              speechSynth.speak(mainUtterance);
            }, 50);
          };
          
          // ÈñãÂßãÈ†êÁÜ±
          speechSynth.speak(warmupUtterance);
        } else {
          // Â∑≤È†êÁÜ±ÔºåÁõ¥Êé•Êí≠ÊîæÔºà‰ªçÁÑ∂‰ΩøÁî®Á∑©Ë°ùÊñáÊú¨Ôºâ
          const mainUtterance = createAndPlayUtterance(bufferedText, true);
          speechSynth.speak(mainUtterance);
        }
      }
      

      // Êõ¥Êñ∞ÊÆµËêΩÁØÑÂúçËº∏ÂÖ•ÁöÑÊúÄÂ§ßÂÄº
      function updateSegmentInputs() {
        const text = resultDiv.textContent || latestStory || '';
        const segments = splitTextToSegments(text);
        const total = segments.length;
        
        const startInput = document.getElementById('startSegment');
        const endInput = document.getElementById('endSegment');
        const segmentInfo = document.getElementById('segmentInfo');
        
        startInput.max = total || 1;
        endInput.max = total || 1;
        endInput.value = total || 1;
        
        segmentInfo.textContent = `ÂÖ± ${total} ÊÆµ`;
        
        return segments;
      }

      // ÈñãÂßã/Êö´ÂÅúÊúóËÆÄ
      function toggleSpeech() {
        if (!latestStory) {
          showStatus('error', 'Ê≤íÊúâÂèØÊúóËÆÄÁöÑÂÖßÂÆπ');
          return;
        }
        
        if (isSpeaking && !isPaused) {
          // Êö´ÂÅú
          speechSynth.pause();
          isPaused = true;
          saveSpeechProgress(); // Êö´ÂÅúÊôÇÂÑ≤Â≠òÈÄ≤Â∫¶
          playPauseBtn.textContent = '‚ñ∂Ô∏è ÁπºÁ∫åÊúóËÆÄ';
          speechProgressText.textContent = '‚è∏Ô∏è Â∑≤Êö´ÂÅú';
        } else if (isPaused) {
          // ÁπºÁ∫å
          speechSynth.resume();
          isPaused = false;
          playPauseBtn.textContent = '‚è∏Ô∏è Êö´ÂÅú';
          speechProgressText.textContent = `Ê≠£Âú®ÊúóËÆÄ ${currentSegmentIndex + 1}/${speechSegments.length} ÊÆµ...`;
        } else {
          // ÈñãÂßãÊñ∞ÊúóËÆÄ
          const text = resultDiv.textContent || latestStory;
          const allSegments = splitTextToSegments(text);
          
          if (allSegments.length === 0) {
            showStatus('error', 'Ê≤íÊúâÂèØÊúóËÆÄÁöÑÂÖßÂÆπ');
            return;
          }
          
          // Áç≤ÂèñÊÆµËêΩÁØÑÂúç
          const startInput = document.getElementById('startSegment');
          const endInput = document.getElementById('endSegment');
          let startIdx = parseInt(startInput.value) - 1 || 0;
          let endIdx = parseInt(endInput.value) || allSegments.length;
          
          // È©óË≠âÁØÑÂúç
          startIdx = Math.max(0, Math.min(startIdx, allSegments.length - 1));
          endIdx = Math.max(startIdx + 1, Math.min(endIdx, allSegments.length));
          
          // Âè™ÈÅ∏ÂèñÊåáÂÆöÁØÑÂúçÁöÑÊÆµËêΩ
          speechSegments = allSegments.slice(startIdx, endIdx);
          
          if (speechSegments.length === 0) {
            showStatus('error', 'Ê≤íÊúâÂèØÊúóËÆÄÁöÑÂÖßÂÆπ');
            return;
          }
          
          // Ê™¢Êü•ÊòØÂê¶ÊúâÂÑ≤Â≠òÁöÑÈÄ≤Â∫¶ÔºàÂè™Âú®ÊúóËÆÄÂÖ®ÈÉ®ÊôÇÊ™¢Êü•Ôºâ
          const savedProgress = loadSpeechProgress();
          let startIndex = 0;
          
          const isReadingAll = startIdx === 0 && endIdx === allSegments.length;
          
          if (isReadingAll && savedProgress && savedProgress.segmentIndex > 0 && savedProgress.segmentIndex < speechSegments.length) {
            // Ë©¢ÂïèÊòØÂê¶Âæû‰∏äÊ¨°‰ΩçÁΩÆÁπºÁ∫å
            const resumeFromSaved = confirm(`ÁôºÁèæ‰∏äÊ¨°ÊúóËÆÄÈÄ≤Â∫¶ÔºàÁ¨¨ ${savedProgress.segmentIndex + 1}/${speechSegments.length} ÊÆµÔºâ\n\nÈªûÊìä„ÄåÁ¢∫ÂÆö„ÄçÂæû‰∏äÊ¨°‰ΩçÁΩÆÁπºÁ∫å\nÈªûÊìä„ÄåÂèñÊ∂à„ÄçÂæûÈ†≠ÈñãÂßã`);
            
            if (resumeFromSaved) {
              startIndex = savedProgress.segmentIndex;
              // ÊÅ¢Âæ©Ë®≠ÂÆö
              if (savedProgress.rate) speechRate.value = savedProgress.rate;
              if (savedProgress.pitch) speechPitch.value = savedProgress.pitch;
              if (savedProgress.emotion) emotionMode.value = savedProgress.emotion;
              rateValue.textContent = speechRate.value + 'x';
              pitchValue.textContent = speechPitch.value;
              // Ë™ûÈü≥ÈúÄË¶ÅÂú®Ë™ûÈü≥ÂàóË°®ËºâÂÖ•ÂæåË®≠ÂÆö
              setTimeout(() => {
                if (savedProgress.voice && availableVoices.find(v => v.name === savedProgress.voice)) {
                  voiceSelect.value = savedProgress.voice;
                }
              }, 100);
            } else {
              clearSpeechProgress();
            }
          }
          
          isSpeaking = true;
          isPaused = false;
          playPauseBtn.textContent = '‚è∏Ô∏è Êö´ÂÅú';
          startSpeechKeepAlive(); // ÂïüÂãï Chrome bug workaround
          
          // Áµ¶ÊúóËÆÄÊåâÈàïÊ∑ªÂä†Ë¶ñË¶∫ÊèêÁ§∫
          speakBtn.classList.add('active-task');
          
          // È°ØÁ§∫ÊúóËÆÄÁØÑÂúç
          if (!isReadingAll) {
            speechProgressText.textContent = `ÊúóËÆÄÁØÑÂúçÔºöÁ¨¨ ${startIdx + 1} - ${endIdx} ÊÆµ`;
          }
          
          speakSegment(startIndex);
        }
      }

      // ÂÅúÊ≠¢ÊúóËÆÄ
      function stopSpeech() {
        speechSynth.cancel();
        isSpeaking = false;
        isPaused = false;
        speechEngineWarmedUp = false; // ÈáçÁΩÆÈ†êÁÜ±ÁãÄÊÖã
        stopSpeechKeepAlive(); // ÂÅúÊ≠¢ Chrome bug workaround
        saveSpeechProgress(); // ÂÅúÊ≠¢ÊôÇ‰πüÂÑ≤Â≠òÈÄ≤Â∫¶
        
        // ÁßªÈô§ÊúóËÆÄÊåâÈàïË¶ñË¶∫ÊèêÁ§∫
        speakBtn.classList.remove('active-task');
        currentSegmentIndex = 0;
        playPauseBtn.textContent = '‚ñ∂Ô∏è ÈñãÂßãÊúóËÆÄ';
        speechProgressFill.style.width = '0%';
        speechProgressText.textContent = 'Ê∫ñÂÇôÂ∞±Á∑í';
        clearHighlight();
        updateNavButtons();
      }
      
      // ÈáçÁΩÆÊúóËÆÄÔºàÂæûÈ†≠ÈñãÂßãÔºâ
      function resetSpeech() {
        stopSpeech();
        clearSpeechProgress();
        currentSegmentIndex = 0;
        speechProgressText.textContent = 'Â∑≤ÈáçÁΩÆÔºåÊ∫ñÂÇôÂæûÈ†≠ÈñãÂßã';
        clearHighlight();
        updateNavButtons();
        
        // ÈáçÁΩÆÊÆµËêΩÁØÑÂúç
        const startInput = document.getElementById('startSegment');
        startInput.value = 1;
        updateSegmentInputs();
      }
      
      // Ë∑≥Âà∞‰∏ä‰∏ÄÊÆµ
      function prevSegment() {
        if (!isSpeaking || currentSegmentIndex <= 0) return;
        speechSynth.cancel();
        isPaused = false;
        speakSegment(currentSegmentIndex - 1);
      }
      
      // Ë∑≥Âà∞‰∏ã‰∏ÄÊÆµ
      function nextSegment() {
        if (!isSpeaking || currentSegmentIndex >= speechSegments.length - 1) return;
        speechSynth.cancel();
        isPaused = false;
        speakSegment(currentSegmentIndex + 1);
      }
      
      // Ë∑≥ËΩâÂà∞ÊåáÂÆöÊÆµËêΩÔºàÈÄèÈÅéÈÄ≤Â∫¶Ê¢ùÈªûÊìäÔºâ
      function jumpToSegment(segmentIndex) {
        if (!isSpeaking || segmentIndex < 0 || segmentIndex >= speechSegments.length) return;
        speechSynth.cancel();
        isPaused = false;
        speakSegment(segmentIndex);
      }

      // Ë§áË£ΩÂÖ®Êñá
      function copyAllText() {
        const text = resultDiv.textContent || latestStory || '';
        if (!text) {
          showStatus('error', 'Ê≤íÊúâÂèØË§áË£ΩÁöÑÂÖßÂÆπ');
          return;
        }
        
        navigator.clipboard.writeText(text).then(() => {
          showStatus('success', 'üìã Â∑≤Ë§áË£ΩÂÖ®ÊñáÔºÅÂèØË≤ºÂà∞ÂÖ∂‰ªñ App ÈÄ≤Ë°åÊúóËÆÄ');
        }).catch(err => {
          // ÂÇôÁî®ÊñπÊ°àÔºö‰ΩøÁî® textarea
          const textarea = document.createElement('textarea');
          textarea.value = text;
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.select();
          try {
            document.execCommand('copy');
            showStatus('success', 'üìã Â∑≤Ë§áË£ΩÂÖ®ÊñáÔºÅ');
          } catch (e) {
            showStatus('error', 'Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïÈÅ∏ÂèñË§áË£Ω');
          }
          document.body.removeChild(textarea);
        });
      }

      // ‰∫ã‰ª∂Á∂ÅÂÆö
      speakBtn.addEventListener('click', () => {
        speechModal.classList.add('open');
        
        // Êõ¥Êñ∞ÊÆµËêΩË≥áË®ä
        updateSegmentInputs();
        updateNavButtons();
        
        // Ê™¢Êü•ÊòØÂê¶ÊúâÂÑ≤Â≠òÁöÑÈÄ≤Â∫¶ÔºåÈ°ØÁ§∫ÊèêÁ§∫
        const savedProgress = loadSpeechProgress();
        if (savedProgress && savedProgress.segmentIndex > 0 && !isSpeaking) {
          speechProgressText.textContent = `üìç ‰∏äÊ¨°ÈÄ≤Â∫¶ÔºöÁ¨¨ ${savedProgress.segmentIndex + 1} ÊÆµ`;
        }
      });

      closeSpeechModal.addEventListener('click', () => {
        // ÈóúÈñâË¶ñÁ™ó‰ΩÜ‰∏çÂÅúÊ≠¢ÊúóËÆÄ
        speechModal.classList.remove('open');
        if (isSpeaking) {
          showStatus('info', 'üîä ÊúóËÆÄÁπºÁ∫å‰∏≠... ÈªûÊìäÊúóËÆÄÊåâÈàïÂèØËøîÂõûÊéßÂà∂Èù¢Êùø');
        }
      });

      // ÈªûÊìäËÉåÊôØÈóúÈñâÊ®°ÊÖãË¶ñÁ™ó
      speechModal.addEventListener('click', (e) => {
        if (e.target === speechModal) {
          // ÈóúÈñâË¶ñÁ™ó‰ΩÜ‰∏çÂÅúÊ≠¢ÊúóËÆÄ
          speechModal.classList.remove('open');
          if (isSpeaking) {
            showStatus('info', 'üîä ÊúóËÆÄÁπºÁ∫å‰∏≠... ÈªûÊìäÊúóËÆÄÊåâÈàïÂèØËøîÂõûÊéßÂà∂Èù¢Êùø');
          }
        }
      });

      playPauseBtn.addEventListener('click', toggleSpeech);
      stopSpeechBtn.addEventListener('click', stopSpeech);
      resetSpeechBtn.addEventListener('click', resetSpeech);
      
      // ‰∏ä‰∏ÄÊÆµ/‰∏ã‰∏ÄÊÆµÊåâÈàï
      prevSegmentBtn.addEventListener('click', prevSegment);
      nextSegmentBtn.addEventListener('click', nextSegment);
      
      // ÈÄ≤Â∫¶Ê¢ùÈªûÊìäË∑≥ËΩâ
      speechProgressBar.addEventListener('click', (e) => {
        if (!isSpeaking || speechSegments.length === 0) return;
        
        const rect = speechProgressBar.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const percentage = clickX / rect.width;
        const targetIndex = Math.floor(percentage * speechSegments.length);
        
        jumpToSegment(Math.max(0, Math.min(targetIndex, speechSegments.length - 1)));
      });
      
      // Ë™ûÈÄüÂæÆË™øÊåâÈàï
      document.querySelectorAll('.speed-btn[data-speed]').forEach(btn => {
        btn.addEventListener('click', () => {
          const delta = parseFloat(btn.dataset.speed);
          let newValue = parseFloat(speechRate.value) + delta;
          newValue = Math.max(0.25, Math.min(3, newValue));
          speechRate.value = newValue.toFixed(2);
          rateValue.textContent = newValue.toFixed(1) + 'x';
        });
      });
      
      // Èü≥Ë™øÂæÆË™øÊåâÈàï
      document.querySelectorAll('.speed-btn[data-pitch]').forEach(btn => {
        btn.addEventListener('click', () => {
          const delta = parseFloat(btn.dataset.pitch);
          let newValue = parseFloat(speechPitch.value) + delta;
          newValue = Math.max(0.5, Math.min(2, newValue));
          speechPitch.value = newValue.toFixed(2);
          pitchValue.textContent = newValue.toFixed(1);
        });
      });
      
      // Ë§áË£ΩÂÖ®ÊñáÊåâÈàï
      document.getElementById('copyAllBtn').addEventListener('click', copyAllText);
      
      // ÊúóËÆÄÂÖ®ÈÉ®ÊåâÈàï
      document.getElementById('readAllBtn').addEventListener('click', () => {
        const startInput = document.getElementById('startSegment');
        const endInput = document.getElementById('endSegment');
        startInput.value = 1;
        updateSegmentInputs();
      });
      
      // ÊÆµËêΩËº∏ÂÖ•È©óË≠â
      document.getElementById('startSegment').addEventListener('change', function() {
        const endInput = document.getElementById('endSegment');
        if (parseInt(this.value) > parseInt(endInput.value)) {
          endInput.value = this.value;
        }
        if (parseInt(this.value) < 1) this.value = 1;
      });
      
      document.getElementById('endSegment').addEventListener('change', function() {
        const startInput = document.getElementById('startSegment');
        if (parseInt(this.value) < parseInt(startInput.value)) {
          this.value = startInput.value;
        }
        if (parseInt(this.value) < 1) this.value = 1;
      });

      speechRate.addEventListener('input', () => {
        rateValue.textContent = parseFloat(speechRate.value).toFixed(1) + 'x';
      });

      speechPitch.addEventListener('input', () => {
        pitchValue.textContent = parseFloat(speechPitch.value).toFixed(1);
      });

      // È†ÅÈù¢Èõ¢ÈñãÊôÇÂÑ≤Â≠òÈÄ≤Â∫¶
      window.addEventListener('beforeunload', () => {
        if (isSpeaking || currentSegmentIndex > 0) {
          saveSpeechProgress();
        }
        speechSynth.cancel();
      });

      // È†ÅÈù¢ÂÆåÂÖ®ËºâÂÖ•ÂæåÔºåÁ¢∫‰øùÊåâÈàïÁãÄÊÖãÊ≠£Á¢∫
      window.addEventListener('load', () => {
        setTimeout(() => {
          // Â¶ÇÊûúÊúâÊïÖ‰∫ãÂÖßÂÆπÔºåÁ¢∫‰øùÊåâÈàïÂïüÁî®
          if (latestStory && latestStory.length > 0) {
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('continueBtn').disabled = false;
            document.getElementById('speakBtn').disabled = false;
            document.getElementById('generateImageBtn').disabled = false;
            updateWordCount(latestStory);
          }
        }, 500);
      });

      // ==================== Ë®≠ÂÆöÈù¢ÊùøÂäüËÉΩ ====================
      const settingsToggle = document.getElementById('settingsToggle');
      const settingsDropdown = document.getElementById('settingsDropdown');
      const settingsClose = document.getElementById('settingsClose');
      const lightThemeBtn = document.getElementById('lightThemeBtn');
      const darkThemeBtn = document.getElementById('darkThemeBtn');
      const fontSizeSlider = document.getElementById('fontSizeSlider');
      const fontSizeValue = document.getElementById('fontSizeValue');

      // Ë®≠ÂÆöÈù¢ÊùøÈñãÈóú
      settingsToggle.addEventListener('click', () => {
        settingsDropdown.classList.toggle('open');
      });

      settingsClose.addEventListener('click', () => {
        settingsDropdown.classList.remove('open');
      });

      // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâË®≠ÂÆöÈù¢Êùø
      document.addEventListener('click', (e) => {
        if (!settingsDropdown.contains(e.target) && !settingsToggle.contains(e.target)) {
          settingsDropdown.classList.remove('open');
        }
      });

      // ==================== ‰∏ªÈ°åÂàáÊèõÂäüËÉΩ ====================
      function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        
        if (theme === 'dark') {
          darkThemeBtn.classList.add('active');
          lightThemeBtn.classList.remove('active');
        } else {
          lightThemeBtn.classList.add('active');
          darkThemeBtn.classList.remove('active');
        }
      }

      // ËºâÂÖ•ÂÑ≤Â≠òÁöÑ‰∏ªÈ°å
      const savedTheme = localStorage.getItem('theme') || 'light';
      setTheme(savedTheme);

      lightThemeBtn.addEventListener('click', () => setTheme('light'));
      darkThemeBtn.addEventListener('click', () => setTheme('dark'));

      // ==================== Â≠óÈ´îÂ§ßÂ∞èË™øÊï¥ ====================
      function setFontSize(size) {
        document.getElementById('result').style.fontSize = size + 'px';
        document.getElementById('result').style.lineHeight = (size * 0.11 + 1.1).toFixed(2);
        fontSizeValue.textContent = size + 'px';
        localStorage.setItem('readingFontSize', size);
      }

      // ËºâÂÖ•ÂÑ≤Â≠òÁöÑÂ≠óÈ´îÂ§ßÂ∞è
      const savedFontSize = localStorage.getItem('readingFontSize') || 18;
      fontSizeSlider.value = savedFontSize;
      setFontSize(savedFontSize);

      fontSizeSlider.addEventListener('input', () => {
        setFontSize(fontSizeSlider.value);
      });

      // ==================== Â≠óÊï∏Áµ±Ë®àÂäüËÉΩ ====================
      function updateWordCount(text) {
        if (!text) {
          document.getElementById('wordCountDisplay').style.display = 'none';
          return;
        }
        
        // Ë®àÁÆó‰∏≠ÊñáÂ≠óÊï∏ÔºàÂåÖÊã¨Ê®ôÈªûÔºâ
        const chineseChars = text.replace(/[\s\n]/g, '').length;
        
        // Ë®àÁÆóÁ´†ÁØÄÊï∏
        const chapterMatches = text.match(/Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉ\d]+Á´†|Chapter\s*\d+/gi) || [];
        
        // Ë®àÁÆóÊÆµËêΩÊï∏
        const paragraphs = text.split(/\n\n+/).filter(p => p.trim().length > 0);
        
        document.getElementById('totalWordCount').textContent = chineseChars.toLocaleString();
        document.getElementById('totalChapterCount').textContent = chapterMatches.length;
        document.getElementById('totalParagraphCount').textContent = paragraphs.length;
        document.getElementById('wordCountDisplay').style.display = 'flex';
      }

      // ==================== Âø´ÈÄüÊ®°ÊùøÂäüËÉΩ ====================
      const templates = {
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ÁéÑÂπª‰ªô‰ø† ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        fantasy: {
          name: 'ÁéÑÂπª‰øÆ‰ªô',
          theme: 'ÁéÑÂπª‰øÆÁúü',
          setting: '‰πùÂ∑ûÂ§ßÈô∏ÔºåÈùàÊ∞£Âæ©ËòáÔºåÂÆóÈñÄÊûóÁ´ã',
          style: 'ÁÜ±Ë°Ä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'ÁéÑÂπªÂ§ßÈô∏',
          pacing: 'ÁàΩÊñáÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 20,
          length: 100000
        },
        cultivation: {
          name: 'ÂÇ≥Áµ±‰ªô‰ø†',
          theme: '‰ªô‰ø†‰øÆÈÅì',
          setting: 'ËíºÁ©π‰πã‰∏ãÔºåËê¨ÂäçÂÆó‰ΩçÊñºÈùíÈõ≤Â±±ËÑà',
          style: 'Á¥∞ËÜ©',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: '‰ªô‰ø†‰∏ñÁïå',
          pacing: 'ÊÖ¢ÁÜ±Èã™Èô≥',
          rating: 'ËºïÂ∫¶ÊõñÊòß',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Ë∂ÖËÑ´‰∏ñ‰øó',
          ending: 'ÊòáËèØÁµêÂ±Ä',
          chapters: 25,
          length: 120000
        },
        martial: {
          name: 'Ê≠¶‰ø†Ê±üÊπñ',
          theme: 'Ê≠¶‰ø†Ê±üÊπñ',
          setting: 'Ê±üÊπñÁ¥õÁà≠ÔºåÊ≠£ÈÇ™Â∞çÁ´ãÔºåÊÅ©ÊÄ®ÊÉÖ‰ªá',
          style: 'Ë±™ÈÇÅ',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü•',
          era: 'ÊòéÊ∏ÖÊôÇ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ËíºÊ∂ºÊÇ≤Â£Ø',
          ending: 'ÈÅ∫ÊÜæHE',
          chapters: 18,
          length: 90000
        },
        'xuanhuan-harem': {
          name: 'ÁéÑÂπªÂæåÂÆÆ',
          theme: 'ÁéÑÂπªÂæåÂÆÆ',
          setting: 'Â§©ÂÖÉÂ§ßÈô∏ÔºåÁæéÂ•≥Â¶ÇÈõ≤ÔºåÂº∑ËÄÖÁÇ∫Â∞ä',
          style: 'ËºïÈ¨Ü',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'ÁéÑÂπªÂ§ßÈô∏',
          pacing: 'ÁàΩÊñáÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁàΩÂø´Ëß£Â£ì',
          ending: 'ÂúìÊªøHE',
          chapters: 30,
          length: 150000
        },
        'system-novel': {
          name: 'Á≥ªÁµ±ÊµÅ',
          theme: 'Á≥ªÁµ±ÊµÅ',
          setting: 'Á∂ÅÂÆöÈÄÜÂ§©Á≥ªÁµ±ÔºåÈñãÂïüÈÄÜË•≤‰∫∫Áîü',
          style: 'ÁàΩÂø´',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'ÁàΩÊñáÁØÄÂ•è',
          rating: '15+',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁàΩÂø´Ëß£Â£ì',
          ending: 'HE',
          chapters: 20,
          length: 100000
        },
        reincarnation: {
          name: 'ÈáçÁîüÂæ©‰ªá',
          theme: 'ÈáçÁîüÂæ©‰ªá',
          setting: 'ÈáçÂõûÂçÅÂπ¥ÂâçÔºåÈÄô‰∏Ä‰∏ñ‰∏çÂÜç‰ªª‰∫∫ÂÆ∞Ââ≤',
          style: 'Á∑äÂºµ',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ë§áÈõúÁ≥æËëõ',
          ending: 'ÂèçÊÆ∫ÁµêÂ±Ä',
          chapters: 15,
          length: 75000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Ë®ÄÊÉÖÊµ™Êº´ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        romance: {
          name: 'Áèæ‰ª£Ë®ÄÊÉÖ',
          theme: 'Êµ™Êº´ÊÑõÊÉÖ',
          setting: 'ÁπÅËèØÈÉΩÂ∏ÇÔºåÂÖ©ÂÄãÈùàÈ≠ÇÁöÑÁõ∏ÈÅá',
          style: 'Ê∫´È¶®',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'ÊÖ¢ÁÜ±Èã™Èô≥',
          rating: 'Á¥îÊÑõÂêë',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'Êµ™Êº´ÁîúËúú',
          ending: 'ÈõôÂêëÂ•îËµ¥HE',
          chapters: 12,
          length: 60000
        },
        'ceo-romance': {
          name: 'Èú∏Á∏ΩËôêÊÑõ',
          theme: 'ÈÉΩÂ∏ÇÁ∏ΩË£Å',
          setting: 'È†ÇÁ¥öË±™ÈñÄÔºåÂÑÑËê¨Á∏ΩË£ÅÁöÑÁ¶ÅÂøåÊàÄÊÉÖ',
          style: 'ËôêÂøÉ',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Áèæ‰ª£',
          pacing: 'Ê≥¢Êµ™ÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ËôêÂøÉÁ≥æÁµê',
          ending: 'Ëã¶Áõ°Áîò‰æÜHE',
          chapters: 18,
          length: 90000
        },
        'campus-romance': {
          name: 'Ê†°ÂúíÁ¥îÊÑõ',
          theme: 'Ê†°ÂúíÊàÄÊÑõ',
          setting: 'ÈùíÊò•Ê†°ÂúíÔºåÊúÄÁæéÂ•ΩÁöÑÂπ¥ËèØÈÅáË¶ã‰Ω†',
          style: 'Ê∏ÖÊñ∞',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'ÊÖ¢ÁÜ±Èã™Èô≥',
          rating: 'Á¥îÊÑõÂêë',
          worldComplexity: 'Ê•µÁ∞°',
          emotionalTone: 'ÈùíÊò•Ê¥ªÂäõ',
          ending: 'HE',
          chapters: 10,
          length: 50000
        },
        'historical-romance': {
          name: 'Âè§‰ª£ÂÆÆÂª∑',
          theme: 'ÂÆÆÂª∑ÂæåÂÆÆ',
          setting: 'Ê∑±ÂÆÆ‰πã‰∏≠ÔºåÂêéÂ¶ÉÁà≠ÂØµÔºåÊ≠•Ê≠•ÁÇ∫Ááü',
          style: 'ËèØÈ∫ó',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ê∏ÖÊúù',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Ë§áÈõúÁ≥æËëõ',
          ending: 'ÈÅ∫ÊÜæHE',
          chapters: 25,
          length: 120000
        },
        'transmig-romance': {
          name: 'Á©øÊõ∏Â•≥‰∏ª',
          theme: 'Á©øÊõ∏ÈÄÜË•≤',
          setting: 'Á©øÈÄ≤ËôêÊñáÔºåÊîπÂØ´ÁÇÆÁÅ∞ÂëΩÈÅã',
          style: 'ËºïÈ¨Ü',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ËºïÂ∫¶ÊõñÊòß',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ê≠°Ê®ÇËºïÈ¨Ü',
          ending: 'HE',
          chapters: 15,
          length: 75000
        },
        'rebirth-romance': {
          name: 'ÈáçÁîüÂæ©Áîú',
          theme: 'ÈáçÁîüÊàÄÊÑõ',
          setting: 'ÈáçÁîüÂõûÂà∞ÈÅáË¶ã‰ªñ‰πãÂâçÔºåÈÄôÊ¨°‰∏çÂÜçÈåØÈÅé',
          style: 'ÁîúËúú',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Á¥îÊÑõÂêë',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'Êµ™Êº´ÁîúËúú',
          ending: 'ÂúìÊªøHE',
          chapters: 12,
          length: 60000
        },
        'contract-marriage': {
          name: 'Â•ëÁ¥ÑÂ©öÂßª',
          theme: 'Â•ëÁ¥ÑÂ©öÂßª',
          setting: '‰∏ÄÁ¥ôÂêàÁ¥ÑÔºåÂÖ©È°ÜÂøÉÈÄêÊº∏Èù†Ëøë',
          style: 'ËºïÈ¨Ü',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Áèæ‰ª£',
          pacing: 'ÊÖ¢ÁÜ±Èã™Èô≥',
          rating: 'ËºïÂ∫¶ÊõñÊòß',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'Êµ™Êº´ÁîúËúú',
          ending: 'ÈõôÂêëÂ•îËµ¥HE',
          chapters: 14,
          length: 70000
        },
        'enemies-lovers': {
          name: 'Ê≠°ÂñúÂÜ§ÂÆ∂',
          theme: 'Ê≠°ÂñúÂÜ§ÂÆ∂',
          setting: 'ÂÜ§ÂÆ∂Ë∑ØÁ™ÑÔºåÈ¨•Âò¥Êó•Â∏∏ÔºåÊÑõ‰∏ä‰∫ÜÊÄéÈ∫ºËæ¶',
          style: 'ÊêûÁ¨ë',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Áèæ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Á¥îÊÑõÂêë',
          worldComplexity: 'Ê•µÁ∞°',
          emotionalTone: 'Ê≠°Ê®ÇËºïÈ¨Ü',
          ending: 'HE',
          chapters: 10,
          length: 50000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Êá∏ÁñëÈ©öÊÇö ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        mystery: {
          name: 'Êá∏ÁñëÊé®ÁêÜ',
          theme: 'Êá∏ÁñëÊé®ÁêÜ',
          setting: 'Ëø∑ÈúßÈáçÈáçÔºåÁúüÁõ∏Âè™Êúâ‰∏ÄÂÄã',
          style: 'Á∑äÂºµ',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: '15+',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Êá∏ÁñëÁ∑äÂºµ',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 12,
          length: 60000
        },
        detective: {
          name: 'ÂÅµÊé¢Á†¥Ê°à',
          theme: 'ÂÅµÊé¢Êé®ÁêÜ',
          setting: 'ÂêçÂÅµÊé¢ÁôªÂ†¥ÔºåÊØèÂÄãÁ¥∞ÁØÄÈÉΩÊòØÁ∑öÁ¥¢',
          style: 'Á¥∞ËÜ©',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: '15+',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Êá∏ÁñëÁ∑äÂºµ',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 10,
          length: 50000
        },
        thriller: {
          name: 'È©öÊÇöÊÅêÊÄñ',
          theme: 'ÊÅêÊÄñÈ©öÊÇö',
          setting: 'ÈªëÊöóËßíËêΩÔºåÊÅêÊáºÂ¶ÇÂΩ±Èö®ÂΩ¢',
          style: 'Èô∞Ê£Æ',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'È©öÊÇöÁØÄÂ•è',
          rating: 'È©öÊÇöÂêë',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'Ë©≠Áï∞È©öÊÇö',
          ending: 'OE',
          chapters: 10,
          length: 45000
        },
        psychological: {
          name: 'ÂøÉÁêÜÈ©öÊÇö',
          theme: 'ÂøÉÁêÜÊá∏Áñë',
          setting: '‰∫∫ÂøÉÊúÄÊ∑±ËôïÔºåËóèËëóÊúÄÂèØÊÄïÁöÑÁßòÂØÜ',
          style: 'Â£ìÊäë',
          narrative: '‰∏çÂèØÈù†ÊïòËø∞ËÄÖ',
          era: 'Áèæ‰ª£',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Á•ûÁßòË©≠Ë≠é',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 12,
          length: 55000
        },
        crime: {
          name: 'ÁäØÁΩ™Êá∏Áñë',
          theme: 'ÁäØÁΩ™Êá∏Áñë',
          setting: 'ÁΩ™ÊÉ°‰πãÂüéÔºåËøΩËπ§ÁçµÁâ©ÁöÑÈÅäÊà≤ÈñãÂßã',
          style: 'ÈªëÊöó',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Áèæ‰ª£',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÅ∞Ëâ≤Âú∞Â∏∂',
          ending: 'ÂèçÊ¥æÂãùÂà©',
          chapters: 15,
          length: 70000
        },
        'supernatural-mystery': {
          name: 'ÈùàÁï∞Êá∏Áñë',
          theme: 'ÈùàÁï∞Êá∏Áñë',
          setting: 'Èô∞ÈôΩÂÖ©ÁïåÔºåÈ¨ºÂΩ±ÈáçÈáçÔºåÁúüÂÅáÈõ£Ëæ®',
          style: 'Ë©≠Áï∞',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: 'È©öÊÇöÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ë©≠Áï∞È©öÊÇö',
          ending: 'OE',
          chapters: 12,
          length: 55000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ÁßëÂπªÊú™‰æÜ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        scifi: {
          name: 'Â§™Á©∫Ê≠åÂäá',
          theme: 'ÊòüÈöõÂÜíÈö™',
          setting: 'ÈäÄÊ≤≥Á≥ªÈÇäÁ∑£Ôºå‰∫∫È°ûÊÆñÊ∞ëÂú∞ÁöÑÂÜíÈö™',
          style: 'Âè≤Ë©©',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'ÈÅ†Êú™‰æÜ',
          pacing: 'Âè≤Ë©©ÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Âè≤Ë©©Á¥ö',
          emotionalTone: 'Âè≤Ë©©Â£ØÈóò',
          ending: 'OE',
          chapters: 20,
          length: 100000
        },
        cyberpunk: {
          name: 'Ë≥ΩÂçöÈæêÂÖã',
          theme: 'Ë≥ΩÂçöÈæêÂÖã',
          setting: 'ÈúìËôπÂ§úÈõ®ÔºåÈ´òÁßëÊäÄ‰ΩéÁîüÊ¥ªÁöÑÊöóÈªëÈÉΩÂ∏Ç',
          style: 'ÈªëÊöó',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Ë≥ΩÂçöÈæêÂÖã',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÅ∞Ëâ≤Âú∞Â∏∂',
          ending: 'OE',
          chapters: 15,
          length: 70000
        },
        apocalypse: {
          name: 'Êú´Êó•Âª¢Âúü',
          theme: 'Êú´Êó•ÁîüÂ≠ò',
          setting: 'Ê†∏Êà∞‰πãÂæåÔºå‰∫∫È°ûÂú®Âª¢Â¢ü‰∏≠ÊéôÊâéÊ±ÇÂ≠ò',
          style: 'Ê≤âÈáç',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Êú´Êó•Âæå',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁµïÊúõÁ™íÊÅØ',
          ending: 'ÈÅ∫ÊÜæHE',
          chapters: 18,
          length: 85000
        },
        'ai-story': {
          name: '‰∫∫Â∑•Êô∫ËÉΩ',
          theme: 'AIË¶∫ÈÜí',
          setting: 'Áï∂AIÁî¢ÁîüËá™ÊàëÊÑèË≠òÔºå‰∫∫È°û‰ΩïÂéª‰ΩïÂæû',
          style: 'Âì≤ÊÄù',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'ËøëÊú™‰æÜ',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Âì≤ÁêÜÊ∑±Ê≤â',
          ending: 'OE',
          chapters: 15,
          length: 75000
        },
        'virtual-reality': {
          name: 'ËôõÊì¨ÁèæÂØ¶',
          theme: 'ËôõÊì¨ÈÅäÊà≤',
          setting: 'ÂÖ®ÊÅØÁ∂≤ÈÅäÔºåÁèæÂØ¶ËàáËôõÊì¨ÁöÑÈÇäÁïåÊ®°Á≥ä',
          style: 'Âà∫ÊøÄ',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'ËøëÊú™‰æÜ',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'È©öÈö™Âà∫ÊøÄ',
          ending: 'HE',
          chapters: 20,
          length: 90000
        },
        'time-travel': {
          name: 'ÊôÇÈñìÊóÖË°å',
          theme: 'ÊôÇÈñìÁ©øË∂ä',
          setting: 'Á©øÊ¢≠ÊôÇÁ©∫ÔºåÊØèÂÄãÈÅ∏ÊìáÈÉΩÊîπËÆäÊ≠∑Âè≤',
          style: 'ÁáíËÖ¶',
          narrative: 'Á¢éÁâáÂºè',
          era: 'ÊôÇÈñìÁ©øË∂ä',
          pacing: 'Á¢éÁâáÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Á•ûÁßòË©≠Ë≠é',
          ending: 'Ëº™Ëø¥ÁµêÂ±Ä',
          chapters: 15,
          length: 70000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Ë•øÊñπÂ•áÂπª ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'western-fantasy': {
          name: 'ÂäçËàáÈ≠îÊ≥ï',
          theme: 'Ë•øÊñπÂ•áÂπª',
          setting: 'ËâæÁàæÁ∂≠‰∫ûÂ§ßÈô∏ÔºåÂãáËÄÖÁöÑÂÜíÈö™ÂïüÁ®ã',
          style: 'ÂÜíÈö™',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ë•øÊñπ‰∏≠‰∏ñÁ¥Ä',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 20,
          length: 100000
        },
        'dark-fantasy': {
          name: 'ÈªëÊöóÂ•áÂπª',
          theme: 'ÈªëÊöóÂ•áÂπª',
          setting: 'ÊÆòÈÖ∑‰∏ñÁïåÔºåÊ≤íÊúâÁµïÂ∞çÁöÑÂñÑËàáÊÉ°',
          style: 'ÈªëÊöó',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Ë•øÊñπ‰∏≠‰∏ñÁ¥Ä',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÅ∞Ëâ≤Âú∞Â∏∂',
          ending: 'BE',
          chapters: 18,
          length: 90000
        },
        'dragon-knight': {
          name: 'ÈæçÈ®éÂ£´',
          theme: 'ÈæçÈ®éÂ£´',
          setting: 'ËàáÈæçÁ∑†ÁµêÂ•ëÁ¥ÑÔºåÁø±ÁøîÂ§©Èöõ',
          style: 'Âè≤Ë©©',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ë•øÊñπ‰∏≠‰∏ñÁ¥Ä',
          pacing: 'Âè≤Ë©©ÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Âè≤Ë©©Â£ØÈóò',
          ending: 'HE',
          chapters: 22,
          length: 110000
        },
        'magic-academy': {
          name: 'È≠îÊ≥ïÂ≠∏Èô¢',
          theme: 'È≠îÊ≥ïÂ≠∏Èô¢',
          setting: 'Á•ûÁßòÁöÑÈ≠îÊ≥ïÂ≠∏Èô¢ÔºåÂ§©ÊâçÂ∞ëÂπ¥ÁöÑÊàêÈï∑',
          style: 'ËºïÈ¨Ü',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ë•øÂπªÂ§ßÈô∏',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'ËºïÂ∫¶ÊõñÊòß',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÈùíÊò•Ê¥ªÂäõ',
          ending: 'HE',
          chapters: 18,
          length: 85000
        },
        vampire: {
          name: 'Âê∏Ë°ÄÈ¨º',
          theme: 'Âê∏Ë°ÄÈ¨ºÂÇ≥Ë™™',
          setting: 'ÈªëÂ§úÊòØ‰ªñÂÄëÁöÑÂúãÂ∫¶ÔºåÊ∞∏ÁîüÁöÑË©õÂíí',
          style: 'Âì•Áâπ',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Á∂≠Â§öÂà©‰∫ûÊôÇ‰ª£',
          pacing: 'ÊÖ¢ÁÜ±Èã™Èô≥',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÈªëÊöóÊ≤âÈáç',
          ending: 'OE',
          chapters: 15,
          length: 70000
        },
        werewolf: {
          name: 'Áãº‰∫∫ÂÇ≥Ë™™',
          theme: 'Áãº‰∫∫ÊïÖ‰∫ã',
          setting: 'ÊªøÊúà‰πãÂ§úÔºåÈáéÊÄßÁöÑÂëºÂñöÁÑ°Ê≥ïÊäóÊãí',
          style: 'ÈáéÊÄß',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'È©öÈö™Âà∫ÊøÄ',
          ending: 'HE',
          chapters: 14,
          length: 65000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ÈÅäÊà≤Á´∂ÊäÄ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'game-world': {
          name: 'ÈÅäÊà≤‰∏ñÁïå',
          theme: 'Á©øË∂äÈÅäÊà≤',
          setting: 'Á©øË∂äÂà∞ÈÅäÊà≤‰∏ñÁïåÔºåÁî®Áé©ÂÆ∂ÊÄùÁ∂≠Ê±ÇÁîü',
          style: 'ËºïÈ¨Ü',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: '15+',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Ê≠°Ê®ÇËºïÈ¨Ü',
          ending: 'HE',
          chapters: 20,
          length: 95000
        },
        esports: {
          name: 'ÈõªÁ´∂ÁÜ±Ë°Ä',
          theme: 'ÈõªÁ´∂Á´∂ÊäÄ',
          setting: 'ËÅ∑Ê•≠ÈõªÁ´∂ÔºåÂäçÊåá‰∏ñÁïåÂÜ†Ëªç',
          style: 'ÁÜ±Ë°Ä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'ÁÜ±Ë°ÄÁØÄÂ•è',
          rating: 'ËºïÂ∫¶ÊõñÊòß',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 18,
          length: 85000
        },
        'infinite-flow': {
          name: 'ÁÑ°ÈôêÊµÅ',
          theme: 'ÁÑ°ÈôêÊµÅ',
          setting: '‰∏ÄÂÄãÂèà‰∏ÄÂÄãÂâØÊú¨ÔºåÁîüÂ≠òÊâçÊòØÂîØ‰∏ÄÁõÆÊ®ô',
          style: 'Á∑äÂºµ',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Â§öÂÖÉÂÆáÂÆô',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Âè≤Ë©©Á¥ö',
          emotionalTone: 'È©öÈö™Âà∫ÊøÄ',
          ending: 'OE',
          chapters: 25,
          length: 120000
        },
        'death-game': {
          name: 'Ê≠ª‰∫°ÈÅäÊà≤',
          theme: 'Ê≠ª‰∫°ÈÅäÊà≤',
          setting: 'ÈÅäÊà≤ÈñãÂßãÔºåÂ§±ÊïóËÄÖÂ∞á‰ªòÂá∫ÁîüÂëΩ',
          style: 'ÊÆòÈÖ∑',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Áèæ‰ª£',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Â£ìËø´Á™íÊÅØ',
          ending: 'BE',
          chapters: 15,
          length: 70000
        },
        'card-master': {
          name: 'Âç°ÁâåÂ§ßÂ∏´',
          theme: 'Âç°ÁâåÂ∞çÊ±∫',
          setting: 'Âç°ÁâåÂç≥ÊòØÂäõÈáèÔºåÊ±∫È¨•ÂêßÔºÅ',
          style: 'ÁÜ±Ë°Ä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'ÁÜ±Ë°ÄÁØÄÂ•è',
          rating: 'ÂÖ®Âπ¥ÈΩ°',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 18,
          length: 85000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Ê≠∑Âè≤ÂÇ≥Â•á ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        historical: {
          name: 'Êû∂Á©∫Ê≠∑Âè≤',
          theme: 'Ê¨äË¨ÄÁà≠Èú∏',
          setting: '‰∫Ç‰∏ñ‰πã‰∏≠ÔºåË™∞‰∏ªÊ≤âÊµÆ',
          style: 'ÂéöÈáç',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü•',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Âè≤Ë©©ÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: 'Âè≤Ë©©Á¥ö',
          emotionalTone: 'Âè≤Ë©©Â£ØÈóò',
          ending: 'OE',
          chapters: 30,
          length: 150000
        },
        'three-kingdoms': {
          name: '‰∏âÂúãÈ¢®Èõ≤',
          theme: '‰∏âÂúãÊºîÁæ©',
          setting: 'Êù±Êº¢Êú´Âπ¥ÔºåÁæ§ÈõÑ‰∏¶Ëµ∑ÔºåÈÄêÈπø‰∏≠Âéü',
          style: 'Âè≤Ë©©',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü•',
          era: '‰∏âÂúã',
          pacing: 'Âè≤Ë©©ÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: 'Âè≤Ë©©Á¥ö',
          emotionalTone: 'Âè≤Ë©©Â£ØÈóò',
          ending: 'ËíºÊ∂ºÊÇ≤Â£Ø',
          chapters: 35,
          length: 180000
        },
        'tang-dynasty': {
          name: 'Â§ßÂîêÁõõ‰∏ñ',
          theme: 'Â§ßÂîêÈ¢®ËèØ',
          setting: 'ÁõõÂîêÈï∑ÂÆâÔºåËê¨Âúã‰æÜÊúùÁöÑÁπÅËèØÁõõ‰∏ñ',
          style: 'ËèØÈ∫ó',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'ÈöãÂîêÊôÇ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Âæ©Âè§Êá∑Ëàä',
          ending: 'HE',
          chapters: 22,
          length: 110000
        },
        'ming-dynasty': {
          name: 'ÊòéÊúùÈå¶Ë°£',
          theme: 'ÊòéÊúùÈ¢®Èõ≤',
          setting: 'Èå¶Ë°£Ë°õ„ÄÅÊù±Âª†„ÄÅÊúùÂ†ÇÈ¢®Èõ≤',
          style: 'Á∑äÂºµ',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'ÊòéÊúù',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÁÅ∞Ëâ≤Âú∞Â∏∂',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 20,
          length: 100000
        },
        'warring-states': {
          name: 'Êà∞ÂúãÁ≠ñÂ£´',
          theme: 'Êà∞ÂúãÁ∏±Ê©´',
          setting: '‰∏ÉÂúãÁà≠ÈõÑÔºåÁ∏±Ê©´Êç≠ÈóîÔºåÊô∫Ë¨ÄÂ§©‰∏ã',
          style: 'Êô∫Ë¨Ä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÂÖ®Áü•',
          era: 'ÂÖàÁß¶ÊôÇ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'Âè≤Ë©©Â£ØÈóò',
          ending: 'OE',
          chapters: 25,
          length: 120000
        },
        'republic-era': {
          name: 'Ê∞ëÂúãÈ¢®Èõ≤',
          theme: 'Ê∞ëÂúãÂÇ≥Â•á',
          setting: '‰∏äÊµ∑ÁÅòÔºå‰∫Ç‰∏ñÊµÆÊ≤âÔºåÂÖíÂ•≥ÊÉÖÈï∑',
          style: 'Êá∑Ëàä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ê∞ëÂúãÊôÇ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Âæ©Âè§Êá∑Ëàä',
          ending: 'ÈÅ∫ÊÜæHE',
          chapters: 18,
          length: 90000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ÁâπÊÆäÈ°åÊùê ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'slice-of-life': {
          name: 'Êó•Â∏∏Ê≤ªÁôí',
          theme: 'Êó•Â∏∏Ê≤ªÁôí',
          setting: 'Âπ≥Âá°ÁîüÊ¥ª‰∏≠ÁöÑÂ∞èÁ¢∫Âπ∏',
          style: 'Ê∫´È¶®',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Áèæ‰ª£',
          pacing: 'Êó•Â∏∏ÁØÄÂ•è',
          rating: 'Ê≤ªÁôíÂêë',
          worldComplexity: 'Ê•µÁ∞°',
          emotionalTone: 'ÊÖ¢ÁîüÊ¥ª',
          ending: 'HE',
          chapters: 10,
          length: 45000
        },
        farming: {
          name: 'Á®ÆÁî∞Á∂ìÁáü',
          theme: 'Á®ÆÁî∞ÁîüÊ¥ª',
          setting: 'ÈÅ†Èõ¢Â°µÂõÇÔºåÊâìÈÄ†Â±¨ÊñºËá™Â∑±ÁöÑÁî∞Âúí',
          style: 'ÊÇ†Èñí',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Êó•Â∏∏ÁØÄÂ•è',
          rating: 'Ê≤ªÁôíÂêë',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'ÊÖ¢ÁîüÊ¥ª',
          ending: 'HE',
          chapters: 15,
          length: 70000
        },
        cooking: {
          name: 'ÁæéÈ£üÊ±üÊπñ',
          theme: 'ÁæéÈ£üÂÇ≥Â•á',
          setting: '‰ª•ÂªöËóùÁÇ∫ÂäçÔºåÂæÅÊúçÂ§©‰∏ãÂë≥Ëïæ',
          style: 'ËºïÈ¨Ü',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Ê≤ªÁôíÂêë',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'Ê≠°Ê®ÇËºïÈ¨Ü',
          ending: 'HE',
          chapters: 15,
          length: 70000
        },
        showbiz: {
          name: 'Â®õÊ®ÇÂúà',
          theme: 'Â®õÊ®ÇÂúà',
          setting: 'ÊòüÂÖâÁíÄÁí®ËÉåÂæåÁöÑÊòéÁà≠ÊöóÈ¨•',
          style: 'ËèØÈ∫ó',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ë§áÈõúÁ≥æËëõ',
          ending: 'HE',
          chapters: 18,
          length: 85000
        },
        sports: {
          name: 'ÁÜ±Ë°ÄÈÅãÂãï',
          theme: 'È´îËÇ≤Á´∂ÊäÄ',
          setting: 'Ê±óÊ∞¥ËàáÊ∑öÊ∞¥ÔºåËøΩÈÄêÂÜ†ËªçÁöÑÂ§¢',
          style: 'ÁÜ±Ë°Ä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'ÁÜ±Ë°ÄÁØÄÂ•è',
          rating: 'ÂÖ®Âπ¥ÈΩ°',
          worldComplexity: 'Á∞°ÂñÆ',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 18,
          length: 80000
        },
        military: {
          name: 'ËªçÊóÖÊ¶ÆÂÖâ',
          theme: 'Ëªç‰∫ãÈ°åÊùê',
          setting: 'ÈêµË°ÄËªçÈ≠ÇÔºå‰øùÂÆ∂Ë°õÂúã',
          style: 'Á°¨Ê¥æ',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁÜ±Ë°ÄÁáÉÂêë',
          ending: 'HE',
          chapters: 20,
          length: 95000
        },
        medical: {
          name: 'ÈÜ´ÁôÇÊá∏Â£∫',
          theme: 'ÈÜ´ÁôÇÈ°åÊùê',
          setting: 'ÁôΩË°£Â§©‰ΩøÔºåÁîüÊ≠ª‰πãÈñìÁöÑÊäâÊìá',
          style: 'Â∞àÊ•≠',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ê∫´È¶®Ê≤ªÁôí',
          ending: 'HE',
          chapters: 18,
          length: 85000
        },
        legal: {
          name: 'Ê≥ïÂæãÊ≠£Áæ©',
          theme: 'Ê≥ïÂæãÈ°åÊùê',
          setting: 'Ê≥ïÂ∫≠‰πã‰∏äÔºåÊ≠£Áæ©ÁµÇÂ∞áÂà∞‰æÜ',
          style: 'Á∑äÊπä',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Áèæ‰ª£',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: 'Ê≠£ÂäáÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Êá∏ÁñëÁ∑äÂºµ',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 15,
          length: 70000
        },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ÂèçÊ¥æË¶ñËßí ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'villain-mc': {
          name: 'ÂèçÊ¥æ‰∏ªËßí',
          theme: 'ÂèçÊ¥æË¶ñËßí',
          setting: 'Ë™∞Ë™™ÂèçÊ¥æ‰∏çËÉΩË¥èÔºüÈÄôÊ¨°ÊàëË¶ÅÊîπÂØ´ÁµêÂ±Ä',
          style: 'ÈªëÊöó',
          narrative: 'Á¨¨‰∏Ä‰∫∫Á®±',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Âø´ÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ÁÅ∞Ëâ≤Âú∞Â∏∂',
          ending: 'ÂèçÊ¥æÂãùÂà©',
          chapters: 18,
          length: 85000
        },
        'demon-lord': {
          name: 'È≠îÁéãÂ¥õËµ∑',
          theme: 'È≠îÁéãÊïÖ‰∫ã',
          setting: 'ÊàëÊòØÈ≠îÁéãÔºåÁµ±Âæ°ÈªëÊöóÔºåÊØÄÊªÖÂÖâÊòé',
          style: 'Èú∏Ê∞£',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Ë•øÂπªÂ§ßÈô∏',
          pacing: 'ÁàΩÊñáÁØÄÂ•è',
          rating: 'ÊöóÈªëÂêë',
          worldComplexity: 'Ë§áÈõú',
          emotionalTone: 'ÈªëÊöóÊ≤âÈáç',
          ending: 'OE',
          chapters: 22,
          length: 110000
        },
        'villain-redemption': {
          name: 'ÂèçÊ¥æÊïëË¥ñ',
          theme: 'ÂèçÊ¥æÊ¥óÁôΩ',
          setting: 'ÊõæÁ∂ìÁöÑÊÉ°‰∫∫ÔºåËÉΩÂê¶Áç≤ÂæóÊïëË¥ñ',
          style: 'Á≥æÁµê',
          narrative: 'Á¨¨‰∏â‰∫∫Á®±ÈôêÁü•',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Ê®ôÊ∫ñÁØÄÂ•è',
          rating: '‰∏≠Â∫¶ÊÉÖÊÑü',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'Ë§áÈõúÁ≥æËëõ',
          ending: 'ÈÅ∫ÊÜæHE',
          chapters: 16,
          length: 75000
        },
        misunderstood: {
          name: 'Ë¢´Ë™§Ëß£ÁöÑÊÉ°‰∫∫',
          theme: 'ÁúüÁõ∏ÂèçËΩâ',
          setting: 'ÊâÄÊúâ‰∫∫ÈÉΩË™çÁÇ∫‰ªñÊòØÊÉ°‰∫∫ÔºåÁõ¥Âà∞ÁúüÁõ∏Êè≠Êõâ',
          style: 'ËôêÂøÉ',
          narrative: 'Â§öË¶ñËßíÂàáÊèõ',
          era: 'Êû∂Á©∫Ê≠∑Âè≤',
          pacing: 'Êá∏ÁñëÁØÄÂ•è',
          rating: 'ËôêÂøÉÂêë',
          worldComplexity: '‰∏≠Á≠â',
          emotionalTone: 'ËôêÂøÉÁ≥æÁµê',
          ending: 'ÈÄÜËΩâÁµêÂ±Ä',
          chapters: 15,
          length: 70000
        }
      };

      // Ê®°ÊùøÈÅ∏ÊìáÂô®‰∫ã‰ª∂
      const quickTemplateSelect = document.getElementById('quickTemplateSelect');
      const applyTemplateBtn = document.getElementById('applyTemplateBtn');

      applyTemplateBtn.addEventListener('click', () => {
        const templateName = quickTemplateSelect.value;
        if (!templateName) {
          showStatus('warning', 'Ë´ãÂÖàÈÅ∏Êìá‰∏ÄÂÄãÊ®°Êùø');
          setTimeout(hideStatus, 2000);
          return;
        }

        const template = templates[templateName];
        if (!template) return;

        // Â•óÁî®Ê®°ÊùøË®≠ÂÆö
        themeSelect.value = template.theme;
        settingSelect.value = template.setting;
        styleSelect.value = template.style;
        narrativeSelect.value = template.narrative;
        eraSelect.value = template.era;
        pacingSelect.value = template.pacing;
        ratingSelect.value = template.rating;
        worldComplexitySelect.value = template.worldComplexity;
        emotionalToneSelect.value = template.emotionalTone;
        endingSelect.value = template.ending;
        chaptersInput.value = template.chapters;
        lengthInput.value = template.length;

        // Èö®Ê©üÁîüÊàê‰∫∫Áâ©
        randomizeAllCharacters();
        
        // ÂÑ≤Â≠òË®≠ÂÆö
        saveSettingsToLocal();
        
        // ÈóúÈñâË®≠ÂÆöÈù¢Êùø
        settingsDropdown.classList.remove('open');
        
        // ÈáçÁΩÆÈÅ∏ÊìáÂô®
        quickTemplateSelect.value = '';
        
        showStatus('success', `Â∑≤Â•óÁî®„Äå${template.name}„ÄçÊ®°ÊùøÔºÅ`);
        setTimeout(hideStatus, 2000);
      });

      // ÈõôÊìäÂø´ÈÄüÂ•óÁî®
      quickTemplateSelect.addEventListener('dblclick', () => {
        if (quickTemplateSelect.value) {
          applyTemplateBtn.click();
        }
      });

      // ==================== ÈçµÁõ§Âø´Êç∑Èçµ ====================
      document.addEventListener('keydown', (e) => {
        // Ctrl + G: ÈñãÂßãÁîüÊàê
        if (e.ctrlKey && e.key.toLowerCase() === 'g') {
          e.preventDefault();
          if (!generateBtn.disabled && isOnline) {
            generateBtn.click();
          }
        }
        
        // Ctrl + R: Èö®Ê©üÂ°´ÂÖÖÔºàÈÅøÂÖçËàáÁÄèË¶ΩÂô®Âà∑Êñ∞Ë°ùÁ™ÅÔºåÊîπÁî® ShiftÔºâ
        if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'r') {
          e.preventDefault();
          randomBtn.click();
        }
        
        // Ctrl + S: ÂÑ≤Â≠òÊõ∏Á±§
        if (e.ctrlKey && e.key.toLowerCase() === 's') {
          e.preventDefault();
          if (latestStory) {
            addBookmarkBtn.click();
          }
        }
        
        // Ctrl + D: ÂàáÊèõÊ∑±Ëâ≤Ê®°Âºè
        if (e.ctrlKey && e.key.toLowerCase() === 'd') {
          e.preventDefault();
          const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
          setTheme(currentTheme === 'light' ? 'dark' : 'light');
        }
      });

      // ==================== ÁîüÊàêÈÄ≤Â∫¶ËøΩËπ§ ====================
      let generationStartTime = null;
      let lastProgressUpdate = null;

      function showGenerationProgress() {
        document.getElementById('generationProgress').classList.add('show');
        generationStartTime = Date.now();
        lastProgressUpdate = Date.now();
      }

      function hideGenerationProgress() {
        document.getElementById('generationProgress').classList.remove('show');
        generationStartTime = null;
      }

      function updateGenerationProgress(currentChapter, totalChapters, currentWords) {
        const progressPercent = Math.round((currentChapter / totalChapters) * 100);
        document.getElementById('progressChapter').textContent = `Ê≠£Âú®ÁîüÊàêÁ¨¨ ${currentChapter}/${totalChapters} Á´†`;
        document.getElementById('progressPercent').textContent = `${progressPercent}%`;
        document.getElementById('progressBarFill').style.width = `${progressPercent}%`;
        document.getElementById('progressWords').textContent = `Â∑≤ÁîüÊàê ${currentWords.toLocaleString()} Â≠ó`;
        
        // È†ê‰º∞Ââ©È§òÊôÇÈñì
        if (generationStartTime && currentChapter > 0) {
          const elapsed = Date.now() - generationStartTime;
          const avgTimePerChapter = elapsed / currentChapter;
          const remainingChapters = totalChapters - currentChapter;
          const remainingMs = avgTimePerChapter * remainingChapters;
          
          const remainingMins = Math.floor(remainingMs / 60000);
          const remainingSecs = Math.floor((remainingMs % 60000) / 1000);
          document.getElementById('progressTime').textContent = 
            `È†ê‰º∞Ââ©È§ò ${remainingMins}:${remainingSecs.toString().padStart(2, '0')}`;
        }
      }

      // ==================== Á≥ªÁµ±ÂÅèÂ•ΩÊ∑±Ëâ≤Ê®°ÂºèÊ™¢Ê∏¨ ====================
      if (window.matchMedia && !localStorage.getItem('theme')) {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          setTheme('dark');
        }
      }

      // Áõ£ËÅΩÁ≥ªÁµ±‰∏ªÈ°åËÆäÂåñ
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
          setTheme(e.matches ? 'dark' : 'light');
        }
      });

      // ==================== ÊïÖ‰∫ãÂ§ßÁ∂±È†êË¶ΩÂäüËÉΩ ====================
      const outlineBtn = document.getElementById('outlineBtn');
      const outlineModal = document.getElementById('outlineModal');
      const closeOutlineModal = document.getElementById('closeOutlineModal');
      const generateOutlineBtn = document.getElementById('generateOutlineBtn');
      const generateFromOutlineBtn = document.getElementById('generateFromOutlineBtn');
      const regenerateOutlineBtn = document.getElementById('regenerateOutlineBtn');
      const outlineLoading = document.getElementById('outlineLoading');
      const outlineContent = document.getElementById('outlineContent');
      
      let currentOutline = null;

      // ÊâìÈñãÂ§ßÁ∂±Ê®°ÊÖãË¶ñÁ™ó
      outlineBtn.addEventListener('click', () => {
        outlineModal.classList.add('open');
        // ÈáçÁΩÆÁãÄÊÖã
        if (!currentOutline) {
          generateOutlineBtn.style.display = 'flex';
          generateFromOutlineBtn.style.display = 'none';
          regenerateOutlineBtn.style.display = 'none';
          outlineContent.style.display = 'none';
        }
      });

      closeOutlineModal.addEventListener('click', () => {
        outlineModal.classList.remove('open');
      });

      outlineModal.addEventListener('click', (e) => {
        if (e.target === outlineModal) {
          outlineModal.classList.remove('open');
        }
      });

      // ÁîüÊàêÂ§ßÁ∂±
      generateOutlineBtn.addEventListener('click', generateOutline);
      regenerateOutlineBtn.addEventListener('click', generateOutline);

      async function generateOutline() {
        const apiKey = apiKeyInput.value.trim();
        const model = modelSelect.value;
        
        if (!apiKey) {
          showStatus('error', 'Ë´ãÂÖàË®≠ÂÆö API ÈáëÈë∞');
          return;
        }

        // Êî∂ÈõÜË®≠ÂÆö
        const theme = themeSelect.value.trim();
        const setting = settingSelect.value.trim();
        const style = styleSelect.value.trim();
        const chapters = chaptersInput.value.trim() || '10';
        const narrative = narrativeSelect.value.trim();
        const era = eraSelect.value.trim();
        const pacing = pacingSelect.value.trim();
        const emotionalTone = emotionalToneSelect.value.trim();
        const ending = endingSelect.value.trim();
        
        // Êî∂ÈõÜ‰∫∫Áâ©
        const characterRows = Array.from(charactersContainer.querySelectorAll('.character-row'));
        let charactersInfo = '';
        characterRows.forEach((row, idx) => {
          const name = row.querySelector('.char-name').value.trim();
          const personality = row.querySelector('.char-personality').value.trim();
          const goal = row.querySelector('.char-goal').value.trim();
          if (name) {
            charactersInfo += `‚Ä¢ ${name}`;
            if (personality) charactersInfo += `Ôºà${personality}Ôºâ`;
            if (goal) charactersInfo += `Ôºö${goal}`;
            charactersInfo += '\n';
          }
        });

        // Êî∂ÈõÜÁâπÊÆäÂÖÉÁ¥†
        const selectedElements = [];
        specialElementsContainer.querySelectorAll('.special-element-item.selected').forEach(item => {
          selectedElements.push(item.querySelector('.element-label').textContent);
        });

        // ÊßãÂª∫Â§ßÁ∂±ÁîüÊàê prompt
        let prompt = `Ë´ãÁÇ∫‰ª•‰∏ãË®≠ÂÆöÁîüÊàê‰∏ÄÂÄãË©≥Á¥∞ÁöÑÊïÖ‰∫ãÂ§ßÁ∂±Ôºö

„ÄêÊïÖ‰∫ãË®≠ÂÆö„Äë
${theme ? `‰∏ªÈ°åÔºö${theme}` : ''}
${setting ? `ËÉåÊôØÔºö${setting}` : ''}
${era ? `ÊôÇ‰ª£Ôºö${era}` : ''}
${style ? `È¢®Ê†ºÔºö${style}` : ''}
${pacing ? `ÁØÄÂ•èÔºö${pacing}` : ''}
${emotionalTone ? `Âü∫Ë™øÔºö${emotionalTone}` : ''}
${ending ? `ÁµêÂ±ÄÂÇæÂêëÔºö${ending}` : ''}
Á´†ÁØÄÊï∏Ôºö${chapters} Á´†
${charactersInfo ? `\n„Äê‰∏ªË¶Å‰∫∫Áâ©„Äë\n${charactersInfo}` : ''}
${selectedElements.length > 0 ? `\n„ÄêÁâπÊÆäÂÖÉÁ¥†„Äë\n${selectedElements.join('„ÄÅ')}` : ''}

Ë´ãÁîüÊàêÊïÖ‰∫ãÂ§ßÁ∂±ÔºåÊ†ºÂºèÂ¶Ç‰∏ãÔºö

„ÄêÊïÖ‰∫ãÊ¶ÇËø∞„Äë
Ôºà2-3Âè•Ë©±ÊèèËø∞Êï¥È´îÊïÖ‰∫ãÊñπÂêëÔºâ

„ÄêÂêÑÁ´†ÁØÄÂ§ßÁ∂±„Äë
Á¨¨1Á´†ÔºöÊ®ôÈ°å
Á∞°Ëø∞Ôºà50-80Â≠óÔºåÊèèËø∞Êú¨Á´†‰∏ªË¶ÅÂÖßÂÆπ„ÄÅË°ùÁ™ÅÂíåÁôºÂ±ïÔºâ

Á¨¨2Á´†ÔºöÊ®ôÈ°å
Á∞°Ëø∞

...‰ª•Ê≠§È°ûÊé®ÔºåÁõ¥Âà∞Á¨¨${chapters}Á´†

„ÄêÊ†∏ÂøÉË°ùÁ™Å„Äë
ÊèèËø∞ÊïÖ‰∫ãÁöÑÊ†∏ÂøÉÁüõÁõæÂíåÂºµÂäõ

„ÄêËßíËâ≤ÂºßÁ∑ö„Äë
Á∞°Ëø∞‰∏ªË¶ÅËßíËâ≤ÁöÑÊàêÈï∑ËÆäÂåñ

Ë´ã‰ΩøÁî®ÁπÅÈ´î‰∏≠ÊñáÔºåÁ¢∫‰øùÂ§ßÁ∂±ÊúâÂê∏ÂºïÂäõ‰∏îÈÇèËºØÈÄ£Ë≤´„ÄÇ`;

        // È°ØÁ§∫ËºâÂÖ•ÁãÄÊÖã
        outlineLoading.style.display = 'flex';
        outlineContent.style.display = 'none';
        generateOutlineBtn.style.display = 'none';
        generateFromOutlineBtn.style.display = 'none';
        regenerateOutlineBtn.style.display = 'none';

        try {
          const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(model)}:generateContent`;
          const response = await fetch(endpoint, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'x-goog-api-key': apiKey,
            },
            body: JSON.stringify({
              contents: [{ parts: [{ text: prompt }] }],
            }),
          });
          
          const data = await response.json();
          
          if (data.error) {
            throw new Error(data.error.message);
          }
          
          if (data.candidates && data.candidates.length > 0) {
            const parts = data.candidates[0].content.parts || [];
            currentOutline = parts.map(p => p.text || '').join('').trim();
            
            // Ê†ºÂºèÂåñÈ°ØÁ§∫Â§ßÁ∂±
            displayOutline(currentOutline);
            
            outlineLoading.style.display = 'none';
            outlineContent.style.display = 'block';
            generateFromOutlineBtn.style.display = 'flex';
            regenerateOutlineBtn.style.display = 'flex';
          } else {
            throw new Error('Ê≤íÊúâÁç≤ÂæóÂÖßÂÆπ');
          }
        } catch (err) {
          outlineLoading.style.display = 'none';
          generateOutlineBtn.style.display = 'flex';
          showStatus('error', 'Â§ßÁ∂±ÁîüÊàêÂ§±ÊïóÔºö' + err.message);
        }
      }

      // Ê†ºÂºèÂåñÈ°ØÁ§∫Â§ßÁ∂±
      function displayOutline(outline) {
        // Ëß£ÊûêÂ§ßÁ∂±‰∏¶ÁæéÂåñÈ°ØÁ§∫
        let html = '';
        
        // ÂàÜÊÆµËôïÁêÜ
        const sections = outline.split(/„Äê(.+?)„Äë/g).filter(s => s.trim());
        
        for (let i = 0; i < sections.length; i += 2) {
          const title = sections[i];
          const content = sections[i + 1] || '';
          
          if (title === 'ÊïÖ‰∫ãÊ¶ÇËø∞' || title === 'Ê†∏ÂøÉË°ùÁ™Å' || title === 'ËßíËâ≤ÂºßÁ∑ö') {
            html += `<div style="margin-bottom: 16px;">
              <h4 style="color: var(--accent); margin-bottom: 8px;">üìå ${title}</h4>
              <p style="color: var(--text); line-height: 1.6;">${content.trim().replace(/\n/g, '<br>')}</p>
            </div>`;
          } else if (title === 'ÂêÑÁ´†ÁØÄÂ§ßÁ∂±') {
            html += `<div style="margin-bottom: 16px;">
              <h4 style="color: var(--accent); margin-bottom: 12px;">üìñ ${title}</h4>`;
            
            // Ëß£ÊûêÂêÑÁ´†ÁØÄ
            const chapters = content.split(/Á¨¨(\d+)Á´†[Ôºö:]?\s*/).filter(s => s.trim());
            for (let j = 0; j < chapters.length; j += 2) {
              const chapterNum = chapters[j];
              const chapterContent = chapters[j + 1] || '';
              
              if (chapterNum && chapterContent) {
                const lines = chapterContent.trim().split('\n');
                const chapterTitle = lines[0] || '';
                const chapterSummary = lines.slice(1).join(' ').trim();
                
                html += `<div class="outline-chapter">
                  <div class="outline-chapter-title">Á¨¨ ${chapterNum} Á´†Ôºö${chapterTitle}</div>
                  <div class="outline-chapter-summary">${chapterSummary}</div>
                </div>`;
              }
            }
            html += `</div>`;
          }
        }
        
        // Â¶ÇÊûúËß£ÊûêÂ§±ÊïóÔºåÁõ¥Êé•È°ØÁ§∫ÂéüÊñá
        if (!html) {
          html = `<div style="white-space: pre-wrap; line-height: 1.8;">${outline}</div>`;
        }
        
        outlineContent.innerHTML = html;
      }

      // Âü∫ÊñºÂ§ßÁ∂±ÁîüÊàêÂ∞èË™™
      generateFromOutlineBtn.addEventListener('click', async () => {
        if (!currentOutline) {
          showStatus('error', 'Ë´ãÂÖàÁîüÊàêÂ§ßÁ∂±');
          return;
        }
        
        // ÈóúÈñâÊ®°ÊÖãË¶ñÁ™ó
        outlineModal.classList.remove('open');
        
        // Â∞áÂ§ßÁ∂±Ê∑ªÂä†Âà∞Ë£úÂÖÖË™™Êòé‰∏≠
        const existingNotes = notesInput.value.trim();
        const outlineNote = `„ÄêÂ∑≤ÁîüÊàêÁöÑÊïÖ‰∫ãÂ§ßÁ∂±ÔºåË´ãÂö¥Ê†ºÊåâÁÖßÊ≠§Â§ßÁ∂±Â±ïÈñãÊïÖ‰∫ã„Äë\n${currentOutline}`;
        
        if (existingNotes) {
          notesInput.value = existingNotes + '\n\n' + outlineNote;
        } else {
          notesInput.value = outlineNote;
        }
        
        // Ëß∏ÁôºÁîüÊàê
        showStatus('success', 'Â§ßÁ∂±Â∑≤Âä†ÂÖ•Ë£úÂÖÖË™™ÊòéÔºåÊ≠£Âú®ÈñãÂßãÁîüÊàê...');
        setTimeout(() => {
          generateBtn.click();
        }, 500);
      });

      // ==================== Ëá™Âãï‰øùÂ≠òÊåáÁ§∫Âô® ====================
      const autoSaveIndicator = document.getElementById('autoSaveIndicator');
      let autoSaveTimeout = null;

      function showAutoSaveIndicator() {
        autoSaveIndicator.classList.add('show');
        
        if (autoSaveTimeout) {
          clearTimeout(autoSaveTimeout);
        }
        
        autoSaveTimeout = setTimeout(() => {
          autoSaveIndicator.classList.remove('show');
        }, 2000);
      }

      // Áõ£ËÅΩË®≠ÂÆöËÆäÊõ¥‰æÜÈ°ØÁ§∫Ëá™Âãï‰øùÂ≠òÊåáÁ§∫Âô®
      const originalSaveSettings = saveSettingsToLocal;
      saveSettingsToLocal = function() {
        originalSaveSettings();
        showAutoSaveIndicator();
      };

      // ==================== ÁîüÊàêÊ≠∑Âè≤ÂäüËÉΩ ====================
      const historyToggle = document.getElementById('historyToggle');
      const historyPanel = document.getElementById('historyPanel');
      const historyClose = document.getElementById('historyClose');
      const historyList = document.getElementById('historyList');
      const historyBadge = document.getElementById('historyBadge');

      // Âæû localStorage ËºâÂÖ•Ê≠∑Âè≤
      let generationHistory = JSON.parse(localStorage.getItem('novelGenerationHistory') || '[]');

      function updateHistoryBadge() {
        if (generationHistory.length > 0) {
          historyBadge.textContent = generationHistory.length;
          historyBadge.style.display = 'inline-flex';
        } else {
          historyBadge.style.display = 'none';
        }
      }

      function renderHistoryList() {
        if (generationHistory.length === 0) {
          historyList.innerHTML = `
            <div class="history-empty">
              <div class="history-empty-icon">üì≠</div>
              <p>Â∞öÁÑ°ÁîüÊàêË®òÈåÑ</p>
              <p style="font-size: 0.85rem;">ÁîüÊàêÊïÖ‰∫ãÂæåÊúÉËá™Âãï‰øùÂ≠òÂà∞ÈÄôË£°</p>
            </div>
          `;
          return;
        }

        historyList.innerHTML = generationHistory.map((item, index) => `
          <div class="history-item" data-index="${index}">
            <div class="history-item-title">
              üìñ ${item.theme || 'Êú™ÂëΩÂêçÊïÖ‰∫ã'}
            </div>
            <div class="history-item-meta">
              <span>üìÖ ${new Date(item.timestamp).toLocaleDateString('zh-TW')}</span>
              <span>üìù ${item.wordCount || 0} Â≠ó</span>
              <span>üìë ${item.chapters || '?'} Á´†</span>
            </div>
            <div class="history-item-preview">${item.preview || 'ÁÑ°È†êË¶Ω'}</div>
          </div>
        `).join('');

        // Ê∑ªÂä†ÈªûÊìä‰∫ã‰ª∂
        historyList.querySelectorAll('.history-item').forEach(item => {
          item.addEventListener('click', () => {
            const index = parseInt(item.dataset.index);
            loadFromHistory(index);
          });
        });
      }

      function saveToHistory(theme, content, settings = {}) {
        const wordCount = content.replace(/[\s\n#*_\-]/g, '').length;
        const chapterMatches = content.match(/###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá]/g);
        const chapters = chapterMatches ? chapterMatches.length : 1;
        
        // ÂèñÂâç100Â≠ó‰ΩúÁÇ∫È†êË¶Ω
        const cleanContent = content.replace(/###?\s*Á¨¨[‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅÁôæÂçÉËê¨Èõ∂Â£πË≤≥ÂèÉËÇÜ‰ºçÈô∏ÊüíÊçåÁéñÊãæ‰Ω∞‰ªü\d]+[Á´†ÁØÄÂõûÂç∑ÈÉ®ÈõÜÁØá][Ôºö:].*/g, '').trim();
        const preview = cleanContent.substring(0, 100).replace(/\n/g, ' ') + '...';

        const historyItem = {
          timestamp: Date.now(),
          theme: theme || settings.theme || 'Êú™ÂëΩÂêçÊïÖ‰∫ã',
          content: content,
          wordCount: wordCount,
          chapters: chapters,
          preview: preview,
          settings: settings
        };

        // Âè™‰øùÁïôÊúÄËøë 20 Ê¢ùË®òÈåÑ
        generationHistory.unshift(historyItem);
        if (generationHistory.length > 20) {
          generationHistory = generationHistory.slice(0, 20);
        }

        localStorage.setItem('novelGenerationHistory', JSON.stringify(generationHistory));
        updateHistoryBadge();
        renderHistoryList();
      }

      function loadFromHistory(index) {
        const item = generationHistory[index];
        if (!item) return;

        // ÊÅ¢Âæ©ÂÖßÂÆπ
        latestStory = item.content;
        resultDiv.innerHTML = formatResult(item.content);
        resultDiv.style.display = 'block';
        continueBtn.disabled = false;
        updateWordCount();

        // ÊÅ¢Âæ©Ë®≠ÂÆö
        if (item.settings) {
          if (item.settings.theme) themeSelect.value = item.settings.theme;
          if (item.settings.setting) settingSelect.value = item.settings.setting;
          if (item.settings.style) styleSelect.value = item.settings.style;
        }

        // ÈóúÈñâÈù¢Êùø
        historyPanel.classList.remove('open');
        
        showStatus('success', `Â∑≤ËºâÂÖ•„Äå${item.theme}„Äç`);
        setTimeout(hideStatus, 2000);
      }

      // Ê≠∑Âè≤Èù¢ÊùøÈñãÈóú
      historyToggle.addEventListener('click', () => {
        historyPanel.classList.toggle('open');
      });

      historyClose.addEventListener('click', () => {
        historyPanel.classList.remove('open');
      });

      // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâ
      document.addEventListener('click', (e) => {
        if (historyPanel.classList.contains('open') && 
            !historyPanel.contains(e.target) && 
            !historyToggle.contains(e.target)) {
          historyPanel.classList.remove('open');
        }
      });

      // ÂàùÂßãÂåñÊ≠∑Âè≤ÂàóË°®
      updateHistoryBadge();
      renderHistoryList();

      // ==================== È¶ñÊ¨°‰ΩøÁî®ÂºïÂ∞é ====================
      const onboardingOverlay = document.getElementById('onboardingOverlay');
      const onboardingSkip = document.getElementById('onboardingSkip');
      const onboardingStart = document.getElementById('onboardingStart');

      // Ê™¢Êü•ÊòØÂê¶È¶ñÊ¨°‰ΩøÁî®
      if (!localStorage.getItem('novelWorkshopOnboarded')) {
        setTimeout(() => {
          onboardingOverlay.classList.add('show');
        }, 1000);
      }

      onboardingSkip.addEventListener('click', () => {
        onboardingOverlay.classList.remove('show');
        localStorage.setItem('novelWorkshopOnboarded', 'true');
      });

      onboardingStart.addEventListener('click', () => {
        onboardingOverlay.classList.remove('show');
        localStorage.setItem('novelWorkshopOnboarded', 'true');
        
        // ÂºïÂ∞éÁî®Êà∂Âà∞ API Ë®≠ÂÆö
        if (!apiKeyInput.value) {
          apiPanel.classList.add('open');
          apiKeyInput.focus();
        }
      });

      // ==================== Ëº∏ÂÖ•È©óË≠âÂ¢ûÂº∑ ====================
      function validateInputs() {
        let isValid = true;
        const requiredFields = [
          { element: themeSelect, name: '‰∏ªÈ°å' },
          { element: settingSelect, name: 'ËÉåÊôØË®≠ÂÆö' }
        ];

        requiredFields.forEach(field => {
          if (!field.element.value.trim()) {
            field.element.classList.add('input-error');
            setTimeout(() => field.element.classList.remove('input-error'), 1000);
            isValid = false;
          }
        });

        return isValid;
      }

      // Âú®ÁîüÊàêÊåâÈàïÊ∑ªÂä†È©óË≠â
      const originalGenerateClick = generateBtn.onclick;
      generateBtn.addEventListener('click', (e) => {
        if (!validateInputs()) {
          e.stopPropagation();
          showStatus('warning', 'Ë´ãÂ°´ÂØ´ÂøÖË¶ÅÊ¨Ñ‰ΩçÔºà‰∏ªÈ°åÂíåËÉåÊôØË®≠ÂÆöÔºâ');
          setTimeout(hideStatus, 3000);
        }
      }, true);

      // ==================== ÁîüÊàêÂÆåÊàêÂæå‰øùÂ≠òÂà∞Ê≠∑Âè≤ ====================
      // Êì¥Â±ïÂéüÊúâÁöÑÁîüÊàêÂÆåÊàêËôïÁêÜ
      const originalUpdateWordCount = updateWordCount;
      let lastSavedContent = '';
      
      updateWordCount = function() {
        originalUpdateWordCount();
        
        // Ê™¢Êü•ÊòØÂê¶ÊúâÊñ∞ÂÖßÂÆπÈúÄË¶Å‰øùÂ≠òÂà∞Ê≠∑Âè≤
        if (latestStory && latestStory !== lastSavedContent && latestStory.length > 500) {
          // Áç≤ÂèñÁï∂ÂâçË®≠ÂÆö
          const currentSettings = {
            theme: themeSelect.value,
            setting: settingSelect.value,
            style: styleSelect.value,
            narrative: narrativeSelect.value,
            era: eraSelect.value
          };
          
          // Âª∂ÈÅ≤‰øùÂ≠òÔºåÈÅøÂÖçÈ†ªÁπÅÊõ¥Êñ∞
          clearTimeout(window.historySaveTimeout);
          window.historySaveTimeout = setTimeout(() => {
            if (latestStory !== lastSavedContent) {
              saveToHistory(themeSelect.value, latestStory, currentSettings);
              lastSavedContent = latestStory;
            }
          }, 5000);
        }
      };

      console.log('üé® AI Â∞èË™™ & Êº´Áï´Â∑•ÂùäÂ∑≤ËºâÂÖ•ÂÆåÊàêÔºÅ');
      console.log('üí° Âø´Êç∑ÈçµÔºöCtrl+G ÁîüÊàê | Ctrl+Shift+R Èö®Ê©ü | Ctrl+S ÂÑ≤Â≠ò | Ctrl+D ÂàáÊèõ‰∏ªÈ°å');
      console.log('üìú Êñ∞ÂäüËÉΩÔºöÁîüÊàêÊ≠∑Âè≤„ÄÅËá™Âãï‰øùÂ≠òÊåáÁ§∫Âô®„ÄÅÈ¶ñÊ¨°ÂºïÂ∞éÊïôÁ®ã');
    </script>
  </body>
</html>
